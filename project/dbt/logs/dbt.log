[0m11:52:37.967227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103334a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043a9a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043a9880>]}


============================== 11:52:37.970261 | 254a1479-af55-4bcd-964c-96ae97bb237c ==============================
[0m11:52:37.970261 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:52:37.970632 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'printer_width': '80', 'empty': 'None', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'use_colors': 'True', 'quiet': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt debug --profiles-dir=.', 'log_cache_events': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'debug': 'False', 'introspect': 'True', 'write_json': 'True', 'warn_error': 'None', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True'}
[0m11:52:37.978492 [info ] [MainThread]: dbt version: 1.10.13
[0m11:52:37.978749 [info ] [MainThread]: python version: 3.9.6
[0m11:52:37.978936 [info ] [MainThread]: python path: /Users/izaakford/Desktop/demo_sports_data_project/.venv/bin/python
[0m11:52:37.979125 [info ] [MainThread]: os info: macOS-15.3.2-arm64-arm-64bit
[0m11:52:38.101959 [info ] [MainThread]: Using profiles dir at .
[0m11:52:38.102283 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m11:52:38.102476 [info ] [MainThread]: Using dbt_project.yml file at /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/dbt_project.yml
[0m11:52:38.103527 [info ] [MainThread]: adapter type: duckdb
[0m11:52:38.103720 [info ] [MainThread]: adapter version: 1.9.6
[0m11:52:38.163738 [info ] [MainThread]: Configuration:
[0m11:52:38.164051 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:52:38.164257 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:52:38.164442 [info ] [MainThread]: Required dependencies:
[0m11:52:38.164668 [debug] [MainThread]: Executing "git --help"
[0m11:52:38.180092 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:52:38.180642 [debug] [MainThread]: STDERR: "b''"
[0m11:52:38.180881 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:52:38.181120 [info ] [MainThread]: Connection:
[0m11:52:38.181356 [info ] [MainThread]:   database: nhl
[0m11:52:38.181534 [info ] [MainThread]:   schema: silver
[0m11:52:38.181700 [info ] [MainThread]:   path: ../nhl.duckdb
[0m11:52:38.181867 [info ] [MainThread]:   config_options: None
[0m11:52:38.182034 [info ] [MainThread]:   extensions: ['httpfs', 'parquet']
[0m11:52:38.182198 [info ] [MainThread]:   settings: {}
[0m11:52:38.182360 [info ] [MainThread]:   external_root: .
[0m11:52:38.182527 [info ] [MainThread]:   use_credential_provider: None
[0m11:52:38.182692 [info ] [MainThread]:   attach: None
[0m11:52:38.183140 [info ] [MainThread]:   filesystems: None
[0m11:52:38.183430 [info ] [MainThread]:   remote: None
[0m11:52:38.183666 [info ] [MainThread]:   plugins: None
[0m11:52:38.183856 [info ] [MainThread]:   disable_transactions: False
[0m11:52:38.184249 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:52:38.252188 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m11:52:38.281616 [debug] [MainThread]: Using duckdb connection "debug"
[0m11:52:38.281841 [debug] [MainThread]: On debug: select 1 as id
[0m11:52:38.282004 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:52:39.017629 [debug] [MainThread]: SQL status: OK in 0.736 seconds
[0m11:52:39.018298 [debug] [MainThread]: On debug: Close
[0m11:52:39.018768 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:52:39.019019 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:52:39.019965 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.0985439, "process_in_blocks": "0", "process_kernel_time": 0.201899, "process_mem_max_rss": "168116224", "process_out_blocks": "0", "process_user_time": 0.985561}
[0m11:52:39.020234 [debug] [MainThread]: Command `dbt debug` succeeded at 11:52:39.020176 after 1.10 seconds
[0m11:52:39.020432 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:52:39.020639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103334a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10463b070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103601b80>]}
[0m11:52:39.020908 [debug] [MainThread]: Flushing usage events
[0m11:52:39.264982 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:52:45.180529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109728a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9e8490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9e82b0>]}


============================== 11:52:45.182669 | f0edd01d-099b-4759-9096-9097e9331898 ==============================
[0m11:52:45.182669 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:52:45.183013 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'version_check': 'True', 'write_json': 'True', 'target_path': 'None', 'printer_width': '80', 'log_cache_events': 'False', 'profiles_dir': '.', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'empty': 'False', 'quiet': 'False', 'invocation_command': 'dbt run --profiles-dir=.', 'cache_selected_only': 'False', 'no_print': 'None', 'warn_error': 'None', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'indirect_selection': 'eager', 'log_format': 'default', 'use_experimental_parser': 'False', 'static_parser': 'True', 'use_colors': 'True'}
[0m11:52:45.305387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0edd01d-099b-4759-9096-9097e9331898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b55f10>]}
[0m11:52:45.339451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0edd01d-099b-4759-9096-9097e9331898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aaac970>]}
[0m11:52:45.340473 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:52:45.407945 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:52:45.408409 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:52:45.408644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f0edd01d-099b-4759-9096-9097e9331898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af01e50>]}
[0m11:52:46.259994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0edd01d-099b-4759-9096-9097e9331898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1ab130>]}
[0m11:52:46.348660 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m11:52:46.350106 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m11:52:46.363684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0edd01d-099b-4759-9096-9097e9331898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2bd310>]}
[0m11:52:46.364119 [info ] [MainThread]: Found 11 models, 10 data tests, 4 sources, 444 macros
[0m11:52:46.364370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0edd01d-099b-4759-9096-9097e9331898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c144040>]}
[0m11:52:46.365552 [info ] [MainThread]: 
[0m11:52:46.365780 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:52:46.365967 [info ] [MainThread]: 
[0m11:52:46.366258 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:52:46.369922 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl'
[0m11:52:46.396852 [debug] [ThreadPool]: Using duckdb connection "list_nhl"
[0m11:52:46.397101 [debug] [ThreadPool]: On list_nhl: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m11:52:46.397273 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:52:46.424656 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m11:52:46.425864 [debug] [ThreadPool]: On list_nhl: Close
[0m11:52:46.426250 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nhl, now create_nhl_silver)
[0m11:52:46.426513 [debug] [ThreadPool]: Creating schema "database: "nhl"
schema: "silver"
"
[0m11:52:46.430829 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:52:46.431027 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nhl'
        and type='sqlite'
    
  
[0m11:52:46.431191 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:52:46.431798 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:52:46.432609 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:52:46.432794 [debug] [ThreadPool]: On create_nhl_silver: BEGIN
[0m11:52:46.433048 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:52:46.433215 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:52:46.433385 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
    
        create schema if not exists "nhl"."silver"
    
[0m11:52:46.433647 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:52:46.434087 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m11:52:46.434250 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:52:46.434399 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m11:52:46.435049 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:52:46.435224 [debug] [ThreadPool]: On create_nhl_silver: Close
[0m11:52:46.436225 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nhl_silver, now list_nhl_silver)
[0m11:52:46.439765 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m11:52:46.439948 [debug] [ThreadPool]: On list_nhl_silver: BEGIN
[0m11:52:46.440107 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:52:46.440431 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:52:46.440646 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m11:52:46.440830 [debug] [ThreadPool]: On list_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl_silver"} */
select
      'nhl' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'silver'
    and lower(table_catalog) = 'nhl'
  
[0m11:52:46.450586 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m11:52:46.451280 [debug] [ThreadPool]: On list_nhl_silver: ROLLBACK
[0m11:52:46.452433 [debug] [ThreadPool]: Failed to rollback 'list_nhl_silver'
[0m11:52:46.452608 [debug] [ThreadPool]: On list_nhl_silver: Close
[0m11:52:46.452916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0edd01d-099b-4759-9096-9097e9331898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a948790>]}
[0m11:52:46.453205 [debug] [MainThread]: Using duckdb connection "master"
[0m11:52:46.453373 [debug] [MainThread]: On master: BEGIN
[0m11:52:46.453526 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:52:46.453802 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:52:46.453975 [debug] [MainThread]: On master: COMMIT
[0m11:52:46.454138 [debug] [MainThread]: Using duckdb connection "master"
[0m11:52:46.454286 [debug] [MainThread]: On master: COMMIT
[0m11:52:46.454532 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:52:46.454700 [debug] [MainThread]: On master: Close
[0m11:52:46.457426 [debug] [Thread-1  ]: Began running node model.nhl_analytics.int_all_players
[0m11:52:46.457672 [debug] [Thread-2  ]: Began running node model.nhl_analytics.int_team_performance
[0m11:52:46.458164 [debug] [Thread-3  ]: Began running node model.nhl_analytics.mart_goalie_performance
[0m11:52:46.457978 [info ] [Thread-1  ]: 1 of 11 START sql view model silver.int_all_players ............................ [RUN]
[0m11:52:46.458437 [debug] [Thread-4  ]: Began running node model.nhl_analytics.mart_player_performance
[0m11:52:46.458705 [info ] [Thread-2  ]: 2 of 11 START sql view model silver.int_team_performance ....................... [RUN]
[0m11:52:46.459016 [info ] [Thread-3  ]: 3 of 11 START sql table model silver.mart_goalie_performance ................... [RUN]
[0m11:52:46.459300 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_nhl_silver, now model.nhl_analytics.int_all_players)
[0m11:52:46.459569 [info ] [Thread-4  ]: 4 of 11 START sql table model silver.mart_player_performance ................... [RUN]
[0m11:52:46.459862 [debug] [Thread-2  ]: Acquiring new duckdb connection 'model.nhl_analytics.int_team_performance'
[0m11:52:46.460137 [debug] [Thread-3  ]: Acquiring new duckdb connection 'model.nhl_analytics.mart_goalie_performance'
[0m11:52:46.460344 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.int_all_players
[0m11:52:46.460601 [debug] [Thread-4  ]: Acquiring new duckdb connection 'model.nhl_analytics.mart_player_performance'
[0m11:52:46.460800 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.int_team_performance
[0m11:52:46.461003 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.mart_goalie_performance
[0m11:52:46.466180 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.int_all_players"
[0m11:52:46.466424 [debug] [Thread-4  ]: Began compiling node model.nhl_analytics.mart_player_performance
[0m11:52:46.467744 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.int_team_performance"
[0m11:52:46.469032 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.mart_goalie_performance"
[0m11:52:46.470434 [debug] [Thread-4  ]: Writing injected SQL for node "model.nhl_analytics.mart_player_performance"
[0m11:52:46.471158 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.int_all_players
[0m11:52:46.483803 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.mart_goalie_performance
[0m11:52:46.490013 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.int_all_players"
[0m11:52:46.490258 [debug] [Thread-4  ]: Began executing node model.nhl_analytics.mart_player_performance
[0m11:52:46.496621 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.int_team_performance
[0m11:52:46.503541 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.mart_goalie_performance"
[0m11:52:46.505673 [debug] [Thread-4  ]: Writing runtime sql for node "model.nhl_analytics.mart_player_performance"
[0m11:52:46.507810 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.int_team_performance"
[0m11:52:46.508738 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m11:52:46.509034 [debug] [Thread-4  ]: On model.nhl_analytics.mart_player_performance: BEGIN
[0m11:52:46.509260 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:52:46.509502 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m11:52:46.509726 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.int_team_performance"
[0m11:52:46.510084 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m11:52:46.510297 [debug] [Thread-1  ]: On model.nhl_analytics.int_all_players: BEGIN
[0m11:52:46.510511 [debug] [Thread-2  ]: On model.nhl_analytics.int_team_performance: BEGIN
[0m11:52:46.510721 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m11:52:46.510918 [debug] [Thread-3  ]: On model.nhl_analytics.mart_goalie_performance: BEGIN
[0m11:52:46.511125 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:52:46.511340 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:52:46.511561 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m11:52:46.511771 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:52:46.512158 [debug] [Thread-4  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */

  
    
    

    create  table
      "nhl"."silver"."mart_player_performance__dbt_tmp"
  
    as (
      { { config(materialized = 'table') } }
select player_id,
    player_name,
    team_code,
    position,
    position_group,
    games_played,
    points_per_game,
    shooting_percentage,
    faceoff_percentage,
    case
        when points_per_game >= 1.0 then 'Elite'
        when points_per_game >= 0.7 then 'Very Good'
        when points_per_game >= 0.5 then 'Good'
        when points_per_game >= 0.3 then 'Average'
        else 'Below Average'
    end as offensive_rating,
    case
        when shooting_percentage >= 15 then 'Elite Shooter'
        when shooting_percentage >= 12 then 'Good Shooter'
        when shooting_percentage >= 10 then 'Average Shooter'
        else 'Below Average Shooter'
    end as shooting_rating,
    is_active,
    loaded_at
from { { ref('int_all_players') } }
where position_group in ('Forward', 'Defense')
    and is_active = true
    and games_played >= 10
    );
  
  
[0m11:52:46.512400 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m11:52:46.512642 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m11:52:46.515524 [debug] [Thread-4  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */

  
    
    

    create  table
      "nhl"."silver"."mart_player_performance__dbt_tmp"
  
    as (
      { { config(materialized = 'table') } }
select player_id,
    player_name,
    team_code,
    position,
    position_group,
    games_played,
    points_per_game,
    shooting_percentage,
    faceoff_percentage,
    case
        when points_per_game >= 1.0 then 'Elite'
        when points_per_game >= 0.7 then 'Very Good'
        when points_per_game >= 0.5 then 'Good'
        when points_per_game >= 0.3 then 'Average'
        else 'Below Average'
    end as offensive_rating,
    case
        when shooting_percentage >= 15 then 'Elite Shooter'
        when shooting_percentage >= 12 then 'Good Shooter'
        when shooting_percentage >= 10 then 'Average Shooter'
        else 'Below Average Shooter'
    end as shooting_rating,
    is_active,
    loaded_at
from { { ref('int_all_players') } }
where position_group in ('Forward', 'Defense')
    and is_active = true
    and games_played >= 10
    );
  
  
[0m11:52:46.515751 [debug] [Thread-3  ]: SQL status: OK in 0.004 seconds
[0m11:52:46.515942 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m11:52:46.516155 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.int_team_performance"
[0m11:52:46.516356 [debug] [Thread-4  ]: DuckDB adapter: Rolling back transaction.
[0m11:52:46.516550 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m11:52:46.516779 [debug] [Thread-1  ]: On model.nhl_analytics.int_all_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */

  
  create view "nhl"."silver"."int_all_players__dbt_tmp" as (
    { { config(materialized = 'view') } } with all_players as (
    select player_id,
        season,
        player_name,
        team_code,
        'G' as position,
        games_played,
        points_per_game,
        null as shooting_percentage,
        null as faceoff_percentage,
        save_percentage,
        goals_against_average,
        is_active_goalie as is_active,
        loaded_at
    from { { ref('stg_goalies') } }
    union all
    select player_id,
        season,
        player_name,
        team_code,
        position,
        games_played,
        points_per_game,
        shooting_percentage,
        faceoff_percentage,
        null as save_percentage,
        null as goals_against_average,
        is_active_player as is_active,
        loaded_at
    from { { ref('stg_skaters') } }
)
select *,
    case
        when position = 'G' then 'Goalie'
        when position in ('C', 'L', 'R', 'LW', 'RW') then 'Forward'
        when position in ('D') then 'Defense'
        else 'Unknown'
    end as position_group
from all_players
  );

[0m11:52:46.517033 [debug] [Thread-2  ]: On model.nhl_analytics.int_team_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_team_performance"} */

  
  create view "nhl"."silver"."int_team_performance__dbt_tmp" as (
    { { config(materialized = 'view') } } with team_stats as (
    select *,
        row_number() over (
            order by team_points desc,
                points_percentage desc
        ) as standings_rank
    from { { ref('stg_teams') } }
),
team_performance as (
    select *,
        case
            when standings_rank <= 8 then 'Playoff Position'
            when standings_rank <= 16 then 'Wild Card Contention'
            else 'Rebuilding'
        end as team_category,
        goals_per_game - goals_against_per_game as goal_differential_per_game
    from team_stats
)
select *
from team_performance
  );

[0m11:52:46.517313 [debug] [Thread-4  ]: On model.nhl_analytics.mart_player_performance: ROLLBACK
[0m11:52:46.517551 [debug] [Thread-3  ]: On model.nhl_analytics.mart_goalie_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */

  
    
    

    create  table
      "nhl"."silver"."mart_goalie_performance__dbt_tmp"
  
    as (
      { { config(materialized = 'table') } }
select player_id,
    player_name,
    team_code,
    games_played,
    save_percentage,
    goals_against_average,
    case
        when save_percentage >= 0.925 then 'Elite'
        when save_percentage >= 0.915 then 'Very Good'
        when save_percentage >= 0.905 then 'Good'
        when save_percentage >= 0.895 then 'Average'
        else 'Below Average'
    end as goalie_rating,
    case
        when goals_against_average <= 2.2 then 'Elite'
        when goals_against_average <= 2.5 then 'Very Good'
        when goals_against_average <= 2.8 then 'Good'
        when goals_against_average <= 3.2 then 'Average'
        else 'Below Average'
    end as gaa_rating,
    is_active,
    loaded_at
from { { ref('int_all_players') } }
where position_group = 'Goalie'
    and is_active = true
    and games_played >= 10
    );
  
  
[0m11:52:46.517956 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */

  
  create view "nhl"."silver"."int_all_players__dbt_tmp" as (
    { { config(materialized = 'view') } } with all_players as (
    select player_id,
        season,
        player_name,
        team_code,
        'G' as position,
        games_played,
        points_per_game,
        null as shooting_percentage,
        null as faceoff_percentage,
        save_percentage,
        goals_against_average,
        is_active_goalie as is_active,
        loaded_at
    from { { ref('stg_goalies') } }
    union all
    select player_id,
        season,
        player_name,
        team_code,
        position,
        games_played,
        points_per_game,
        shooting_percentage,
        faceoff_percentage,
        null as save_percentage,
        null as goals_against_average,
        is_active_player as is_active,
        loaded_at
    from { { ref('stg_skaters') } }
)
select *,
    case
        when position = 'G' then 'Goalie'
        when position in ('C', 'L', 'R', 'LW', 'RW') then 'Forward'
        when position in ('D') then 'Defense'
        else 'Unknown'
    end as position_group
from all_players
  );

[0m11:52:46.518343 [debug] [Thread-2  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_team_performance"} */

  
  create view "nhl"."silver"."int_team_performance__dbt_tmp" as (
    { { config(materialized = 'view') } } with team_stats as (
    select *,
        row_number() over (
            order by team_points desc,
                points_percentage desc
        ) as standings_rank
    from { { ref('stg_teams') } }
),
team_performance as (
    select *,
        case
            when standings_rank <= 8 then 'Playoff Position'
            when standings_rank <= 16 then 'Wild Card Contention'
            else 'Rebuilding'
        end as team_category,
        goals_per_game - goals_against_per_game as goal_differential_per_game
    from team_stats
)
select *
from team_performance
  );

[0m11:52:46.520338 [debug] [Thread-3  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */

  
    
    

    create  table
      "nhl"."silver"."mart_goalie_performance__dbt_tmp"
  
    as (
      { { config(materialized = 'table') } }
select player_id,
    player_name,
    team_code,
    games_played,
    save_percentage,
    goals_against_average,
    case
        when save_percentage >= 0.925 then 'Elite'
        when save_percentage >= 0.915 then 'Very Good'
        when save_percentage >= 0.905 then 'Good'
        when save_percentage >= 0.895 then 'Average'
        else 'Below Average'
    end as goalie_rating,
    case
        when goals_against_average <= 2.2 then 'Elite'
        when goals_against_average <= 2.5 then 'Very Good'
        when goals_against_average <= 2.8 then 'Good'
        when goals_against_average <= 3.2 then 'Average'
        else 'Below Average'
    end as gaa_rating,
    is_active,
    loaded_at
from { { ref('int_all_players') } }
where position_group = 'Goalie'
    and is_active = true
    and games_played >= 10
    );
  
  
[0m11:52:46.520583 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m11:52:46.520799 [debug] [Thread-2  ]: DuckDB adapter: Rolling back transaction.
[0m11:52:46.521022 [debug] [Thread-3  ]: DuckDB adapter: Rolling back transaction.
[0m11:52:46.521334 [debug] [Thread-1  ]: On model.nhl_analytics.int_all_players: ROLLBACK
[0m11:52:46.521608 [debug] [Thread-2  ]: On model.nhl_analytics.int_team_performance: ROLLBACK
[0m11:52:46.523036 [debug] [Thread-3  ]: On model.nhl_analytics.mart_goalie_performance: ROLLBACK
[0m11:52:46.562419 [debug] [Thread-2  ]: Failed to rollback 'model.nhl_analytics.int_team_performance'
[0m11:52:46.562678 [debug] [Thread-2  ]: On model.nhl_analytics.int_team_performance: Close
[0m11:52:46.563125 [debug] [Thread-4  ]: Failed to rollback 'model.nhl_analytics.mart_player_performance'
[0m11:52:46.563563 [debug] [Thread-3  ]: Failed to rollback 'model.nhl_analytics.mart_goalie_performance'
[0m11:52:46.563920 [debug] [Thread-4  ]: On model.nhl_analytics.mart_player_performance: Close
[0m11:52:46.564324 [debug] [Thread-1  ]: Failed to rollback 'model.nhl_analytics.int_all_players'
[0m11:52:46.564534 [debug] [Thread-3  ]: On model.nhl_analytics.mart_goalie_performance: Close
[0m11:52:46.564807 [debug] [Thread-1  ]: On model.nhl_analytics.int_all_players: Close
[0m11:52:46.567727 [debug] [Thread-2  ]: Runtime Error in model int_team_performance (models/intermediate/int_team_performance.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } } with team_stats as (
              ^
[0m11:52:46.571257 [debug] [Thread-4  ]: Runtime Error in model mart_player_performance (models/marts/mart_player_performance.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 11:       { { config(materialized = 'table') } }
                 ^
[0m11:52:46.573997 [debug] [Thread-3  ]: Runtime Error in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 11:       { { config(materialized = 'table') } }
                 ^
[0m11:52:46.574292 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0edd01d-099b-4759-9096-9097e9331898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099a7880>]}
[0m11:52:46.574492 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0edd01d-099b-4759-9096-9097e9331898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b25e970>]}
[0m11:52:46.574695 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0edd01d-099b-4759-9096-9097e9331898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b41aca0>]}
[0m11:52:46.577371 [debug] [Thread-1  ]: Runtime Error in model int_all_players (models/intermediate/int_all_players.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } } with all_players as (
              ^
[0m11:52:46.577702 [error] [Thread-2  ]: 2 of 11 ERROR creating sql view model silver.int_team_performance .............. [[31mERROR[0m in 0.11s]
[0m11:52:46.578114 [error] [Thread-4  ]: 4 of 11 ERROR creating sql table model silver.mart_player_performance .......... [[31mERROR[0m in 0.11s]
[0m11:52:46.578698 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0edd01d-099b-4759-9096-9097e9331898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6a9400>]}
[0m11:52:46.578477 [error] [Thread-3  ]: 3 of 11 ERROR creating sql table model silver.mart_goalie_performance .......... [[31mERROR[0m in 0.11s]
[0m11:52:46.579063 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.int_team_performance
[0m11:52:46.579374 [debug] [Thread-4  ]: Finished running node model.nhl_analytics.mart_player_performance
[0m11:52:46.579954 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.mart_goalie_performance
[0m11:52:46.579702 [error] [Thread-1  ]: 1 of 11 ERROR creating sql view model silver.int_all_players ................... [[31mERROR[0m in 0.12s]
[0m11:52:46.580241 [debug] [Thread-2  ]: Began running node model.nhl_analytics.mart_team_standings
[0m11:52:46.580496 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.int_team_performance' to be skipped because of status 'error'.  Reason: Runtime Error in model int_team_performance (models/intermediate/int_team_performance.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } } with team_stats as (
              ^.
[0m11:52:46.580720 [debug] [Thread-4  ]: Began running node model.nhl_analytics.my_first_dbt_model
[0m11:52:46.580936 [debug] [Thread-3  ]: Began running node model.nhl_analytics.stg_goalies
[0m11:52:46.581214 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.int_all_players
[0m11:52:46.581463 [info ] [Thread-2  ]: 5 of 11 START sql table model silver.mart_team_standings ....................... [RUN]
[0m11:52:46.581769 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.mart_player_performance' to be skipped because of status 'error'.  Reason: Runtime Error in model mart_player_performance (models/marts/mart_player_performance.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 11:       { { config(materialized = 'table') } }
                 ^.
[0m11:52:46.582019 [info ] [Thread-4  ]: 6 of 11 START sql table model silver.my_first_dbt_model ........................ [RUN]
[0m11:52:46.582292 [info ] [Thread-3  ]: 7 of 11 START sql view model silver.stg_goalies ................................ [RUN]
[0m11:52:46.582532 [debug] [Thread-1  ]: Began running node model.nhl_analytics.stg_lines
[0m11:52:46.582760 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.int_team_performance, now model.nhl_analytics.mart_team_standings)
[0m11:52:46.583033 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.mart_goalie_performance' to be skipped because of status 'error'.  Reason: Runtime Error in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 11:       { { config(materialized = 'table') } }
                 ^.
[0m11:52:46.583251 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.mart_player_performance, now model.nhl_analytics.my_first_dbt_model)
[0m11:52:46.583484 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.mart_goalie_performance, now model.nhl_analytics.stg_goalies)
[0m11:52:46.583775 [info ] [Thread-1  ]: 8 of 11 START sql view model silver.stg_lines .................................. [RUN]
[0m11:52:46.584044 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.mart_team_standings
[0m11:52:46.584350 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.int_all_players' to be skipped because of status 'error'.  Reason: Runtime Error in model int_all_players (models/intermediate/int_all_players.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } } with all_players as (
              ^.
[0m11:52:46.584584 [debug] [Thread-4  ]: Began compiling node model.nhl_analytics.my_first_dbt_model
[0m11:52:46.584794 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.stg_goalies
[0m11:52:46.585030 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.int_all_players, now model.nhl_analytics.stg_lines)
[0m11:52:46.586536 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.mart_team_standings"
[0m11:52:46.588342 [debug] [Thread-4  ]: Writing injected SQL for node "model.nhl_analytics.my_first_dbt_model"
[0m11:52:46.589593 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.stg_goalies"
[0m11:52:46.589799 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.stg_lines
[0m11:52:46.591465 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.stg_lines"
[0m11:52:46.591727 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.mart_team_standings
[0m11:52:46.594659 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.mart_team_standings"
[0m11:52:46.594959 [debug] [Thread-4  ]: Began executing node model.nhl_analytics.my_first_dbt_model
[0m11:52:46.595195 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.stg_lines
[0m11:52:46.595397 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.stg_goalies
[0m11:52:46.597717 [debug] [Thread-4  ]: Writing runtime sql for node "model.nhl_analytics.my_first_dbt_model"
[0m11:52:46.600175 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.stg_lines"
[0m11:52:46.602559 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.stg_goalies"
[0m11:52:46.602833 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m11:52:46.603243 [debug] [Thread-2  ]: On model.nhl_analytics.mart_team_standings: BEGIN
[0m11:52:46.603493 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:52:46.603865 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.my_first_dbt_model"
[0m11:52:46.604087 [debug] [Thread-4  ]: On model.nhl_analytics.my_first_dbt_model: BEGIN
[0m11:52:46.604296 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m11:52:46.604532 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_lines"
[0m11:52:46.604756 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m11:52:46.605054 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:52:46.605256 [debug] [Thread-1  ]: On model.nhl_analytics.stg_lines: BEGIN
[0m11:52:46.605464 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m11:52:46.605660 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m11:52:46.605857 [debug] [Thread-3  ]: On model.nhl_analytics.stg_goalies: BEGIN
[0m11:52:46.606047 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:52:46.606271 [debug] [Thread-2  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

  
    
    

    create  table
      "nhl"."silver"."mart_team_standings__dbt_tmp"
  
    as (
      { { config(materialized = 'table') } }
select season,
    team_name,
    team_points,
    wins,
    losses,
    overtime_losses,
    games_played,
    standings_rank,
    team_category,
    goals_per_game,
    goals_against_per_game,
    goal_differential_per_game,
    power_play_percentage,
    penalty_kill_percentage,
    shots_per_game,
    shots_allowed_per_game,
    faceoff_percentage,
    points_percentage,
    -- Performance indicators
    case
        when wins_when_scoring_first > 0
        and games_played > 0 then round(
            wins_when_scoring_first * 100.0 / games_played,
            1
        )
        else null
    end as win_pct_when_scoring_first,
    case
        when wins_when_outshooting_opponent > 0
        and games_played > 0 then round(
            wins_when_outshooting_opponent * 100.0 / games_played,
            1
        )
        else null
    end as win_pct_when_outshooting,
    loaded_at
from { { ref('int_team_performance') } }
order by standings_rank
    );
  
  
[0m11:52:46.606492 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.my_first_dbt_model"
[0m11:52:46.606686 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m11:52:46.607149 [debug] [Thread-2  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

  
    
    

    create  table
      "nhl"."silver"."mart_team_standings__dbt_tmp"
  
    as (
      { { config(materialized = 'table') } }
select season,
    team_name,
    team_points,
    wins,
    losses,
    overtime_losses,
    games_played,
    standings_rank,
    team_category,
    goals_per_game,
    goals_against_per_game,
    goal_differential_per_game,
    power_play_percentage,
    penalty_kill_percentage,
    shots_per_game,
    shots_allowed_per_game,
    faceoff_percentage,
    points_percentage,
    -- Performance indicators
    case
        when wins_when_scoring_first > 0
        and games_played > 0 then round(
            wins_when_scoring_first * 100.0 / games_played,
            1
        )
        else null
    end as win_pct_when_scoring_first,
    case
        when wins_when_outshooting_opponent > 0
        and games_played > 0 then round(
            wins_when_outshooting_opponent * 100.0 / games_played,
            1
        )
        else null
    end as win_pct_when_outshooting,
    loaded_at
from { { ref('int_team_performance') } }
order by standings_rank
    );
  
  
[0m11:52:46.607415 [debug] [Thread-4  ]: On model.nhl_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.my_first_dbt_model"} */

  
    
    

    create  table
      "nhl"."silver"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m11:52:46.607632 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m11:52:46.607884 [debug] [Thread-2  ]: DuckDB adapter: Rolling back transaction.
[0m11:52:46.608162 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_lines"
[0m11:52:46.608352 [debug] [Thread-3  ]: SQL status: OK in 0.002 seconds
[0m11:52:46.608628 [debug] [Thread-2  ]: On model.nhl_analytics.mart_team_standings: ROLLBACK
[0m11:52:46.608871 [debug] [Thread-1  ]: On model.nhl_analytics.stg_lines: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_lines"} */

  
  create view "nhl"."silver"."stg_lines__dbt_tmp" as (
    { { config(materialized = 'view') } }
select season,
    team,
    l1 as line_player_1,
    l2 as line_player_2,
    l3 as line_player_3,
    games_played,
    icetime as ice_time,
    icetimeRank as ice_time_rank,
    -- Offensive stats
    goals,
    assists,
    points,
    shots,
    shotsFor as shots_for,
    shotsAgainst as shots_against,
    -- Advanced stats
    corsiFor as corsi_for,
    corsiAgainst as corsi_against,
    corsiForPct as corsi_for_percentage,
    fenwickFor as fenwick_for,
    fenwickAgainst as fenwick_against,
    fenwickForPct as fenwick_for_percentage,
    -- Goals for/against
    goalsFor as goals_for,
    goalsAgainst as goals_against,
    goalDifferential as goal_differential,
    -- Add line identification
    concat(team, '_', l1, '_', l2, '_', l3) as line_id,
    -- Calculate additional metrics
    case
        when icetime > 0 then round(points * 60.0 / icetime, 2)
        else null
    end as points_per_60,
    case
        when shots > 0 then round(goals * 100.0 / shots, 2)
        else null
    end as shooting_percentage,
    current_timestamp as loaded_at
from { { source('bronze', 'lines') } }
where season is not null
    and team is not null
    and l1 is not null
    and l2 is not null
    and l3 is not null
  );

[0m11:52:46.609112 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:52:46.609567 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_lines"} */

  
  create view "nhl"."silver"."stg_lines__dbt_tmp" as (
    { { config(materialized = 'view') } }
select season,
    team,
    l1 as line_player_1,
    l2 as line_player_2,
    l3 as line_player_3,
    games_played,
    icetime as ice_time,
    icetimeRank as ice_time_rank,
    -- Offensive stats
    goals,
    assists,
    points,
    shots,
    shotsFor as shots_for,
    shotsAgainst as shots_against,
    -- Advanced stats
    corsiFor as corsi_for,
    corsiAgainst as corsi_against,
    corsiForPct as corsi_for_percentage,
    fenwickFor as fenwick_for,
    fenwickAgainst as fenwick_against,
    fenwickForPct as fenwick_for_percentage,
    -- Goals for/against
    goalsFor as goals_for,
    goalsAgainst as goals_against,
    goalDifferential as goal_differential,
    -- Add line identification
    concat(team, '_', l1, '_', l2, '_', l3) as line_id,
    -- Calculate additional metrics
    case
        when icetime > 0 then round(points * 60.0 / icetime, 2)
        else null
    end as points_per_60,
    case
        when shots > 0 then round(goals * 100.0 / shots, 2)
        else null
    end as shooting_percentage,
    current_timestamp as loaded_at
from { { source('bronze', 'lines') } }
where season is not null
    and team is not null
    and l1 is not null
    and l2 is not null
    and l3 is not null
  );

[0m11:52:46.609849 [debug] [Thread-3  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    games_played,
    games_started,
    wins,
    losses,
    ties,
    otLosses as ot_losses,
    shotsAgainst as shots_against,
    saves,
    goals_against,
    savePercentage as save_percentage,
    goalsAgainstAverage as goals_against_average,
    timeOnIce as time_on_ice,
    timeOnIcePerGame as time_on_ice_per_game,
    shutouts,
    lowDangerGoals as low_danger_goals,
    mediumDangerGoals as medium_danger_goals,
    highDangerGoals as high_danger_goals,
    blocked_shot_attempts,
    penalityMinutes as penalty_minutes,
    penalties,
    -- Add data quality flags
    case
        when games_played > 0
        and saves > 0 then true
        else false
    end as is_active_goalie,
    -- Calculate additional metrics
    case
        when shotsAgainst > 0 then round(saves * 100.0 / shotsAgainst, 2)
        else null
    end as calculated_save_percentage,
    current_timestamp as loaded_at
from { { source('bronze', 'goalies') } }
where playerId is not null
    and season is not null
  );

[0m11:52:46.610137 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m11:52:46.610536 [debug] [Thread-3  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    games_played,
    games_started,
    wins,
    losses,
    ties,
    otLosses as ot_losses,
    shotsAgainst as shots_against,
    saves,
    goals_against,
    savePercentage as save_percentage,
    goalsAgainstAverage as goals_against_average,
    timeOnIce as time_on_ice,
    timeOnIcePerGame as time_on_ice_per_game,
    shutouts,
    lowDangerGoals as low_danger_goals,
    mediumDangerGoals as medium_danger_goals,
    highDangerGoals as high_danger_goals,
    blocked_shot_attempts,
    penalityMinutes as penalty_minutes,
    penalties,
    -- Add data quality flags
    case
        when games_played > 0
        and saves > 0 then true
        else false
    end as is_active_goalie,
    -- Calculate additional metrics
    case
        when shotsAgainst > 0 then round(saves * 100.0 / shotsAgainst, 2)
        else null
    end as calculated_save_percentage,
    current_timestamp as loaded_at
from { { source('bronze', 'goalies') } }
where playerId is not null
    and season is not null
  );

[0m11:52:46.610831 [debug] [Thread-1  ]: On model.nhl_analytics.stg_lines: ROLLBACK
[0m11:52:46.611041 [debug] [Thread-4  ]: SQL status: OK in 0.003 seconds
[0m11:52:46.611239 [debug] [Thread-3  ]: DuckDB adapter: Rolling back transaction.
[0m11:52:46.614530 [debug] [Thread-2  ]: Failed to rollback 'model.nhl_analytics.mart_team_standings'
[0m11:52:46.618464 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.my_first_dbt_model"
[0m11:52:46.618787 [debug] [Thread-3  ]: On model.nhl_analytics.stg_goalies: ROLLBACK
[0m11:52:46.619011 [debug] [Thread-2  ]: On model.nhl_analytics.mart_team_standings: Close
[0m11:52:46.619250 [debug] [Thread-4  ]: On model.nhl_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.my_first_dbt_model"} */
alter table "nhl"."silver"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m11:52:46.622115 [debug] [Thread-1  ]: Failed to rollback 'model.nhl_analytics.stg_lines'
[0m11:52:46.622564 [debug] [Thread-1  ]: On model.nhl_analytics.stg_lines: Close
[0m11:52:46.622825 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m11:52:46.631191 [debug] [Thread-4  ]: On model.nhl_analytics.my_first_dbt_model: COMMIT
[0m11:52:46.631492 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.my_first_dbt_model"
[0m11:52:46.631725 [debug] [Thread-4  ]: On model.nhl_analytics.my_first_dbt_model: COMMIT
[0m11:52:46.634459 [debug] [Thread-3  ]: Failed to rollback 'model.nhl_analytics.stg_goalies'
[0m11:52:46.634671 [debug] [Thread-3  ]: On model.nhl_analytics.stg_goalies: Close
[0m11:52:46.637678 [debug] [Thread-2  ]: Runtime Error in model mart_team_standings (models/marts/mart_team_standings.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 11:       { { config(materialized = 'table') } }
                 ^
[0m11:52:46.638132 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0edd01d-099b-4759-9096-9097e9331898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099a7880>]}
[0m11:52:46.638358 [debug] [Thread-4  ]: SQL status: OK in 0.006 seconds
[0m11:52:46.642483 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.my_first_dbt_model"
[0m11:52:46.642825 [error] [Thread-2  ]: 5 of 11 ERROR creating sql table model silver.mart_team_standings .............. [[31mERROR[0m in 0.06s]
[0m11:52:46.643063 [debug] [Thread-4  ]: On model.nhl_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.my_first_dbt_model"} */

      drop table if exists "nhl"."silver"."my_first_dbt_model__dbt_backup" cascade
    
[0m11:52:46.645898 [debug] [Thread-1  ]: Runtime Error in model stg_lines (models/staging/stg_lines.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m11:52:46.646206 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.mart_team_standings
[0m11:52:46.649243 [debug] [Thread-3  ]: Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m11:52:46.649578 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0edd01d-099b-4759-9096-9097e9331898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6231f0>]}
[0m11:52:46.649850 [debug] [Thread-2  ]: Began running node model.nhl_analytics.stg_skaters
[0m11:52:46.650075 [debug] [Thread-4  ]: SQL status: OK in 0.004 seconds
[0m11:52:46.650348 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.mart_team_standings' to be skipped because of status 'error'.  Reason: Runtime Error in model mart_team_standings (models/marts/mart_team_standings.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 11:       { { config(materialized = 'table') } }
                 ^.
[0m11:52:46.650600 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0edd01d-099b-4759-9096-9097e9331898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6230a0>]}
[0m11:52:46.650998 [error] [Thread-1  ]: 8 of 11 ERROR creating sql view model silver.stg_lines ......................... [[31mERROR[0m in 0.06s]
[0m11:52:46.652778 [debug] [Thread-4  ]: On model.nhl_analytics.my_first_dbt_model: Close
[0m11:52:46.651241 [info ] [Thread-2  ]: 9 of 11 START sql view model silver.stg_skaters ................................ [RUN]
[0m11:52:46.653532 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.stg_lines
[0m11:52:46.653267 [error] [Thread-3  ]: 7 of 11 ERROR creating sql view model silver.stg_goalies ....................... [[31mERROR[0m in 0.07s]
[0m11:52:46.653868 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.mart_team_standings, now model.nhl_analytics.stg_skaters)
[0m11:52:46.654187 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0edd01d-099b-4759-9096-9097e9331898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b39d00>]}
[0m11:52:46.654431 [debug] [Thread-1  ]: Began running node model.nhl_analytics.stg_teams
[0m11:52:46.654689 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_lines' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_lines (models/staging/stg_lines.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^.
[0m11:52:46.654965 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.stg_goalies
[0m11:52:46.655176 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.stg_skaters
[0m11:52:46.655546 [info ] [Thread-4  ]: 6 of 11 OK created sql table model silver.my_first_dbt_model ................... [[32mOK[0m in 0.07s]
[0m11:52:46.655787 [info ] [Thread-1  ]: 10 of 11 START sql view model silver.stg_teams ................................. [RUN]
[0m11:52:46.656212 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_goalies' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^.
[0m11:52:46.657656 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.stg_skaters"
[0m11:52:46.657952 [debug] [Thread-4  ]: Finished running node model.nhl_analytics.my_first_dbt_model
[0m11:52:46.658182 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.stg_lines, now model.nhl_analytics.stg_teams)
[0m11:52:46.658528 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.stg_teams
[0m11:52:46.658809 [debug] [Thread-3  ]: Began running node model.nhl_analytics.my_second_dbt_model
[0m11:52:46.660097 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.stg_teams"
[0m11:52:46.660592 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.stg_skaters
[0m11:52:46.660387 [info ] [Thread-3  ]: 11 of 11 START sql table model silver.my_second_dbt_model ...................... [RUN]
[0m11:52:46.663095 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.stg_skaters"
[0m11:52:46.663369 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.stg_goalies, now model.nhl_analytics.my_second_dbt_model)
[0m11:52:46.663657 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.stg_teams
[0m11:52:46.663868 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.my_second_dbt_model
[0m11:52:46.666349 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.stg_teams"
[0m11:52:46.668219 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.my_second_dbt_model"
[0m11:52:46.668697 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m11:52:46.668939 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: BEGIN
[0m11:52:46.669149 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.my_second_dbt_model
[0m11:52:46.669383 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m11:52:46.669576 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:52:46.671757 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.my_second_dbt_model"
[0m11:52:46.671967 [debug] [Thread-1  ]: On model.nhl_analytics.stg_teams: BEGIN
[0m11:52:46.672327 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:52:46.672614 [debug] [Thread-2  ]: SQL status: OK in 0.003 seconds
[0m11:52:46.672818 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m11:52:46.673017 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m11:52:46.673250 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.my_second_dbt_model"
[0m11:52:46.673496 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    games_played,
    time_on_ice,
    assists,
    goals,
    shots,
    points,
    plusMinus as plus_minus,
    penalityMinutes as penalty_minutes,
    faceOffWins as faceoff_wins,
    faceoffTaken as faceoff_taken,
    takeaways,
    giveaways,
    shortHandedGoals as short_handed_goals,
    shortHandedAssists as short_handed_assists,
    shortHandedPoints as short_handed_points,
    powerPlayGoals as power_play_goals,
    powerPlayAssists as power_play_assists,
    powerPlayPoints as power_play_points,
    gameWinningGoals as game_winning_goals,
    overtimeGoals as overtime_goals,
    shootoutGoals as shootout_goals,
    shootoutAttempts as shootout_attempts,
    hits,
    blocked,
    shifts,
    -- Add data quality flags
    case
        when games_played > 0 then true
        else false
    end as is_active_player,
    -- Calculate additional metrics
    case
        when games_played > 0 then round(points * 1.0 / games_played, 2)
        else null
    end as points_per_game,
    case
        when faceoffTaken > 0 then round(faceOffWins * 100.0 / faceoffTaken, 2)
        else null
    end as faceoff_percentage,
    case
        when shots > 0 then round(goals * 100.0 / shots, 2)
        else null
    end as shooting_percentage,
    current_timestamp as loaded_at
from { { source('bronze', 'skaters') } }
where playerId is not null
    and season is not null
  );

[0m11:52:46.673733 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m11:52:46.673927 [debug] [Thread-3  ]: On model.nhl_analytics.my_second_dbt_model: BEGIN
[0m11:52:46.674330 [debug] [Thread-2  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    games_played,
    time_on_ice,
    assists,
    goals,
    shots,
    points,
    plusMinus as plus_minus,
    penalityMinutes as penalty_minutes,
    faceOffWins as faceoff_wins,
    faceoffTaken as faceoff_taken,
    takeaways,
    giveaways,
    shortHandedGoals as short_handed_goals,
    shortHandedAssists as short_handed_assists,
    shortHandedPoints as short_handed_points,
    powerPlayGoals as power_play_goals,
    powerPlayAssists as power_play_assists,
    powerPlayPoints as power_play_points,
    gameWinningGoals as game_winning_goals,
    overtimeGoals as overtime_goals,
    shootoutGoals as shootout_goals,
    shootoutAttempts as shootout_attempts,
    hits,
    blocked,
    shifts,
    -- Add data quality flags
    case
        when games_played > 0 then true
        else false
    end as is_active_player,
    -- Calculate additional metrics
    case
        when games_played > 0 then round(points * 1.0 / games_played, 2)
        else null
    end as points_per_game,
    case
        when faceoffTaken > 0 then round(faceOffWins * 100.0 / faceoffTaken, 2)
        else null
    end as faceoff_percentage,
    case
        when shots > 0 then round(goals * 100.0 / shots, 2)
        else null
    end as shooting_percentage,
    current_timestamp as loaded_at
from { { source('bronze', 'skaters') } }
where playerId is not null
    and season is not null
  );

[0m11:52:46.674604 [debug] [Thread-1  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

  
  create view "nhl"."silver"."stg_teams__dbt_tmp" as (
    { { config(materialized = 'view') } }
select season,
    name as team_name,
    wins,
    losses,
    ot as overtime_losses,
    points as team_points,
    pointPctg as points_percentage,
    goalsPerGame as goals_per_game,
    goalsAgainstPerGame as goals_against_per_game,
    powerPlayPercentage as power_play_percentage,
    powerPlayGoals as power_play_goals,
    powerPlayOpportunities as power_play_opportunities,
    penaltyKillPercentage as penalty_kill_percentage,
    shotsPerGame as shots_per_game,
    shotsAllowed as shots_allowed_per_game,
    winScoreFirst as wins_when_scoring_first,
    winOppScoreFirst as wins_when_opponent_scores_first,
    winLeadFirstPer as wins_leading_first_period,
    winLeadSecondPer as wins_leading_second_period,
    winOutshootOpp as wins_when_outshooting_opponent,
    winOutshotByOpp as wins_when_outshot_by_opponent,
    faceOffsTaken as faceoffs_taken,
    faceOffsWon as faceoffs_won,
    -- Calculate additional metrics
    case
        when faceOffsTaken > 0 then round(faceOffsWon * 100.0 / faceOffsTaken, 2)
        else null
    end as faceoff_percentage,
    wins + losses + ot as games_played,
    current_timestamp as loaded_at
from { { source('bronze', 'teams') } }
where season is not null
    and name is not null
  );

[0m11:52:46.674840 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m11:52:46.675046 [debug] [Thread-2  ]: DuckDB adapter: Rolling back transaction.
[0m11:52:46.675410 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

  
  create view "nhl"."silver"."stg_teams__dbt_tmp" as (
    { { config(materialized = 'view') } }
select season,
    name as team_name,
    wins,
    losses,
    ot as overtime_losses,
    points as team_points,
    pointPctg as points_percentage,
    goalsPerGame as goals_per_game,
    goalsAgainstPerGame as goals_against_per_game,
    powerPlayPercentage as power_play_percentage,
    powerPlayGoals as power_play_goals,
    powerPlayOpportunities as power_play_opportunities,
    penaltyKillPercentage as penalty_kill_percentage,
    shotsPerGame as shots_per_game,
    shotsAllowed as shots_allowed_per_game,
    winScoreFirst as wins_when_scoring_first,
    winOppScoreFirst as wins_when_opponent_scores_first,
    winLeadFirstPer as wins_leading_first_period,
    winLeadSecondPer as wins_leading_second_period,
    winOutshootOpp as wins_when_outshooting_opponent,
    winOutshotByOpp as wins_when_outshot_by_opponent,
    faceOffsTaken as faceoffs_taken,
    faceOffsWon as faceoffs_won,
    -- Calculate additional metrics
    case
        when faceOffsTaken > 0 then round(faceOffsWon * 100.0 / faceOffsTaken, 2)
        else null
    end as faceoff_percentage,
    wins + losses + ot as games_played,
    current_timestamp as loaded_at
from { { source('bronze', 'teams') } }
where season is not null
    and name is not null
  );

[0m11:52:46.675774 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: ROLLBACK
[0m11:52:46.675988 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m11:52:46.676183 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m11:52:46.676479 [debug] [Thread-1  ]: On model.nhl_analytics.stg_teams: ROLLBACK
[0m11:52:46.676716 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.my_second_dbt_model"
[0m11:52:46.676971 [debug] [Thread-3  ]: On model.nhl_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.my_second_dbt_model"} */

  
    
    

    create  table
      "nhl"."silver"."my_second_dbt_model__dbt_tmp"
  
    as (
      -- Use the `ref` function to select from other models

select *
from "nhl"."silver"."my_first_dbt_model"
where id = 1
    );
  
  
[0m11:52:46.680669 [debug] [Thread-2  ]: Failed to rollback 'model.nhl_analytics.stg_skaters'
[0m11:52:46.680901 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: Close
[0m11:52:46.681120 [debug] [Thread-3  ]: SQL status: OK in 0.004 seconds
[0m11:52:46.683888 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.my_second_dbt_model"
[0m11:52:46.686642 [debug] [Thread-1  ]: Failed to rollback 'model.nhl_analytics.stg_teams'
[0m11:52:46.686854 [debug] [Thread-3  ]: On model.nhl_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.my_second_dbt_model"} */
alter table "nhl"."silver"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m11:52:46.687107 [debug] [Thread-1  ]: On model.nhl_analytics.stg_teams: Close
[0m11:52:46.689860 [debug] [Thread-2  ]: Runtime Error in model stg_skaters (models/staging/stg_skaters.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m11:52:46.690244 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0edd01d-099b-4759-9096-9097e9331898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a948790>]}
[0m11:52:46.690457 [debug] [Thread-3  ]: SQL status: OK in 0.003 seconds
[0m11:52:46.691737 [debug] [Thread-3  ]: On model.nhl_analytics.my_second_dbt_model: COMMIT
[0m11:52:46.691958 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.my_second_dbt_model"
[0m11:52:46.692172 [debug] [Thread-3  ]: On model.nhl_analytics.my_second_dbt_model: COMMIT
[0m11:52:46.690868 [error] [Thread-2  ]: 9 of 11 ERROR creating sql view model silver.stg_skaters ....................... [[31mERROR[0m in 0.04s]
[0m11:52:46.692657 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.stg_skaters
[0m11:52:46.692956 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_skaters' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_skaters (models/staging/stg_skaters.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^.
[0m11:52:46.693208 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m11:52:46.694827 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.my_second_dbt_model"
[0m11:52:46.695061 [debug] [Thread-3  ]: On model.nhl_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.my_second_dbt_model"} */

      drop table if exists "nhl"."silver"."my_second_dbt_model__dbt_backup" cascade
    
[0m11:52:46.697988 [debug] [Thread-1  ]: Runtime Error in model stg_teams (models/staging/stg_teams.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m11:52:46.698271 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0edd01d-099b-4759-9096-9097e9331898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9a5760>]}
[0m11:52:46.698494 [debug] [Thread-3  ]: SQL status: OK in 0.003 seconds
[0m11:52:46.699540 [debug] [Thread-3  ]: On model.nhl_analytics.my_second_dbt_model: Close
[0m11:52:46.698860 [error] [Thread-1  ]: 10 of 11 ERROR creating sql view model silver.stg_teams ........................ [[31mERROR[0m in 0.04s]
[0m11:52:46.699918 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.stg_teams
[0m11:52:46.700200 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0edd01d-099b-4759-9096-9097e9331898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9acc70>]}
[0m11:52:46.700481 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_teams' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_teams (models/staging/stg_teams.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^.
[0m11:52:46.700857 [info ] [Thread-3  ]: 11 of 11 OK created sql table model silver.my_second_dbt_model ................. [[32mOK[0m in 0.04s]
[0m11:52:46.701171 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.my_second_dbt_model
[0m11:52:46.701760 [debug] [MainThread]: Using duckdb connection "master"
[0m11:52:46.701927 [debug] [MainThread]: On master: BEGIN
[0m11:52:46.702077 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:52:46.702373 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:52:46.702539 [debug] [MainThread]: On master: COMMIT
[0m11:52:46.702690 [debug] [MainThread]: Using duckdb connection "master"
[0m11:52:46.702836 [debug] [MainThread]: On master: COMMIT
[0m11:52:46.703061 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:52:46.703225 [debug] [MainThread]: On master: Close
[0m11:52:46.703453 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:52:46.703626 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_teams' was properly closed.
[0m11:52:46.703772 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_skaters' was properly closed.
[0m11:52:46.703908 [debug] [MainThread]: Connection 'model.nhl_analytics.my_second_dbt_model' was properly closed.
[0m11:52:46.704042 [debug] [MainThread]: Connection 'model.nhl_analytics.my_first_dbt_model' was properly closed.
[0m11:52:46.704246 [info ] [MainThread]: 
[0m11:52:46.704447 [info ] [MainThread]: Finished running 5 table models, 6 view models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m11:52:46.705492 [debug] [MainThread]: Command end result
[0m11:52:46.723030 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m11:52:46.724023 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m11:52:46.728040 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/run_results.json
[0m11:52:46.728246 [info ] [MainThread]: 
[0m11:52:46.728469 [info ] [MainThread]: [31mCompleted with 9 errors, 0 partial successes, and 0 warnings:[0m
[0m11:52:46.728659 [info ] [MainThread]: 
[0m11:52:46.728884 [error] [MainThread]: [31mFailure in model int_team_performance (models/intermediate/int_team_performance.sql)[0m
[0m11:52:46.729102 [error] [MainThread]:   Runtime Error in model int_team_performance (models/intermediate/int_team_performance.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } } with team_stats as (
              ^
[0m11:52:46.729277 [info ] [MainThread]: 
[0m11:52:46.729480 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/intermediate/int_team_performance.sql
[0m11:52:46.729655 [info ] [MainThread]: 
[0m11:52:46.729862 [error] [MainThread]: [31mFailure in model mart_player_performance (models/marts/mart_player_performance.sql)[0m
[0m11:52:46.730073 [error] [MainThread]:   Runtime Error in model mart_player_performance (models/marts/mart_player_performance.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 11:       { { config(materialized = 'table') } }
                 ^
[0m11:52:46.730242 [info ] [MainThread]: 
[0m11:52:46.730438 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/marts/mart_player_performance.sql
[0m11:52:46.730607 [info ] [MainThread]: 
[0m11:52:46.730812 [error] [MainThread]: [31mFailure in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)[0m
[0m11:52:46.731056 [error] [MainThread]:   Runtime Error in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 11:       { { config(materialized = 'table') } }
                 ^
[0m11:52:46.731334 [info ] [MainThread]: 
[0m11:52:46.731572 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/marts/mart_goalie_performance.sql
[0m11:52:46.731762 [info ] [MainThread]: 
[0m11:52:46.731981 [error] [MainThread]: [31mFailure in model int_all_players (models/intermediate/int_all_players.sql)[0m
[0m11:52:46.732198 [error] [MainThread]:   Runtime Error in model int_all_players (models/intermediate/int_all_players.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } } with all_players as (
              ^
[0m11:52:46.732375 [info ] [MainThread]: 
[0m11:52:46.732575 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/intermediate/int_all_players.sql
[0m11:52:46.732749 [info ] [MainThread]: 
[0m11:52:46.733008 [error] [MainThread]: [31mFailure in model mart_team_standings (models/marts/mart_team_standings.sql)[0m
[0m11:52:46.733245 [error] [MainThread]:   Runtime Error in model mart_team_standings (models/marts/mart_team_standings.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 11:       { { config(materialized = 'table') } }
                 ^
[0m11:52:46.733434 [info ] [MainThread]: 
[0m11:52:46.733643 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/marts/mart_team_standings.sql
[0m11:52:46.733820 [info ] [MainThread]: 
[0m11:52:46.734030 [error] [MainThread]: [31mFailure in model stg_lines (models/staging/stg_lines.sql)[0m
[0m11:52:46.734237 [error] [MainThread]:   Runtime Error in model stg_lines (models/staging/stg_lines.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m11:52:46.734407 [info ] [MainThread]: 
[0m11:52:46.734605 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_lines.sql
[0m11:52:46.734776 [info ] [MainThread]: 
[0m11:52:46.734980 [error] [MainThread]: [31mFailure in model stg_goalies (models/staging/stg_goalies.sql)[0m
[0m11:52:46.735186 [error] [MainThread]:   Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m11:52:46.735354 [info ] [MainThread]: 
[0m11:52:46.735549 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_goalies.sql
[0m11:52:46.735722 [info ] [MainThread]: 
[0m11:52:46.735926 [error] [MainThread]: [31mFailure in model stg_skaters (models/staging/stg_skaters.sql)[0m
[0m11:52:46.736130 [error] [MainThread]:   Runtime Error in model stg_skaters (models/staging/stg_skaters.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m11:52:46.736297 [info ] [MainThread]: 
[0m11:52:46.736491 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_skaters.sql
[0m11:52:46.736660 [info ] [MainThread]: 
[0m11:52:46.736860 [error] [MainThread]: [31mFailure in model stg_teams (models/staging/stg_teams.sql)[0m
[0m11:52:46.737060 [error] [MainThread]:   Runtime Error in model stg_teams (models/staging/stg_teams.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m11:52:46.737226 [info ] [MainThread]: 
[0m11:52:46.737419 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_teams.sql
[0m11:52:46.737591 [info ] [MainThread]: 
[0m11:52:46.737808 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=9 SKIP=0 NO-OP=0 TOTAL=11
[0m11:52:46.738944 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5974348, "process_in_blocks": "0", "process_kernel_time": 0.143344, "process_mem_max_rss": "150831104", "process_out_blocks": "0", "process_user_time": 2.199477}
[0m11:52:46.739212 [debug] [MainThread]: Command `dbt run` failed at 11:52:46.739160 after 1.60 seconds
[0m11:52:46.739449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109728a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2ac1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b55f10>]}
[0m11:52:46.739684 [debug] [MainThread]: Flushing usage events
[0m11:52:47.023044 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:53:59.755983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ae0ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b644c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b642e0>]}


============================== 11:53:59.758779 | 1afc9a99-6bf1-4def-9da2-fc57aeb28326 ==============================
[0m11:53:59.758779 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:53:59.759116 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'use_colors': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'version_check': 'True', 'empty': 'False', 'log_cache_events': 'False', 'profiles_dir': '.', 'write_json': 'True', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'quiet': 'False', 'target_path': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt run --profiles-dir=.', 'use_experimental_parser': 'False', 'static_parser': 'True', 'warn_error': 'None', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None'}
[0m11:53:59.923566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1afc9a99-6bf1-4def-9da2-fc57aeb28326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10841a400>]}
[0m11:53:59.958055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1afc9a99-6bf1-4def-9da2-fc57aeb28326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c78c10>]}
[0m11:53:59.959769 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:54:00.027438 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:54:00.120624 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m11:54:00.121412 [debug] [MainThread]: Partial parsing: updated file: nhl_analytics://models/marts/mart_goalie_performance.sql
[0m11:54:00.121657 [debug] [MainThread]: Partial parsing: updated file: nhl_analytics://models/marts/mart_player_performance.sql
[0m11:54:00.121878 [debug] [MainThread]: Partial parsing: updated file: nhl_analytics://models/marts/mart_team_standings.sql
[0m11:54:00.310161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1afc9a99-6bf1-4def-9da2-fc57aeb28326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d2ce80>]}
[0m11:54:00.370659 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m11:54:00.371891 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m11:54:00.382124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1afc9a99-6bf1-4def-9da2-fc57aeb28326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d52490>]}
[0m11:54:00.382428 [info ] [MainThread]: Found 11 models, 10 data tests, 4 sources, 444 macros
[0m11:54:00.382649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1afc9a99-6bf1-4def-9da2-fc57aeb28326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10916c2e0>]}
[0m11:54:00.383728 [info ] [MainThread]: 
[0m11:54:00.383945 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:54:00.384132 [info ] [MainThread]: 
[0m11:54:00.384406 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:54:00.387750 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl'
[0m11:54:00.419226 [debug] [ThreadPool]: Using duckdb connection "list_nhl"
[0m11:54:00.419475 [debug] [ThreadPool]: On list_nhl: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m11:54:00.419650 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:54:00.460216 [debug] [ThreadPool]: SQL status: OK in 0.041 seconds
[0m11:54:00.461006 [debug] [ThreadPool]: On list_nhl: Close
[0m11:54:00.461470 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nhl, now create_nhl_silver)
[0m11:54:00.461754 [debug] [ThreadPool]: Creating schema "database: "nhl"
schema: "silver"
"
[0m11:54:00.466018 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:54:00.466213 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nhl'
        and type='sqlite'
    
  
[0m11:54:00.466379 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:54:00.466959 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:54:00.467623 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:54:00.467791 [debug] [ThreadPool]: On create_nhl_silver: BEGIN
[0m11:54:00.468040 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:54:00.468208 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:54:00.468371 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
    
        create schema if not exists "nhl"."silver"
    
[0m11:54:00.468642 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:54:00.469082 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m11:54:00.469246 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:54:00.469396 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m11:54:00.469631 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:54:00.469801 [debug] [ThreadPool]: On create_nhl_silver: Close
[0m11:54:00.470753 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nhl_silver, now list_nhl_silver)
[0m11:54:00.474139 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m11:54:00.474317 [debug] [ThreadPool]: On list_nhl_silver: BEGIN
[0m11:54:00.474472 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:54:00.474737 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:54:00.474907 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m11:54:00.475077 [debug] [ThreadPool]: On list_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl_silver"} */
select
      'nhl' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'silver'
    and lower(table_catalog) = 'nhl'
  
[0m11:54:00.484364 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m11:54:00.485189 [debug] [ThreadPool]: On list_nhl_silver: ROLLBACK
[0m11:54:00.486352 [debug] [ThreadPool]: Failed to rollback 'list_nhl_silver'
[0m11:54:00.486517 [debug] [ThreadPool]: On list_nhl_silver: Close
[0m11:54:00.486970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1afc9a99-6bf1-4def-9da2-fc57aeb28326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083f79a0>]}
[0m11:54:00.487220 [debug] [MainThread]: Using duckdb connection "master"
[0m11:54:00.487383 [debug] [MainThread]: On master: BEGIN
[0m11:54:00.487533 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:54:00.487790 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:54:00.487960 [debug] [MainThread]: On master: COMMIT
[0m11:54:00.488126 [debug] [MainThread]: Using duckdb connection "master"
[0m11:54:00.488281 [debug] [MainThread]: On master: COMMIT
[0m11:54:00.488512 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:54:00.488680 [debug] [MainThread]: On master: Close
[0m11:54:00.490163 [debug] [Thread-1  ]: Began running node model.nhl_analytics.int_all_players
[0m11:54:00.490403 [debug] [Thread-2  ]: Began running node model.nhl_analytics.int_team_performance
[0m11:54:00.490623 [debug] [Thread-3  ]: Began running node model.nhl_analytics.mart_goalie_performance
[0m11:54:00.490828 [debug] [Thread-4  ]: Began running node model.nhl_analytics.mart_player_performance
[0m11:54:00.491108 [info ] [Thread-1  ]: 1 of 11 START sql view model silver.int_all_players ............................ [RUN]
[0m11:54:00.491411 [info ] [Thread-2  ]: 2 of 11 START sql view model silver.int_team_performance ....................... [RUN]
[0m11:54:00.491739 [info ] [Thread-3  ]: 3 of 11 START sql table model silver.mart_goalie_performance ................... [RUN]
[0m11:54:00.492047 [info ] [Thread-4  ]: 4 of 11 START sql table model silver.mart_player_performance ................... [RUN]
[0m11:54:00.492307 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_nhl_silver, now model.nhl_analytics.int_all_players)
[0m11:54:00.492587 [debug] [Thread-2  ]: Acquiring new duckdb connection 'model.nhl_analytics.int_team_performance'
[0m11:54:00.492842 [debug] [Thread-3  ]: Acquiring new duckdb connection 'model.nhl_analytics.mart_goalie_performance'
[0m11:54:00.493100 [debug] [Thread-4  ]: Acquiring new duckdb connection 'model.nhl_analytics.mart_player_performance'
[0m11:54:00.493306 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.int_all_players
[0m11:54:00.493505 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.int_team_performance
[0m11:54:00.493704 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.mart_goalie_performance
[0m11:54:00.493896 [debug] [Thread-4  ]: Began compiling node model.nhl_analytics.mart_player_performance
[0m11:54:00.498574 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.int_all_players"
[0m11:54:00.500497 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.int_team_performance"
[0m11:54:00.501747 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.mart_goalie_performance"
[0m11:54:00.503026 [debug] [Thread-4  ]: Writing injected SQL for node "model.nhl_analytics.mart_player_performance"
[0m11:54:00.503493 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.int_all_players
[0m11:54:00.503719 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.int_team_performance
[0m11:54:00.503937 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.mart_goalie_performance
[0m11:54:00.532227 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.int_team_performance"
[0m11:54:00.532490 [debug] [Thread-4  ]: Began executing node model.nhl_analytics.mart_player_performance
[0m11:54:00.539803 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.int_all_players"
[0m11:54:00.545354 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.mart_goalie_performance"
[0m11:54:00.547584 [debug] [Thread-4  ]: Writing runtime sql for node "model.nhl_analytics.mart_player_performance"
[0m11:54:00.548000 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.int_team_performance"
[0m11:54:00.548294 [debug] [Thread-2  ]: On model.nhl_analytics.int_team_performance: BEGIN
[0m11:54:00.548519 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:54:00.548880 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m11:54:00.549113 [debug] [Thread-3  ]: On model.nhl_analytics.mart_goalie_performance: BEGIN
[0m11:54:00.549334 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m11:54:00.549559 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:54:00.549779 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.int_team_performance"
[0m11:54:00.550015 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m11:54:00.550266 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m11:54:00.550567 [debug] [Thread-2  ]: On model.nhl_analytics.int_team_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_team_performance"} */

  
  create view "nhl"."silver"."int_team_performance__dbt_tmp" as (
    { { config(materialized = 'view') } } with team_stats as (
    select *,
        row_number() over (
            order by team_points desc,
                points_percentage desc
        ) as standings_rank
    from { { ref('stg_teams') } }
),
team_performance as (
    select *,
        case
            when standings_rank <= 8 then 'Playoff Position'
            when standings_rank <= 16 then 'Wild Card Contention'
            else 'Rebuilding'
        end as team_category,
        goals_per_game - goals_against_per_game as goal_differential_per_game
    from team_stats
)
select *
from team_performance
  );

[0m11:54:00.550805 [debug] [Thread-1  ]: On model.nhl_analytics.int_all_players: BEGIN
[0m11:54:00.551015 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m11:54:00.551206 [debug] [Thread-4  ]: On model.nhl_analytics.mart_player_performance: BEGIN
[0m11:54:00.553697 [debug] [Thread-2  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_team_performance"} */

  
  create view "nhl"."silver"."int_team_performance__dbt_tmp" as (
    { { config(materialized = 'view') } } with team_stats as (
    select *,
        row_number() over (
            order by team_points desc,
                points_percentage desc
        ) as standings_rank
    from { { ref('stg_teams') } }
),
team_performance as (
    select *,
        case
            when standings_rank <= 8 then 'Playoff Position'
            when standings_rank <= 16 then 'Wild Card Contention'
            else 'Rebuilding'
        end as team_category,
        goals_per_game - goals_against_per_game as goal_differential_per_game
    from team_stats
)
select *
from team_performance
  );

[0m11:54:00.553906 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:54:00.554117 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m11:54:00.554308 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:54:00.554515 [debug] [Thread-2  ]: DuckDB adapter: Rolling back transaction.
[0m11:54:00.554797 [debug] [Thread-3  ]: On model.nhl_analytics.mart_goalie_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */

  
    
    

    create  table
      "nhl"."silver"."mart_goalie_performance__dbt_tmp"
  
    as (
      { { config(materialized = 'table') } }
select
select player_id,
    player_name,
    team_code,
    games_played,
    save_percentage,
    goals_against_average,
    case
        when save_percentage >= 0.925 then 'Elite'
        when save_percentage >= 0.915 then 'Very Good'
        when save_percentage >= 0.905 then 'Good'
        when save_percentage >= 0.895 then 'Average'
        else 'Below Average'
    end as goalie_rating,
    case
        when goals_against_average <= 2.2 then 'Elite'
        when goals_against_average <= 2.5 then 'Very Good'
        when goals_against_average <= 2.8 then 'Good'
        when goals_against_average <= 3.2 then 'Average'
        else 'Below Average'
    end as gaa_rating,
    is_active,
    loaded_at
from { { ref('int_all_players') } }
where position_group = 'Goalie'
    and is_active = true
    and games_played >= 10
    );
  
  
[0m11:54:00.555074 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m11:54:00.555357 [debug] [Thread-2  ]: On model.nhl_analytics.int_team_performance: ROLLBACK
[0m11:54:00.555564 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m11:54:00.555916 [debug] [Thread-3  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */

  
    
    

    create  table
      "nhl"."silver"."mart_goalie_performance__dbt_tmp"
  
    as (
      { { config(materialized = 'table') } }
select
select player_id,
    player_name,
    team_code,
    games_played,
    save_percentage,
    goals_against_average,
    case
        when save_percentage >= 0.925 then 'Elite'
        when save_percentage >= 0.915 then 'Very Good'
        when save_percentage >= 0.905 then 'Good'
        when save_percentage >= 0.895 then 'Average'
        else 'Below Average'
    end as goalie_rating,
    case
        when goals_against_average <= 2.2 then 'Elite'
        when goals_against_average <= 2.5 then 'Very Good'
        when goals_against_average <= 2.8 then 'Good'
        when goals_against_average <= 3.2 then 'Average'
        else 'Below Average'
    end as gaa_rating,
    is_active,
    loaded_at
from { { ref('int_all_players') } }
where position_group = 'Goalie'
    and is_active = true
    and games_played >= 10
    );
  
  
[0m11:54:00.556149 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m11:54:00.556442 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m11:54:00.558250 [debug] [Thread-3  ]: DuckDB adapter: Rolling back transaction.
[0m11:54:00.558500 [debug] [Thread-1  ]: On model.nhl_analytics.int_all_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */

  
  create view "nhl"."silver"."int_all_players__dbt_tmp" as (
    { { config(materialized = 'view') } } with all_players as (
    select player_id,
        season,
        player_name,
        team_code,
        'G' as position,
        games_played,
        points_per_game,
        null as shooting_percentage,
        null as faceoff_percentage,
        save_percentage,
        goals_against_average,
        is_active_goalie as is_active,
        loaded_at
    from { { ref('stg_goalies') } }
    union all
    select player_id,
        season,
        player_name,
        team_code,
        position,
        games_played,
        points_per_game,
        shooting_percentage,
        faceoff_percentage,
        null as save_percentage,
        null as goals_against_average,
        is_active_player as is_active,
        loaded_at
    from { { ref('stg_skaters') } }
)
select *,
    case
        when position = 'G' then 'Goalie'
        when position in ('C', 'L', 'R', 'LW', 'RW') then 'Forward'
        when position in ('D') then 'Defense'
        else 'Unknown'
    end as position_group
from all_players
  );

[0m11:54:00.558784 [debug] [Thread-4  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */

  
    
    

    create  table
      "nhl"."silver"."mart_player_performance__dbt_tmp"
  
    as (
      { { config(materialized = 'table') } }
select
select player_id,
    player_name,
    team_code,
    position,
    position_group,
    games_played,
    points_per_game,
    shooting_percentage,
    faceoff_percentage,
    case
        when points_per_game >= 1.0 then 'Elite'
        when points_per_game >= 0.7 then 'Very Good'
        when points_per_game >= 0.5 then 'Good'
        when points_per_game >= 0.3 then 'Average'
        else 'Below Average'
    end as offensive_rating,
    case
        when shooting_percentage >= 15 then 'Elite Shooter'
        when shooting_percentage >= 12 then 'Good Shooter'
        when shooting_percentage >= 10 then 'Average Shooter'
        else 'Below Average Shooter'
    end as shooting_rating,
    is_active,
    loaded_at
from { { ref('int_all_players') } }
where position_group in ('Forward', 'Defense')
    and is_active = true
    and games_played >= 10
    );
  
  
[0m11:54:00.559131 [debug] [Thread-3  ]: On model.nhl_analytics.mart_goalie_performance: ROLLBACK
[0m11:54:00.560720 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */

  
  create view "nhl"."silver"."int_all_players__dbt_tmp" as (
    { { config(materialized = 'view') } } with all_players as (
    select player_id,
        season,
        player_name,
        team_code,
        'G' as position,
        games_played,
        points_per_game,
        null as shooting_percentage,
        null as faceoff_percentage,
        save_percentage,
        goals_against_average,
        is_active_goalie as is_active,
        loaded_at
    from { { ref('stg_goalies') } }
    union all
    select player_id,
        season,
        player_name,
        team_code,
        position,
        games_played,
        points_per_game,
        shooting_percentage,
        faceoff_percentage,
        null as save_percentage,
        null as goals_against_average,
        is_active_player as is_active,
        loaded_at
    from { { ref('stg_skaters') } }
)
select *,
    case
        when position = 'G' then 'Goalie'
        when position in ('C', 'L', 'R', 'LW', 'RW') then 'Forward'
        when position in ('D') then 'Defense'
        else 'Unknown'
    end as position_group
from all_players
  );

[0m11:54:00.561139 [debug] [Thread-4  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */

  
    
    

    create  table
      "nhl"."silver"."mart_player_performance__dbt_tmp"
  
    as (
      { { config(materialized = 'table') } }
select
select player_id,
    player_name,
    team_code,
    position,
    position_group,
    games_played,
    points_per_game,
    shooting_percentage,
    faceoff_percentage,
    case
        when points_per_game >= 1.0 then 'Elite'
        when points_per_game >= 0.7 then 'Very Good'
        when points_per_game >= 0.5 then 'Good'
        when points_per_game >= 0.3 then 'Average'
        else 'Below Average'
    end as offensive_rating,
    case
        when shooting_percentage >= 15 then 'Elite Shooter'
        when shooting_percentage >= 12 then 'Good Shooter'
        when shooting_percentage >= 10 then 'Average Shooter'
        else 'Below Average Shooter'
    end as shooting_rating,
    is_active,
    loaded_at
from { { ref('int_all_players') } }
where position_group in ('Forward', 'Defense')
    and is_active = true
    and games_played >= 10
    );
  
  
[0m11:54:00.561507 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m11:54:00.561775 [debug] [Thread-4  ]: DuckDB adapter: Rolling back transaction.
[0m11:54:00.564131 [debug] [Thread-1  ]: On model.nhl_analytics.int_all_players: ROLLBACK
[0m11:54:00.564489 [debug] [Thread-4  ]: On model.nhl_analytics.mart_player_performance: ROLLBACK
[0m11:54:00.597450 [debug] [Thread-1  ]: Failed to rollback 'model.nhl_analytics.int_all_players'
[0m11:54:00.597957 [debug] [Thread-2  ]: Failed to rollback 'model.nhl_analytics.int_team_performance'
[0m11:54:00.598182 [debug] [Thread-1  ]: On model.nhl_analytics.int_all_players: Close
[0m11:54:00.598614 [debug] [Thread-4  ]: Failed to rollback 'model.nhl_analytics.mart_player_performance'
[0m11:54:00.599045 [debug] [Thread-3  ]: Failed to rollback 'model.nhl_analytics.mart_goalie_performance'
[0m11:54:00.599250 [debug] [Thread-2  ]: On model.nhl_analytics.int_team_performance: Close
[0m11:54:00.599559 [debug] [Thread-4  ]: On model.nhl_analytics.mart_player_performance: Close
[0m11:54:00.599777 [debug] [Thread-3  ]: On model.nhl_analytics.mart_goalie_performance: Close
[0m11:54:00.602831 [debug] [Thread-1  ]: Runtime Error in model int_all_players (models/intermediate/int_all_players.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } } with all_players as (
              ^
[0m11:54:00.606348 [debug] [Thread-2  ]: Runtime Error in model int_team_performance (models/intermediate/int_team_performance.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } } with team_stats as (
              ^
[0m11:54:00.609026 [debug] [Thread-4  ]: Runtime Error in model mart_player_performance (models/marts/mart_player_performance.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 11:       { { config(materialized = 'table') } }
                 ^
[0m11:54:00.611845 [debug] [Thread-3  ]: Runtime Error in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 11:       { { config(materialized = 'table') } }
                 ^
[0m11:54:00.612070 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1afc9a99-6bf1-4def-9da2-fc57aeb28326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10978efa0>]}
[0m11:54:00.612311 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1afc9a99-6bf1-4def-9da2-fc57aeb28326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097f9a60>]}
[0m11:54:00.612492 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1afc9a99-6bf1-4def-9da2-fc57aeb28326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097a9c70>]}
[0m11:54:00.612672 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1afc9a99-6bf1-4def-9da2-fc57aeb28326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10756f250>]}
[0m11:54:00.613085 [error] [Thread-1  ]: 1 of 11 ERROR creating sql view model silver.int_all_players ................... [[31mERROR[0m in 0.11s]
[0m11:54:00.613361 [error] [Thread-3  ]: 3 of 11 ERROR creating sql table model silver.mart_goalie_performance .......... [[31mERROR[0m in 0.12s]
[0m11:54:00.613710 [error] [Thread-2  ]: 2 of 11 ERROR creating sql view model silver.int_team_performance .............. [[31mERROR[0m in 0.11s]
[0m11:54:00.614119 [error] [Thread-4  ]: 4 of 11 ERROR creating sql table model silver.mart_player_performance .......... [[31mERROR[0m in 0.12s]
[0m11:54:00.614444 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.int_all_players
[0m11:54:00.614733 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.mart_goalie_performance
[0m11:54:00.615021 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.int_team_performance
[0m11:54:00.615311 [debug] [Thread-4  ]: Finished running node model.nhl_analytics.mart_player_performance
[0m11:54:00.615532 [debug] [Thread-1  ]: Began running node model.nhl_analytics.mart_team_standings
[0m11:54:00.615792 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.int_all_players' to be skipped because of status 'error'.  Reason: Runtime Error in model int_all_players (models/intermediate/int_all_players.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } } with all_players as (
              ^.
[0m11:54:00.616005 [debug] [Thread-3  ]: Began running node model.nhl_analytics.my_first_dbt_model
[0m11:54:00.616223 [debug] [Thread-2  ]: Began running node model.nhl_analytics.stg_goalies
[0m11:54:00.616430 [debug] [Thread-4  ]: Began running node model.nhl_analytics.stg_lines
[0m11:54:00.616683 [info ] [Thread-1  ]: 5 of 11 START sql table model silver.mart_team_standings ....................... [RUN]
[0m11:54:00.616997 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.mart_goalie_performance' to be skipped because of status 'error'.  Reason: Runtime Error in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 11:       { { config(materialized = 'table') } }
                 ^.
[0m11:54:00.617274 [info ] [Thread-3  ]: 6 of 11 START sql table model silver.my_first_dbt_model ........................ [RUN]
[0m11:54:00.617559 [info ] [Thread-2  ]: 7 of 11 START sql view model silver.stg_goalies ................................ [RUN]
[0m11:54:00.617855 [info ] [Thread-4  ]: 8 of 11 START sql view model silver.stg_lines .................................. [RUN]
[0m11:54:00.618139 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.int_all_players, now model.nhl_analytics.mart_team_standings)
[0m11:54:00.618463 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.int_team_performance' to be skipped because of status 'error'.  Reason: Runtime Error in model int_team_performance (models/intermediate/int_team_performance.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } } with team_stats as (
              ^.
[0m11:54:00.618727 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.mart_goalie_performance, now model.nhl_analytics.my_first_dbt_model)
[0m11:54:00.618973 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.int_team_performance, now model.nhl_analytics.stg_goalies)
[0m11:54:00.619212 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.mart_player_performance, now model.nhl_analytics.stg_lines)
[0m11:54:00.619431 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.mart_team_standings
[0m11:54:00.619696 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.mart_player_performance' to be skipped because of status 'error'.  Reason: Runtime Error in model mart_player_performance (models/marts/mart_player_performance.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 11:       { { config(materialized = 'table') } }
                 ^.
[0m11:54:00.619895 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.my_first_dbt_model
[0m11:54:00.620087 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.stg_goalies
[0m11:54:00.620290 [debug] [Thread-4  ]: Began compiling node model.nhl_analytics.stg_lines
[0m11:54:00.621670 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.mart_team_standings"
[0m11:54:00.623422 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.my_first_dbt_model"
[0m11:54:00.624711 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.stg_goalies"
[0m11:54:00.625981 [debug] [Thread-4  ]: Writing injected SQL for node "model.nhl_analytics.stg_lines"
[0m11:54:00.626471 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.mart_team_standings
[0m11:54:00.626726 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.stg_goalies
[0m11:54:00.626943 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.my_first_dbt_model
[0m11:54:00.629256 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.mart_team_standings"
[0m11:54:00.632464 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.stg_goalies"
[0m11:54:00.632726 [debug] [Thread-4  ]: Began executing node model.nhl_analytics.stg_lines
[0m11:54:00.634832 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.my_first_dbt_model"
[0m11:54:00.637173 [debug] [Thread-4  ]: Writing runtime sql for node "model.nhl_analytics.stg_lines"
[0m11:54:00.637512 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m11:54:00.637814 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:54:00.638039 [debug] [Thread-1  ]: On model.nhl_analytics.mart_team_standings: BEGIN
[0m11:54:00.638287 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.my_first_dbt_model"
[0m11:54:00.638507 [debug] [Thread-2  ]: On model.nhl_analytics.stg_goalies: BEGIN
[0m11:54:00.638720 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:54:00.638943 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.stg_lines"
[0m11:54:00.639144 [debug] [Thread-3  ]: On model.nhl_analytics.my_first_dbt_model: BEGIN
[0m11:54:00.639350 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:54:00.639669 [debug] [Thread-4  ]: On model.nhl_analytics.stg_lines: BEGIN
[0m11:54:00.639880 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m11:54:00.640079 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m11:54:00.640327 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m11:54:00.640586 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m11:54:00.640799 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m11:54:00.641002 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m11:54:00.641233 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:54:00.641473 [debug] [Thread-1  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

  
    
    

    create  table
      "nhl"."silver"."mart_team_standings__dbt_tmp"
  
    as (
      { { config(materialized = 'table') } }
select
select season,
    team_name,
    team_points,
    wins,
    losses,
    overtime_losses,
    games_played,
    standings_rank,
    team_category,
    goals_per_game,
    goals_against_per_game,
    goal_differential_per_game,
    power_play_percentage,
    penalty_kill_percentage,
    shots_per_game,
    shots_allowed_per_game,
    faceoff_percentage,
    points_percentage,
    -- Performance indicators
    case
        when wins_when_scoring_first > 0
        and games_played > 0 then round(
            wins_when_scoring_first * 100.0 / games_played,
            1
        )
        else null
    end as win_pct_when_scoring_first,
    case
        when wins_when_outshooting_opponent > 0
        and games_played > 0 then round(
            wins_when_outshooting_opponent * 100.0 / games_played,
            1
        )
        else null
    end as win_pct_when_outshooting,
    loaded_at
from { { ref('int_team_performance') } }
order by standings_rank
    );
  
  
[0m11:54:00.641702 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m11:54:00.641889 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.my_first_dbt_model"
[0m11:54:00.642118 [debug] [Thread-2  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    games_played,
    games_started,
    wins,
    losses,
    ties,
    otLosses as ot_losses,
    shotsAgainst as shots_against,
    saves,
    goals_against,
    savePercentage as save_percentage,
    goalsAgainstAverage as goals_against_average,
    timeOnIce as time_on_ice,
    timeOnIcePerGame as time_on_ice_per_game,
    shutouts,
    lowDangerGoals as low_danger_goals,
    mediumDangerGoals as medium_danger_goals,
    highDangerGoals as high_danger_goals,
    blocked_shot_attempts,
    penalityMinutes as penalty_minutes,
    penalties,
    -- Add data quality flags
    case
        when games_played > 0
        and saves > 0 then true
        else false
    end as is_active_goalie,
    -- Calculate additional metrics
    case
        when shotsAgainst > 0 then round(saves * 100.0 / shotsAgainst, 2)
        else null
    end as calculated_save_percentage,
    current_timestamp as loaded_at
from { { source('bronze', 'goalies') } }
where playerId is not null
    and season is not null
  );

[0m11:54:00.642539 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

  
    
    

    create  table
      "nhl"."silver"."mart_team_standings__dbt_tmp"
  
    as (
      { { config(materialized = 'table') } }
select
select season,
    team_name,
    team_points,
    wins,
    losses,
    overtime_losses,
    games_played,
    standings_rank,
    team_category,
    goals_per_game,
    goals_against_per_game,
    goal_differential_per_game,
    power_play_percentage,
    penalty_kill_percentage,
    shots_per_game,
    shots_allowed_per_game,
    faceoff_percentage,
    points_percentage,
    -- Performance indicators
    case
        when wins_when_scoring_first > 0
        and games_played > 0 then round(
            wins_when_scoring_first * 100.0 / games_played,
            1
        )
        else null
    end as win_pct_when_scoring_first,
    case
        when wins_when_outshooting_opponent > 0
        and games_played > 0 then round(
            wins_when_outshooting_opponent * 100.0 / games_played,
            1
        )
        else null
    end as win_pct_when_outshooting,
    loaded_at
from { { ref('int_team_performance') } }
order by standings_rank
    );
  
  
[0m11:54:00.642764 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.stg_lines"
[0m11:54:00.642977 [debug] [Thread-3  ]: On model.nhl_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.my_first_dbt_model"} */

  
    
    

    create  table
      "nhl"."silver"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m11:54:00.643340 [debug] [Thread-2  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    games_played,
    games_started,
    wins,
    losses,
    ties,
    otLosses as ot_losses,
    shotsAgainst as shots_against,
    saves,
    goals_against,
    savePercentage as save_percentage,
    goalsAgainstAverage as goals_against_average,
    timeOnIce as time_on_ice,
    timeOnIcePerGame as time_on_ice_per_game,
    shutouts,
    lowDangerGoals as low_danger_goals,
    mediumDangerGoals as medium_danger_goals,
    highDangerGoals as high_danger_goals,
    blocked_shot_attempts,
    penalityMinutes as penalty_minutes,
    penalties,
    -- Add data quality flags
    case
        when games_played > 0
        and saves > 0 then true
        else false
    end as is_active_goalie,
    -- Calculate additional metrics
    case
        when shotsAgainst > 0 then round(saves * 100.0 / shotsAgainst, 2)
        else null
    end as calculated_save_percentage,
    current_timestamp as loaded_at
from { { source('bronze', 'goalies') } }
where playerId is not null
    and season is not null
  );

[0m11:54:00.643572 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m11:54:00.643812 [debug] [Thread-4  ]: On model.nhl_analytics.stg_lines: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_lines"} */

  
  create view "nhl"."silver"."stg_lines__dbt_tmp" as (
    { { config(materialized = 'view') } }
select season,
    team,
    l1 as line_player_1,
    l2 as line_player_2,
    l3 as line_player_3,
    games_played,
    icetime as ice_time,
    icetimeRank as ice_time_rank,
    -- Offensive stats
    goals,
    assists,
    points,
    shots,
    shotsFor as shots_for,
    shotsAgainst as shots_against,
    -- Advanced stats
    corsiFor as corsi_for,
    corsiAgainst as corsi_against,
    corsiForPct as corsi_for_percentage,
    fenwickFor as fenwick_for,
    fenwickAgainst as fenwick_against,
    fenwickForPct as fenwick_for_percentage,
    -- Goals for/against
    goalsFor as goals_for,
    goalsAgainst as goals_against,
    goalDifferential as goal_differential,
    -- Add line identification
    concat(team, '_', l1, '_', l2, '_', l3) as line_id,
    -- Calculate additional metrics
    case
        when icetime > 0 then round(points * 60.0 / icetime, 2)
        else null
    end as points_per_60,
    case
        when shots > 0 then round(goals * 100.0 / shots, 2)
        else null
    end as shooting_percentage,
    current_timestamp as loaded_at
from { { source('bronze', 'lines') } }
where season is not null
    and team is not null
    and l1 is not null
    and l2 is not null
    and l3 is not null
  );

[0m11:54:00.644139 [debug] [Thread-2  ]: DuckDB adapter: Rolling back transaction.
[0m11:54:00.644417 [debug] [Thread-1  ]: On model.nhl_analytics.mart_team_standings: ROLLBACK
[0m11:54:00.644863 [debug] [Thread-4  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_lines"} */

  
  create view "nhl"."silver"."stg_lines__dbt_tmp" as (
    { { config(materialized = 'view') } }
select season,
    team,
    l1 as line_player_1,
    l2 as line_player_2,
    l3 as line_player_3,
    games_played,
    icetime as ice_time,
    icetimeRank as ice_time_rank,
    -- Offensive stats
    goals,
    assists,
    points,
    shots,
    shotsFor as shots_for,
    shotsAgainst as shots_against,
    -- Advanced stats
    corsiFor as corsi_for,
    corsiAgainst as corsi_against,
    corsiForPct as corsi_for_percentage,
    fenwickFor as fenwick_for,
    fenwickAgainst as fenwick_against,
    fenwickForPct as fenwick_for_percentage,
    -- Goals for/against
    goalsFor as goals_for,
    goalsAgainst as goals_against,
    goalDifferential as goal_differential,
    -- Add line identification
    concat(team, '_', l1, '_', l2, '_', l3) as line_id,
    -- Calculate additional metrics
    case
        when icetime > 0 then round(points * 60.0 / icetime, 2)
        else null
    end as points_per_60,
    case
        when shots > 0 then round(goals * 100.0 / shots, 2)
        else null
    end as shooting_percentage,
    current_timestamp as loaded_at
from { { source('bronze', 'lines') } }
where season is not null
    and team is not null
    and l1 is not null
    and l2 is not null
    and l3 is not null
  );

[0m11:54:00.645210 [debug] [Thread-2  ]: On model.nhl_analytics.stg_goalies: ROLLBACK
[0m11:54:00.645516 [debug] [Thread-4  ]: DuckDB adapter: Rolling back transaction.
[0m11:54:00.645905 [debug] [Thread-4  ]: On model.nhl_analytics.stg_lines: ROLLBACK
[0m11:54:00.649236 [debug] [Thread-1  ]: Failed to rollback 'model.nhl_analytics.mart_team_standings'
[0m11:54:00.649459 [debug] [Thread-1  ]: On model.nhl_analytics.mart_team_standings: Close
[0m11:54:00.649841 [debug] [Thread-3  ]: SQL status: OK in 0.006 seconds
[0m11:54:00.653142 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.my_first_dbt_model"
[0m11:54:00.655842 [debug] [Thread-2  ]: Failed to rollback 'model.nhl_analytics.stg_goalies'
[0m11:54:00.656067 [debug] [Thread-3  ]: On model.nhl_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.my_first_dbt_model"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'silver'
      AND table_name = 'my_first_dbt_model'
  
[0m11:54:00.656312 [debug] [Thread-2  ]: On model.nhl_analytics.stg_goalies: Close
[0m11:54:00.659169 [debug] [Thread-4  ]: Failed to rollback 'model.nhl_analytics.stg_lines'
[0m11:54:00.659396 [debug] [Thread-4  ]: On model.nhl_analytics.stg_lines: Close
[0m11:54:00.659609 [debug] [Thread-3  ]: SQL status: OK in 0.003 seconds
[0m11:54:00.662377 [debug] [Thread-1  ]: Runtime Error in model mart_team_standings (models/marts/mart_team_standings.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 11:       { { config(materialized = 'table') } }
                 ^
[0m11:54:00.662890 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1afc9a99-6bf1-4def-9da2-fc57aeb28326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096b4d90>]}
[0m11:54:00.663936 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.my_first_dbt_model"
[0m11:54:00.663268 [error] [Thread-1  ]: 5 of 11 ERROR creating sql table model silver.mart_team_standings .............. [[31mERROR[0m in 0.04s]
[0m11:54:00.664260 [debug] [Thread-3  ]: On model.nhl_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.my_first_dbt_model"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'silver'
      AND table_name = 'my_first_dbt_model'
  
[0m11:54:00.664569 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.mart_team_standings
[0m11:54:00.667315 [debug] [Thread-2  ]: Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m11:54:00.667568 [debug] [Thread-1  ]: Began running node model.nhl_analytics.stg_skaters
[0m11:54:00.667783 [debug] [Thread-3  ]: SQL status: OK in 0.003 seconds
[0m11:54:00.668046 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.mart_team_standings' to be skipped because of status 'error'.  Reason: Runtime Error in model mart_team_standings (models/marts/mart_team_standings.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 11:       { { config(materialized = 'table') } }
                 ^.
[0m11:54:00.668313 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1afc9a99-6bf1-4def-9da2-fc57aeb28326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097a9c70>]}
[0m11:54:00.671295 [debug] [Thread-4  ]: Runtime Error in model stg_lines (models/staging/stg_lines.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m11:54:00.668607 [info ] [Thread-1  ]: 9 of 11 START sql view model silver.stg_skaters ................................ [RUN]
[0m11:54:00.675364 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.my_first_dbt_model"
[0m11:54:00.675734 [error] [Thread-2  ]: 7 of 11 ERROR creating sql view model silver.stg_goalies ....................... [[31mERROR[0m in 0.05s]
[0m11:54:00.676025 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1afc9a99-6bf1-4def-9da2-fc57aeb28326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10969b250>]}
[0m11:54:00.676276 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.mart_team_standings, now model.nhl_analytics.stg_skaters)
[0m11:54:00.676496 [debug] [Thread-3  ]: On model.nhl_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.my_first_dbt_model"} */
alter table "nhl"."silver"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m11:54:00.676778 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.stg_goalies
[0m11:54:00.677102 [error] [Thread-4  ]: 8 of 11 ERROR creating sql view model silver.stg_lines ......................... [[31mERROR[0m in 0.06s]
[0m11:54:00.677343 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.stg_skaters
[0m11:54:00.677644 [debug] [Thread-2  ]: Began running node model.nhl_analytics.stg_teams
[0m11:54:00.678003 [debug] [Thread-4  ]: Finished running node model.nhl_analytics.stg_lines
[0m11:54:00.678204 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m11:54:00.678454 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_goalies' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^.
[0m11:54:00.679990 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.stg_skaters"
[0m11:54:00.680278 [info ] [Thread-2  ]: 10 of 11 START sql view model silver.stg_teams ................................. [RUN]
[0m11:54:00.682275 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.my_first_dbt_model"
[0m11:54:00.682570 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_lines' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_lines (models/staging/stg_lines.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^.
[0m11:54:00.682863 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.stg_goalies, now model.nhl_analytics.stg_teams)
[0m11:54:00.683112 [debug] [Thread-3  ]: On model.nhl_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.my_first_dbt_model"} */
alter table "nhl"."silver"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m11:54:00.683374 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.stg_skaters
[0m11:54:00.683586 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.stg_teams
[0m11:54:00.686504 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.stg_skaters"
[0m11:54:00.687837 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.stg_teams"
[0m11:54:00.688056 [debug] [Thread-3  ]: SQL status: OK in 0.004 seconds
[0m11:54:00.697525 [debug] [Thread-3  ]: On model.nhl_analytics.my_first_dbt_model: COMMIT
[0m11:54:00.697775 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.my_first_dbt_model"
[0m11:54:00.697983 [debug] [Thread-3  ]: On model.nhl_analytics.my_first_dbt_model: COMMIT
[0m11:54:00.698361 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m11:54:00.698609 [debug] [Thread-1  ]: On model.nhl_analytics.stg_skaters: BEGIN
[0m11:54:00.698863 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.stg_teams
[0m11:54:00.699108 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:54:00.699313 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m11:54:00.701567 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.stg_teams"
[0m11:54:00.705049 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.my_first_dbt_model"
[0m11:54:00.705340 [debug] [Thread-3  ]: On model.nhl_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.my_first_dbt_model"} */

      drop table if exists "nhl"."silver"."my_first_dbt_model__dbt_backup" cascade
    
[0m11:54:00.705553 [debug] [Thread-1  ]: SQL status: OK in 0.006 seconds
[0m11:54:00.705859 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m11:54:00.706080 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m11:54:00.706333 [debug] [Thread-1  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    games_played,
    time_on_ice,
    assists,
    goals,
    shots,
    points,
    plusMinus as plus_minus,
    penalityMinutes as penalty_minutes,
    faceOffWins as faceoff_wins,
    faceoffTaken as faceoff_taken,
    takeaways,
    giveaways,
    shortHandedGoals as short_handed_goals,
    shortHandedAssists as short_handed_assists,
    shortHandedPoints as short_handed_points,
    powerPlayGoals as power_play_goals,
    powerPlayAssists as power_play_assists,
    powerPlayPoints as power_play_points,
    gameWinningGoals as game_winning_goals,
    overtimeGoals as overtime_goals,
    shootoutGoals as shootout_goals,
    shootoutAttempts as shootout_attempts,
    hits,
    blocked,
    shifts,
    -- Add data quality flags
    case
        when games_played > 0 then true
        else false
    end as is_active_player,
    -- Calculate additional metrics
    case
        when games_played > 0 then round(points * 1.0 / games_played, 2)
        else null
    end as points_per_game,
    case
        when faceoffTaken > 0 then round(faceOffWins * 100.0 / faceoffTaken, 2)
        else null
    end as faceoff_percentage,
    case
        when shots > 0 then round(goals * 100.0 / shots, 2)
        else null
    end as shooting_percentage,
    current_timestamp as loaded_at
from { { source('bronze', 'skaters') } }
where playerId is not null
    and season is not null
  );

[0m11:54:00.706581 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m11:54:00.706767 [debug] [Thread-2  ]: On model.nhl_analytics.stg_teams: BEGIN
[0m11:54:00.707157 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    games_played,
    time_on_ice,
    assists,
    goals,
    shots,
    points,
    plusMinus as plus_minus,
    penalityMinutes as penalty_minutes,
    faceOffWins as faceoff_wins,
    faceoffTaken as faceoff_taken,
    takeaways,
    giveaways,
    shortHandedGoals as short_handed_goals,
    shortHandedAssists as short_handed_assists,
    shortHandedPoints as short_handed_points,
    powerPlayGoals as power_play_goals,
    powerPlayAssists as power_play_assists,
    powerPlayPoints as power_play_points,
    gameWinningGoals as game_winning_goals,
    overtimeGoals as overtime_goals,
    shootoutGoals as shootout_goals,
    shootoutAttempts as shootout_attempts,
    hits,
    blocked,
    shifts,
    -- Add data quality flags
    case
        when games_played > 0 then true
        else false
    end as is_active_player,
    -- Calculate additional metrics
    case
        when games_played > 0 then round(points * 1.0 / games_played, 2)
        else null
    end as points_per_game,
    case
        when faceoffTaken > 0 then round(faceOffWins * 100.0 / faceoffTaken, 2)
        else null
    end as faceoff_percentage,
    case
        when shots > 0 then round(goals * 100.0 / shots, 2)
        else null
    end as shooting_percentage,
    current_timestamp as loaded_at
from { { source('bronze', 'skaters') } }
where playerId is not null
    and season is not null
  );

[0m11:54:00.708594 [debug] [Thread-3  ]: On model.nhl_analytics.my_first_dbt_model: Close
[0m11:54:00.708805 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:54:00.709016 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m11:54:00.709346 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1afc9a99-6bf1-4def-9da2-fc57aeb28326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106454670>]}
[0m11:54:00.709677 [debug] [Thread-1  ]: On model.nhl_analytics.stg_skaters: ROLLBACK
[0m11:54:00.709963 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m11:54:00.710261 [info ] [Thread-3  ]: 6 of 11 OK created sql table model silver.my_first_dbt_model ................... [[32mOK[0m in 0.09s]
[0m11:54:00.710533 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m11:54:00.710836 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.my_first_dbt_model
[0m11:54:00.711100 [debug] [Thread-2  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

  
  create view "nhl"."silver"."stg_teams__dbt_tmp" as (
    { { config(materialized = 'view') } }
select season,
    name as team_name,
    wins,
    losses,
    ot as overtime_losses,
    points as team_points,
    pointPctg as points_percentage,
    goalsPerGame as goals_per_game,
    goalsAgainstPerGame as goals_against_per_game,
    powerPlayPercentage as power_play_percentage,
    powerPlayGoals as power_play_goals,
    powerPlayOpportunities as power_play_opportunities,
    penaltyKillPercentage as penalty_kill_percentage,
    shotsPerGame as shots_per_game,
    shotsAllowed as shots_allowed_per_game,
    winScoreFirst as wins_when_scoring_first,
    winOppScoreFirst as wins_when_opponent_scores_first,
    winLeadFirstPer as wins_leading_first_period,
    winLeadSecondPer as wins_leading_second_period,
    winOutshootOpp as wins_when_outshooting_opponent,
    winOutshotByOpp as wins_when_outshot_by_opponent,
    faceOffsTaken as faceoffs_taken,
    faceOffsWon as faceoffs_won,
    -- Calculate additional metrics
    case
        when faceOffsTaken > 0 then round(faceOffsWon * 100.0 / faceOffsTaken, 2)
        else null
    end as faceoff_percentage,
    wins + losses + ot as games_played,
    current_timestamp as loaded_at
from { { source('bronze', 'teams') } }
where season is not null
    and name is not null
  );

[0m11:54:00.711736 [debug] [Thread-2  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

  
  create view "nhl"."silver"."stg_teams__dbt_tmp" as (
    { { config(materialized = 'view') } }
select season,
    name as team_name,
    wins,
    losses,
    ot as overtime_losses,
    points as team_points,
    pointPctg as points_percentage,
    goalsPerGame as goals_per_game,
    goalsAgainstPerGame as goals_against_per_game,
    powerPlayPercentage as power_play_percentage,
    powerPlayGoals as power_play_goals,
    powerPlayOpportunities as power_play_opportunities,
    penaltyKillPercentage as penalty_kill_percentage,
    shotsPerGame as shots_per_game,
    shotsAllowed as shots_allowed_per_game,
    winScoreFirst as wins_when_scoring_first,
    winOppScoreFirst as wins_when_opponent_scores_first,
    winLeadFirstPer as wins_leading_first_period,
    winLeadSecondPer as wins_leading_second_period,
    winOutshootOpp as wins_when_outshooting_opponent,
    winOutshotByOpp as wins_when_outshot_by_opponent,
    faceOffsTaken as faceoffs_taken,
    faceOffsWon as faceoffs_won,
    -- Calculate additional metrics
    case
        when faceOffsTaken > 0 then round(faceOffsWon * 100.0 / faceOffsTaken, 2)
        else null
    end as faceoff_percentage,
    wins + losses + ot as games_played,
    current_timestamp as loaded_at
from { { source('bronze', 'teams') } }
where season is not null
    and name is not null
  );

[0m11:54:00.712009 [debug] [Thread-4  ]: Began running node model.nhl_analytics.my_second_dbt_model
[0m11:54:00.712242 [debug] [Thread-2  ]: DuckDB adapter: Rolling back transaction.
[0m11:54:00.712538 [info ] [Thread-4  ]: 11 of 11 START sql table model silver.my_second_dbt_model ...................... [RUN]
[0m11:54:00.712838 [debug] [Thread-2  ]: On model.nhl_analytics.stg_teams: ROLLBACK
[0m11:54:00.713098 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.stg_lines, now model.nhl_analytics.my_second_dbt_model)
[0m11:54:00.716237 [debug] [Thread-1  ]: Failed to rollback 'model.nhl_analytics.stg_skaters'
[0m11:54:00.716491 [debug] [Thread-4  ]: Began compiling node model.nhl_analytics.my_second_dbt_model
[0m11:54:00.716727 [debug] [Thread-1  ]: On model.nhl_analytics.stg_skaters: Close
[0m11:54:00.718664 [debug] [Thread-4  ]: Writing injected SQL for node "model.nhl_analytics.my_second_dbt_model"
[0m11:54:00.721557 [debug] [Thread-2  ]: Failed to rollback 'model.nhl_analytics.stg_teams'
[0m11:54:00.721779 [debug] [Thread-2  ]: On model.nhl_analytics.stg_teams: Close
[0m11:54:00.724703 [debug] [Thread-1  ]: Runtime Error in model stg_skaters (models/staging/stg_skaters.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m11:54:00.724938 [debug] [Thread-4  ]: Began executing node model.nhl_analytics.my_second_dbt_model
[0m11:54:00.725193 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1afc9a99-6bf1-4def-9da2-fc57aeb28326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109221f40>]}
[0m11:54:00.727794 [debug] [Thread-2  ]: Runtime Error in model stg_teams (models/staging/stg_teams.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m11:54:00.730249 [debug] [Thread-4  ]: Writing runtime sql for node "model.nhl_analytics.my_second_dbt_model"
[0m11:54:00.730605 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1afc9a99-6bf1-4def-9da2-fc57aeb28326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097ad970>]}
[0m11:54:00.730911 [error] [Thread-1  ]: 9 of 11 ERROR creating sql view model silver.stg_skaters ....................... [[31mERROR[0m in 0.05s]
[0m11:54:00.731615 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.stg_skaters
[0m11:54:00.731336 [error] [Thread-2  ]: 10 of 11 ERROR creating sql view model silver.stg_teams ........................ [[31mERROR[0m in 0.05s]
[0m11:54:00.732035 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.stg_teams
[0m11:54:00.732280 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.my_second_dbt_model"
[0m11:54:00.732535 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_skaters' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_skaters (models/staging/stg_skaters.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^.
[0m11:54:00.732770 [debug] [Thread-4  ]: On model.nhl_analytics.my_second_dbt_model: BEGIN
[0m11:54:00.733055 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_teams' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_teams (models/staging/stg_teams.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^.
[0m11:54:00.733259 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m11:54:00.733648 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m11:54:00.733845 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.my_second_dbt_model"
[0m11:54:00.734033 [debug] [Thread-4  ]: On model.nhl_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.my_second_dbt_model"} */

  
    
    

    create  table
      "nhl"."silver"."my_second_dbt_model__dbt_tmp"
  
    as (
      -- Use the `ref` function to select from other models

select *
from "nhl"."silver"."my_first_dbt_model"
where id = 1
    );
  
  
[0m11:54:00.734729 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m11:54:00.735303 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.my_second_dbt_model"
[0m11:54:00.735500 [debug] [Thread-4  ]: On model.nhl_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.my_second_dbt_model"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'silver'
      AND table_name = 'my_second_dbt_model'
  
[0m11:54:00.735975 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m11:54:00.736627 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.my_second_dbt_model"
[0m11:54:00.736881 [debug] [Thread-4  ]: On model.nhl_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.my_second_dbt_model"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'silver'
      AND table_name = 'my_second_dbt_model'
  
[0m11:54:00.737419 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m11:54:00.740192 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.my_second_dbt_model"
[0m11:54:00.740404 [debug] [Thread-4  ]: On model.nhl_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.my_second_dbt_model"} */
alter table "nhl"."silver"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m11:54:00.740742 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m11:54:00.742548 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.my_second_dbt_model"
[0m11:54:00.742764 [debug] [Thread-4  ]: On model.nhl_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.my_second_dbt_model"} */
alter table "nhl"."silver"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m11:54:00.743111 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m11:54:00.744110 [debug] [Thread-4  ]: On model.nhl_analytics.my_second_dbt_model: COMMIT
[0m11:54:00.744307 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.my_second_dbt_model"
[0m11:54:00.744501 [debug] [Thread-4  ]: On model.nhl_analytics.my_second_dbt_model: COMMIT
[0m11:54:00.744931 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m11:54:00.746736 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.my_second_dbt_model"
[0m11:54:00.746940 [debug] [Thread-4  ]: On model.nhl_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.my_second_dbt_model"} */

      drop table if exists "nhl"."silver"."my_second_dbt_model__dbt_backup" cascade
    
[0m11:54:00.747355 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m11:54:00.748047 [debug] [Thread-4  ]: On model.nhl_analytics.my_second_dbt_model: Close
[0m11:54:00.748353 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1afc9a99-6bf1-4def-9da2-fc57aeb28326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099167f0>]}
[0m11:54:00.748685 [info ] [Thread-4  ]: 11 of 11 OK created sql table model silver.my_second_dbt_model ................. [[32mOK[0m in 0.04s]
[0m11:54:00.748998 [debug] [Thread-4  ]: Finished running node model.nhl_analytics.my_second_dbt_model
[0m11:54:00.749599 [debug] [MainThread]: Using duckdb connection "master"
[0m11:54:00.749770 [debug] [MainThread]: On master: BEGIN
[0m11:54:00.749919 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:54:00.750186 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:54:00.750352 [debug] [MainThread]: On master: COMMIT
[0m11:54:00.750507 [debug] [MainThread]: Using duckdb connection "master"
[0m11:54:00.750653 [debug] [MainThread]: On master: COMMIT
[0m11:54:00.750881 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:54:00.751048 [debug] [MainThread]: On master: Close
[0m11:54:00.751245 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:54:00.751391 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_skaters' was properly closed.
[0m11:54:00.751529 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_teams' was properly closed.
[0m11:54:00.751666 [debug] [MainThread]: Connection 'model.nhl_analytics.my_first_dbt_model' was properly closed.
[0m11:54:00.751802 [debug] [MainThread]: Connection 'model.nhl_analytics.my_second_dbt_model' was properly closed.
[0m11:54:00.752012 [info ] [MainThread]: 
[0m11:54:00.752199 [info ] [MainThread]: Finished running 5 table models, 6 view models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m11:54:00.753211 [debug] [MainThread]: Command end result
[0m11:54:00.769196 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m11:54:00.770112 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m11:54:00.774348 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/run_results.json
[0m11:54:00.774540 [info ] [MainThread]: 
[0m11:54:00.774767 [info ] [MainThread]: [31mCompleted with 9 errors, 0 partial successes, and 0 warnings:[0m
[0m11:54:00.774952 [info ] [MainThread]: 
[0m11:54:00.775168 [error] [MainThread]: [31mFailure in model int_all_players (models/intermediate/int_all_players.sql)[0m
[0m11:54:00.775383 [error] [MainThread]:   Runtime Error in model int_all_players (models/intermediate/int_all_players.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } } with all_players as (
              ^
[0m11:54:00.775556 [info ] [MainThread]: 
[0m11:54:00.775755 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/intermediate/int_all_players.sql
[0m11:54:00.775929 [info ] [MainThread]: 
[0m11:54:00.776133 [error] [MainThread]: [31mFailure in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)[0m
[0m11:54:00.776343 [error] [MainThread]:   Runtime Error in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 11:       { { config(materialized = 'table') } }
                 ^
[0m11:54:00.776510 [info ] [MainThread]: 
[0m11:54:00.776705 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/marts/mart_goalie_performance.sql
[0m11:54:00.776874 [info ] [MainThread]: 
[0m11:54:00.777077 [error] [MainThread]: [31mFailure in model int_team_performance (models/intermediate/int_team_performance.sql)[0m
[0m11:54:00.777283 [error] [MainThread]:   Runtime Error in model int_team_performance (models/intermediate/int_team_performance.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } } with team_stats as (
              ^
[0m11:54:00.777451 [info ] [MainThread]: 
[0m11:54:00.777646 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/intermediate/int_team_performance.sql
[0m11:54:00.777816 [info ] [MainThread]: 
[0m11:54:00.778119 [error] [MainThread]: [31mFailure in model mart_player_performance (models/marts/mart_player_performance.sql)[0m
[0m11:54:00.778352 [error] [MainThread]:   Runtime Error in model mart_player_performance (models/marts/mart_player_performance.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 11:       { { config(materialized = 'table') } }
                 ^
[0m11:54:00.778536 [info ] [MainThread]: 
[0m11:54:00.778747 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/marts/mart_player_performance.sql
[0m11:54:00.778928 [info ] [MainThread]: 
[0m11:54:00.779220 [error] [MainThread]: [31mFailure in model mart_team_standings (models/marts/mart_team_standings.sql)[0m
[0m11:54:00.779441 [error] [MainThread]:   Runtime Error in model mart_team_standings (models/marts/mart_team_standings.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 11:       { { config(materialized = 'table') } }
                 ^
[0m11:54:00.779620 [info ] [MainThread]: 
[0m11:54:00.779823 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/marts/mart_team_standings.sql
[0m11:54:00.780000 [info ] [MainThread]: 
[0m11:54:00.780210 [error] [MainThread]: [31mFailure in model stg_goalies (models/staging/stg_goalies.sql)[0m
[0m11:54:00.780964 [error] [MainThread]:   Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m11:54:00.781167 [info ] [MainThread]: 
[0m11:54:00.781368 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_goalies.sql
[0m11:54:00.781545 [info ] [MainThread]: 
[0m11:54:00.781752 [error] [MainThread]: [31mFailure in model stg_lines (models/staging/stg_lines.sql)[0m
[0m11:54:00.781959 [error] [MainThread]:   Runtime Error in model stg_lines (models/staging/stg_lines.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m11:54:00.782128 [info ] [MainThread]: 
[0m11:54:00.782322 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_lines.sql
[0m11:54:00.782493 [info ] [MainThread]: 
[0m11:54:00.782695 [error] [MainThread]: [31mFailure in model stg_skaters (models/staging/stg_skaters.sql)[0m
[0m11:54:00.782901 [error] [MainThread]:   Runtime Error in model stg_skaters (models/staging/stg_skaters.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m11:54:00.783068 [info ] [MainThread]: 
[0m11:54:00.783264 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_skaters.sql
[0m11:54:00.783434 [info ] [MainThread]: 
[0m11:54:00.783632 [error] [MainThread]: [31mFailure in model stg_teams (models/staging/stg_teams.sql)[0m
[0m11:54:00.783832 [error] [MainThread]:   Runtime Error in model stg_teams (models/staging/stg_teams.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m11:54:00.783998 [info ] [MainThread]: 
[0m11:54:00.784224 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_teams.sql
[0m11:54:00.784401 [info ] [MainThread]: 
[0m11:54:00.784596 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=9 SKIP=0 NO-OP=0 TOTAL=11
[0m11:54:00.785508 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.070362, "process_in_blocks": "0", "process_kernel_time": 0.191227, "process_mem_max_rss": "148291584", "process_out_blocks": "0", "process_user_time": 1.640765}
[0m11:54:00.785750 [debug] [MainThread]: Command `dbt run` failed at 11:54:00.785703 after 1.07 seconds
[0m11:54:00.785972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ae0ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10841a400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d52220>]}
[0m11:54:00.786206 [debug] [MainThread]: Flushing usage events
[0m11:54:01.069615 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:55:29.628056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10797ca30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111428430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111428250>]}


============================== 11:55:29.630840 | 163df7aa-aca2-4dc0-b454-aad13c293aaf ==============================
[0m11:55:29.630840 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:55:29.631190 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'partial_parse': 'True', 'target_path': 'None', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'warn_error': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --profiles-dir=. --select stg_goalies', 'quiet': 'False', 'static_parser': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'debug': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'use_colors': 'True', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'printer_width': '80'}
[0m11:55:29.763133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '163df7aa-aca2-4dc0-b454-aad13c293aaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130d62e0>]}
[0m11:55:29.797383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '163df7aa-aca2-4dc0-b454-aad13c293aaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130f18e0>]}
[0m11:55:29.798721 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:55:29.867151 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:55:29.867627 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:55:29.867870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '163df7aa-aca2-4dc0-b454-aad13c293aaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113bc0d0>]}
[0m11:55:30.637014 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.nhl_analytics.marts
- models.nhl_analytics.intermediate
[0m11:55:30.645604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '163df7aa-aca2-4dc0-b454-aad13c293aaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139f7130>]}
[0m11:55:30.733408 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m11:55:30.734879 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m11:55:30.745042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '163df7aa-aca2-4dc0-b454-aad13c293aaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139576a0>]}
[0m11:55:30.745356 [info ] [MainThread]: Found 3 models, 6 data tests, 4 sources, 444 macros
[0m11:55:30.745574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '163df7aa-aca2-4dc0-b454-aad13c293aaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138f7ca0>]}
[0m11:55:30.746241 [info ] [MainThread]: 
[0m11:55:30.746454 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:55:30.746631 [info ] [MainThread]: 
[0m11:55:30.746911 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:55:30.747379 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl'
[0m11:55:30.778402 [debug] [ThreadPool]: Using duckdb connection "list_nhl"
[0m11:55:30.778694 [debug] [ThreadPool]: On list_nhl: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m11:55:30.778895 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:30.813498 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m11:55:30.814644 [debug] [ThreadPool]: On list_nhl: Close
[0m11:55:30.815100 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nhl, now create_nhl_silver)
[0m11:55:30.815385 [debug] [ThreadPool]: Creating schema "database: "nhl"
schema: "silver"
"
[0m11:55:30.819789 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:55:30.819983 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nhl'
        and type='sqlite'
    
  
[0m11:55:30.820149 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:55:30.820615 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:55:30.821321 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:55:30.821504 [debug] [ThreadPool]: On create_nhl_silver: BEGIN
[0m11:55:30.821758 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:55:30.821928 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:55:30.822100 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
    
        create schema if not exists "nhl"."silver"
    
[0m11:55:30.822374 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:55:30.822830 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m11:55:30.823000 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:55:30.823152 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m11:55:30.823391 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:55:30.823564 [debug] [ThreadPool]: On create_nhl_silver: Close
[0m11:55:30.826802 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nhl_silver, now list_nhl_silver)
[0m11:55:30.830745 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m11:55:30.830941 [debug] [ThreadPool]: On list_nhl_silver: BEGIN
[0m11:55:30.831104 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:55:30.831405 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:55:30.831568 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m11:55:30.831735 [debug] [ThreadPool]: On list_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl_silver"} */
select
      'nhl' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'silver'
    and lower(table_catalog) = 'nhl'
  
[0m11:55:30.838626 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m11:55:30.839337 [debug] [ThreadPool]: On list_nhl_silver: ROLLBACK
[0m11:55:30.840738 [debug] [ThreadPool]: Failed to rollback 'list_nhl_silver'
[0m11:55:30.840945 [debug] [ThreadPool]: On list_nhl_silver: Close
[0m11:55:30.841443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '163df7aa-aca2-4dc0-b454-aad13c293aaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11399db50>]}
[0m11:55:30.841718 [debug] [MainThread]: Using duckdb connection "master"
[0m11:55:30.841883 [debug] [MainThread]: On master: BEGIN
[0m11:55:30.842032 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:55:30.842297 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:55:30.842467 [debug] [MainThread]: On master: COMMIT
[0m11:55:30.842633 [debug] [MainThread]: Using duckdb connection "master"
[0m11:55:30.842781 [debug] [MainThread]: On master: COMMIT
[0m11:55:30.843043 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:55:30.843214 [debug] [MainThread]: On master: Close
[0m11:55:30.844730 [debug] [Thread-1  ]: Began running node model.nhl_analytics.stg_goalies
[0m11:55:30.845046 [info ] [Thread-1  ]: 1 of 1 START sql view model silver.stg_goalies ................................. [RUN]
[0m11:55:30.845312 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_nhl_silver, now model.nhl_analytics.stg_goalies)
[0m11:55:30.845527 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.stg_goalies
[0m11:55:30.849873 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.stg_goalies"
[0m11:55:30.850399 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.stg_goalies
[0m11:55:30.869186 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.stg_goalies"
[0m11:55:30.869809 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:55:30.870020 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: BEGIN
[0m11:55:30.870206 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:55:30.870581 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m11:55:30.870769 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:55:30.870983 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    games_played,
    games_started,
    wins,
    losses,
    ties,
    otLosses as ot_losses,
    shotsAgainst as shots_against,
    saves,
    goals_against,
    savePercentage as save_percentage,
    goalsAgainstAverage as goals_against_average,
    timeOnIce as time_on_ice,
    timeOnIcePerGame as time_on_ice_per_game,
    shutouts,
    lowDangerGoals as low_danger_goals,
    mediumDangerGoals as medium_danger_goals,
    highDangerGoals as high_danger_goals,
    blocked_shot_attempts,
    penalityMinutes as penalty_minutes,
    penalties,
    -- Add data quality flags
    case
        when games_played > 0
        and saves > 0 then true
        else false
    end as is_active_goalie,
    -- Calculate additional metrics
    case
        when shotsAgainst > 0 then round(saves * 100.0 / shotsAgainst, 2)
        else null
    end as calculated_save_percentage,
    current_timestamp as loaded_at
from { { source('bronze', 'goalies') } }
where playerId is not null
    and season is not null
  );

[0m11:55:30.871633 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    games_played,
    games_started,
    wins,
    losses,
    ties,
    otLosses as ot_losses,
    shotsAgainst as shots_against,
    saves,
    goals_against,
    savePercentage as save_percentage,
    goalsAgainstAverage as goals_against_average,
    timeOnIce as time_on_ice,
    timeOnIcePerGame as time_on_ice_per_game,
    shutouts,
    lowDangerGoals as low_danger_goals,
    mediumDangerGoals as medium_danger_goals,
    highDangerGoals as high_danger_goals,
    blocked_shot_attempts,
    penalityMinutes as penalty_minutes,
    penalties,
    -- Add data quality flags
    case
        when games_played > 0
        and saves > 0 then true
        else false
    end as is_active_goalie,
    -- Calculate additional metrics
    case
        when shotsAgainst > 0 then round(saves * 100.0 / shotsAgainst, 2)
        else null
    end as calculated_save_percentage,
    current_timestamp as loaded_at
from { { source('bronze', 'goalies') } }
where playerId is not null
    and season is not null
  );

[0m11:55:30.871891 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m11:55:30.872164 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: ROLLBACK
[0m11:55:30.888162 [debug] [Thread-1  ]: Failed to rollback 'model.nhl_analytics.stg_goalies'
[0m11:55:30.888390 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: Close
[0m11:55:30.891507 [debug] [Thread-1  ]: Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m11:55:30.892760 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '163df7aa-aca2-4dc0-b454-aad13c293aaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113227730>]}
[0m11:55:30.893159 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model silver.stg_goalies ........................ [[31mERROR[0m in 0.05s]
[0m11:55:30.893496 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.stg_goalies
[0m11:55:30.893792 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_goalies' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^.
[0m11:55:30.894392 [debug] [MainThread]: Using duckdb connection "master"
[0m11:55:30.894609 [debug] [MainThread]: On master: BEGIN
[0m11:55:30.894789 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:55:30.895108 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:55:30.895287 [debug] [MainThread]: On master: COMMIT
[0m11:55:30.895453 [debug] [MainThread]: Using duckdb connection "master"
[0m11:55:30.895609 [debug] [MainThread]: On master: COMMIT
[0m11:55:30.895857 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:55:30.896031 [debug] [MainThread]: On master: Close
[0m11:55:30.896244 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:55:30.896393 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_goalies' was properly closed.
[0m11:55:30.896559 [info ] [MainThread]: 
[0m11:55:30.896748 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m11:55:30.897123 [debug] [MainThread]: Command end result
[0m11:55:30.911569 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m11:55:30.912623 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m11:55:30.916515 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/run_results.json
[0m11:55:30.916706 [info ] [MainThread]: 
[0m11:55:30.916940 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:55:30.917128 [info ] [MainThread]: 
[0m11:55:30.917352 [error] [MainThread]: [31mFailure in model stg_goalies (models/staging/stg_goalies.sql)[0m
[0m11:55:30.917574 [error] [MainThread]:   Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m11:55:30.917748 [info ] [MainThread]: 
[0m11:55:30.917948 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_goalies.sql
[0m11:55:30.918120 [info ] [MainThread]: 
[0m11:55:30.918311 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m11:55:30.919162 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3334018, "process_in_blocks": "0", "process_kernel_time": 0.173883, "process_mem_max_rss": "147767296", "process_out_blocks": "0", "process_user_time": 1.928981}
[0m11:55:30.919380 [debug] [MainThread]: Command `dbt run` failed at 11:55:30.919338 after 1.33 seconds
[0m11:55:30.919581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10797ca30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ce08e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113957bb0>]}
[0m11:55:30.919784 [debug] [MainThread]: Flushing usage events
[0m11:55:31.151192 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:56:00.919095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d7ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105928460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105928280>]}


============================== 11:56:00.921818 | 9e8d96d6-57ed-4cb3-aa74-15db38ce0393 ==============================
[0m11:56:00.921818 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:56:00.922157 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'version_check': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'profiles_dir': '.', 'partial_parse': 'True', 'log_format': 'default', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'no_print': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'fail_fast': 'False', 'invocation_command': 'dbt run --profiles-dir=. --select stg_goalies', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'use_colors': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'introspect': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'write_json': 'True'}
[0m11:56:01.096750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e8d96d6-57ed-4cb3-aa74-15db38ce0393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059ec6a0>]}
[0m11:56:01.131249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e8d96d6-57ed-4cb3-aa74-15db38ce0393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047de760>]}
[0m11:56:01.132879 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:56:01.202110 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:56:01.293314 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:56:01.293686 [debug] [MainThread]: Partial parsing: updated file: nhl_analytics://models/staging/stg_goalies.sql
[0m11:56:01.441799 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.nhl_analytics.marts
- models.nhl_analytics.intermediate
[0m11:56:01.479645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e8d96d6-57ed-4cb3-aa74-15db38ce0393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cd9280>]}
[0m11:56:01.541875 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m11:56:01.543281 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m11:56:01.553423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e8d96d6-57ed-4cb3-aa74-15db38ce0393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cdfe20>]}
[0m11:56:01.553722 [info ] [MainThread]: Found 3 models, 6 data tests, 4 sources, 444 macros
[0m11:56:01.553953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e8d96d6-57ed-4cb3-aa74-15db38ce0393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c82e50>]}
[0m11:56:01.554612 [info ] [MainThread]: 
[0m11:56:01.554841 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:56:01.555016 [info ] [MainThread]: 
[0m11:56:01.555291 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:56:01.555747 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl'
[0m11:56:01.586506 [debug] [ThreadPool]: Using duckdb connection "list_nhl"
[0m11:56:01.586758 [debug] [ThreadPool]: On list_nhl: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m11:56:01.586936 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:56:01.628804 [debug] [ThreadPool]: SQL status: OK in 0.042 seconds
[0m11:56:01.629959 [debug] [ThreadPool]: On list_nhl: Close
[0m11:56:01.630354 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nhl, now create_nhl_silver)
[0m11:56:01.630622 [debug] [ThreadPool]: Creating schema "database: "nhl"
schema: "silver"
"
[0m11:56:01.635091 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:56:01.635288 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nhl'
        and type='sqlite'
    
  
[0m11:56:01.635455 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:56:01.636040 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:56:01.636838 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:56:01.637012 [debug] [ThreadPool]: On create_nhl_silver: BEGIN
[0m11:56:01.637267 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:56:01.637437 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:56:01.637608 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
    
        create schema if not exists "nhl"."silver"
    
[0m11:56:01.638013 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:56:01.638478 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m11:56:01.638642 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:56:01.638793 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m11:56:01.639032 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:56:01.639206 [debug] [ThreadPool]: On create_nhl_silver: Close
[0m11:56:01.642393 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nhl_silver, now list_nhl_silver)
[0m11:56:01.645979 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m11:56:01.646183 [debug] [ThreadPool]: On list_nhl_silver: BEGIN
[0m11:56:01.646345 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:56:01.646635 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:56:01.646812 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m11:56:01.646995 [debug] [ThreadPool]: On list_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl_silver"} */
select
      'nhl' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'silver'
    and lower(table_catalog) = 'nhl'
  
[0m11:56:01.656746 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m11:56:01.657610 [debug] [ThreadPool]: On list_nhl_silver: ROLLBACK
[0m11:56:01.658818 [debug] [ThreadPool]: Failed to rollback 'list_nhl_silver'
[0m11:56:01.659000 [debug] [ThreadPool]: On list_nhl_silver: Close
[0m11:56:01.659701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e8d96d6-57ed-4cb3-aa74-15db38ce0393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059ec850>]}
[0m11:56:01.659961 [debug] [MainThread]: Using duckdb connection "master"
[0m11:56:01.660131 [debug] [MainThread]: On master: BEGIN
[0m11:56:01.660277 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:56:01.660544 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:56:01.660716 [debug] [MainThread]: On master: COMMIT
[0m11:56:01.660883 [debug] [MainThread]: Using duckdb connection "master"
[0m11:56:01.661076 [debug] [MainThread]: On master: COMMIT
[0m11:56:01.661376 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:56:01.661602 [debug] [MainThread]: On master: Close
[0m11:56:01.663083 [debug] [Thread-1  ]: Began running node model.nhl_analytics.stg_goalies
[0m11:56:01.663390 [info ] [Thread-1  ]: 1 of 1 START sql view model silver.stg_goalies ................................. [RUN]
[0m11:56:01.663659 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_nhl_silver, now model.nhl_analytics.stg_goalies)
[0m11:56:01.663877 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.stg_goalies
[0m11:56:01.668985 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.stg_goalies"
[0m11:56:01.669392 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.stg_goalies
[0m11:56:01.688226 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.stg_goalies"
[0m11:56:01.688735 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:56:01.688954 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: BEGIN
[0m11:56:01.689140 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:56:01.689533 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m11:56:01.689739 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:56:01.689927 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    

select
    playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position
from "nhl"."bronze"."goalies"
where playerId is not null
    and season is not null
    limit 10
  );

[0m11:56:01.690360 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m11:56:01.693978 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:56:01.694190 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */
alter view "nhl"."silver"."stg_goalies__dbt_tmp" rename to "stg_goalies"
[0m11:56:01.694950 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m11:56:01.701603 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: COMMIT
[0m11:56:01.701833 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:56:01.702034 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: COMMIT
[0m11:56:01.703243 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m11:56:01.706582 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:56:01.706795 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

      drop view if exists "nhl"."silver"."stg_goalies__dbt_backup" cascade
    
[0m11:56:01.707147 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m11:56:01.708482 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: Close
[0m11:56:01.709555 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e8d96d6-57ed-4cb3-aa74-15db38ce0393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106edc640>]}
[0m11:56:01.709909 [info ] [Thread-1  ]: 1 of 1 OK created sql view model silver.stg_goalies ............................ [[32mOK[0m in 0.05s]
[0m11:56:01.710235 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.stg_goalies
[0m11:56:01.710812 [debug] [MainThread]: Using duckdb connection "master"
[0m11:56:01.711015 [debug] [MainThread]: On master: BEGIN
[0m11:56:01.711202 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:56:01.711526 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:56:01.711732 [debug] [MainThread]: On master: COMMIT
[0m11:56:01.711900 [debug] [MainThread]: Using duckdb connection "master"
[0m11:56:01.712056 [debug] [MainThread]: On master: COMMIT
[0m11:56:01.712322 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:56:01.712504 [debug] [MainThread]: On master: Close
[0m11:56:01.712714 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:56:01.712866 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_goalies' was properly closed.
[0m11:56:01.713025 [info ] [MainThread]: 
[0m11:56:01.713216 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m11:56:01.713581 [debug] [MainThread]: Command end result
[0m11:56:01.727449 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m11:56:01.728444 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m11:56:01.732499 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/run_results.json
[0m11:56:01.732699 [info ] [MainThread]: 
[0m11:56:01.732955 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:56:01.733137 [info ] [MainThread]: 
[0m11:56:01.733337 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:56:01.734215 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.85662293, "process_in_blocks": "0", "process_kernel_time": 0.179525, "process_mem_max_rss": "144621568", "process_out_blocks": "0", "process_user_time": 1.40406}
[0m11:56:01.734428 [debug] [MainThread]: Command `dbt run` succeeded at 11:56:01.734389 after 0.86 seconds
[0m11:56:01.734628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d7ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030fba60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cdfe20>]}
[0m11:56:01.734833 [debug] [MainThread]: Flushing usage events
[0m11:56:01.945870 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:56:58.849299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b74a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bf8430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bf8250>]}


============================== 11:56:58.852553 | dd01eb8a-2d50-4ef3-8f49-a9ae8154f6f7 ==============================
[0m11:56:58.852553 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:56:58.852935 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'debug': 'False', 'printer_width': '80', 'invocation_command': 'dbt run --profiles-dir=.', 'cache_selected_only': 'False', 'static_parser': 'True', 'no_print': 'None', 'introspect': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'version_check': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'quiet': 'False', 'partial_parse': 'True', 'profiles_dir': '.', 'log_cache_events': 'False', 'log_format': 'default', 'empty': 'False', 'write_json': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False'}
[0m11:56:59.020301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd01eb8a-2d50-4ef3-8f49-a9ae8154f6f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104506940>]}
[0m11:56:59.054329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd01eb8a-2d50-4ef3-8f49-a9ae8154f6f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ce1a90>]}
[0m11:56:59.055636 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:56:59.125745 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:56:59.215616 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 2 files changed.
[0m11:56:59.215938 [debug] [MainThread]: Partial parsing: added file: nhl_analytics://models/intermediate/int_all_players.sql
[0m11:56:59.216136 [debug] [MainThread]: Partial parsing: added file: nhl_analytics://models/marts/mart_team_standings.sql
[0m11:56:59.216315 [debug] [MainThread]: Partial parsing: added file: nhl_analytics://models/marts/mart_player_performance.sql
[0m11:56:59.216540 [debug] [MainThread]: Partial parsing: updated file: nhl_analytics://models/staging/stg_skaters.sql
[0m11:56:59.216747 [debug] [MainThread]: Partial parsing: updated file: nhl_analytics://models/staging/stg_teams.sql
[0m11:56:59.407919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd01eb8a-2d50-4ef3-8f49-a9ae8154f6f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ded070>]}
[0m11:56:59.470667 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m11:56:59.472202 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m11:56:59.482318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd01eb8a-2d50-4ef3-8f49-a9ae8154f6f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de2e20>]}
[0m11:56:59.482616 [info ] [MainThread]: Found 6 data tests, 6 models, 4 sources, 444 macros
[0m11:56:59.482837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd01eb8a-2d50-4ef3-8f49-a9ae8154f6f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ded340>]}
[0m11:56:59.483710 [info ] [MainThread]: 
[0m11:56:59.483914 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:56:59.484089 [info ] [MainThread]: 
[0m11:56:59.484361 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:56:59.487396 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl'
[0m11:56:59.515629 [debug] [ThreadPool]: Using duckdb connection "list_nhl"
[0m11:56:59.515880 [debug] [ThreadPool]: On list_nhl: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m11:56:59.516053 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:56:59.562043 [debug] [ThreadPool]: SQL status: OK in 0.046 seconds
[0m11:56:59.562966 [debug] [ThreadPool]: On list_nhl: Close
[0m11:56:59.563416 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nhl, now create_nhl_silver)
[0m11:56:59.563691 [debug] [ThreadPool]: Creating schema "database: "nhl"
schema: "silver"
"
[0m11:56:59.568679 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:56:59.568948 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nhl'
        and type='sqlite'
    
  
[0m11:56:59.569144 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:56:59.569883 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:56:59.570807 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:56:59.571001 [debug] [ThreadPool]: On create_nhl_silver: BEGIN
[0m11:56:59.571290 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:56:59.571465 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:56:59.571637 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
    
        create schema if not exists "nhl"."silver"
    
[0m11:56:59.572069 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:56:59.572548 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m11:56:59.572725 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:56:59.572884 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m11:56:59.573132 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:56:59.573311 [debug] [ThreadPool]: On create_nhl_silver: Close
[0m11:56:59.574159 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nhl_silver, now list_nhl_silver)
[0m11:56:59.577714 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m11:56:59.577927 [debug] [ThreadPool]: On list_nhl_silver: BEGIN
[0m11:56:59.578099 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:56:59.578383 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:56:59.578548 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m11:56:59.578723 [debug] [ThreadPool]: On list_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl_silver"} */
select
      'nhl' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'silver'
    and lower(table_catalog) = 'nhl'
  
[0m11:56:59.588610 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m11:56:59.589490 [debug] [ThreadPool]: On list_nhl_silver: ROLLBACK
[0m11:56:59.590652 [debug] [ThreadPool]: Failed to rollback 'list_nhl_silver'
[0m11:56:59.590829 [debug] [ThreadPool]: On list_nhl_silver: Close
[0m11:56:59.591402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd01eb8a-2d50-4ef3-8f49-a9ae8154f6f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045cd7c0>]}
[0m11:56:59.591682 [debug] [MainThread]: Using duckdb connection "master"
[0m11:56:59.591853 [debug] [MainThread]: On master: BEGIN
[0m11:56:59.592002 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:56:59.592283 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:56:59.592456 [debug] [MainThread]: On master: COMMIT
[0m11:56:59.592623 [debug] [MainThread]: Using duckdb connection "master"
[0m11:56:59.592778 [debug] [MainThread]: On master: COMMIT
[0m11:56:59.593007 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:56:59.593177 [debug] [MainThread]: On master: Close
[0m11:56:59.594653 [debug] [Thread-1  ]: Began running node model.nhl_analytics.stg_goalies
[0m11:56:59.594938 [debug] [Thread-2  ]: Began running node model.nhl_analytics.stg_skaters
[0m11:56:59.595407 [debug] [Thread-3  ]: Began running node model.nhl_analytics.stg_teams
[0m11:56:59.595228 [info ] [Thread-1  ]: 1 of 6 START sql view model silver.stg_goalies ................................. [RUN]
[0m11:56:59.595744 [info ] [Thread-2  ]: 2 of 6 START sql view model silver.stg_skaters ................................. [RUN]
[0m11:56:59.596047 [info ] [Thread-3  ]: 3 of 6 START sql view model silver.stg_teams ................................... [RUN]
[0m11:56:59.596329 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_nhl_silver, now model.nhl_analytics.stg_goalies)
[0m11:56:59.596600 [debug] [Thread-2  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_skaters'
[0m11:56:59.596861 [debug] [Thread-3  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_teams'
[0m11:56:59.597061 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.stg_goalies
[0m11:56:59.597258 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.stg_skaters
[0m11:56:59.597449 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.stg_teams
[0m11:56:59.602675 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.stg_goalies"
[0m11:56:59.604671 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.stg_skaters"
[0m11:56:59.606573 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.stg_teams"
[0m11:56:59.607032 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.stg_skaters
[0m11:56:59.607257 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.stg_goalies
[0m11:56:59.627161 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.stg_teams
[0m11:56:59.635679 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.stg_skaters"
[0m11:56:59.637906 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.stg_teams"
[0m11:56:59.638248 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.stg_goalies"
[0m11:56:59.638968 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m11:56:59.639249 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m11:56:59.639469 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: BEGIN
[0m11:56:59.639685 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:56:59.639890 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: BEGIN
[0m11:56:59.640079 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:56:59.640267 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: BEGIN
[0m11:56:59.640455 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:56:59.640765 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:56:59.641089 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m11:56:59.641366 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m11:56:59.641573 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m11:56:59.641794 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

  
  create view "nhl"."silver"."stg_teams__dbt_tmp" as (
    

select
    season,
    name as team_name,
    wins,
    losses,
    ot as overtime_losses,
    points as team_points,
    pointPctg as points_percentage,
    goalsPerGame as goals_per_game,
    goalsAgainstPerGame as goals_against_per_game,
    wins + losses + ot as games_played,
    current_timestamp as loaded_at
from "nhl"."bronze"."teams"
where season is not null
    and name is not null
  );

[0m11:56:59.642012 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m11:56:59.642201 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m11:56:59.642498 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:56:59.642738 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    

select
    playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    games_played,
    assists,
    goals,
    shots,
    points,
    plusMinus as plus_minus,
    penalityMinutes as penalty_minutes,
    case 
        when games_played > 0 then true 
        else false 
    end as is_active_player,
    case 
        when games_played > 0 then round(points * 1.0 / games_played, 2)
        else null 
    end as points_per_game,
    case 
        when shots > 0 then round(goals * 100.0 / shots, 2)
        else null 
    end as shooting_percentage,
    current_timestamp as loaded_at
from "nhl"."bronze"."skaters"
where playerId is not null
    and season is not null
  );

[0m11:56:59.642988 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    

select
    playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position
from "nhl"."bronze"."goalies"
where playerId is not null
    and season is not null
    limit 10
  );

[0m11:56:59.643951 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m11:56:59.647916 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:56:59.648303 [debug] [Thread-3  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

  
  create view "nhl"."silver"."stg_teams__dbt_tmp" as (
    

select
    season,
    name as team_name,
    wins,
    losses,
    ot as overtime_losses,
    points as team_points,
    pointPctg as points_percentage,
    goalsPerGame as goals_per_game,
    goalsAgainstPerGame as goals_against_per_game,
    wins + losses + ot as games_played,
    current_timestamp as loaded_at
from "nhl"."bronze"."teams"
where season is not null
    and name is not null
  );

[0m11:56:59.648605 [debug] [Thread-2  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    

select
    playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    games_played,
    assists,
    goals,
    shots,
    points,
    plusMinus as plus_minus,
    penalityMinutes as penalty_minutes,
    case 
        when games_played > 0 then true 
        else false 
    end as is_active_player,
    case 
        when games_played > 0 then round(points * 1.0 / games_played, 2)
        else null 
    end as points_per_game,
    case 
        when shots > 0 then round(goals * 100.0 / shots, 2)
        else null 
    end as shooting_percentage,
    current_timestamp as loaded_at
from "nhl"."bronze"."skaters"
where playerId is not null
    and season is not null
  );

[0m11:56:59.648833 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */
alter view "nhl"."silver"."stg_goalies" rename to "stg_goalies__dbt_backup"
[0m11:56:59.649045 [debug] [Thread-3  ]: DuckDB adapter: Rolling back transaction.
[0m11:56:59.649253 [debug] [Thread-2  ]: DuckDB adapter: Rolling back transaction.
[0m11:56:59.649585 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: ROLLBACK
[0m11:56:59.649854 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: ROLLBACK
[0m11:56:59.650068 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m11:56:59.654198 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:56:59.655643 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */
alter view "nhl"."silver"."stg_goalies__dbt_tmp" rename to "stg_goalies"
[0m11:56:59.658466 [debug] [Thread-1  ]: SQL status: OK in 0.003 seconds
[0m11:56:59.665484 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: COMMIT
[0m11:56:59.665755 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:56:59.666029 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: COMMIT
[0m11:56:59.668188 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m11:56:59.671573 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:56:59.672348 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

      drop view if exists "nhl"."silver"."stg_goalies__dbt_backup" cascade
    
[0m11:56:59.673417 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m11:56:59.674822 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: Close
[0m11:56:59.680509 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd01eb8a-2d50-4ef3-8f49-a9ae8154f6f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c79d60>]}
[0m11:56:59.682517 [info ] [Thread-1  ]: 1 of 6 OK created sql view model silver.stg_goalies ............................ [[32mOK[0m in 0.08s]
[0m11:56:59.684524 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.stg_goalies
[0m11:56:59.693165 [debug] [Thread-3  ]: Failed to rollback 'model.nhl_analytics.stg_teams'
[0m11:56:59.693384 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: Close
[0m11:56:59.693821 [debug] [Thread-2  ]: Failed to rollback 'model.nhl_analytics.stg_skaters'
[0m11:56:59.694044 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: Close
[0m11:56:59.697184 [debug] [Thread-2  ]: Runtime Error in model stg_skaters (models/staging/stg_skaters.sql)
  Binder Error: Referenced column "assists" not found in FROM clause!
  Candidate bindings: "shifts", "I_F_shifts", "I_F_xGoals_with_earned_rebounds_scoreFlurryAdjusted", "position", "penalityMinutesDrawn"
  
  LINE 14:     assists,
               ^
[0m11:56:59.700098 [debug] [Thread-3  ]: Runtime Error in model stg_teams (models/staging/stg_teams.sql)
  Binder Error: Referenced column "wins" not found in FROM clause!
  Candidate bindings: "hitsFor", "hitsAgainst", "reboundsFor", "takeawaysFor", "xReboundsFor"
  
  LINE 10:     wins,
               ^
[0m11:56:59.700395 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd01eb8a-2d50-4ef3-8f49-a9ae8154f6f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107223250>]}
[0m11:56:59.700657 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd01eb8a-2d50-4ef3-8f49-a9ae8154f6f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107821580>]}
[0m11:56:59.701092 [error] [Thread-2  ]: 2 of 6 ERROR creating sql view model silver.stg_skaters ........................ [[31mERROR[0m in 0.10s]
[0m11:56:59.701415 [error] [Thread-3  ]: 3 of 6 ERROR creating sql view model silver.stg_teams .......................... [[31mERROR[0m in 0.10s]
[0m11:56:59.701758 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.stg_skaters
[0m11:56:59.702050 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.stg_teams
[0m11:56:59.702337 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_skaters' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_skaters (models/staging/stg_skaters.sql)
  Binder Error: Referenced column "assists" not found in FROM clause!
  Candidate bindings: "shifts", "I_F_shifts", "I_F_xGoals_with_earned_rebounds_scoreFlurryAdjusted", "position", "penalityMinutesDrawn"
  
  LINE 14:     assists,
               ^.
[0m11:56:59.702669 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_teams' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_teams (models/staging/stg_teams.sql)
  Binder Error: Referenced column "wins" not found in FROM clause!
  Candidate bindings: "hitsFor", "hitsAgainst", "reboundsFor", "takeawaysFor", "xReboundsFor"
  
  LINE 10:     wins,
               ^.
[0m11:56:59.702960 [debug] [Thread-4  ]: Began running node model.nhl_analytics.int_all_players
[0m11:56:59.703380 [debug] [Thread-2  ]: Began running node model.nhl_analytics.mart_team_standings
[0m11:56:59.703211 [info ] [Thread-4  ]: 4 of 6 SKIP relation silver.int_all_players .................................... [[33mSKIP[0m]
[0m11:56:59.703600 [info ] [Thread-2  ]: 5 of 6 SKIP relation silver.mart_team_standings ................................ [[33mSKIP[0m]
[0m11:56:59.703907 [debug] [Thread-4  ]: Finished running node model.nhl_analytics.int_all_players
[0m11:56:59.704131 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.mart_team_standings
[0m11:56:59.704429 [debug] [Thread-1  ]: Began running node model.nhl_analytics.mart_player_performance
[0m11:56:59.704698 [info ] [Thread-1  ]: 6 of 6 SKIP relation silver.mart_player_performance ............................ [[33mSKIP[0m]
[0m11:56:59.704929 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.mart_player_performance
[0m11:56:59.705532 [debug] [MainThread]: Using duckdb connection "master"
[0m11:56:59.705707 [debug] [MainThread]: On master: BEGIN
[0m11:56:59.705879 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:56:59.706287 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:56:59.706453 [debug] [MainThread]: On master: COMMIT
[0m11:56:59.706635 [debug] [MainThread]: Using duckdb connection "master"
[0m11:56:59.706801 [debug] [MainThread]: On master: COMMIT
[0m11:56:59.707092 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:56:59.707266 [debug] [MainThread]: On master: Close
[0m11:56:59.707494 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:56:59.707662 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_goalies' was properly closed.
[0m11:56:59.707799 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_skaters' was properly closed.
[0m11:56:59.707934 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_teams' was properly closed.
[0m11:56:59.708136 [info ] [MainThread]: 
[0m11:56:59.708326 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m11:56:59.708876 [debug] [MainThread]: Command end result
[0m11:56:59.725850 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m11:56:59.726918 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m11:56:59.731563 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/run_results.json
[0m11:56:59.731787 [info ] [MainThread]: 
[0m11:56:59.732017 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m11:56:59.732213 [info ] [MainThread]: 
[0m11:56:59.732435 [error] [MainThread]: [31mFailure in model stg_skaters (models/staging/stg_skaters.sql)[0m
[0m11:56:59.732652 [error] [MainThread]:   Runtime Error in model stg_skaters (models/staging/stg_skaters.sql)
  Binder Error: Referenced column "assists" not found in FROM clause!
  Candidate bindings: "shifts", "I_F_shifts", "I_F_xGoals_with_earned_rebounds_scoreFlurryAdjusted", "position", "penalityMinutesDrawn"
  
  LINE 14:     assists,
               ^
[0m11:56:59.732830 [info ] [MainThread]: 
[0m11:56:59.733029 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_skaters.sql
[0m11:56:59.733203 [info ] [MainThread]: 
[0m11:56:59.733405 [error] [MainThread]: [31mFailure in model stg_teams (models/staging/stg_teams.sql)[0m
[0m11:56:59.733610 [error] [MainThread]:   Runtime Error in model stg_teams (models/staging/stg_teams.sql)
  Binder Error: Referenced column "wins" not found in FROM clause!
  Candidate bindings: "hitsFor", "hitsAgainst", "reboundsFor", "takeawaysFor", "xReboundsFor"
  
  LINE 10:     wins,
               ^
[0m11:56:59.733779 [info ] [MainThread]: 
[0m11:56:59.733975 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_teams.sql
[0m11:56:59.734145 [info ] [MainThread]: 
[0m11:56:59.734332 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=3 NO-OP=0 TOTAL=6
[0m11:56:59.735222 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9328495, "process_in_blocks": "0", "process_kernel_time": 0.183715, "process_mem_max_rss": "147030016", "process_out_blocks": "0", "process_user_time": 1.49225}
[0m11:56:59.735438 [debug] [MainThread]: Command `dbt run` failed at 11:56:59.735396 after 0.93 seconds
[0m11:56:59.735642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b74a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de2550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077bcf10>]}
[0m11:56:59.735842 [debug] [MainThread]: Flushing usage events
[0m11:56:59.927766 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:57:45.579316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d6aaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106df04f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106df0310>]}


============================== 11:57:45.581486 | bf2edf27-aa88-4bb7-a664-383b652c6ed1 ==============================
[0m11:57:45.581486 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:57:45.581836 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'write_json': 'True', 'empty': 'False', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir=.', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'static_parser': 'True', 'fail_fast': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'partial_parse': 'True', 'quiet': 'False', 'version_check': 'True', 'profiles_dir': '.', 'use_colors': 'True', 'indirect_selection': 'eager'}
[0m11:57:45.701909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf2edf27-aa88-4bb7-a664-383b652c6ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ef91c0>]}
[0m11:57:45.736158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf2edf27-aa88-4bb7-a664-383b652c6ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e85190>]}
[0m11:57:45.737189 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:57:45.803260 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:57:45.890909 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:57:45.891329 [debug] [MainThread]: Partial parsing: updated file: nhl_analytics://models/staging/stg_skaters.sql
[0m11:57:45.891586 [debug] [MainThread]: Partial parsing: updated file: nhl_analytics://models/staging/stg_teams.sql
[0m11:57:46.101836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf2edf27-aa88-4bb7-a664-383b652c6ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10605eb20>]}
[0m11:57:46.169230 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m11:57:46.171126 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m11:57:46.181488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf2edf27-aa88-4bb7-a664-383b652c6ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e24550>]}
[0m11:57:46.181837 [info ] [MainThread]: Found 6 data tests, 6 models, 4 sources, 444 macros
[0m11:57:46.182063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf2edf27-aa88-4bb7-a664-383b652c6ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106706400>]}
[0m11:57:46.183023 [info ] [MainThread]: 
[0m11:57:46.183254 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:57:46.183436 [info ] [MainThread]: 
[0m11:57:46.183730 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:57:46.187085 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl'
[0m11:57:46.220297 [debug] [ThreadPool]: Using duckdb connection "list_nhl"
[0m11:57:46.220612 [debug] [ThreadPool]: On list_nhl: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m11:57:46.220803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:57:46.256096 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m11:57:46.257115 [debug] [ThreadPool]: On list_nhl: Close
[0m11:57:46.257608 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nhl, now create_nhl_silver)
[0m11:57:46.257914 [debug] [ThreadPool]: Creating schema "database: "nhl"
schema: "silver"
"
[0m11:57:46.269361 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:57:46.269827 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nhl'
        and type='sqlite'
    
  
[0m11:57:46.270045 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:57:46.270604 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:57:46.271366 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:57:46.271561 [debug] [ThreadPool]: On create_nhl_silver: BEGIN
[0m11:57:46.271830 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:57:46.272003 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:57:46.272177 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
    
        create schema if not exists "nhl"."silver"
    
[0m11:57:46.272445 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:57:46.272901 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m11:57:46.273079 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:57:46.273245 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m11:57:46.273475 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:57:46.273650 [debug] [ThreadPool]: On create_nhl_silver: Close
[0m11:57:46.274534 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nhl_silver, now list_nhl_silver)
[0m11:57:46.279524 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m11:57:46.280040 [debug] [ThreadPool]: On list_nhl_silver: BEGIN
[0m11:57:46.280427 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:57:46.281843 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:57:46.282234 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m11:57:46.282617 [debug] [ThreadPool]: On list_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl_silver"} */
select
      'nhl' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'silver'
    and lower(table_catalog) = 'nhl'
  
[0m11:57:46.294518 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m11:57:46.296338 [debug] [ThreadPool]: On list_nhl_silver: ROLLBACK
[0m11:57:46.298940 [debug] [ThreadPool]: Failed to rollback 'list_nhl_silver'
[0m11:57:46.299169 [debug] [ThreadPool]: On list_nhl_silver: Close
[0m11:57:46.299793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf2edf27-aa88-4bb7-a664-383b652c6ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047c5940>]}
[0m11:57:46.300084 [debug] [MainThread]: Using duckdb connection "master"
[0m11:57:46.300262 [debug] [MainThread]: On master: BEGIN
[0m11:57:46.300427 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:57:46.300733 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:57:46.300906 [debug] [MainThread]: On master: COMMIT
[0m11:57:46.301074 [debug] [MainThread]: Using duckdb connection "master"
[0m11:57:46.301237 [debug] [MainThread]: On master: COMMIT
[0m11:57:46.302414 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:57:46.302980 [debug] [MainThread]: On master: Close
[0m11:57:46.310670 [debug] [Thread-1  ]: Began running node model.nhl_analytics.stg_goalies
[0m11:57:46.311382 [info ] [Thread-1  ]: 1 of 6 START sql view model silver.stg_goalies ................................. [RUN]
[0m11:57:46.312172 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_nhl_silver, now model.nhl_analytics.stg_goalies)
[0m11:57:46.312695 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.stg_goalies
[0m11:57:46.320316 [debug] [Thread-2  ]: Began running node model.nhl_analytics.stg_skaters
[0m11:57:46.322460 [info ] [Thread-2  ]: 2 of 6 START sql view model silver.stg_skaters ................................. [RUN]
[0m11:57:46.323195 [debug] [Thread-2  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_skaters'
[0m11:57:46.323662 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.stg_skaters
[0m11:57:46.327142 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.stg_goalies"
[0m11:57:46.328054 [debug] [Thread-3  ]: Began running node model.nhl_analytics.stg_teams
[0m11:57:46.331896 [info ] [Thread-3  ]: 3 of 6 START sql view model silver.stg_teams ................................... [RUN]
[0m11:57:46.332734 [debug] [Thread-3  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_teams'
[0m11:57:46.333204 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.stg_teams
[0m11:57:46.337469 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.stg_skaters"
[0m11:57:46.342071 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.stg_teams"
[0m11:57:46.346088 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.stg_skaters
[0m11:57:46.346481 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.stg_goalies
[0m11:57:46.368098 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.stg_skaters"
[0m11:57:46.370705 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.stg_goalies"
[0m11:57:46.371115 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.stg_teams
[0m11:57:46.373576 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.stg_teams"
[0m11:57:46.373951 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m11:57:46.374224 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:57:46.374472 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: BEGIN
[0m11:57:46.374695 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: BEGIN
[0m11:57:46.374928 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m11:57:46.375151 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:57:46.375361 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:57:46.375581 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: BEGIN
[0m11:57:46.376054 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m11:57:46.376250 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:57:46.376444 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m11:57:46.376652 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m11:57:46.376908 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:57:46.377144 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    

select
    playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    games_played,
    icetime as ice_time,
    I_F_goals as goals,
    I_F_points as points,
    I_F_shotsOnGoal as shots_on_goal,
    I_F_primaryAssists as primary_assists,
    I_F_secondaryAssists as secondary_assists,
    case 
        when games_played > 0 then true 
        else false 
    end as is_active_player,
    case 
        when games_played > 0 then round(I_F_points * 1.0 / games_played, 2)
        else null 
    end as points_per_game,
    case 
        when I_F_shotsOnGoal > 0 then round(I_F_goals * 100.0 / I_F_shotsOnGoal, 2)
        else null 
    end as shooting_percentage,
    current_timestamp as loaded_at
from "nhl"."bronze"."skaters"
where playerId is not null
    and season is not null
  );

[0m11:57:46.377367 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m11:57:46.377623 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    

select
    playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position
from "nhl"."bronze"."goalies"
where playerId is not null
    and season is not null
    limit 10
  );

[0m11:57:46.378044 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m11:57:46.378372 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

  
  create view "nhl"."silver"."stg_teams__dbt_tmp" as (
    

select
    season,
    name as team_name,
    team as team_code,
    games_played,
    goalsFor,
    goalsAgainst,
    goalsFor - goalsAgainst as goal_differential,
    xGoalsFor,
    xGoalsAgainst,
    current_timestamp as loaded_at
from "nhl"."bronze"."teams"
where season is not null
    and name is not null
    and situation = 'all'
  );

[0m11:57:46.378668 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m11:57:46.382677 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:57:46.382911 [debug] [Thread-2  ]: SQL status: OK in 0.005 seconds
[0m11:57:46.383126 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */
alter view "nhl"."silver"."stg_goalies" rename to "stg_goalies__dbt_backup"
[0m11:57:46.383337 [debug] [Thread-3  ]: SQL status: OK in 0.005 seconds
[0m11:57:46.385305 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m11:57:46.387293 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m11:57:46.387531 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */
alter view "nhl"."silver"."stg_skaters__dbt_tmp" rename to "stg_skaters"
[0m11:57:46.387746 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m11:57:46.388395 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */
alter view "nhl"."silver"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m11:57:46.390379 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:57:46.390665 [debug] [Thread-2  ]: SQL status: OK in 0.002 seconds
[0m11:57:46.390877 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */
alter view "nhl"."silver"."stg_goalies__dbt_tmp" rename to "stg_goalies"
[0m11:57:46.397397 [debug] [Thread-3  ]: SQL status: OK in 0.007 seconds
[0m11:57:46.397182 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: COMMIT
[0m11:57:46.398356 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: COMMIT
[0m11:57:46.398588 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m11:57:46.398799 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m11:57:46.399006 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m11:57:46.399216 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: COMMIT
[0m11:57:46.401208 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: COMMIT
[0m11:57:46.401435 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: COMMIT
[0m11:57:46.401708 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:57:46.402035 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: COMMIT
[0m11:57:46.402318 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m11:57:46.402540 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m11:57:46.406189 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m11:57:46.406407 [debug] [Thread-1  ]: SQL status: OK in 0.004 seconds
[0m11:57:46.408147 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m11:57:46.408380 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

      drop view if exists "nhl"."silver"."stg_teams__dbt_backup" cascade
    
[0m11:57:46.410063 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:57:46.410291 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

      drop view if exists "nhl"."silver"."stg_skaters__dbt_backup" cascade
    
[0m11:57:46.410583 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

      drop view if exists "nhl"."silver"."stg_goalies__dbt_backup" cascade
    
[0m11:57:46.410873 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m11:57:46.412494 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: Close
[0m11:57:46.412721 [debug] [Thread-2  ]: SQL status: OK in 0.002 seconds
[0m11:57:46.412953 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m11:57:46.414035 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: Close
[0m11:57:46.415169 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: Close
[0m11:57:46.415684 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf2edf27-aa88-4bb7-a664-383b652c6ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079abb50>]}
[0m11:57:46.415873 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf2edf27-aa88-4bb7-a664-383b652c6ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a1c190>]}
[0m11:57:46.416066 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf2edf27-aa88-4bb7-a664-383b652c6ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10792a0d0>]}
[0m11:57:46.416450 [info ] [Thread-3  ]: 3 of 6 OK created sql view model silver.stg_teams .............................. [[32mOK[0m in 0.08s]
[0m11:57:46.416837 [info ] [Thread-2  ]: 2 of 6 OK created sql view model silver.stg_skaters ............................ [[32mOK[0m in 0.09s]
[0m11:57:46.417216 [info ] [Thread-1  ]: 1 of 6 OK created sql view model silver.stg_goalies ............................ [[32mOK[0m in 0.10s]
[0m11:57:46.417535 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.stg_teams
[0m11:57:46.417824 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.stg_skaters
[0m11:57:46.418104 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.stg_goalies
[0m11:57:46.418436 [debug] [Thread-4  ]: Began running node model.nhl_analytics.mart_team_standings
[0m11:57:46.418819 [info ] [Thread-4  ]: 4 of 6 START sql table model silver.mart_team_standings ........................ [RUN]
[0m11:57:46.419153 [debug] [Thread-4  ]: Acquiring new duckdb connection 'model.nhl_analytics.mart_team_standings'
[0m11:57:46.419379 [debug] [Thread-2  ]: Began running node model.nhl_analytics.int_all_players
[0m11:57:46.419581 [debug] [Thread-4  ]: Began compiling node model.nhl_analytics.mart_team_standings
[0m11:57:46.419852 [info ] [Thread-2  ]: 5 of 6 START sql view model silver.int_all_players ............................. [RUN]
[0m11:57:46.421934 [debug] [Thread-4  ]: Writing injected SQL for node "model.nhl_analytics.mart_team_standings"
[0m11:57:46.422197 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.stg_skaters, now model.nhl_analytics.int_all_players)
[0m11:57:46.422461 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.int_all_players
[0m11:57:46.424801 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.int_all_players"
[0m11:57:46.425269 [debug] [Thread-4  ]: Began executing node model.nhl_analytics.mart_team_standings
[0m11:57:46.432177 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.int_all_players
[0m11:57:46.441088 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.int_all_players"
[0m11:57:46.442806 [debug] [Thread-4  ]: Writing runtime sql for node "model.nhl_analytics.mart_team_standings"
[0m11:57:46.443382 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m11:57:46.443633 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m11:57:46.443848 [debug] [Thread-2  ]: On model.nhl_analytics.int_all_players: BEGIN
[0m11:57:46.444068 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: BEGIN
[0m11:57:46.444282 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:57:46.444551 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:57:46.445182 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m11:57:46.445492 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m11:57:46.445735 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m11:57:46.446006 [debug] [Thread-2  ]: On model.nhl_analytics.int_all_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */

  
  create view "nhl"."silver"."int_all_players__dbt_tmp" as (
    

with all_players as (
    select 
        player_id,
        season,
        player_name,
        team_code,
        'G' as position,
        null as games_played,
        null as points_per_game,
        null as shooting_percentage,
        loaded_at
    from "nhl"."silver"."stg_goalies"
    
    union all
    
    select 
        player_id,
        season,
        player_name,
        team_code,
        position,
        games_played,
        points_per_game,
        shooting_percentage,
        loaded_at
    from "nhl"."silver"."stg_skaters"
)

select *,
    case 
        when position = 'G' then 'Goalie'
        when position in ('C', 'L', 'R', 'LW', 'RW') then 'Forward'
        when position in ('D') then 'Defense'
        else 'Unknown'
    end as position_group
from all_players
  );

[0m11:57:46.446256 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m11:57:46.446608 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

  
    
    

    create  table
      "nhl"."silver"."mart_team_standings__dbt_tmp"
  
    as (
      

select 
    season,
    team_name,
    team_points,
    wins,
    losses,
    overtime_losses,
    games_played,
    points_percentage,
    goals_per_game,
    goals_against_per_game,
    goals_per_game - goals_against_per_game as goal_differential_per_game,
    row_number() over (order by team_points desc, points_percentage desc) as standings_rank,
    loaded_at
from "nhl"."silver"."stg_teams"
order by standings_rank
    );
  
  
[0m11:57:46.447026 [debug] [Thread-2  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */

  
  create view "nhl"."silver"."int_all_players__dbt_tmp" as (
    

with all_players as (
    select 
        player_id,
        season,
        player_name,
        team_code,
        'G' as position,
        null as games_played,
        null as points_per_game,
        null as shooting_percentage,
        loaded_at
    from "nhl"."silver"."stg_goalies"
    
    union all
    
    select 
        player_id,
        season,
        player_name,
        team_code,
        position,
        games_played,
        points_per_game,
        shooting_percentage,
        loaded_at
    from "nhl"."silver"."stg_skaters"
)

select *,
    case 
        when position = 'G' then 'Goalie'
        when position in ('C', 'L', 'R', 'LW', 'RW') then 'Forward'
        when position in ('D') then 'Defense'
        else 'Unknown'
    end as position_group
from all_players
  );

[0m11:57:46.447276 [debug] [Thread-2  ]: DuckDB adapter: Rolling back transaction.
[0m11:57:46.447558 [debug] [Thread-2  ]: On model.nhl_analytics.int_all_players: ROLLBACK
[0m11:57:46.447851 [debug] [Thread-4  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

  
    
    

    create  table
      "nhl"."silver"."mart_team_standings__dbt_tmp"
  
    as (
      

select 
    season,
    team_name,
    team_points,
    wins,
    losses,
    overtime_losses,
    games_played,
    points_percentage,
    goals_per_game,
    goals_against_per_game,
    goals_per_game - goals_against_per_game as goal_differential_per_game,
    row_number() over (order by team_points desc, points_percentage desc) as standings_rank,
    loaded_at
from "nhl"."silver"."stg_teams"
order by standings_rank
    );
  
  
[0m11:57:46.448165 [debug] [Thread-4  ]: DuckDB adapter: Rolling back transaction.
[0m11:57:46.448442 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: ROLLBACK
[0m11:57:46.476010 [debug] [Thread-4  ]: Failed to rollback 'model.nhl_analytics.mart_team_standings'
[0m11:57:46.476525 [debug] [Thread-2  ]: Failed to rollback 'model.nhl_analytics.int_all_players'
[0m11:57:46.476747 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: Close
[0m11:57:46.476967 [debug] [Thread-2  ]: On model.nhl_analytics.int_all_players: Close
[0m11:57:46.480231 [debug] [Thread-4  ]: Runtime Error in model mart_team_standings (models/marts/mart_team_standings.sql)
  Binder Error: Referenced column "team_points" not found in FROM clause!
  Candidate bindings: "team_name", "team_code", "season", "goal_differential", "goalsAgainst"
  
  LINE 16:     team_points,
               ^
[0m11:57:46.483031 [debug] [Thread-2  ]: Runtime Error in model int_all_players (models/intermediate/int_all_players.sql)
  Binder Error: Referenced column "loaded_at" not found in FROM clause!
  Candidate bindings: "player_name", "player_id", "season"
  
  LINE 17:         loaded_at
                   ^
[0m11:57:46.483349 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf2edf27-aa88-4bb7-a664-383b652c6ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10792a0d0>]}
[0m11:57:46.483620 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf2edf27-aa88-4bb7-a664-383b652c6ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107af5eb0>]}
[0m11:57:46.484068 [error] [Thread-4  ]: 4 of 6 ERROR creating sql table model silver.mart_team_standings ............... [[31mERROR[0m in 0.06s]
[0m11:57:46.484420 [error] [Thread-2  ]: 5 of 6 ERROR creating sql view model silver.int_all_players .................... [[31mERROR[0m in 0.06s]
[0m11:57:46.484787 [debug] [Thread-4  ]: Finished running node model.nhl_analytics.mart_team_standings
[0m11:57:46.485085 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.int_all_players
[0m11:57:46.485409 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.mart_team_standings' to be skipped because of status 'error'.  Reason: Runtime Error in model mart_team_standings (models/marts/mart_team_standings.sql)
  Binder Error: Referenced column "team_points" not found in FROM clause!
  Candidate bindings: "team_name", "team_code", "season", "goal_differential", "goalsAgainst"
  
  LINE 16:     team_points,
               ^.
[0m11:57:46.485743 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.int_all_players' to be skipped because of status 'error'.  Reason: Runtime Error in model int_all_players (models/intermediate/int_all_players.sql)
  Binder Error: Referenced column "loaded_at" not found in FROM clause!
  Candidate bindings: "player_name", "player_id", "season"
  
  LINE 17:         loaded_at
                   ^.
[0m11:57:46.486127 [debug] [Thread-1  ]: Began running node model.nhl_analytics.mart_player_performance
[0m11:57:46.486398 [info ] [Thread-1  ]: 6 of 6 SKIP relation silver.mart_player_performance ............................ [[33mSKIP[0m]
[0m11:57:46.486650 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.mart_player_performance
[0m11:57:46.487246 [debug] [MainThread]: Using duckdb connection "master"
[0m11:57:46.487426 [debug] [MainThread]: On master: BEGIN
[0m11:57:46.487588 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:57:46.487937 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:57:46.488107 [debug] [MainThread]: On master: COMMIT
[0m11:57:46.488273 [debug] [MainThread]: Using duckdb connection "master"
[0m11:57:46.488429 [debug] [MainThread]: On master: COMMIT
[0m11:57:46.488675 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:57:46.488846 [debug] [MainThread]: On master: Close
[0m11:57:46.489062 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:57:46.489217 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_goalies' was properly closed.
[0m11:57:46.489365 [debug] [MainThread]: Connection 'model.nhl_analytics.int_all_players' was properly closed.
[0m11:57:46.489511 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_teams' was properly closed.
[0m11:57:46.489656 [debug] [MainThread]: Connection 'model.nhl_analytics.mart_team_standings' was properly closed.
[0m11:57:46.489877 [info ] [MainThread]: 
[0m11:57:46.490067 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m11:57:46.490871 [debug] [MainThread]: Command end result
[0m11:57:46.507791 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m11:57:46.509137 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m11:57:46.514142 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/run_results.json
[0m11:57:46.514425 [info ] [MainThread]: 
[0m11:57:46.514681 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m11:57:46.514891 [info ] [MainThread]: 
[0m11:57:46.515128 [error] [MainThread]: [31mFailure in model mart_team_standings (models/marts/mart_team_standings.sql)[0m
[0m11:57:46.515357 [error] [MainThread]:   Runtime Error in model mart_team_standings (models/marts/mart_team_standings.sql)
  Binder Error: Referenced column "team_points" not found in FROM clause!
  Candidate bindings: "team_name", "team_code", "season", "goal_differential", "goalsAgainst"
  
  LINE 16:     team_points,
               ^
[0m11:57:46.515543 [info ] [MainThread]: 
[0m11:57:46.515754 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/marts/mart_team_standings.sql
[0m11:57:46.515939 [info ] [MainThread]: 
[0m11:57:46.516152 [error] [MainThread]: [31mFailure in model int_all_players (models/intermediate/int_all_players.sql)[0m
[0m11:57:46.516366 [error] [MainThread]:   Runtime Error in model int_all_players (models/intermediate/int_all_players.sql)
  Binder Error: Referenced column "loaded_at" not found in FROM clause!
  Candidate bindings: "player_name", "player_id", "season"
  
  LINE 17:         loaded_at
                   ^
[0m11:57:46.516543 [info ] [MainThread]: 
[0m11:57:46.516746 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/intermediate/int_all_players.sql
[0m11:57:46.516924 [info ] [MainThread]: 
[0m11:57:46.517122 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=1 NO-OP=0 TOTAL=6
[0m11:57:46.518139 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.97819674, "process_in_blocks": "0", "process_kernel_time": 0.16356, "process_mem_max_rss": "147718144", "process_out_blocks": "0", "process_user_time": 1.557669}
[0m11:57:46.518387 [debug] [MainThread]: Command `dbt run` failed at 11:57:46.518339 after 0.98 seconds
[0m11:57:46.518625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d6aaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10708e8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10707e970>]}
[0m11:57:46.518869 [debug] [MainThread]: Flushing usage events
[0m11:57:46.750677 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:58:18.524169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fe8a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ba8430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ba8250>]}


============================== 11:58:18.526623 | 91df6f80-8795-4b3d-b514-96bfe5a72e03 ==============================
[0m11:58:18.526623 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:58:18.526983 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --profiles-dir=.', 'profiles_dir': '.', 'use_experimental_parser': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'empty': 'False', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'log_cache_events': 'False', 'log_format': 'default', 'static_parser': 'True', 'fail_fast': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'debug': 'False', 'printer_width': '80', 'partial_parse': 'True', 'warn_error': 'None'}
[0m11:58:18.654642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91df6f80-8795-4b3d-b514-96bfe5a72e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e1a940>]}
[0m11:58:18.693540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91df6f80-8795-4b3d-b514-96bfe5a72e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c90a90>]}
[0m11:58:18.695118 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:58:18.776969 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:58:18.868512 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:58:18.869022 [debug] [MainThread]: Partial parsing: updated file: nhl_analytics://models/marts/mart_team_standings.sql
[0m11:58:18.869320 [debug] [MainThread]: Partial parsing: updated file: nhl_analytics://models/intermediate/int_all_players.sql
[0m11:58:19.078369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91df6f80-8795-4b3d-b514-96bfe5a72e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1185f1250>]}
[0m11:58:19.147083 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m11:58:19.148369 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m11:58:19.156012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91df6f80-8795-4b3d-b514-96bfe5a72e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11821ea60>]}
[0m11:58:19.156393 [info ] [MainThread]: Found 6 data tests, 6 models, 4 sources, 444 macros
[0m11:58:19.156632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91df6f80-8795-4b3d-b514-96bfe5a72e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11819c340>]}
[0m11:58:19.157618 [info ] [MainThread]: 
[0m11:58:19.157852 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:58:19.158039 [info ] [MainThread]: 
[0m11:58:19.158336 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:58:19.163014 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl'
[0m11:58:19.188604 [debug] [ThreadPool]: Using duckdb connection "list_nhl"
[0m11:58:19.188885 [debug] [ThreadPool]: On list_nhl: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m11:58:19.189082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:58:19.212319 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m11:58:19.213137 [debug] [ThreadPool]: On list_nhl: Close
[0m11:58:19.213550 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nhl, now create_nhl_silver)
[0m11:58:19.213839 [debug] [ThreadPool]: Creating schema "database: "nhl"
schema: "silver"
"
[0m11:58:19.218141 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:58:19.218357 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nhl'
        and type='sqlite'
    
  
[0m11:58:19.218528 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:58:19.219012 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:58:19.219657 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:58:19.219832 [debug] [ThreadPool]: On create_nhl_silver: BEGIN
[0m11:58:19.220093 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:58:19.220252 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:58:19.220413 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
    
        create schema if not exists "nhl"."silver"
    
[0m11:58:19.220701 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:58:19.221125 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m11:58:19.221294 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:58:19.221459 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m11:58:19.221707 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:58:19.221867 [debug] [ThreadPool]: On create_nhl_silver: Close
[0m11:58:19.222632 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nhl_silver, now list_nhl_silver)
[0m11:58:19.226091 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m11:58:19.226275 [debug] [ThreadPool]: On list_nhl_silver: BEGIN
[0m11:58:19.226434 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:58:19.226713 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:58:19.226871 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m11:58:19.227035 [debug] [ThreadPool]: On list_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl_silver"} */
select
      'nhl' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'silver'
    and lower(table_catalog) = 'nhl'
  
[0m11:58:19.235022 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m11:58:19.235701 [debug] [ThreadPool]: On list_nhl_silver: ROLLBACK
[0m11:58:19.236593 [debug] [ThreadPool]: Failed to rollback 'list_nhl_silver'
[0m11:58:19.236761 [debug] [ThreadPool]: On list_nhl_silver: Close
[0m11:58:19.237458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91df6f80-8795-4b3d-b514-96bfe5a72e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ee17c0>]}
[0m11:58:19.237703 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:19.237871 [debug] [MainThread]: On master: BEGIN
[0m11:58:19.238021 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:58:19.238302 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:58:19.238459 [debug] [MainThread]: On master: COMMIT
[0m11:58:19.238612 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:19.238764 [debug] [MainThread]: On master: COMMIT
[0m11:58:19.239006 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:58:19.239163 [debug] [MainThread]: On master: Close
[0m11:58:19.240310 [debug] [Thread-1  ]: Began running node model.nhl_analytics.stg_goalies
[0m11:58:19.240539 [debug] [Thread-2  ]: Began running node model.nhl_analytics.stg_skaters
[0m11:58:19.240819 [info ] [Thread-1  ]: 1 of 6 START sql view model silver.stg_goalies ................................. [RUN]
[0m11:58:19.241120 [debug] [Thread-3  ]: Began running node model.nhl_analytics.stg_teams
[0m11:58:19.241412 [info ] [Thread-2  ]: 2 of 6 START sql view model silver.stg_skaters ................................. [RUN]
[0m11:58:19.241711 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_nhl_silver, now model.nhl_analytics.stg_goalies)
[0m11:58:19.242000 [info ] [Thread-3  ]: 3 of 6 START sql view model silver.stg_teams ................................... [RUN]
[0m11:58:19.242302 [debug] [Thread-2  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_skaters'
[0m11:58:19.242520 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.stg_goalies
[0m11:58:19.242773 [debug] [Thread-3  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_teams'
[0m11:58:19.242979 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.stg_skaters
[0m11:58:19.248150 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.stg_goalies"
[0m11:58:19.248401 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.stg_teams
[0m11:58:19.250344 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.stg_skaters"
[0m11:58:19.252249 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.stg_teams"
[0m11:58:19.252636 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.stg_goalies
[0m11:58:19.271421 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.stg_skaters
[0m11:58:19.275201 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.stg_skaters"
[0m11:58:19.276010 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.stg_goalies"
[0m11:58:19.276386 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.stg_teams
[0m11:58:19.278787 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.stg_teams"
[0m11:58:19.279167 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:58:19.279423 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m11:58:19.279645 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: BEGIN
[0m11:58:19.279897 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: BEGIN
[0m11:58:19.280134 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m11:58:19.280334 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:58:19.280539 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:58:19.280739 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: BEGIN
[0m11:58:19.281121 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:58:19.281340 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m11:58:19.281583 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m11:58:19.281785 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:58:19.281998 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m11:58:19.282186 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m11:58:19.282402 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    

select
    playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position
from "nhl"."bronze"."goalies"
where playerId is not null
    and season is not null
    limit 10
  );

[0m11:58:19.282615 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m11:58:19.282840 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    

select
    playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    games_played,
    icetime as ice_time,
    I_F_goals as goals,
    I_F_points as points,
    I_F_shotsOnGoal as shots_on_goal,
    I_F_primaryAssists as primary_assists,
    I_F_secondaryAssists as secondary_assists,
    case 
        when games_played > 0 then true 
        else false 
    end as is_active_player,
    case 
        when games_played > 0 then round(I_F_points * 1.0 / games_played, 2)
        else null 
    end as points_per_game,
    case 
        when I_F_shotsOnGoal > 0 then round(I_F_goals * 100.0 / I_F_shotsOnGoal, 2)
        else null 
    end as shooting_percentage,
    current_timestamp as loaded_at
from "nhl"."bronze"."skaters"
where playerId is not null
    and season is not null
  );

[0m11:58:19.283149 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

  
  create view "nhl"."silver"."stg_teams__dbt_tmp" as (
    

select
    season,
    name as team_name,
    team as team_code,
    games_played,
    goalsFor,
    goalsAgainst,
    goalsFor - goalsAgainst as goal_differential,
    xGoalsFor,
    xGoalsAgainst,
    current_timestamp as loaded_at
from "nhl"."bronze"."teams"
where season is not null
    and name is not null
    and situation = 'all'
  );

[0m11:58:19.283447 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m11:58:19.287286 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:58:19.287539 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */
alter view "nhl"."silver"."stg_goalies" rename to "stg_goalies__dbt_backup"
[0m11:58:19.287825 [debug] [Thread-3  ]: SQL status: OK in 0.004 seconds
[0m11:58:19.288038 [debug] [Thread-2  ]: SQL status: OK in 0.005 seconds
[0m11:58:19.289987 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m11:58:19.290211 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m11:58:19.292456 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m11:58:19.292693 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */
alter view "nhl"."silver"."stg_teams" rename to "stg_teams__dbt_backup"
[0m11:58:19.294632 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:58:19.294854 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */
alter view "nhl"."silver"."stg_skaters" rename to "stg_skaters__dbt_backup"
[0m11:58:19.295151 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */
alter view "nhl"."silver"."stg_goalies__dbt_tmp" rename to "stg_goalies"
[0m11:58:19.295470 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m11:58:19.297322 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m11:58:19.297537 [debug] [Thread-2  ]: SQL status: OK in 0.002 seconds
[0m11:58:19.297750 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */
alter view "nhl"."silver"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m11:58:19.297959 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m11:58:19.299815 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m11:58:19.306948 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: COMMIT
[0m11:58:19.307182 [debug] [Thread-3  ]: SQL status: OK in 0.007 seconds
[0m11:58:19.307412 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */
alter view "nhl"."silver"."stg_skaters__dbt_tmp" rename to "stg_skaters"
[0m11:58:19.307647 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:58:19.308503 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: COMMIT
[0m11:58:19.308793 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: COMMIT
[0m11:58:19.309033 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m11:58:19.309235 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m11:58:19.309479 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: COMMIT
[0m11:58:19.310343 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: COMMIT
[0m11:58:19.310587 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m11:58:19.310824 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m11:58:19.314302 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:58:19.314511 [debug] [Thread-3  ]: SQL status: OK in 0.004 seconds
[0m11:58:19.314731 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: COMMIT
[0m11:58:19.314955 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

      drop view if exists "nhl"."silver"."stg_goalies__dbt_backup" cascade
    
[0m11:58:19.316528 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m11:58:19.316872 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

      drop view if exists "nhl"."silver"."stg_teams__dbt_backup" cascade
    
[0m11:58:19.317127 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m11:58:19.319188 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m11:58:19.319409 [debug] [Thread-1  ]: SQL status: OK in 0.003 seconds
[0m11:58:19.319622 [debug] [Thread-3  ]: SQL status: OK in 0.003 seconds
[0m11:58:19.319828 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

      drop view if exists "nhl"."silver"."stg_skaters__dbt_backup" cascade
    
[0m11:58:19.321196 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: Close
[0m11:58:19.321870 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: Close
[0m11:58:19.323519 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m11:58:19.324195 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: Close
[0m11:58:19.324591 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91df6f80-8795-4b3d-b514-96bfe5a72e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dfb610>]}
[0m11:58:19.324805 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91df6f80-8795-4b3d-b514-96bfe5a72e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118dccfd0>]}
[0m11:58:19.325046 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91df6f80-8795-4b3d-b514-96bfe5a72e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118d7db50>]}
[0m11:58:19.325346 [info ] [Thread-1  ]: 1 of 6 OK created sql view model silver.stg_goalies ............................ [[32mOK[0m in 0.08s]
[0m11:58:19.325696 [info ] [Thread-3  ]: 3 of 6 OK created sql view model silver.stg_teams .............................. [[32mOK[0m in 0.08s]
[0m11:58:19.326081 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.stg_goalies
[0m11:58:19.326364 [info ] [Thread-2  ]: 2 of 6 OK created sql view model silver.stg_skaters ............................ [[32mOK[0m in 0.08s]
[0m11:58:19.326688 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.stg_teams
[0m11:58:19.327037 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.stg_skaters
[0m11:58:19.327369 [debug] [Thread-4  ]: Began running node model.nhl_analytics.mart_team_standings
[0m11:58:19.327855 [debug] [Thread-3  ]: Began running node model.nhl_analytics.int_all_players
[0m11:58:19.327680 [info ] [Thread-4  ]: 4 of 6 START sql table model silver.mart_team_standings ........................ [RUN]
[0m11:58:19.328185 [info ] [Thread-3  ]: 5 of 6 START sql view model silver.int_all_players ............................. [RUN]
[0m11:58:19.328506 [debug] [Thread-4  ]: Acquiring new duckdb connection 'model.nhl_analytics.mart_team_standings'
[0m11:58:19.328762 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.stg_teams, now model.nhl_analytics.int_all_players)
[0m11:58:19.328980 [debug] [Thread-4  ]: Began compiling node model.nhl_analytics.mart_team_standings
[0m11:58:19.329187 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.int_all_players
[0m11:58:19.331091 [debug] [Thread-4  ]: Writing injected SQL for node "model.nhl_analytics.mart_team_standings"
[0m11:58:19.333125 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.int_all_players"
[0m11:58:19.333518 [debug] [Thread-4  ]: Began executing node model.nhl_analytics.mart_team_standings
[0m11:58:19.333742 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.int_all_players
[0m11:58:19.346043 [debug] [Thread-4  ]: Writing runtime sql for node "model.nhl_analytics.mart_team_standings"
[0m11:58:19.348730 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.int_all_players"
[0m11:58:19.349189 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m11:58:19.349433 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m11:58:19.349652 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: BEGIN
[0m11:58:19.349859 [debug] [Thread-3  ]: On model.nhl_analytics.int_all_players: BEGIN
[0m11:58:19.350050 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:58:19.350233 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m11:58:19.350648 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m11:58:19.350844 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m11:58:19.351045 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m11:58:19.351256 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

  
    
    

    create  table
      "nhl"."silver"."mart_team_standings__dbt_tmp"
  
    as (
      

select 
    season,
    team_name,
    team_code,
    games_played,
    goalsFor,
    goalsAgainst,
    goal_differential,
    xGoalsFor,
    xGoalsAgainst,
    row_number() over (order by goalsFor desc, goal_differential desc) as standings_rank,
    loaded_at
from "nhl"."silver"."stg_teams"
order by standings_rank
    );
  
  
[0m11:58:19.351468 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m11:58:19.351767 [debug] [Thread-3  ]: On model.nhl_analytics.int_all_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */

  
  create view "nhl"."silver"."int_all_players__dbt_tmp" as (
    

with all_players as (
    select 
        player_id,
        season,
        player_name,
        team_code,
        'G' as position,
        null as games_played,
        null as points_per_game,
        null as shooting_percentage
    from "nhl"."silver"."stg_goalies"
    
    union all
    
    select 
        player_id,
        season,
        player_name,
        team_code,
        position,
        games_played,
        points_per_game,
        shooting_percentage
    from "nhl"."silver"."stg_skaters"
)

select *,
    case 
        when position = 'G' then 'Goalie'
        when position in ('C', 'L', 'R', 'LW', 'RW') then 'Forward'
        when position in ('D') then 'Defense'
        else 'Unknown'
    end as position_group,
    current_timestamp as loaded_at
from all_players
  );

[0m11:58:19.352867 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m11:58:19.354878 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m11:58:19.355109 [debug] [Thread-3  ]: On model.nhl_analytics.int_all_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */
alter view "nhl"."silver"."int_all_players__dbt_tmp" rename to "int_all_players"
[0m11:58:19.355507 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m11:58:19.356359 [debug] [Thread-3  ]: On model.nhl_analytics.int_all_players: COMMIT
[0m11:58:19.356583 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m11:58:19.356798 [debug] [Thread-3  ]: On model.nhl_analytics.int_all_players: COMMIT
[0m11:58:19.357217 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m11:58:19.358853 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m11:58:19.359062 [debug] [Thread-3  ]: On model.nhl_analytics.int_all_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */

      drop view if exists "nhl"."silver"."int_all_players__dbt_backup" cascade
    
[0m11:58:19.359322 [debug] [Thread-4  ]: SQL status: OK in 0.008 seconds
[0m11:58:19.361910 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m11:58:19.362125 [debug] [Thread-3  ]: SQL status: OK in 0.003 seconds
[0m11:58:19.362368 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */
alter table "nhl"."silver"."mart_team_standings__dbt_tmp" rename to "mart_team_standings"
[0m11:58:19.363077 [debug] [Thread-3  ]: On model.nhl_analytics.int_all_players: Close
[0m11:58:19.363485 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91df6f80-8795-4b3d-b514-96bfe5a72e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1198f8be0>]}
[0m11:58:19.363761 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m11:58:19.366812 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: COMMIT
[0m11:58:19.364065 [info ] [Thread-3  ]: 5 of 6 OK created sql view model silver.int_all_players ........................ [[32mOK[0m in 0.03s]
[0m11:58:19.367095 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m11:58:19.367392 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.int_all_players
[0m11:58:19.367596 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: COMMIT
[0m11:58:19.367932 [debug] [Thread-1  ]: Began running node model.nhl_analytics.mart_player_performance
[0m11:58:19.368283 [info ] [Thread-1  ]: 6 of 6 START sql table model silver.mart_player_performance .................... [RUN]
[0m11:58:19.368558 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.stg_goalies, now model.nhl_analytics.mart_player_performance)
[0m11:58:19.368774 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m11:58:19.368989 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.mart_player_performance
[0m11:58:19.370778 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m11:58:19.372679 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.mart_player_performance"
[0m11:58:19.372920 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

      drop table if exists "nhl"."silver"."mart_team_standings__dbt_backup" cascade
    
[0m11:58:19.373306 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m11:58:19.373980 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: Close
[0m11:58:19.374303 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91df6f80-8795-4b3d-b514-96bfe5a72e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ee17c0>]}
[0m11:58:19.374595 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.mart_player_performance
[0m11:58:19.376889 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.mart_player_performance"
[0m11:58:19.377198 [info ] [Thread-4  ]: 4 of 6 OK created sql table model silver.mart_team_standings ................... [[32mOK[0m in 0.05s]
[0m11:58:19.377577 [debug] [Thread-4  ]: Finished running node model.nhl_analytics.mart_team_standings
[0m11:58:19.377901 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m11:58:19.378130 [debug] [Thread-1  ]: On model.nhl_analytics.mart_player_performance: BEGIN
[0m11:58:19.378332 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:58:19.378709 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m11:58:19.378918 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m11:58:19.379134 [debug] [Thread-1  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */

  
    
    

    create  table
      "nhl"."silver"."mart_player_performance__dbt_tmp"
  
    as (
      

select 
    player_id,
    player_name,
    team_code,
    position,
    position_group,
    games_played,
    points_per_game,
    shooting_percentage,
    case 
        when points_per_game >= 1.0 then 'Elite'
        when points_per_game >= 0.7 then 'Very Good'
        when points_per_game >= 0.5 then 'Good'
        when points_per_game >= 0.3 then 'Average'
        else 'Below Average'
    end as offensive_rating,
    loaded_at
from "nhl"."silver"."int_all_players"
where position_group in ('Forward', 'Defense')
    and games_played >= 10
    );
  
  
[0m11:58:19.385925 [debug] [Thread-1  ]: SQL status: OK in 0.007 seconds
[0m11:58:19.387952 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m11:58:19.388160 [debug] [Thread-1  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */
alter table "nhl"."silver"."mart_player_performance__dbt_tmp" rename to "mart_player_performance"
[0m11:58:19.388499 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m11:58:19.389407 [debug] [Thread-1  ]: On model.nhl_analytics.mart_player_performance: COMMIT
[0m11:58:19.389628 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m11:58:19.389818 [debug] [Thread-1  ]: On model.nhl_analytics.mart_player_performance: COMMIT
[0m11:58:19.390716 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m11:58:19.392280 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m11:58:19.392480 [debug] [Thread-1  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */

      drop table if exists "nhl"."silver"."mart_player_performance__dbt_backup" cascade
    
[0m11:58:19.392779 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m11:58:19.393471 [debug] [Thread-1  ]: On model.nhl_analytics.mart_player_performance: Close
[0m11:58:19.393786 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91df6f80-8795-4b3d-b514-96bfe5a72e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119914940>]}
[0m11:58:19.394125 [info ] [Thread-1  ]: 6 of 6 OK created sql table model silver.mart_player_performance ............... [[32mOK[0m in 0.03s]
[0m11:58:19.394509 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.mart_player_performance
[0m11:58:19.395137 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:19.395332 [debug] [MainThread]: On master: BEGIN
[0m11:58:19.395501 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:58:19.395894 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:58:19.396069 [debug] [MainThread]: On master: COMMIT
[0m11:58:19.396242 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:19.396405 [debug] [MainThread]: On master: COMMIT
[0m11:58:19.396639 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:58:19.396813 [debug] [MainThread]: On master: Close
[0m11:58:19.397020 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:58:19.397171 [debug] [MainThread]: Connection 'model.nhl_analytics.mart_player_performance' was properly closed.
[0m11:58:19.397314 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_skaters' was properly closed.
[0m11:58:19.397453 [debug] [MainThread]: Connection 'model.nhl_analytics.int_all_players' was properly closed.
[0m11:58:19.397592 [debug] [MainThread]: Connection 'model.nhl_analytics.mart_team_standings' was properly closed.
[0m11:58:19.397796 [info ] [MainThread]: 
[0m11:58:19.397992 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m11:58:19.398674 [debug] [MainThread]: Command end result
[0m11:58:19.413649 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m11:58:19.414620 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m11:58:19.418381 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/run_results.json
[0m11:58:19.418575 [info ] [MainThread]: 
[0m11:58:19.418807 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:58:19.418997 [info ] [MainThread]: 
[0m11:58:19.419195 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m11:58:19.420060 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.94032544, "process_in_blocks": "0", "process_kernel_time": 0.140823, "process_mem_max_rss": "154320896", "process_out_blocks": "0", "process_user_time": 1.611834}
[0m11:58:19.420281 [debug] [MainThread]: Command `dbt run` succeeded at 11:58:19.420240 after 0.94 seconds
[0m11:58:19.420482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fe8a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118157df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11821ea60>]}
[0m11:58:19.420686 [debug] [MainThread]: Flushing usage events
[0m11:58:19.688394 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:58:50.041638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b22af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113da74c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113da72e0>]}


============================== 11:58:50.044467 | ef92972e-f60d-43d9-b840-752d46f13af1 ==============================
[0m11:58:50.044467 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:58:50.044827 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'profiles_dir': '.', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'cache_selected_only': 'False', 'version_check': 'True', 'write_json': 'True', 'log_format': 'default', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'introspect': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt test --profiles-dir=.', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'target_path': 'None', 'warn_error': 'None', 'printer_width': '80', 'no_print': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False'}
[0m11:58:50.183285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef92972e-f60d-43d9-b840-752d46f13af1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113eafb80>]}
[0m11:58:50.219492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef92972e-f60d-43d9-b840-752d46f13af1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d65eb0>]}
[0m11:58:50.220891 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:58:50.295637 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:58:50.391192 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:58:50.391492 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:58:50.428170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef92972e-f60d-43d9-b840-752d46f13af1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1146c6130>]}
[0m11:58:50.508086 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m11:58:50.509766 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m11:58:50.526494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef92972e-f60d-43d9-b840-752d46f13af1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115012e80>]}
[0m11:58:50.526907 [info ] [MainThread]: Found 6 data tests, 6 models, 4 sources, 444 macros
[0m11:58:50.527149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef92972e-f60d-43d9-b840-752d46f13af1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114690700>]}
[0m11:58:50.528372 [info ] [MainThread]: 
[0m11:58:50.528666 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:58:50.528861 [info ] [MainThread]: 
[0m11:58:50.529178 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:58:50.565161 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl_silver'
[0m11:58:50.594684 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m11:58:50.595050 [debug] [ThreadPool]: On list_nhl_silver: BEGIN
[0m11:58:50.595316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:58:50.630343 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m11:58:50.630682 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m11:58:50.630900 [debug] [ThreadPool]: On list_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl_silver"} */
select
      'nhl' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'silver'
    and lower(table_catalog) = 'nhl'
  
[0m11:58:50.638445 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m11:58:50.639485 [debug] [ThreadPool]: On list_nhl_silver: ROLLBACK
[0m11:58:50.640836 [debug] [ThreadPool]: Failed to rollback 'list_nhl_silver'
[0m11:58:50.641056 [debug] [ThreadPool]: On list_nhl_silver: Close
[0m11:58:50.642093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef92972e-f60d-43d9-b840-752d46f13af1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104caaaf0>]}
[0m11:58:50.642405 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:50.642581 [debug] [MainThread]: On master: BEGIN
[0m11:58:50.642746 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:58:50.643073 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:58:50.643247 [debug] [MainThread]: On master: COMMIT
[0m11:58:50.643417 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:50.643581 [debug] [MainThread]: On master: COMMIT
[0m11:58:50.643838 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:58:50.644013 [debug] [MainThread]: On master: Close
[0m11:58:50.645863 [debug] [Thread-1  ]: Began running node test.nhl_analytics.source_not_null_bronze_goalies_playerId.ea8839b69c
[0m11:58:50.646108 [debug] [Thread-2  ]: Began running node test.nhl_analytics.source_not_null_bronze_goalies_season.412c0679ce
[0m11:58:50.646350 [debug] [Thread-3  ]: Began running node test.nhl_analytics.source_not_null_bronze_lines_season.c13bc81444
[0m11:58:50.646558 [debug] [Thread-4  ]: Began running node test.nhl_analytics.source_not_null_bronze_skaters_playerId.85905f90b2
[0m11:58:50.646790 [info ] [Thread-1  ]: 1 of 6 START test source_not_null_bronze_goalies_playerId ...................... [RUN]
[0m11:58:50.647064 [info ] [Thread-2  ]: 2 of 6 START test source_not_null_bronze_goalies_season ........................ [RUN]
[0m11:58:50.647358 [info ] [Thread-3  ]: 3 of 6 START test source_not_null_bronze_lines_season .......................... [RUN]
[0m11:58:50.647859 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_nhl_silver, now test.nhl_analytics.source_not_null_bronze_goalies_playerId.ea8839b69c)
[0m11:58:50.647615 [info ] [Thread-4  ]: 4 of 6 START test source_not_null_bronze_skaters_playerId ...................... [RUN]
[0m11:58:50.648228 [debug] [Thread-2  ]: Acquiring new duckdb connection 'test.nhl_analytics.source_not_null_bronze_goalies_season.412c0679ce'
[0m11:58:50.648505 [debug] [Thread-3  ]: Acquiring new duckdb connection 'test.nhl_analytics.source_not_null_bronze_lines_season.c13bc81444'
[0m11:58:50.648736 [debug] [Thread-1  ]: Began compiling node test.nhl_analytics.source_not_null_bronze_goalies_playerId.ea8839b69c
[0m11:58:50.649003 [debug] [Thread-4  ]: Acquiring new duckdb connection 'test.nhl_analytics.source_not_null_bronze_skaters_playerId.85905f90b2'
[0m11:58:50.649220 [debug] [Thread-2  ]: Began compiling node test.nhl_analytics.source_not_null_bronze_goalies_season.412c0679ce
[0m11:58:50.649437 [debug] [Thread-3  ]: Began compiling node test.nhl_analytics.source_not_null_bronze_lines_season.c13bc81444
[0m11:58:50.661097 [debug] [Thread-1  ]: Writing injected SQL for node "test.nhl_analytics.source_not_null_bronze_goalies_playerId.ea8839b69c"
[0m11:58:50.661452 [debug] [Thread-4  ]: Began compiling node test.nhl_analytics.source_not_null_bronze_skaters_playerId.85905f90b2
[0m11:58:50.665221 [debug] [Thread-2  ]: Writing injected SQL for node "test.nhl_analytics.source_not_null_bronze_goalies_season.412c0679ce"
[0m11:58:50.667961 [debug] [Thread-3  ]: Writing injected SQL for node "test.nhl_analytics.source_not_null_bronze_lines_season.c13bc81444"
[0m11:58:50.670669 [debug] [Thread-4  ]: Writing injected SQL for node "test.nhl_analytics.source_not_null_bronze_skaters_playerId.85905f90b2"
[0m11:58:50.671290 [debug] [Thread-1  ]: Began executing node test.nhl_analytics.source_not_null_bronze_goalies_playerId.ea8839b69c
[0m11:58:50.671546 [debug] [Thread-2  ]: Began executing node test.nhl_analytics.source_not_null_bronze_goalies_season.412c0679ce
[0m11:58:50.671784 [debug] [Thread-4  ]: Began executing node test.nhl_analytics.source_not_null_bronze_skaters_playerId.85905f90b2
[0m11:58:50.677506 [debug] [Thread-3  ]: Began executing node test.nhl_analytics.source_not_null_bronze_lines_season.c13bc81444
[0m11:58:50.683726 [debug] [Thread-1  ]: Writing runtime sql for node "test.nhl_analytics.source_not_null_bronze_goalies_playerId.ea8839b69c"
[0m11:58:50.685684 [debug] [Thread-2  ]: Writing runtime sql for node "test.nhl_analytics.source_not_null_bronze_goalies_season.412c0679ce"
[0m11:58:50.687466 [debug] [Thread-4  ]: Writing runtime sql for node "test.nhl_analytics.source_not_null_bronze_skaters_playerId.85905f90b2"
[0m11:58:50.689869 [debug] [Thread-3  ]: Writing runtime sql for node "test.nhl_analytics.source_not_null_bronze_lines_season.c13bc81444"
[0m11:58:50.690597 [debug] [Thread-1  ]: Using duckdb connection "test.nhl_analytics.source_not_null_bronze_goalies_playerId.ea8839b69c"
[0m11:58:50.690860 [debug] [Thread-1  ]: On test.nhl_analytics.source_not_null_bronze_goalies_playerId.ea8839b69c: BEGIN
[0m11:58:50.691119 [debug] [Thread-3  ]: Using duckdb connection "test.nhl_analytics.source_not_null_bronze_lines_season.c13bc81444"
[0m11:58:50.691374 [debug] [Thread-2  ]: Using duckdb connection "test.nhl_analytics.source_not_null_bronze_goalies_season.412c0679ce"
[0m11:58:50.691584 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:58:50.691803 [debug] [Thread-4  ]: Using duckdb connection "test.nhl_analytics.source_not_null_bronze_skaters_playerId.85905f90b2"
[0m11:58:50.692021 [debug] [Thread-3  ]: On test.nhl_analytics.source_not_null_bronze_lines_season.c13bc81444: BEGIN
[0m11:58:50.692228 [debug] [Thread-2  ]: On test.nhl_analytics.source_not_null_bronze_goalies_season.412c0679ce: BEGIN
[0m11:58:50.692581 [debug] [Thread-4  ]: On test.nhl_analytics.source_not_null_bronze_skaters_playerId.85905f90b2: BEGIN
[0m11:58:50.692808 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:58:50.693023 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m11:58:50.693227 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:58:50.693431 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:58:50.693712 [debug] [Thread-1  ]: Using duckdb connection "test.nhl_analytics.source_not_null_bronze_goalies_playerId.ea8839b69c"
[0m11:58:50.693968 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m11:58:50.694315 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m11:58:50.694584 [debug] [Thread-1  ]: On test.nhl_analytics.source_not_null_bronze_goalies_playerId.ea8839b69c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "test.nhl_analytics.source_not_null_bronze_goalies_playerId.ea8839b69c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select playerId
from "nhl"."bronze"."goalies"
where playerId is null



  
  
      
    ) dbt_internal_test
[0m11:58:50.694823 [debug] [Thread-3  ]: Using duckdb connection "test.nhl_analytics.source_not_null_bronze_lines_season.c13bc81444"
[0m11:58:50.695040 [debug] [Thread-4  ]: SQL status: OK in 0.002 seconds
[0m11:58:50.695238 [debug] [Thread-2  ]: Using duckdb connection "test.nhl_analytics.source_not_null_bronze_goalies_season.412c0679ce"
[0m11:58:50.695557 [debug] [Thread-3  ]: On test.nhl_analytics.source_not_null_bronze_lines_season.c13bc81444: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "test.nhl_analytics.source_not_null_bronze_lines_season.c13bc81444"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select season
from "nhl"."bronze"."lines"
where season is null



  
  
      
    ) dbt_internal_test
[0m11:58:50.695792 [debug] [Thread-4  ]: Using duckdb connection "test.nhl_analytics.source_not_null_bronze_skaters_playerId.85905f90b2"
[0m11:58:50.696044 [debug] [Thread-2  ]: On test.nhl_analytics.source_not_null_bronze_goalies_season.412c0679ce: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "test.nhl_analytics.source_not_null_bronze_goalies_season.412c0679ce"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select season
from "nhl"."bronze"."goalies"
where season is null



  
  
      
    ) dbt_internal_test
[0m11:58:50.696374 [debug] [Thread-4  ]: On test.nhl_analytics.source_not_null_bronze_skaters_playerId.85905f90b2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "test.nhl_analytics.source_not_null_bronze_skaters_playerId.85905f90b2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select playerId
from "nhl"."bronze"."skaters"
where playerId is null



  
  
      
    ) dbt_internal_test
[0m11:58:50.696589 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m11:58:50.696896 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m11:58:50.697152 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m11:58:50.697496 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m11:58:50.700107 [debug] [Thread-3  ]: On test.nhl_analytics.source_not_null_bronze_lines_season.c13bc81444: ROLLBACK
[0m11:58:50.700992 [debug] [Thread-2  ]: On test.nhl_analytics.source_not_null_bronze_goalies_season.412c0679ce: ROLLBACK
[0m11:58:50.701715 [debug] [Thread-1  ]: On test.nhl_analytics.source_not_null_bronze_goalies_playerId.ea8839b69c: ROLLBACK
[0m11:58:50.702582 [debug] [Thread-4  ]: On test.nhl_analytics.source_not_null_bronze_skaters_playerId.85905f90b2: ROLLBACK
[0m11:58:50.702821 [debug] [Thread-3  ]: Failed to rollback 'test.nhl_analytics.source_not_null_bronze_lines_season.c13bc81444'
[0m11:58:50.703053 [debug] [Thread-2  ]: Failed to rollback 'test.nhl_analytics.source_not_null_bronze_goalies_season.412c0679ce'
[0m11:58:50.703301 [debug] [Thread-1  ]: Failed to rollback 'test.nhl_analytics.source_not_null_bronze_goalies_playerId.ea8839b69c'
[0m11:58:50.703549 [debug] [Thread-4  ]: Failed to rollback 'test.nhl_analytics.source_not_null_bronze_skaters_playerId.85905f90b2'
[0m11:58:50.703752 [debug] [Thread-3  ]: On test.nhl_analytics.source_not_null_bronze_lines_season.c13bc81444: Close
[0m11:58:50.703967 [debug] [Thread-2  ]: On test.nhl_analytics.source_not_null_bronze_goalies_season.412c0679ce: Close
[0m11:58:50.704177 [debug] [Thread-1  ]: On test.nhl_analytics.source_not_null_bronze_goalies_playerId.ea8839b69c: Close
[0m11:58:50.704383 [debug] [Thread-4  ]: On test.nhl_analytics.source_not_null_bronze_skaters_playerId.85905f90b2: Close
[0m11:58:50.704813 [info ] [Thread-3  ]: 3 of 6 PASS source_not_null_bronze_lines_season ................................ [[32mPASS[0m in 0.06s]
[0m11:58:50.705168 [info ] [Thread-2  ]: 2 of 6 PASS source_not_null_bronze_goalies_season .............................. [[32mPASS[0m in 0.06s]
[0m11:58:50.705529 [info ] [Thread-1  ]: 1 of 6 PASS source_not_null_bronze_goalies_playerId ............................ [[32mPASS[0m in 0.06s]
[0m11:58:50.705892 [debug] [Thread-3  ]: Finished running node test.nhl_analytics.source_not_null_bronze_lines_season.c13bc81444
[0m11:58:50.706234 [info ] [Thread-4  ]: 4 of 6 PASS source_not_null_bronze_skaters_playerId ............................ [[32mPASS[0m in 0.06s]
[0m11:58:50.706597 [debug] [Thread-2  ]: Finished running node test.nhl_analytics.source_not_null_bronze_goalies_season.412c0679ce
[0m11:58:50.706919 [debug] [Thread-1  ]: Finished running node test.nhl_analytics.source_not_null_bronze_goalies_playerId.ea8839b69c
[0m11:58:50.707178 [debug] [Thread-3  ]: Began running node test.nhl_analytics.source_not_null_bronze_skaters_season.0f5502a7cb
[0m11:58:50.707516 [debug] [Thread-4  ]: Finished running node test.nhl_analytics.source_not_null_bronze_skaters_playerId.85905f90b2
[0m11:58:50.707752 [debug] [Thread-2  ]: Began running node test.nhl_analytics.source_not_null_bronze_teams_season.9d88656159
[0m11:58:50.708056 [info ] [Thread-3  ]: 5 of 6 START test source_not_null_bronze_skaters_season ........................ [RUN]
[0m11:58:50.708362 [info ] [Thread-2  ]: 6 of 6 START test source_not_null_bronze_teams_season .......................... [RUN]
[0m11:58:50.708664 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.nhl_analytics.source_not_null_bronze_lines_season.c13bc81444, now test.nhl_analytics.source_not_null_bronze_skaters_season.0f5502a7cb)
[0m11:58:50.708910 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.nhl_analytics.source_not_null_bronze_goalies_season.412c0679ce, now test.nhl_analytics.source_not_null_bronze_teams_season.9d88656159)
[0m11:58:50.709142 [debug] [Thread-3  ]: Began compiling node test.nhl_analytics.source_not_null_bronze_skaters_season.0f5502a7cb
[0m11:58:50.709347 [debug] [Thread-2  ]: Began compiling node test.nhl_analytics.source_not_null_bronze_teams_season.9d88656159
[0m11:58:50.712871 [debug] [Thread-3  ]: Writing injected SQL for node "test.nhl_analytics.source_not_null_bronze_skaters_season.0f5502a7cb"
[0m11:58:50.715788 [debug] [Thread-2  ]: Writing injected SQL for node "test.nhl_analytics.source_not_null_bronze_teams_season.9d88656159"
[0m11:58:50.716358 [debug] [Thread-3  ]: Began executing node test.nhl_analytics.source_not_null_bronze_skaters_season.0f5502a7cb
[0m11:58:50.716606 [debug] [Thread-2  ]: Began executing node test.nhl_analytics.source_not_null_bronze_teams_season.9d88656159
[0m11:58:50.718531 [debug] [Thread-3  ]: Writing runtime sql for node "test.nhl_analytics.source_not_null_bronze_skaters_season.0f5502a7cb"
[0m11:58:50.720323 [debug] [Thread-2  ]: Writing runtime sql for node "test.nhl_analytics.source_not_null_bronze_teams_season.9d88656159"
[0m11:58:50.720816 [debug] [Thread-2  ]: Using duckdb connection "test.nhl_analytics.source_not_null_bronze_teams_season.9d88656159"
[0m11:58:50.721067 [debug] [Thread-3  ]: Using duckdb connection "test.nhl_analytics.source_not_null_bronze_skaters_season.0f5502a7cb"
[0m11:58:50.721294 [debug] [Thread-2  ]: On test.nhl_analytics.source_not_null_bronze_teams_season.9d88656159: BEGIN
[0m11:58:50.721521 [debug] [Thread-3  ]: On test.nhl_analytics.source_not_null_bronze_skaters_season.0f5502a7cb: BEGIN
[0m11:58:50.721733 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:58:50.721939 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m11:58:50.722401 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m11:58:50.722614 [debug] [Thread-2  ]: Using duckdb connection "test.nhl_analytics.source_not_null_bronze_teams_season.9d88656159"
[0m11:58:50.722822 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m11:58:50.723033 [debug] [Thread-2  ]: On test.nhl_analytics.source_not_null_bronze_teams_season.9d88656159: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "test.nhl_analytics.source_not_null_bronze_teams_season.9d88656159"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select season
from "nhl"."bronze"."teams"
where season is null



  
  
      
    ) dbt_internal_test
[0m11:58:50.723257 [debug] [Thread-3  ]: Using duckdb connection "test.nhl_analytics.source_not_null_bronze_skaters_season.0f5502a7cb"
[0m11:58:50.723573 [debug] [Thread-3  ]: On test.nhl_analytics.source_not_null_bronze_skaters_season.0f5502a7cb: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "test.nhl_analytics.source_not_null_bronze_skaters_season.0f5502a7cb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select season
from "nhl"."bronze"."skaters"
where season is null



  
  
      
    ) dbt_internal_test
[0m11:58:50.723973 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m11:58:50.724199 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m11:58:50.725093 [debug] [Thread-2  ]: On test.nhl_analytics.source_not_null_bronze_teams_season.9d88656159: ROLLBACK
[0m11:58:50.725909 [debug] [Thread-3  ]: On test.nhl_analytics.source_not_null_bronze_skaters_season.0f5502a7cb: ROLLBACK
[0m11:58:50.726180 [debug] [Thread-2  ]: Failed to rollback 'test.nhl_analytics.source_not_null_bronze_teams_season.9d88656159'
[0m11:58:50.726435 [debug] [Thread-3  ]: Failed to rollback 'test.nhl_analytics.source_not_null_bronze_skaters_season.0f5502a7cb'
[0m11:58:50.726638 [debug] [Thread-2  ]: On test.nhl_analytics.source_not_null_bronze_teams_season.9d88656159: Close
[0m11:58:50.726846 [debug] [Thread-3  ]: On test.nhl_analytics.source_not_null_bronze_skaters_season.0f5502a7cb: Close
[0m11:58:50.727227 [info ] [Thread-2  ]: 6 of 6 PASS source_not_null_bronze_teams_season ................................ [[32mPASS[0m in 0.02s]
[0m11:58:50.727521 [info ] [Thread-3  ]: 5 of 6 PASS source_not_null_bronze_skaters_season .............................. [[32mPASS[0m in 0.02s]
[0m11:58:50.727932 [debug] [Thread-2  ]: Finished running node test.nhl_analytics.source_not_null_bronze_teams_season.9d88656159
[0m11:58:50.728225 [debug] [Thread-3  ]: Finished running node test.nhl_analytics.source_not_null_bronze_skaters_season.0f5502a7cb
[0m11:58:50.729098 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:50.729293 [debug] [MainThread]: On master: BEGIN
[0m11:58:50.729463 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:58:50.730000 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:58:50.730183 [debug] [MainThread]: On master: COMMIT
[0m11:58:50.730358 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:50.730562 [debug] [MainThread]: On master: COMMIT
[0m11:58:50.730946 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:58:50.731222 [debug] [MainThread]: On master: Close
[0m11:58:50.731474 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:58:50.731644 [debug] [MainThread]: Connection 'test.nhl_analytics.source_not_null_bronze_goalies_playerId.ea8839b69c' was properly closed.
[0m11:58:50.731803 [debug] [MainThread]: Connection 'test.nhl_analytics.source_not_null_bronze_teams_season.9d88656159' was properly closed.
[0m11:58:50.731958 [debug] [MainThread]: Connection 'test.nhl_analytics.source_not_null_bronze_skaters_season.0f5502a7cb' was properly closed.
[0m11:58:50.732111 [debug] [MainThread]: Connection 'test.nhl_analytics.source_not_null_bronze_skaters_playerId.85905f90b2' was properly closed.
[0m11:58:50.732307 [info ] [MainThread]: 
[0m11:58:50.732525 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m11:58:50.733710 [debug] [MainThread]: Command end result
[0m11:58:50.750629 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m11:58:50.751934 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m11:58:50.756831 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/run_results.json
[0m11:58:50.757116 [info ] [MainThread]: 
[0m11:58:50.757389 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:58:50.757591 [info ] [MainThread]: 
[0m11:58:50.757796 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m11:58:50.758779 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.76209885, "process_in_blocks": "0", "process_kernel_time": 0.166365, "process_mem_max_rss": "144228352", "process_out_blocks": "0", "process_user_time": 1.416368}
[0m11:58:50.759032 [debug] [MainThread]: Command `dbt test` succeeded at 11:58:50.758985 after 0.76 seconds
[0m11:58:50.759265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b22af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d65eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114254190>]}
[0m11:58:50.759504 [debug] [MainThread]: Flushing usage events
[0m11:58:50.905655 [debug] [MainThread]: An error was encountered while trying to flush usage events

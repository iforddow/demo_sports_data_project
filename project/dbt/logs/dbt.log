[0m11:52:37.967227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103334a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043a9a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043a9880>]}


============================== 11:52:37.970261 | 254a1479-af55-4bcd-964c-96ae97bb237c ==============================
[0m11:52:37.970261 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:52:37.970632 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'printer_width': '80', 'empty': 'None', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'use_colors': 'True', 'quiet': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt debug --profiles-dir=.', 'log_cache_events': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'debug': 'False', 'introspect': 'True', 'write_json': 'True', 'warn_error': 'None', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True'}
[0m11:52:37.978492 [info ] [MainThread]: dbt version: 1.10.13
[0m11:52:37.978749 [info ] [MainThread]: python version: 3.9.6
[0m11:52:37.978936 [info ] [MainThread]: python path: /Users/izaakford/Desktop/demo_sports_data_project/.venv/bin/python
[0m11:52:37.979125 [info ] [MainThread]: os info: macOS-15.3.2-arm64-arm-64bit
[0m11:52:38.101959 [info ] [MainThread]: Using profiles dir at .
[0m11:52:38.102283 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m11:52:38.102476 [info ] [MainThread]: Using dbt_project.yml file at /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/dbt_project.yml
[0m11:52:38.103527 [info ] [MainThread]: adapter type: duckdb
[0m11:52:38.103720 [info ] [MainThread]: adapter version: 1.9.6
[0m11:52:38.163738 [info ] [MainThread]: Configuration:
[0m11:52:38.164051 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:52:38.164257 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:52:38.164442 [info ] [MainThread]: Required dependencies:
[0m11:52:38.164668 [debug] [MainThread]: Executing "git --help"
[0m11:52:38.180092 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:52:38.180642 [debug] [MainThread]: STDERR: "b''"
[0m11:52:38.180881 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:52:38.181120 [info ] [MainThread]: Connection:
[0m11:52:38.181356 [info ] [MainThread]:   database: nhl
[0m11:52:38.181534 [info ] [MainThread]:   schema: silver
[0m11:52:38.181700 [info ] [MainThread]:   path: ../nhl.duckdb
[0m11:52:38.181867 [info ] [MainThread]:   config_options: None
[0m11:52:38.182034 [info ] [MainThread]:   extensions: ['httpfs', 'parquet']
[0m11:52:38.182198 [info ] [MainThread]:   settings: {}
[0m11:52:38.182360 [info ] [MainThread]:   external_root: .
[0m11:52:38.182527 [info ] [MainThread]:   use_credential_provider: None
[0m11:52:38.182692 [info ] [MainThread]:   attach: None
[0m11:52:38.183140 [info ] [MainThread]:   filesystems: None
[0m11:52:38.183430 [info ] [MainThread]:   remote: None
[0m11:52:38.183666 [info ] [MainThread]:   plugins: None
[0m11:52:38.183856 [info ] [MainThread]:   disable_transactions: False
[0m11:52:38.184249 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:52:38.252188 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m11:52:38.281616 [debug] [MainThread]: Using duckdb connection "debug"
[0m11:52:38.281841 [debug] [MainThread]: On debug: select 1 as id
[0m11:52:38.282004 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:52:39.017629 [debug] [MainThread]: SQL status: OK in 0.736 seconds
[0m11:52:39.018298 [debug] [MainThread]: On debug: Close
[0m11:52:39.018768 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:52:39.019019 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:52:39.019965 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.0985439, "process_in_blocks": "0", "process_kernel_time": 0.201899, "process_mem_max_rss": "168116224", "process_out_blocks": "0", "process_user_time": 0.985561}
[0m11:52:39.020234 [debug] [MainThread]: Command `dbt debug` succeeded at 11:52:39.020176 after 1.10 seconds
[0m11:52:39.020432 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:52:39.020639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103334a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10463b070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103601b80>]}
[0m11:52:39.020908 [debug] [MainThread]: Flushing usage events
[0m11:52:39.264982 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:52:45.180529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109728a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9e8490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9e82b0>]}


============================== 11:52:45.182669 | f0edd01d-099b-4759-9096-9097e9331898 ==============================
[0m11:52:45.182669 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:52:45.183013 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'version_check': 'True', 'write_json': 'True', 'target_path': 'None', 'printer_width': '80', 'log_cache_events': 'False', 'profiles_dir': '.', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'empty': 'False', 'quiet': 'False', 'invocation_command': 'dbt run --profiles-dir=.', 'cache_selected_only': 'False', 'no_print': 'None', 'warn_error': 'None', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'indirect_selection': 'eager', 'log_format': 'default', 'use_experimental_parser': 'False', 'static_parser': 'True', 'use_colors': 'True'}
[0m11:52:45.305387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0edd01d-099b-4759-9096-9097e9331898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b55f10>]}
[0m11:52:45.339451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0edd01d-099b-4759-9096-9097e9331898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aaac970>]}
[0m11:52:45.340473 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:52:45.407945 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:52:45.408409 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:52:45.408644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f0edd01d-099b-4759-9096-9097e9331898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af01e50>]}
[0m11:52:46.259994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0edd01d-099b-4759-9096-9097e9331898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1ab130>]}
[0m11:52:46.348660 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m11:52:46.350106 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m11:52:46.363684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0edd01d-099b-4759-9096-9097e9331898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2bd310>]}
[0m11:52:46.364119 [info ] [MainThread]: Found 11 models, 10 data tests, 4 sources, 444 macros
[0m11:52:46.364370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0edd01d-099b-4759-9096-9097e9331898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c144040>]}
[0m11:52:46.365552 [info ] [MainThread]: 
[0m11:52:46.365780 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:52:46.365967 [info ] [MainThread]: 
[0m11:52:46.366258 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:52:46.369922 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl'
[0m11:52:46.396852 [debug] [ThreadPool]: Using duckdb connection "list_nhl"
[0m11:52:46.397101 [debug] [ThreadPool]: On list_nhl: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m11:52:46.397273 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:52:46.424656 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m11:52:46.425864 [debug] [ThreadPool]: On list_nhl: Close
[0m11:52:46.426250 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nhl, now create_nhl_silver)
[0m11:52:46.426513 [debug] [ThreadPool]: Creating schema "database: "nhl"
schema: "silver"
"
[0m11:52:46.430829 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:52:46.431027 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nhl'
        and type='sqlite'
    
  
[0m11:52:46.431191 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:52:46.431798 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:52:46.432609 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:52:46.432794 [debug] [ThreadPool]: On create_nhl_silver: BEGIN
[0m11:52:46.433048 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:52:46.433215 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:52:46.433385 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
    
        create schema if not exists "nhl"."silver"
    
[0m11:52:46.433647 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:52:46.434087 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m11:52:46.434250 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:52:46.434399 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m11:52:46.435049 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:52:46.435224 [debug] [ThreadPool]: On create_nhl_silver: Close
[0m11:52:46.436225 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nhl_silver, now list_nhl_silver)
[0m11:52:46.439765 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m11:52:46.439948 [debug] [ThreadPool]: On list_nhl_silver: BEGIN
[0m11:52:46.440107 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:52:46.440431 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:52:46.440646 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m11:52:46.440830 [debug] [ThreadPool]: On list_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl_silver"} */
select
      'nhl' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'silver'
    and lower(table_catalog) = 'nhl'
  
[0m11:52:46.450586 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m11:52:46.451280 [debug] [ThreadPool]: On list_nhl_silver: ROLLBACK
[0m11:52:46.452433 [debug] [ThreadPool]: Failed to rollback 'list_nhl_silver'
[0m11:52:46.452608 [debug] [ThreadPool]: On list_nhl_silver: Close
[0m11:52:46.452916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0edd01d-099b-4759-9096-9097e9331898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a948790>]}
[0m11:52:46.453205 [debug] [MainThread]: Using duckdb connection "master"
[0m11:52:46.453373 [debug] [MainThread]: On master: BEGIN
[0m11:52:46.453526 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:52:46.453802 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:52:46.453975 [debug] [MainThread]: On master: COMMIT
[0m11:52:46.454138 [debug] [MainThread]: Using duckdb connection "master"
[0m11:52:46.454286 [debug] [MainThread]: On master: COMMIT
[0m11:52:46.454532 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:52:46.454700 [debug] [MainThread]: On master: Close
[0m11:52:46.457426 [debug] [Thread-1  ]: Began running node model.nhl_analytics.int_all_players
[0m11:52:46.457672 [debug] [Thread-2  ]: Began running node model.nhl_analytics.int_team_performance
[0m11:52:46.458164 [debug] [Thread-3  ]: Began running node model.nhl_analytics.mart_goalie_performance
[0m11:52:46.457978 [info ] [Thread-1  ]: 1 of 11 START sql view model silver.int_all_players ............................ [RUN]
[0m11:52:46.458437 [debug] [Thread-4  ]: Began running node model.nhl_analytics.mart_player_performance
[0m11:52:46.458705 [info ] [Thread-2  ]: 2 of 11 START sql view model silver.int_team_performance ....................... [RUN]
[0m11:52:46.459016 [info ] [Thread-3  ]: 3 of 11 START sql table model silver.mart_goalie_performance ................... [RUN]
[0m11:52:46.459300 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_nhl_silver, now model.nhl_analytics.int_all_players)
[0m11:52:46.459569 [info ] [Thread-4  ]: 4 of 11 START sql table model silver.mart_player_performance ................... [RUN]
[0m11:52:46.459862 [debug] [Thread-2  ]: Acquiring new duckdb connection 'model.nhl_analytics.int_team_performance'
[0m11:52:46.460137 [debug] [Thread-3  ]: Acquiring new duckdb connection 'model.nhl_analytics.mart_goalie_performance'
[0m11:52:46.460344 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.int_all_players
[0m11:52:46.460601 [debug] [Thread-4  ]: Acquiring new duckdb connection 'model.nhl_analytics.mart_player_performance'
[0m11:52:46.460800 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.int_team_performance
[0m11:52:46.461003 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.mart_goalie_performance
[0m11:52:46.466180 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.int_all_players"
[0m11:52:46.466424 [debug] [Thread-4  ]: Began compiling node model.nhl_analytics.mart_player_performance
[0m11:52:46.467744 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.int_team_performance"
[0m11:52:46.469032 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.mart_goalie_performance"
[0m11:52:46.470434 [debug] [Thread-4  ]: Writing injected SQL for node "model.nhl_analytics.mart_player_performance"
[0m11:52:46.471158 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.int_all_players
[0m11:52:46.483803 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.mart_goalie_performance
[0m11:52:46.490013 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.int_all_players"
[0m11:52:46.490258 [debug] [Thread-4  ]: Began executing node model.nhl_analytics.mart_player_performance
[0m11:52:46.496621 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.int_team_performance
[0m11:52:46.503541 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.mart_goalie_performance"
[0m11:52:46.505673 [debug] [Thread-4  ]: Writing runtime sql for node "model.nhl_analytics.mart_player_performance"
[0m11:52:46.507810 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.int_team_performance"
[0m11:52:46.508738 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m11:52:46.509034 [debug] [Thread-4  ]: On model.nhl_analytics.mart_player_performance: BEGIN
[0m11:52:46.509260 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:52:46.509502 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m11:52:46.509726 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.int_team_performance"
[0m11:52:46.510084 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m11:52:46.510297 [debug] [Thread-1  ]: On model.nhl_analytics.int_all_players: BEGIN
[0m11:52:46.510511 [debug] [Thread-2  ]: On model.nhl_analytics.int_team_performance: BEGIN
[0m11:52:46.510721 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m11:52:46.510918 [debug] [Thread-3  ]: On model.nhl_analytics.mart_goalie_performance: BEGIN
[0m11:52:46.511125 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:52:46.511340 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:52:46.511561 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m11:52:46.511771 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:52:46.512158 [debug] [Thread-4  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */

  
    
    

    create  table
      "nhl"."silver"."mart_player_performance__dbt_tmp"
  
    as (
      { { config(materialized = 'table') } }
select player_id,
    player_name,
    team_code,
    position,
    position_group,
    games_played,
    points_per_game,
    shooting_percentage,
    faceoff_percentage,
    case
        when points_per_game >= 1.0 then 'Elite'
        when points_per_game >= 0.7 then 'Very Good'
        when points_per_game >= 0.5 then 'Good'
        when points_per_game >= 0.3 then 'Average'
        else 'Below Average'
    end as offensive_rating,
    case
        when shooting_percentage >= 15 then 'Elite Shooter'
        when shooting_percentage >= 12 then 'Good Shooter'
        when shooting_percentage >= 10 then 'Average Shooter'
        else 'Below Average Shooter'
    end as shooting_rating,
    is_active,
    loaded_at
from { { ref('int_all_players') } }
where position_group in ('Forward', 'Defense')
    and is_active = true
    and games_played >= 10
    );
  
  
[0m11:52:46.512400 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m11:52:46.512642 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m11:52:46.515524 [debug] [Thread-4  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */

  
    
    

    create  table
      "nhl"."silver"."mart_player_performance__dbt_tmp"
  
    as (
      { { config(materialized = 'table') } }
select player_id,
    player_name,
    team_code,
    position,
    position_group,
    games_played,
    points_per_game,
    shooting_percentage,
    faceoff_percentage,
    case
        when points_per_game >= 1.0 then 'Elite'
        when points_per_game >= 0.7 then 'Very Good'
        when points_per_game >= 0.5 then 'Good'
        when points_per_game >= 0.3 then 'Average'
        else 'Below Average'
    end as offensive_rating,
    case
        when shooting_percentage >= 15 then 'Elite Shooter'
        when shooting_percentage >= 12 then 'Good Shooter'
        when shooting_percentage >= 10 then 'Average Shooter'
        else 'Below Average Shooter'
    end as shooting_rating,
    is_active,
    loaded_at
from { { ref('int_all_players') } }
where position_group in ('Forward', 'Defense')
    and is_active = true
    and games_played >= 10
    );
  
  
[0m11:52:46.515751 [debug] [Thread-3  ]: SQL status: OK in 0.004 seconds
[0m11:52:46.515942 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m11:52:46.516155 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.int_team_performance"
[0m11:52:46.516356 [debug] [Thread-4  ]: DuckDB adapter: Rolling back transaction.
[0m11:52:46.516550 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m11:52:46.516779 [debug] [Thread-1  ]: On model.nhl_analytics.int_all_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */

  
  create view "nhl"."silver"."int_all_players__dbt_tmp" as (
    { { config(materialized = 'view') } } with all_players as (
    select player_id,
        season,
        player_name,
        team_code,
        'G' as position,
        games_played,
        points_per_game,
        null as shooting_percentage,
        null as faceoff_percentage,
        save_percentage,
        goals_against_average,
        is_active_goalie as is_active,
        loaded_at
    from { { ref('stg_goalies') } }
    union all
    select player_id,
        season,
        player_name,
        team_code,
        position,
        games_played,
        points_per_game,
        shooting_percentage,
        faceoff_percentage,
        null as save_percentage,
        null as goals_against_average,
        is_active_player as is_active,
        loaded_at
    from { { ref('stg_skaters') } }
)
select *,
    case
        when position = 'G' then 'Goalie'
        when position in ('C', 'L', 'R', 'LW', 'RW') then 'Forward'
        when position in ('D') then 'Defense'
        else 'Unknown'
    end as position_group
from all_players
  );

[0m11:52:46.517033 [debug] [Thread-2  ]: On model.nhl_analytics.int_team_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_team_performance"} */

  
  create view "nhl"."silver"."int_team_performance__dbt_tmp" as (
    { { config(materialized = 'view') } } with team_stats as (
    select *,
        row_number() over (
            order by team_points desc,
                points_percentage desc
        ) as standings_rank
    from { { ref('stg_teams') } }
),
team_performance as (
    select *,
        case
            when standings_rank <= 8 then 'Playoff Position'
            when standings_rank <= 16 then 'Wild Card Contention'
            else 'Rebuilding'
        end as team_category,
        goals_per_game - goals_against_per_game as goal_differential_per_game
    from team_stats
)
select *
from team_performance
  );

[0m11:52:46.517313 [debug] [Thread-4  ]: On model.nhl_analytics.mart_player_performance: ROLLBACK
[0m11:52:46.517551 [debug] [Thread-3  ]: On model.nhl_analytics.mart_goalie_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */

  
    
    

    create  table
      "nhl"."silver"."mart_goalie_performance__dbt_tmp"
  
    as (
      { { config(materialized = 'table') } }
select player_id,
    player_name,
    team_code,
    games_played,
    save_percentage,
    goals_against_average,
    case
        when save_percentage >= 0.925 then 'Elite'
        when save_percentage >= 0.915 then 'Very Good'
        when save_percentage >= 0.905 then 'Good'
        when save_percentage >= 0.895 then 'Average'
        else 'Below Average'
    end as goalie_rating,
    case
        when goals_against_average <= 2.2 then 'Elite'
        when goals_against_average <= 2.5 then 'Very Good'
        when goals_against_average <= 2.8 then 'Good'
        when goals_against_average <= 3.2 then 'Average'
        else 'Below Average'
    end as gaa_rating,
    is_active,
    loaded_at
from { { ref('int_all_players') } }
where position_group = 'Goalie'
    and is_active = true
    and games_played >= 10
    );
  
  
[0m11:52:46.517956 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */

  
  create view "nhl"."silver"."int_all_players__dbt_tmp" as (
    { { config(materialized = 'view') } } with all_players as (
    select player_id,
        season,
        player_name,
        team_code,
        'G' as position,
        games_played,
        points_per_game,
        null as shooting_percentage,
        null as faceoff_percentage,
        save_percentage,
        goals_against_average,
        is_active_goalie as is_active,
        loaded_at
    from { { ref('stg_goalies') } }
    union all
    select player_id,
        season,
        player_name,
        team_code,
        position,
        games_played,
        points_per_game,
        shooting_percentage,
        faceoff_percentage,
        null as save_percentage,
        null as goals_against_average,
        is_active_player as is_active,
        loaded_at
    from { { ref('stg_skaters') } }
)
select *,
    case
        when position = 'G' then 'Goalie'
        when position in ('C', 'L', 'R', 'LW', 'RW') then 'Forward'
        when position in ('D') then 'Defense'
        else 'Unknown'
    end as position_group
from all_players
  );

[0m11:52:46.518343 [debug] [Thread-2  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_team_performance"} */

  
  create view "nhl"."silver"."int_team_performance__dbt_tmp" as (
    { { config(materialized = 'view') } } with team_stats as (
    select *,
        row_number() over (
            order by team_points desc,
                points_percentage desc
        ) as standings_rank
    from { { ref('stg_teams') } }
),
team_performance as (
    select *,
        case
            when standings_rank <= 8 then 'Playoff Position'
            when standings_rank <= 16 then 'Wild Card Contention'
            else 'Rebuilding'
        end as team_category,
        goals_per_game - goals_against_per_game as goal_differential_per_game
    from team_stats
)
select *
from team_performance
  );

[0m11:52:46.520338 [debug] [Thread-3  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */

  
    
    

    create  table
      "nhl"."silver"."mart_goalie_performance__dbt_tmp"
  
    as (
      { { config(materialized = 'table') } }
select player_id,
    player_name,
    team_code,
    games_played,
    save_percentage,
    goals_against_average,
    case
        when save_percentage >= 0.925 then 'Elite'
        when save_percentage >= 0.915 then 'Very Good'
        when save_percentage >= 0.905 then 'Good'
        when save_percentage >= 0.895 then 'Average'
        else 'Below Average'
    end as goalie_rating,
    case
        when goals_against_average <= 2.2 then 'Elite'
        when goals_against_average <= 2.5 then 'Very Good'
        when goals_against_average <= 2.8 then 'Good'
        when goals_against_average <= 3.2 then 'Average'
        else 'Below Average'
    end as gaa_rating,
    is_active,
    loaded_at
from { { ref('int_all_players') } }
where position_group = 'Goalie'
    and is_active = true
    and games_played >= 10
    );
  
  
[0m11:52:46.520583 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m11:52:46.520799 [debug] [Thread-2  ]: DuckDB adapter: Rolling back transaction.
[0m11:52:46.521022 [debug] [Thread-3  ]: DuckDB adapter: Rolling back transaction.
[0m11:52:46.521334 [debug] [Thread-1  ]: On model.nhl_analytics.int_all_players: ROLLBACK
[0m11:52:46.521608 [debug] [Thread-2  ]: On model.nhl_analytics.int_team_performance: ROLLBACK
[0m11:52:46.523036 [debug] [Thread-3  ]: On model.nhl_analytics.mart_goalie_performance: ROLLBACK
[0m11:52:46.562419 [debug] [Thread-2  ]: Failed to rollback 'model.nhl_analytics.int_team_performance'
[0m11:52:46.562678 [debug] [Thread-2  ]: On model.nhl_analytics.int_team_performance: Close
[0m11:52:46.563125 [debug] [Thread-4  ]: Failed to rollback 'model.nhl_analytics.mart_player_performance'
[0m11:52:46.563563 [debug] [Thread-3  ]: Failed to rollback 'model.nhl_analytics.mart_goalie_performance'
[0m11:52:46.563920 [debug] [Thread-4  ]: On model.nhl_analytics.mart_player_performance: Close
[0m11:52:46.564324 [debug] [Thread-1  ]: Failed to rollback 'model.nhl_analytics.int_all_players'
[0m11:52:46.564534 [debug] [Thread-3  ]: On model.nhl_analytics.mart_goalie_performance: Close
[0m11:52:46.564807 [debug] [Thread-1  ]: On model.nhl_analytics.int_all_players: Close
[0m11:52:46.567727 [debug] [Thread-2  ]: Runtime Error in model int_team_performance (models/intermediate/int_team_performance.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } } with team_stats as (
              ^
[0m11:52:46.571257 [debug] [Thread-4  ]: Runtime Error in model mart_player_performance (models/marts/mart_player_performance.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 11:       { { config(materialized = 'table') } }
                 ^
[0m11:52:46.573997 [debug] [Thread-3  ]: Runtime Error in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 11:       { { config(materialized = 'table') } }
                 ^
[0m11:52:46.574292 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0edd01d-099b-4759-9096-9097e9331898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099a7880>]}
[0m11:52:46.574492 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0edd01d-099b-4759-9096-9097e9331898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b25e970>]}
[0m11:52:46.574695 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0edd01d-099b-4759-9096-9097e9331898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b41aca0>]}
[0m11:52:46.577371 [debug] [Thread-1  ]: Runtime Error in model int_all_players (models/intermediate/int_all_players.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } } with all_players as (
              ^
[0m11:52:46.577702 [error] [Thread-2  ]: 2 of 11 ERROR creating sql view model silver.int_team_performance .............. [[31mERROR[0m in 0.11s]
[0m11:52:46.578114 [error] [Thread-4  ]: 4 of 11 ERROR creating sql table model silver.mart_player_performance .......... [[31mERROR[0m in 0.11s]
[0m11:52:46.578698 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0edd01d-099b-4759-9096-9097e9331898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6a9400>]}
[0m11:52:46.578477 [error] [Thread-3  ]: 3 of 11 ERROR creating sql table model silver.mart_goalie_performance .......... [[31mERROR[0m in 0.11s]
[0m11:52:46.579063 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.int_team_performance
[0m11:52:46.579374 [debug] [Thread-4  ]: Finished running node model.nhl_analytics.mart_player_performance
[0m11:52:46.579954 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.mart_goalie_performance
[0m11:52:46.579702 [error] [Thread-1  ]: 1 of 11 ERROR creating sql view model silver.int_all_players ................... [[31mERROR[0m in 0.12s]
[0m11:52:46.580241 [debug] [Thread-2  ]: Began running node model.nhl_analytics.mart_team_standings
[0m11:52:46.580496 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.int_team_performance' to be skipped because of status 'error'.  Reason: Runtime Error in model int_team_performance (models/intermediate/int_team_performance.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } } with team_stats as (
              ^.
[0m11:52:46.580720 [debug] [Thread-4  ]: Began running node model.nhl_analytics.my_first_dbt_model
[0m11:52:46.580936 [debug] [Thread-3  ]: Began running node model.nhl_analytics.stg_goalies
[0m11:52:46.581214 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.int_all_players
[0m11:52:46.581463 [info ] [Thread-2  ]: 5 of 11 START sql table model silver.mart_team_standings ....................... [RUN]
[0m11:52:46.581769 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.mart_player_performance' to be skipped because of status 'error'.  Reason: Runtime Error in model mart_player_performance (models/marts/mart_player_performance.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 11:       { { config(materialized = 'table') } }
                 ^.
[0m11:52:46.582019 [info ] [Thread-4  ]: 6 of 11 START sql table model silver.my_first_dbt_model ........................ [RUN]
[0m11:52:46.582292 [info ] [Thread-3  ]: 7 of 11 START sql view model silver.stg_goalies ................................ [RUN]
[0m11:52:46.582532 [debug] [Thread-1  ]: Began running node model.nhl_analytics.stg_lines
[0m11:52:46.582760 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.int_team_performance, now model.nhl_analytics.mart_team_standings)
[0m11:52:46.583033 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.mart_goalie_performance' to be skipped because of status 'error'.  Reason: Runtime Error in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 11:       { { config(materialized = 'table') } }
                 ^.
[0m11:52:46.583251 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.mart_player_performance, now model.nhl_analytics.my_first_dbt_model)
[0m11:52:46.583484 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.mart_goalie_performance, now model.nhl_analytics.stg_goalies)
[0m11:52:46.583775 [info ] [Thread-1  ]: 8 of 11 START sql view model silver.stg_lines .................................. [RUN]
[0m11:52:46.584044 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.mart_team_standings
[0m11:52:46.584350 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.int_all_players' to be skipped because of status 'error'.  Reason: Runtime Error in model int_all_players (models/intermediate/int_all_players.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } } with all_players as (
              ^.
[0m11:52:46.584584 [debug] [Thread-4  ]: Began compiling node model.nhl_analytics.my_first_dbt_model
[0m11:52:46.584794 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.stg_goalies
[0m11:52:46.585030 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.int_all_players, now model.nhl_analytics.stg_lines)
[0m11:52:46.586536 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.mart_team_standings"
[0m11:52:46.588342 [debug] [Thread-4  ]: Writing injected SQL for node "model.nhl_analytics.my_first_dbt_model"
[0m11:52:46.589593 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.stg_goalies"
[0m11:52:46.589799 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.stg_lines
[0m11:52:46.591465 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.stg_lines"
[0m11:52:46.591727 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.mart_team_standings
[0m11:52:46.594659 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.mart_team_standings"
[0m11:52:46.594959 [debug] [Thread-4  ]: Began executing node model.nhl_analytics.my_first_dbt_model
[0m11:52:46.595195 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.stg_lines
[0m11:52:46.595397 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.stg_goalies
[0m11:52:46.597717 [debug] [Thread-4  ]: Writing runtime sql for node "model.nhl_analytics.my_first_dbt_model"
[0m11:52:46.600175 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.stg_lines"
[0m11:52:46.602559 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.stg_goalies"
[0m11:52:46.602833 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m11:52:46.603243 [debug] [Thread-2  ]: On model.nhl_analytics.mart_team_standings: BEGIN
[0m11:52:46.603493 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:52:46.603865 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.my_first_dbt_model"
[0m11:52:46.604087 [debug] [Thread-4  ]: On model.nhl_analytics.my_first_dbt_model: BEGIN
[0m11:52:46.604296 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m11:52:46.604532 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_lines"
[0m11:52:46.604756 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m11:52:46.605054 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:52:46.605256 [debug] [Thread-1  ]: On model.nhl_analytics.stg_lines: BEGIN
[0m11:52:46.605464 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m11:52:46.605660 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m11:52:46.605857 [debug] [Thread-3  ]: On model.nhl_analytics.stg_goalies: BEGIN
[0m11:52:46.606047 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:52:46.606271 [debug] [Thread-2  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

  
    
    

    create  table
      "nhl"."silver"."mart_team_standings__dbt_tmp"
  
    as (
      { { config(materialized = 'table') } }
select season,
    team_name,
    team_points,
    wins,
    losses,
    overtime_losses,
    games_played,
    standings_rank,
    team_category,
    goals_per_game,
    goals_against_per_game,
    goal_differential_per_game,
    power_play_percentage,
    penalty_kill_percentage,
    shots_per_game,
    shots_allowed_per_game,
    faceoff_percentage,
    points_percentage,
    -- Performance indicators
    case
        when wins_when_scoring_first > 0
        and games_played > 0 then round(
            wins_when_scoring_first * 100.0 / games_played,
            1
        )
        else null
    end as win_pct_when_scoring_first,
    case
        when wins_when_outshooting_opponent > 0
        and games_played > 0 then round(
            wins_when_outshooting_opponent * 100.0 / games_played,
            1
        )
        else null
    end as win_pct_when_outshooting,
    loaded_at
from { { ref('int_team_performance') } }
order by standings_rank
    );
  
  
[0m11:52:46.606492 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.my_first_dbt_model"
[0m11:52:46.606686 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m11:52:46.607149 [debug] [Thread-2  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

  
    
    

    create  table
      "nhl"."silver"."mart_team_standings__dbt_tmp"
  
    as (
      { { config(materialized = 'table') } }
select season,
    team_name,
    team_points,
    wins,
    losses,
    overtime_losses,
    games_played,
    standings_rank,
    team_category,
    goals_per_game,
    goals_against_per_game,
    goal_differential_per_game,
    power_play_percentage,
    penalty_kill_percentage,
    shots_per_game,
    shots_allowed_per_game,
    faceoff_percentage,
    points_percentage,
    -- Performance indicators
    case
        when wins_when_scoring_first > 0
        and games_played > 0 then round(
            wins_when_scoring_first * 100.0 / games_played,
            1
        )
        else null
    end as win_pct_when_scoring_first,
    case
        when wins_when_outshooting_opponent > 0
        and games_played > 0 then round(
            wins_when_outshooting_opponent * 100.0 / games_played,
            1
        )
        else null
    end as win_pct_when_outshooting,
    loaded_at
from { { ref('int_team_performance') } }
order by standings_rank
    );
  
  
[0m11:52:46.607415 [debug] [Thread-4  ]: On model.nhl_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.my_first_dbt_model"} */

  
    
    

    create  table
      "nhl"."silver"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m11:52:46.607632 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m11:52:46.607884 [debug] [Thread-2  ]: DuckDB adapter: Rolling back transaction.
[0m11:52:46.608162 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_lines"
[0m11:52:46.608352 [debug] [Thread-3  ]: SQL status: OK in 0.002 seconds
[0m11:52:46.608628 [debug] [Thread-2  ]: On model.nhl_analytics.mart_team_standings: ROLLBACK
[0m11:52:46.608871 [debug] [Thread-1  ]: On model.nhl_analytics.stg_lines: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_lines"} */

  
  create view "nhl"."silver"."stg_lines__dbt_tmp" as (
    { { config(materialized = 'view') } }
select season,
    team,
    l1 as line_player_1,
    l2 as line_player_2,
    l3 as line_player_3,
    games_played,
    icetime as ice_time,
    icetimeRank as ice_time_rank,
    -- Offensive stats
    goals,
    assists,
    points,
    shots,
    shotsFor as shots_for,
    shotsAgainst as shots_against,
    -- Advanced stats
    corsiFor as corsi_for,
    corsiAgainst as corsi_against,
    corsiForPct as corsi_for_percentage,
    fenwickFor as fenwick_for,
    fenwickAgainst as fenwick_against,
    fenwickForPct as fenwick_for_percentage,
    -- Goals for/against
    goalsFor as goals_for,
    goalsAgainst as goals_against,
    goalDifferential as goal_differential,
    -- Add line identification
    concat(team, '_', l1, '_', l2, '_', l3) as line_id,
    -- Calculate additional metrics
    case
        when icetime > 0 then round(points * 60.0 / icetime, 2)
        else null
    end as points_per_60,
    case
        when shots > 0 then round(goals * 100.0 / shots, 2)
        else null
    end as shooting_percentage,
    current_timestamp as loaded_at
from { { source('bronze', 'lines') } }
where season is not null
    and team is not null
    and l1 is not null
    and l2 is not null
    and l3 is not null
  );

[0m11:52:46.609112 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:52:46.609567 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_lines"} */

  
  create view "nhl"."silver"."stg_lines__dbt_tmp" as (
    { { config(materialized = 'view') } }
select season,
    team,
    l1 as line_player_1,
    l2 as line_player_2,
    l3 as line_player_3,
    games_played,
    icetime as ice_time,
    icetimeRank as ice_time_rank,
    -- Offensive stats
    goals,
    assists,
    points,
    shots,
    shotsFor as shots_for,
    shotsAgainst as shots_against,
    -- Advanced stats
    corsiFor as corsi_for,
    corsiAgainst as corsi_against,
    corsiForPct as corsi_for_percentage,
    fenwickFor as fenwick_for,
    fenwickAgainst as fenwick_against,
    fenwickForPct as fenwick_for_percentage,
    -- Goals for/against
    goalsFor as goals_for,
    goalsAgainst as goals_against,
    goalDifferential as goal_differential,
    -- Add line identification
    concat(team, '_', l1, '_', l2, '_', l3) as line_id,
    -- Calculate additional metrics
    case
        when icetime > 0 then round(points * 60.0 / icetime, 2)
        else null
    end as points_per_60,
    case
        when shots > 0 then round(goals * 100.0 / shots, 2)
        else null
    end as shooting_percentage,
    current_timestamp as loaded_at
from { { source('bronze', 'lines') } }
where season is not null
    and team is not null
    and l1 is not null
    and l2 is not null
    and l3 is not null
  );

[0m11:52:46.609849 [debug] [Thread-3  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    games_played,
    games_started,
    wins,
    losses,
    ties,
    otLosses as ot_losses,
    shotsAgainst as shots_against,
    saves,
    goals_against,
    savePercentage as save_percentage,
    goalsAgainstAverage as goals_against_average,
    timeOnIce as time_on_ice,
    timeOnIcePerGame as time_on_ice_per_game,
    shutouts,
    lowDangerGoals as low_danger_goals,
    mediumDangerGoals as medium_danger_goals,
    highDangerGoals as high_danger_goals,
    blocked_shot_attempts,
    penalityMinutes as penalty_minutes,
    penalties,
    -- Add data quality flags
    case
        when games_played > 0
        and saves > 0 then true
        else false
    end as is_active_goalie,
    -- Calculate additional metrics
    case
        when shotsAgainst > 0 then round(saves * 100.0 / shotsAgainst, 2)
        else null
    end as calculated_save_percentage,
    current_timestamp as loaded_at
from { { source('bronze', 'goalies') } }
where playerId is not null
    and season is not null
  );

[0m11:52:46.610137 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m11:52:46.610536 [debug] [Thread-3  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    games_played,
    games_started,
    wins,
    losses,
    ties,
    otLosses as ot_losses,
    shotsAgainst as shots_against,
    saves,
    goals_against,
    savePercentage as save_percentage,
    goalsAgainstAverage as goals_against_average,
    timeOnIce as time_on_ice,
    timeOnIcePerGame as time_on_ice_per_game,
    shutouts,
    lowDangerGoals as low_danger_goals,
    mediumDangerGoals as medium_danger_goals,
    highDangerGoals as high_danger_goals,
    blocked_shot_attempts,
    penalityMinutes as penalty_minutes,
    penalties,
    -- Add data quality flags
    case
        when games_played > 0
        and saves > 0 then true
        else false
    end as is_active_goalie,
    -- Calculate additional metrics
    case
        when shotsAgainst > 0 then round(saves * 100.0 / shotsAgainst, 2)
        else null
    end as calculated_save_percentage,
    current_timestamp as loaded_at
from { { source('bronze', 'goalies') } }
where playerId is not null
    and season is not null
  );

[0m11:52:46.610831 [debug] [Thread-1  ]: On model.nhl_analytics.stg_lines: ROLLBACK
[0m11:52:46.611041 [debug] [Thread-4  ]: SQL status: OK in 0.003 seconds
[0m11:52:46.611239 [debug] [Thread-3  ]: DuckDB adapter: Rolling back transaction.
[0m11:52:46.614530 [debug] [Thread-2  ]: Failed to rollback 'model.nhl_analytics.mart_team_standings'
[0m11:52:46.618464 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.my_first_dbt_model"
[0m11:52:46.618787 [debug] [Thread-3  ]: On model.nhl_analytics.stg_goalies: ROLLBACK
[0m11:52:46.619011 [debug] [Thread-2  ]: On model.nhl_analytics.mart_team_standings: Close
[0m11:52:46.619250 [debug] [Thread-4  ]: On model.nhl_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.my_first_dbt_model"} */
alter table "nhl"."silver"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m11:52:46.622115 [debug] [Thread-1  ]: Failed to rollback 'model.nhl_analytics.stg_lines'
[0m11:52:46.622564 [debug] [Thread-1  ]: On model.nhl_analytics.stg_lines: Close
[0m11:52:46.622825 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m11:52:46.631191 [debug] [Thread-4  ]: On model.nhl_analytics.my_first_dbt_model: COMMIT
[0m11:52:46.631492 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.my_first_dbt_model"
[0m11:52:46.631725 [debug] [Thread-4  ]: On model.nhl_analytics.my_first_dbt_model: COMMIT
[0m11:52:46.634459 [debug] [Thread-3  ]: Failed to rollback 'model.nhl_analytics.stg_goalies'
[0m11:52:46.634671 [debug] [Thread-3  ]: On model.nhl_analytics.stg_goalies: Close
[0m11:52:46.637678 [debug] [Thread-2  ]: Runtime Error in model mart_team_standings (models/marts/mart_team_standings.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 11:       { { config(materialized = 'table') } }
                 ^
[0m11:52:46.638132 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0edd01d-099b-4759-9096-9097e9331898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099a7880>]}
[0m11:52:46.638358 [debug] [Thread-4  ]: SQL status: OK in 0.006 seconds
[0m11:52:46.642483 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.my_first_dbt_model"
[0m11:52:46.642825 [error] [Thread-2  ]: 5 of 11 ERROR creating sql table model silver.mart_team_standings .............. [[31mERROR[0m in 0.06s]
[0m11:52:46.643063 [debug] [Thread-4  ]: On model.nhl_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.my_first_dbt_model"} */

      drop table if exists "nhl"."silver"."my_first_dbt_model__dbt_backup" cascade
    
[0m11:52:46.645898 [debug] [Thread-1  ]: Runtime Error in model stg_lines (models/staging/stg_lines.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m11:52:46.646206 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.mart_team_standings
[0m11:52:46.649243 [debug] [Thread-3  ]: Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m11:52:46.649578 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0edd01d-099b-4759-9096-9097e9331898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6231f0>]}
[0m11:52:46.649850 [debug] [Thread-2  ]: Began running node model.nhl_analytics.stg_skaters
[0m11:52:46.650075 [debug] [Thread-4  ]: SQL status: OK in 0.004 seconds
[0m11:52:46.650348 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.mart_team_standings' to be skipped because of status 'error'.  Reason: Runtime Error in model mart_team_standings (models/marts/mart_team_standings.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 11:       { { config(materialized = 'table') } }
                 ^.
[0m11:52:46.650600 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0edd01d-099b-4759-9096-9097e9331898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6230a0>]}
[0m11:52:46.650998 [error] [Thread-1  ]: 8 of 11 ERROR creating sql view model silver.stg_lines ......................... [[31mERROR[0m in 0.06s]
[0m11:52:46.652778 [debug] [Thread-4  ]: On model.nhl_analytics.my_first_dbt_model: Close
[0m11:52:46.651241 [info ] [Thread-2  ]: 9 of 11 START sql view model silver.stg_skaters ................................ [RUN]
[0m11:52:46.653532 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.stg_lines
[0m11:52:46.653267 [error] [Thread-3  ]: 7 of 11 ERROR creating sql view model silver.stg_goalies ....................... [[31mERROR[0m in 0.07s]
[0m11:52:46.653868 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.mart_team_standings, now model.nhl_analytics.stg_skaters)
[0m11:52:46.654187 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0edd01d-099b-4759-9096-9097e9331898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b39d00>]}
[0m11:52:46.654431 [debug] [Thread-1  ]: Began running node model.nhl_analytics.stg_teams
[0m11:52:46.654689 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_lines' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_lines (models/staging/stg_lines.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^.
[0m11:52:46.654965 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.stg_goalies
[0m11:52:46.655176 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.stg_skaters
[0m11:52:46.655546 [info ] [Thread-4  ]: 6 of 11 OK created sql table model silver.my_first_dbt_model ................... [[32mOK[0m in 0.07s]
[0m11:52:46.655787 [info ] [Thread-1  ]: 10 of 11 START sql view model silver.stg_teams ................................. [RUN]
[0m11:52:46.656212 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_goalies' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^.
[0m11:52:46.657656 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.stg_skaters"
[0m11:52:46.657952 [debug] [Thread-4  ]: Finished running node model.nhl_analytics.my_first_dbt_model
[0m11:52:46.658182 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.stg_lines, now model.nhl_analytics.stg_teams)
[0m11:52:46.658528 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.stg_teams
[0m11:52:46.658809 [debug] [Thread-3  ]: Began running node model.nhl_analytics.my_second_dbt_model
[0m11:52:46.660097 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.stg_teams"
[0m11:52:46.660592 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.stg_skaters
[0m11:52:46.660387 [info ] [Thread-3  ]: 11 of 11 START sql table model silver.my_second_dbt_model ...................... [RUN]
[0m11:52:46.663095 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.stg_skaters"
[0m11:52:46.663369 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.stg_goalies, now model.nhl_analytics.my_second_dbt_model)
[0m11:52:46.663657 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.stg_teams
[0m11:52:46.663868 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.my_second_dbt_model
[0m11:52:46.666349 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.stg_teams"
[0m11:52:46.668219 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.my_second_dbt_model"
[0m11:52:46.668697 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m11:52:46.668939 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: BEGIN
[0m11:52:46.669149 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.my_second_dbt_model
[0m11:52:46.669383 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m11:52:46.669576 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:52:46.671757 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.my_second_dbt_model"
[0m11:52:46.671967 [debug] [Thread-1  ]: On model.nhl_analytics.stg_teams: BEGIN
[0m11:52:46.672327 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:52:46.672614 [debug] [Thread-2  ]: SQL status: OK in 0.003 seconds
[0m11:52:46.672818 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m11:52:46.673017 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m11:52:46.673250 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.my_second_dbt_model"
[0m11:52:46.673496 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    games_played,
    time_on_ice,
    assists,
    goals,
    shots,
    points,
    plusMinus as plus_minus,
    penalityMinutes as penalty_minutes,
    faceOffWins as faceoff_wins,
    faceoffTaken as faceoff_taken,
    takeaways,
    giveaways,
    shortHandedGoals as short_handed_goals,
    shortHandedAssists as short_handed_assists,
    shortHandedPoints as short_handed_points,
    powerPlayGoals as power_play_goals,
    powerPlayAssists as power_play_assists,
    powerPlayPoints as power_play_points,
    gameWinningGoals as game_winning_goals,
    overtimeGoals as overtime_goals,
    shootoutGoals as shootout_goals,
    shootoutAttempts as shootout_attempts,
    hits,
    blocked,
    shifts,
    -- Add data quality flags
    case
        when games_played > 0 then true
        else false
    end as is_active_player,
    -- Calculate additional metrics
    case
        when games_played > 0 then round(points * 1.0 / games_played, 2)
        else null
    end as points_per_game,
    case
        when faceoffTaken > 0 then round(faceOffWins * 100.0 / faceoffTaken, 2)
        else null
    end as faceoff_percentage,
    case
        when shots > 0 then round(goals * 100.0 / shots, 2)
        else null
    end as shooting_percentage,
    current_timestamp as loaded_at
from { { source('bronze', 'skaters') } }
where playerId is not null
    and season is not null
  );

[0m11:52:46.673733 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m11:52:46.673927 [debug] [Thread-3  ]: On model.nhl_analytics.my_second_dbt_model: BEGIN
[0m11:52:46.674330 [debug] [Thread-2  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    games_played,
    time_on_ice,
    assists,
    goals,
    shots,
    points,
    plusMinus as plus_minus,
    penalityMinutes as penalty_minutes,
    faceOffWins as faceoff_wins,
    faceoffTaken as faceoff_taken,
    takeaways,
    giveaways,
    shortHandedGoals as short_handed_goals,
    shortHandedAssists as short_handed_assists,
    shortHandedPoints as short_handed_points,
    powerPlayGoals as power_play_goals,
    powerPlayAssists as power_play_assists,
    powerPlayPoints as power_play_points,
    gameWinningGoals as game_winning_goals,
    overtimeGoals as overtime_goals,
    shootoutGoals as shootout_goals,
    shootoutAttempts as shootout_attempts,
    hits,
    blocked,
    shifts,
    -- Add data quality flags
    case
        when games_played > 0 then true
        else false
    end as is_active_player,
    -- Calculate additional metrics
    case
        when games_played > 0 then round(points * 1.0 / games_played, 2)
        else null
    end as points_per_game,
    case
        when faceoffTaken > 0 then round(faceOffWins * 100.0 / faceoffTaken, 2)
        else null
    end as faceoff_percentage,
    case
        when shots > 0 then round(goals * 100.0 / shots, 2)
        else null
    end as shooting_percentage,
    current_timestamp as loaded_at
from { { source('bronze', 'skaters') } }
where playerId is not null
    and season is not null
  );

[0m11:52:46.674604 [debug] [Thread-1  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

  
  create view "nhl"."silver"."stg_teams__dbt_tmp" as (
    { { config(materialized = 'view') } }
select season,
    name as team_name,
    wins,
    losses,
    ot as overtime_losses,
    points as team_points,
    pointPctg as points_percentage,
    goalsPerGame as goals_per_game,
    goalsAgainstPerGame as goals_against_per_game,
    powerPlayPercentage as power_play_percentage,
    powerPlayGoals as power_play_goals,
    powerPlayOpportunities as power_play_opportunities,
    penaltyKillPercentage as penalty_kill_percentage,
    shotsPerGame as shots_per_game,
    shotsAllowed as shots_allowed_per_game,
    winScoreFirst as wins_when_scoring_first,
    winOppScoreFirst as wins_when_opponent_scores_first,
    winLeadFirstPer as wins_leading_first_period,
    winLeadSecondPer as wins_leading_second_period,
    winOutshootOpp as wins_when_outshooting_opponent,
    winOutshotByOpp as wins_when_outshot_by_opponent,
    faceOffsTaken as faceoffs_taken,
    faceOffsWon as faceoffs_won,
    -- Calculate additional metrics
    case
        when faceOffsTaken > 0 then round(faceOffsWon * 100.0 / faceOffsTaken, 2)
        else null
    end as faceoff_percentage,
    wins + losses + ot as games_played,
    current_timestamp as loaded_at
from { { source('bronze', 'teams') } }
where season is not null
    and name is not null
  );

[0m11:52:46.674840 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m11:52:46.675046 [debug] [Thread-2  ]: DuckDB adapter: Rolling back transaction.
[0m11:52:46.675410 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

  
  create view "nhl"."silver"."stg_teams__dbt_tmp" as (
    { { config(materialized = 'view') } }
select season,
    name as team_name,
    wins,
    losses,
    ot as overtime_losses,
    points as team_points,
    pointPctg as points_percentage,
    goalsPerGame as goals_per_game,
    goalsAgainstPerGame as goals_against_per_game,
    powerPlayPercentage as power_play_percentage,
    powerPlayGoals as power_play_goals,
    powerPlayOpportunities as power_play_opportunities,
    penaltyKillPercentage as penalty_kill_percentage,
    shotsPerGame as shots_per_game,
    shotsAllowed as shots_allowed_per_game,
    winScoreFirst as wins_when_scoring_first,
    winOppScoreFirst as wins_when_opponent_scores_first,
    winLeadFirstPer as wins_leading_first_period,
    winLeadSecondPer as wins_leading_second_period,
    winOutshootOpp as wins_when_outshooting_opponent,
    winOutshotByOpp as wins_when_outshot_by_opponent,
    faceOffsTaken as faceoffs_taken,
    faceOffsWon as faceoffs_won,
    -- Calculate additional metrics
    case
        when faceOffsTaken > 0 then round(faceOffsWon * 100.0 / faceOffsTaken, 2)
        else null
    end as faceoff_percentage,
    wins + losses + ot as games_played,
    current_timestamp as loaded_at
from { { source('bronze', 'teams') } }
where season is not null
    and name is not null
  );

[0m11:52:46.675774 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: ROLLBACK
[0m11:52:46.675988 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m11:52:46.676183 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m11:52:46.676479 [debug] [Thread-1  ]: On model.nhl_analytics.stg_teams: ROLLBACK
[0m11:52:46.676716 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.my_second_dbt_model"
[0m11:52:46.676971 [debug] [Thread-3  ]: On model.nhl_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.my_second_dbt_model"} */

  
    
    

    create  table
      "nhl"."silver"."my_second_dbt_model__dbt_tmp"
  
    as (
      -- Use the `ref` function to select from other models

select *
from "nhl"."silver"."my_first_dbt_model"
where id = 1
    );
  
  
[0m11:52:46.680669 [debug] [Thread-2  ]: Failed to rollback 'model.nhl_analytics.stg_skaters'
[0m11:52:46.680901 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: Close
[0m11:52:46.681120 [debug] [Thread-3  ]: SQL status: OK in 0.004 seconds
[0m11:52:46.683888 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.my_second_dbt_model"
[0m11:52:46.686642 [debug] [Thread-1  ]: Failed to rollback 'model.nhl_analytics.stg_teams'
[0m11:52:46.686854 [debug] [Thread-3  ]: On model.nhl_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.my_second_dbt_model"} */
alter table "nhl"."silver"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m11:52:46.687107 [debug] [Thread-1  ]: On model.nhl_analytics.stg_teams: Close
[0m11:52:46.689860 [debug] [Thread-2  ]: Runtime Error in model stg_skaters (models/staging/stg_skaters.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m11:52:46.690244 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0edd01d-099b-4759-9096-9097e9331898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a948790>]}
[0m11:52:46.690457 [debug] [Thread-3  ]: SQL status: OK in 0.003 seconds
[0m11:52:46.691737 [debug] [Thread-3  ]: On model.nhl_analytics.my_second_dbt_model: COMMIT
[0m11:52:46.691958 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.my_second_dbt_model"
[0m11:52:46.692172 [debug] [Thread-3  ]: On model.nhl_analytics.my_second_dbt_model: COMMIT
[0m11:52:46.690868 [error] [Thread-2  ]: 9 of 11 ERROR creating sql view model silver.stg_skaters ....................... [[31mERROR[0m in 0.04s]
[0m11:52:46.692657 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.stg_skaters
[0m11:52:46.692956 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_skaters' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_skaters (models/staging/stg_skaters.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^.
[0m11:52:46.693208 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m11:52:46.694827 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.my_second_dbt_model"
[0m11:52:46.695061 [debug] [Thread-3  ]: On model.nhl_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.my_second_dbt_model"} */

      drop table if exists "nhl"."silver"."my_second_dbt_model__dbt_backup" cascade
    
[0m11:52:46.697988 [debug] [Thread-1  ]: Runtime Error in model stg_teams (models/staging/stg_teams.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m11:52:46.698271 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0edd01d-099b-4759-9096-9097e9331898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9a5760>]}
[0m11:52:46.698494 [debug] [Thread-3  ]: SQL status: OK in 0.003 seconds
[0m11:52:46.699540 [debug] [Thread-3  ]: On model.nhl_analytics.my_second_dbt_model: Close
[0m11:52:46.698860 [error] [Thread-1  ]: 10 of 11 ERROR creating sql view model silver.stg_teams ........................ [[31mERROR[0m in 0.04s]
[0m11:52:46.699918 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.stg_teams
[0m11:52:46.700200 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0edd01d-099b-4759-9096-9097e9331898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9acc70>]}
[0m11:52:46.700481 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_teams' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_teams (models/staging/stg_teams.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^.
[0m11:52:46.700857 [info ] [Thread-3  ]: 11 of 11 OK created sql table model silver.my_second_dbt_model ................. [[32mOK[0m in 0.04s]
[0m11:52:46.701171 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.my_second_dbt_model
[0m11:52:46.701760 [debug] [MainThread]: Using duckdb connection "master"
[0m11:52:46.701927 [debug] [MainThread]: On master: BEGIN
[0m11:52:46.702077 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:52:46.702373 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:52:46.702539 [debug] [MainThread]: On master: COMMIT
[0m11:52:46.702690 [debug] [MainThread]: Using duckdb connection "master"
[0m11:52:46.702836 [debug] [MainThread]: On master: COMMIT
[0m11:52:46.703061 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:52:46.703225 [debug] [MainThread]: On master: Close
[0m11:52:46.703453 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:52:46.703626 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_teams' was properly closed.
[0m11:52:46.703772 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_skaters' was properly closed.
[0m11:52:46.703908 [debug] [MainThread]: Connection 'model.nhl_analytics.my_second_dbt_model' was properly closed.
[0m11:52:46.704042 [debug] [MainThread]: Connection 'model.nhl_analytics.my_first_dbt_model' was properly closed.
[0m11:52:46.704246 [info ] [MainThread]: 
[0m11:52:46.704447 [info ] [MainThread]: Finished running 5 table models, 6 view models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m11:52:46.705492 [debug] [MainThread]: Command end result
[0m11:52:46.723030 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m11:52:46.724023 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m11:52:46.728040 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/run_results.json
[0m11:52:46.728246 [info ] [MainThread]: 
[0m11:52:46.728469 [info ] [MainThread]: [31mCompleted with 9 errors, 0 partial successes, and 0 warnings:[0m
[0m11:52:46.728659 [info ] [MainThread]: 
[0m11:52:46.728884 [error] [MainThread]: [31mFailure in model int_team_performance (models/intermediate/int_team_performance.sql)[0m
[0m11:52:46.729102 [error] [MainThread]:   Runtime Error in model int_team_performance (models/intermediate/int_team_performance.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } } with team_stats as (
              ^
[0m11:52:46.729277 [info ] [MainThread]: 
[0m11:52:46.729480 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/intermediate/int_team_performance.sql
[0m11:52:46.729655 [info ] [MainThread]: 
[0m11:52:46.729862 [error] [MainThread]: [31mFailure in model mart_player_performance (models/marts/mart_player_performance.sql)[0m
[0m11:52:46.730073 [error] [MainThread]:   Runtime Error in model mart_player_performance (models/marts/mart_player_performance.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 11:       { { config(materialized = 'table') } }
                 ^
[0m11:52:46.730242 [info ] [MainThread]: 
[0m11:52:46.730438 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/marts/mart_player_performance.sql
[0m11:52:46.730607 [info ] [MainThread]: 
[0m11:52:46.730812 [error] [MainThread]: [31mFailure in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)[0m
[0m11:52:46.731056 [error] [MainThread]:   Runtime Error in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 11:       { { config(materialized = 'table') } }
                 ^
[0m11:52:46.731334 [info ] [MainThread]: 
[0m11:52:46.731572 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/marts/mart_goalie_performance.sql
[0m11:52:46.731762 [info ] [MainThread]: 
[0m11:52:46.731981 [error] [MainThread]: [31mFailure in model int_all_players (models/intermediate/int_all_players.sql)[0m
[0m11:52:46.732198 [error] [MainThread]:   Runtime Error in model int_all_players (models/intermediate/int_all_players.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } } with all_players as (
              ^
[0m11:52:46.732375 [info ] [MainThread]: 
[0m11:52:46.732575 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/intermediate/int_all_players.sql
[0m11:52:46.732749 [info ] [MainThread]: 
[0m11:52:46.733008 [error] [MainThread]: [31mFailure in model mart_team_standings (models/marts/mart_team_standings.sql)[0m
[0m11:52:46.733245 [error] [MainThread]:   Runtime Error in model mart_team_standings (models/marts/mart_team_standings.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 11:       { { config(materialized = 'table') } }
                 ^
[0m11:52:46.733434 [info ] [MainThread]: 
[0m11:52:46.733643 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/marts/mart_team_standings.sql
[0m11:52:46.733820 [info ] [MainThread]: 
[0m11:52:46.734030 [error] [MainThread]: [31mFailure in model stg_lines (models/staging/stg_lines.sql)[0m
[0m11:52:46.734237 [error] [MainThread]:   Runtime Error in model stg_lines (models/staging/stg_lines.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m11:52:46.734407 [info ] [MainThread]: 
[0m11:52:46.734605 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_lines.sql
[0m11:52:46.734776 [info ] [MainThread]: 
[0m11:52:46.734980 [error] [MainThread]: [31mFailure in model stg_goalies (models/staging/stg_goalies.sql)[0m
[0m11:52:46.735186 [error] [MainThread]:   Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m11:52:46.735354 [info ] [MainThread]: 
[0m11:52:46.735549 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_goalies.sql
[0m11:52:46.735722 [info ] [MainThread]: 
[0m11:52:46.735926 [error] [MainThread]: [31mFailure in model stg_skaters (models/staging/stg_skaters.sql)[0m
[0m11:52:46.736130 [error] [MainThread]:   Runtime Error in model stg_skaters (models/staging/stg_skaters.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m11:52:46.736297 [info ] [MainThread]: 
[0m11:52:46.736491 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_skaters.sql
[0m11:52:46.736660 [info ] [MainThread]: 
[0m11:52:46.736860 [error] [MainThread]: [31mFailure in model stg_teams (models/staging/stg_teams.sql)[0m
[0m11:52:46.737060 [error] [MainThread]:   Runtime Error in model stg_teams (models/staging/stg_teams.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m11:52:46.737226 [info ] [MainThread]: 
[0m11:52:46.737419 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_teams.sql
[0m11:52:46.737591 [info ] [MainThread]: 
[0m11:52:46.737808 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=9 SKIP=0 NO-OP=0 TOTAL=11
[0m11:52:46.738944 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5974348, "process_in_blocks": "0", "process_kernel_time": 0.143344, "process_mem_max_rss": "150831104", "process_out_blocks": "0", "process_user_time": 2.199477}
[0m11:52:46.739212 [debug] [MainThread]: Command `dbt run` failed at 11:52:46.739160 after 1.60 seconds
[0m11:52:46.739449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109728a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2ac1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b55f10>]}
[0m11:52:46.739684 [debug] [MainThread]: Flushing usage events
[0m11:52:47.023044 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:53:59.755983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ae0ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b644c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b642e0>]}


============================== 11:53:59.758779 | 1afc9a99-6bf1-4def-9da2-fc57aeb28326 ==============================
[0m11:53:59.758779 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:53:59.759116 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'use_colors': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'version_check': 'True', 'empty': 'False', 'log_cache_events': 'False', 'profiles_dir': '.', 'write_json': 'True', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'quiet': 'False', 'target_path': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt run --profiles-dir=.', 'use_experimental_parser': 'False', 'static_parser': 'True', 'warn_error': 'None', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None'}
[0m11:53:59.923566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1afc9a99-6bf1-4def-9da2-fc57aeb28326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10841a400>]}
[0m11:53:59.958055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1afc9a99-6bf1-4def-9da2-fc57aeb28326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c78c10>]}
[0m11:53:59.959769 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:54:00.027438 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:54:00.120624 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m11:54:00.121412 [debug] [MainThread]: Partial parsing: updated file: nhl_analytics://models/marts/mart_goalie_performance.sql
[0m11:54:00.121657 [debug] [MainThread]: Partial parsing: updated file: nhl_analytics://models/marts/mart_player_performance.sql
[0m11:54:00.121878 [debug] [MainThread]: Partial parsing: updated file: nhl_analytics://models/marts/mart_team_standings.sql
[0m11:54:00.310161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1afc9a99-6bf1-4def-9da2-fc57aeb28326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d2ce80>]}
[0m11:54:00.370659 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m11:54:00.371891 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m11:54:00.382124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1afc9a99-6bf1-4def-9da2-fc57aeb28326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d52490>]}
[0m11:54:00.382428 [info ] [MainThread]: Found 11 models, 10 data tests, 4 sources, 444 macros
[0m11:54:00.382649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1afc9a99-6bf1-4def-9da2-fc57aeb28326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10916c2e0>]}
[0m11:54:00.383728 [info ] [MainThread]: 
[0m11:54:00.383945 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:54:00.384132 [info ] [MainThread]: 
[0m11:54:00.384406 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:54:00.387750 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl'
[0m11:54:00.419226 [debug] [ThreadPool]: Using duckdb connection "list_nhl"
[0m11:54:00.419475 [debug] [ThreadPool]: On list_nhl: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m11:54:00.419650 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:54:00.460216 [debug] [ThreadPool]: SQL status: OK in 0.041 seconds
[0m11:54:00.461006 [debug] [ThreadPool]: On list_nhl: Close
[0m11:54:00.461470 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nhl, now create_nhl_silver)
[0m11:54:00.461754 [debug] [ThreadPool]: Creating schema "database: "nhl"
schema: "silver"
"
[0m11:54:00.466018 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:54:00.466213 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nhl'
        and type='sqlite'
    
  
[0m11:54:00.466379 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:54:00.466959 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:54:00.467623 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:54:00.467791 [debug] [ThreadPool]: On create_nhl_silver: BEGIN
[0m11:54:00.468040 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:54:00.468208 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:54:00.468371 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
    
        create schema if not exists "nhl"."silver"
    
[0m11:54:00.468642 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:54:00.469082 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m11:54:00.469246 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:54:00.469396 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m11:54:00.469631 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:54:00.469801 [debug] [ThreadPool]: On create_nhl_silver: Close
[0m11:54:00.470753 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nhl_silver, now list_nhl_silver)
[0m11:54:00.474139 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m11:54:00.474317 [debug] [ThreadPool]: On list_nhl_silver: BEGIN
[0m11:54:00.474472 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:54:00.474737 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:54:00.474907 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m11:54:00.475077 [debug] [ThreadPool]: On list_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl_silver"} */
select
      'nhl' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'silver'
    and lower(table_catalog) = 'nhl'
  
[0m11:54:00.484364 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m11:54:00.485189 [debug] [ThreadPool]: On list_nhl_silver: ROLLBACK
[0m11:54:00.486352 [debug] [ThreadPool]: Failed to rollback 'list_nhl_silver'
[0m11:54:00.486517 [debug] [ThreadPool]: On list_nhl_silver: Close
[0m11:54:00.486970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1afc9a99-6bf1-4def-9da2-fc57aeb28326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083f79a0>]}
[0m11:54:00.487220 [debug] [MainThread]: Using duckdb connection "master"
[0m11:54:00.487383 [debug] [MainThread]: On master: BEGIN
[0m11:54:00.487533 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:54:00.487790 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:54:00.487960 [debug] [MainThread]: On master: COMMIT
[0m11:54:00.488126 [debug] [MainThread]: Using duckdb connection "master"
[0m11:54:00.488281 [debug] [MainThread]: On master: COMMIT
[0m11:54:00.488512 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:54:00.488680 [debug] [MainThread]: On master: Close
[0m11:54:00.490163 [debug] [Thread-1  ]: Began running node model.nhl_analytics.int_all_players
[0m11:54:00.490403 [debug] [Thread-2  ]: Began running node model.nhl_analytics.int_team_performance
[0m11:54:00.490623 [debug] [Thread-3  ]: Began running node model.nhl_analytics.mart_goalie_performance
[0m11:54:00.490828 [debug] [Thread-4  ]: Began running node model.nhl_analytics.mart_player_performance
[0m11:54:00.491108 [info ] [Thread-1  ]: 1 of 11 START sql view model silver.int_all_players ............................ [RUN]
[0m11:54:00.491411 [info ] [Thread-2  ]: 2 of 11 START sql view model silver.int_team_performance ....................... [RUN]
[0m11:54:00.491739 [info ] [Thread-3  ]: 3 of 11 START sql table model silver.mart_goalie_performance ................... [RUN]
[0m11:54:00.492047 [info ] [Thread-4  ]: 4 of 11 START sql table model silver.mart_player_performance ................... [RUN]
[0m11:54:00.492307 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_nhl_silver, now model.nhl_analytics.int_all_players)
[0m11:54:00.492587 [debug] [Thread-2  ]: Acquiring new duckdb connection 'model.nhl_analytics.int_team_performance'
[0m11:54:00.492842 [debug] [Thread-3  ]: Acquiring new duckdb connection 'model.nhl_analytics.mart_goalie_performance'
[0m11:54:00.493100 [debug] [Thread-4  ]: Acquiring new duckdb connection 'model.nhl_analytics.mart_player_performance'
[0m11:54:00.493306 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.int_all_players
[0m11:54:00.493505 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.int_team_performance
[0m11:54:00.493704 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.mart_goalie_performance
[0m11:54:00.493896 [debug] [Thread-4  ]: Began compiling node model.nhl_analytics.mart_player_performance
[0m11:54:00.498574 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.int_all_players"
[0m11:54:00.500497 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.int_team_performance"
[0m11:54:00.501747 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.mart_goalie_performance"
[0m11:54:00.503026 [debug] [Thread-4  ]: Writing injected SQL for node "model.nhl_analytics.mart_player_performance"
[0m11:54:00.503493 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.int_all_players
[0m11:54:00.503719 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.int_team_performance
[0m11:54:00.503937 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.mart_goalie_performance
[0m11:54:00.532227 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.int_team_performance"
[0m11:54:00.532490 [debug] [Thread-4  ]: Began executing node model.nhl_analytics.mart_player_performance
[0m11:54:00.539803 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.int_all_players"
[0m11:54:00.545354 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.mart_goalie_performance"
[0m11:54:00.547584 [debug] [Thread-4  ]: Writing runtime sql for node "model.nhl_analytics.mart_player_performance"
[0m11:54:00.548000 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.int_team_performance"
[0m11:54:00.548294 [debug] [Thread-2  ]: On model.nhl_analytics.int_team_performance: BEGIN
[0m11:54:00.548519 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:54:00.548880 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m11:54:00.549113 [debug] [Thread-3  ]: On model.nhl_analytics.mart_goalie_performance: BEGIN
[0m11:54:00.549334 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m11:54:00.549559 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:54:00.549779 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.int_team_performance"
[0m11:54:00.550015 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m11:54:00.550266 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m11:54:00.550567 [debug] [Thread-2  ]: On model.nhl_analytics.int_team_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_team_performance"} */

  
  create view "nhl"."silver"."int_team_performance__dbt_tmp" as (
    { { config(materialized = 'view') } } with team_stats as (
    select *,
        row_number() over (
            order by team_points desc,
                points_percentage desc
        ) as standings_rank
    from { { ref('stg_teams') } }
),
team_performance as (
    select *,
        case
            when standings_rank <= 8 then 'Playoff Position'
            when standings_rank <= 16 then 'Wild Card Contention'
            else 'Rebuilding'
        end as team_category,
        goals_per_game - goals_against_per_game as goal_differential_per_game
    from team_stats
)
select *
from team_performance
  );

[0m11:54:00.550805 [debug] [Thread-1  ]: On model.nhl_analytics.int_all_players: BEGIN
[0m11:54:00.551015 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m11:54:00.551206 [debug] [Thread-4  ]: On model.nhl_analytics.mart_player_performance: BEGIN
[0m11:54:00.553697 [debug] [Thread-2  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_team_performance"} */

  
  create view "nhl"."silver"."int_team_performance__dbt_tmp" as (
    { { config(materialized = 'view') } } with team_stats as (
    select *,
        row_number() over (
            order by team_points desc,
                points_percentage desc
        ) as standings_rank
    from { { ref('stg_teams') } }
),
team_performance as (
    select *,
        case
            when standings_rank <= 8 then 'Playoff Position'
            when standings_rank <= 16 then 'Wild Card Contention'
            else 'Rebuilding'
        end as team_category,
        goals_per_game - goals_against_per_game as goal_differential_per_game
    from team_stats
)
select *
from team_performance
  );

[0m11:54:00.553906 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:54:00.554117 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m11:54:00.554308 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:54:00.554515 [debug] [Thread-2  ]: DuckDB adapter: Rolling back transaction.
[0m11:54:00.554797 [debug] [Thread-3  ]: On model.nhl_analytics.mart_goalie_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */

  
    
    

    create  table
      "nhl"."silver"."mart_goalie_performance__dbt_tmp"
  
    as (
      { { config(materialized = 'table') } }
select
select player_id,
    player_name,
    team_code,
    games_played,
    save_percentage,
    goals_against_average,
    case
        when save_percentage >= 0.925 then 'Elite'
        when save_percentage >= 0.915 then 'Very Good'
        when save_percentage >= 0.905 then 'Good'
        when save_percentage >= 0.895 then 'Average'
        else 'Below Average'
    end as goalie_rating,
    case
        when goals_against_average <= 2.2 then 'Elite'
        when goals_against_average <= 2.5 then 'Very Good'
        when goals_against_average <= 2.8 then 'Good'
        when goals_against_average <= 3.2 then 'Average'
        else 'Below Average'
    end as gaa_rating,
    is_active,
    loaded_at
from { { ref('int_all_players') } }
where position_group = 'Goalie'
    and is_active = true
    and games_played >= 10
    );
  
  
[0m11:54:00.555074 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m11:54:00.555357 [debug] [Thread-2  ]: On model.nhl_analytics.int_team_performance: ROLLBACK
[0m11:54:00.555564 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m11:54:00.555916 [debug] [Thread-3  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */

  
    
    

    create  table
      "nhl"."silver"."mart_goalie_performance__dbt_tmp"
  
    as (
      { { config(materialized = 'table') } }
select
select player_id,
    player_name,
    team_code,
    games_played,
    save_percentage,
    goals_against_average,
    case
        when save_percentage >= 0.925 then 'Elite'
        when save_percentage >= 0.915 then 'Very Good'
        when save_percentage >= 0.905 then 'Good'
        when save_percentage >= 0.895 then 'Average'
        else 'Below Average'
    end as goalie_rating,
    case
        when goals_against_average <= 2.2 then 'Elite'
        when goals_against_average <= 2.5 then 'Very Good'
        when goals_against_average <= 2.8 then 'Good'
        when goals_against_average <= 3.2 then 'Average'
        else 'Below Average'
    end as gaa_rating,
    is_active,
    loaded_at
from { { ref('int_all_players') } }
where position_group = 'Goalie'
    and is_active = true
    and games_played >= 10
    );
  
  
[0m11:54:00.556149 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m11:54:00.556442 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m11:54:00.558250 [debug] [Thread-3  ]: DuckDB adapter: Rolling back transaction.
[0m11:54:00.558500 [debug] [Thread-1  ]: On model.nhl_analytics.int_all_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */

  
  create view "nhl"."silver"."int_all_players__dbt_tmp" as (
    { { config(materialized = 'view') } } with all_players as (
    select player_id,
        season,
        player_name,
        team_code,
        'G' as position,
        games_played,
        points_per_game,
        null as shooting_percentage,
        null as faceoff_percentage,
        save_percentage,
        goals_against_average,
        is_active_goalie as is_active,
        loaded_at
    from { { ref('stg_goalies') } }
    union all
    select player_id,
        season,
        player_name,
        team_code,
        position,
        games_played,
        points_per_game,
        shooting_percentage,
        faceoff_percentage,
        null as save_percentage,
        null as goals_against_average,
        is_active_player as is_active,
        loaded_at
    from { { ref('stg_skaters') } }
)
select *,
    case
        when position = 'G' then 'Goalie'
        when position in ('C', 'L', 'R', 'LW', 'RW') then 'Forward'
        when position in ('D') then 'Defense'
        else 'Unknown'
    end as position_group
from all_players
  );

[0m11:54:00.558784 [debug] [Thread-4  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */

  
    
    

    create  table
      "nhl"."silver"."mart_player_performance__dbt_tmp"
  
    as (
      { { config(materialized = 'table') } }
select
select player_id,
    player_name,
    team_code,
    position,
    position_group,
    games_played,
    points_per_game,
    shooting_percentage,
    faceoff_percentage,
    case
        when points_per_game >= 1.0 then 'Elite'
        when points_per_game >= 0.7 then 'Very Good'
        when points_per_game >= 0.5 then 'Good'
        when points_per_game >= 0.3 then 'Average'
        else 'Below Average'
    end as offensive_rating,
    case
        when shooting_percentage >= 15 then 'Elite Shooter'
        when shooting_percentage >= 12 then 'Good Shooter'
        when shooting_percentage >= 10 then 'Average Shooter'
        else 'Below Average Shooter'
    end as shooting_rating,
    is_active,
    loaded_at
from { { ref('int_all_players') } }
where position_group in ('Forward', 'Defense')
    and is_active = true
    and games_played >= 10
    );
  
  
[0m11:54:00.559131 [debug] [Thread-3  ]: On model.nhl_analytics.mart_goalie_performance: ROLLBACK
[0m11:54:00.560720 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */

  
  create view "nhl"."silver"."int_all_players__dbt_tmp" as (
    { { config(materialized = 'view') } } with all_players as (
    select player_id,
        season,
        player_name,
        team_code,
        'G' as position,
        games_played,
        points_per_game,
        null as shooting_percentage,
        null as faceoff_percentage,
        save_percentage,
        goals_against_average,
        is_active_goalie as is_active,
        loaded_at
    from { { ref('stg_goalies') } }
    union all
    select player_id,
        season,
        player_name,
        team_code,
        position,
        games_played,
        points_per_game,
        shooting_percentage,
        faceoff_percentage,
        null as save_percentage,
        null as goals_against_average,
        is_active_player as is_active,
        loaded_at
    from { { ref('stg_skaters') } }
)
select *,
    case
        when position = 'G' then 'Goalie'
        when position in ('C', 'L', 'R', 'LW', 'RW') then 'Forward'
        when position in ('D') then 'Defense'
        else 'Unknown'
    end as position_group
from all_players
  );

[0m11:54:00.561139 [debug] [Thread-4  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */

  
    
    

    create  table
      "nhl"."silver"."mart_player_performance__dbt_tmp"
  
    as (
      { { config(materialized = 'table') } }
select
select player_id,
    player_name,
    team_code,
    position,
    position_group,
    games_played,
    points_per_game,
    shooting_percentage,
    faceoff_percentage,
    case
        when points_per_game >= 1.0 then 'Elite'
        when points_per_game >= 0.7 then 'Very Good'
        when points_per_game >= 0.5 then 'Good'
        when points_per_game >= 0.3 then 'Average'
        else 'Below Average'
    end as offensive_rating,
    case
        when shooting_percentage >= 15 then 'Elite Shooter'
        when shooting_percentage >= 12 then 'Good Shooter'
        when shooting_percentage >= 10 then 'Average Shooter'
        else 'Below Average Shooter'
    end as shooting_rating,
    is_active,
    loaded_at
from { { ref('int_all_players') } }
where position_group in ('Forward', 'Defense')
    and is_active = true
    and games_played >= 10
    );
  
  
[0m11:54:00.561507 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m11:54:00.561775 [debug] [Thread-4  ]: DuckDB adapter: Rolling back transaction.
[0m11:54:00.564131 [debug] [Thread-1  ]: On model.nhl_analytics.int_all_players: ROLLBACK
[0m11:54:00.564489 [debug] [Thread-4  ]: On model.nhl_analytics.mart_player_performance: ROLLBACK
[0m11:54:00.597450 [debug] [Thread-1  ]: Failed to rollback 'model.nhl_analytics.int_all_players'
[0m11:54:00.597957 [debug] [Thread-2  ]: Failed to rollback 'model.nhl_analytics.int_team_performance'
[0m11:54:00.598182 [debug] [Thread-1  ]: On model.nhl_analytics.int_all_players: Close
[0m11:54:00.598614 [debug] [Thread-4  ]: Failed to rollback 'model.nhl_analytics.mart_player_performance'
[0m11:54:00.599045 [debug] [Thread-3  ]: Failed to rollback 'model.nhl_analytics.mart_goalie_performance'
[0m11:54:00.599250 [debug] [Thread-2  ]: On model.nhl_analytics.int_team_performance: Close
[0m11:54:00.599559 [debug] [Thread-4  ]: On model.nhl_analytics.mart_player_performance: Close
[0m11:54:00.599777 [debug] [Thread-3  ]: On model.nhl_analytics.mart_goalie_performance: Close
[0m11:54:00.602831 [debug] [Thread-1  ]: Runtime Error in model int_all_players (models/intermediate/int_all_players.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } } with all_players as (
              ^
[0m11:54:00.606348 [debug] [Thread-2  ]: Runtime Error in model int_team_performance (models/intermediate/int_team_performance.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } } with team_stats as (
              ^
[0m11:54:00.609026 [debug] [Thread-4  ]: Runtime Error in model mart_player_performance (models/marts/mart_player_performance.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 11:       { { config(materialized = 'table') } }
                 ^
[0m11:54:00.611845 [debug] [Thread-3  ]: Runtime Error in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 11:       { { config(materialized = 'table') } }
                 ^
[0m11:54:00.612070 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1afc9a99-6bf1-4def-9da2-fc57aeb28326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10978efa0>]}
[0m11:54:00.612311 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1afc9a99-6bf1-4def-9da2-fc57aeb28326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097f9a60>]}
[0m11:54:00.612492 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1afc9a99-6bf1-4def-9da2-fc57aeb28326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097a9c70>]}
[0m11:54:00.612672 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1afc9a99-6bf1-4def-9da2-fc57aeb28326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10756f250>]}
[0m11:54:00.613085 [error] [Thread-1  ]: 1 of 11 ERROR creating sql view model silver.int_all_players ................... [[31mERROR[0m in 0.11s]
[0m11:54:00.613361 [error] [Thread-3  ]: 3 of 11 ERROR creating sql table model silver.mart_goalie_performance .......... [[31mERROR[0m in 0.12s]
[0m11:54:00.613710 [error] [Thread-2  ]: 2 of 11 ERROR creating sql view model silver.int_team_performance .............. [[31mERROR[0m in 0.11s]
[0m11:54:00.614119 [error] [Thread-4  ]: 4 of 11 ERROR creating sql table model silver.mart_player_performance .......... [[31mERROR[0m in 0.12s]
[0m11:54:00.614444 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.int_all_players
[0m11:54:00.614733 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.mart_goalie_performance
[0m11:54:00.615021 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.int_team_performance
[0m11:54:00.615311 [debug] [Thread-4  ]: Finished running node model.nhl_analytics.mart_player_performance
[0m11:54:00.615532 [debug] [Thread-1  ]: Began running node model.nhl_analytics.mart_team_standings
[0m11:54:00.615792 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.int_all_players' to be skipped because of status 'error'.  Reason: Runtime Error in model int_all_players (models/intermediate/int_all_players.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } } with all_players as (
              ^.
[0m11:54:00.616005 [debug] [Thread-3  ]: Began running node model.nhl_analytics.my_first_dbt_model
[0m11:54:00.616223 [debug] [Thread-2  ]: Began running node model.nhl_analytics.stg_goalies
[0m11:54:00.616430 [debug] [Thread-4  ]: Began running node model.nhl_analytics.stg_lines
[0m11:54:00.616683 [info ] [Thread-1  ]: 5 of 11 START sql table model silver.mart_team_standings ....................... [RUN]
[0m11:54:00.616997 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.mart_goalie_performance' to be skipped because of status 'error'.  Reason: Runtime Error in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 11:       { { config(materialized = 'table') } }
                 ^.
[0m11:54:00.617274 [info ] [Thread-3  ]: 6 of 11 START sql table model silver.my_first_dbt_model ........................ [RUN]
[0m11:54:00.617559 [info ] [Thread-2  ]: 7 of 11 START sql view model silver.stg_goalies ................................ [RUN]
[0m11:54:00.617855 [info ] [Thread-4  ]: 8 of 11 START sql view model silver.stg_lines .................................. [RUN]
[0m11:54:00.618139 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.int_all_players, now model.nhl_analytics.mart_team_standings)
[0m11:54:00.618463 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.int_team_performance' to be skipped because of status 'error'.  Reason: Runtime Error in model int_team_performance (models/intermediate/int_team_performance.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } } with team_stats as (
              ^.
[0m11:54:00.618727 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.mart_goalie_performance, now model.nhl_analytics.my_first_dbt_model)
[0m11:54:00.618973 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.int_team_performance, now model.nhl_analytics.stg_goalies)
[0m11:54:00.619212 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.mart_player_performance, now model.nhl_analytics.stg_lines)
[0m11:54:00.619431 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.mart_team_standings
[0m11:54:00.619696 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.mart_player_performance' to be skipped because of status 'error'.  Reason: Runtime Error in model mart_player_performance (models/marts/mart_player_performance.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 11:       { { config(materialized = 'table') } }
                 ^.
[0m11:54:00.619895 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.my_first_dbt_model
[0m11:54:00.620087 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.stg_goalies
[0m11:54:00.620290 [debug] [Thread-4  ]: Began compiling node model.nhl_analytics.stg_lines
[0m11:54:00.621670 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.mart_team_standings"
[0m11:54:00.623422 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.my_first_dbt_model"
[0m11:54:00.624711 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.stg_goalies"
[0m11:54:00.625981 [debug] [Thread-4  ]: Writing injected SQL for node "model.nhl_analytics.stg_lines"
[0m11:54:00.626471 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.mart_team_standings
[0m11:54:00.626726 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.stg_goalies
[0m11:54:00.626943 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.my_first_dbt_model
[0m11:54:00.629256 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.mart_team_standings"
[0m11:54:00.632464 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.stg_goalies"
[0m11:54:00.632726 [debug] [Thread-4  ]: Began executing node model.nhl_analytics.stg_lines
[0m11:54:00.634832 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.my_first_dbt_model"
[0m11:54:00.637173 [debug] [Thread-4  ]: Writing runtime sql for node "model.nhl_analytics.stg_lines"
[0m11:54:00.637512 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m11:54:00.637814 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:54:00.638039 [debug] [Thread-1  ]: On model.nhl_analytics.mart_team_standings: BEGIN
[0m11:54:00.638287 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.my_first_dbt_model"
[0m11:54:00.638507 [debug] [Thread-2  ]: On model.nhl_analytics.stg_goalies: BEGIN
[0m11:54:00.638720 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:54:00.638943 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.stg_lines"
[0m11:54:00.639144 [debug] [Thread-3  ]: On model.nhl_analytics.my_first_dbt_model: BEGIN
[0m11:54:00.639350 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:54:00.639669 [debug] [Thread-4  ]: On model.nhl_analytics.stg_lines: BEGIN
[0m11:54:00.639880 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m11:54:00.640079 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m11:54:00.640327 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m11:54:00.640586 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m11:54:00.640799 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m11:54:00.641002 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m11:54:00.641233 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:54:00.641473 [debug] [Thread-1  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

  
    
    

    create  table
      "nhl"."silver"."mart_team_standings__dbt_tmp"
  
    as (
      { { config(materialized = 'table') } }
select
select season,
    team_name,
    team_points,
    wins,
    losses,
    overtime_losses,
    games_played,
    standings_rank,
    team_category,
    goals_per_game,
    goals_against_per_game,
    goal_differential_per_game,
    power_play_percentage,
    penalty_kill_percentage,
    shots_per_game,
    shots_allowed_per_game,
    faceoff_percentage,
    points_percentage,
    -- Performance indicators
    case
        when wins_when_scoring_first > 0
        and games_played > 0 then round(
            wins_when_scoring_first * 100.0 / games_played,
            1
        )
        else null
    end as win_pct_when_scoring_first,
    case
        when wins_when_outshooting_opponent > 0
        and games_played > 0 then round(
            wins_when_outshooting_opponent * 100.0 / games_played,
            1
        )
        else null
    end as win_pct_when_outshooting,
    loaded_at
from { { ref('int_team_performance') } }
order by standings_rank
    );
  
  
[0m11:54:00.641702 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m11:54:00.641889 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.my_first_dbt_model"
[0m11:54:00.642118 [debug] [Thread-2  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    games_played,
    games_started,
    wins,
    losses,
    ties,
    otLosses as ot_losses,
    shotsAgainst as shots_against,
    saves,
    goals_against,
    savePercentage as save_percentage,
    goalsAgainstAverage as goals_against_average,
    timeOnIce as time_on_ice,
    timeOnIcePerGame as time_on_ice_per_game,
    shutouts,
    lowDangerGoals as low_danger_goals,
    mediumDangerGoals as medium_danger_goals,
    highDangerGoals as high_danger_goals,
    blocked_shot_attempts,
    penalityMinutes as penalty_minutes,
    penalties,
    -- Add data quality flags
    case
        when games_played > 0
        and saves > 0 then true
        else false
    end as is_active_goalie,
    -- Calculate additional metrics
    case
        when shotsAgainst > 0 then round(saves * 100.0 / shotsAgainst, 2)
        else null
    end as calculated_save_percentage,
    current_timestamp as loaded_at
from { { source('bronze', 'goalies') } }
where playerId is not null
    and season is not null
  );

[0m11:54:00.642539 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

  
    
    

    create  table
      "nhl"."silver"."mart_team_standings__dbt_tmp"
  
    as (
      { { config(materialized = 'table') } }
select
select season,
    team_name,
    team_points,
    wins,
    losses,
    overtime_losses,
    games_played,
    standings_rank,
    team_category,
    goals_per_game,
    goals_against_per_game,
    goal_differential_per_game,
    power_play_percentage,
    penalty_kill_percentage,
    shots_per_game,
    shots_allowed_per_game,
    faceoff_percentage,
    points_percentage,
    -- Performance indicators
    case
        when wins_when_scoring_first > 0
        and games_played > 0 then round(
            wins_when_scoring_first * 100.0 / games_played,
            1
        )
        else null
    end as win_pct_when_scoring_first,
    case
        when wins_when_outshooting_opponent > 0
        and games_played > 0 then round(
            wins_when_outshooting_opponent * 100.0 / games_played,
            1
        )
        else null
    end as win_pct_when_outshooting,
    loaded_at
from { { ref('int_team_performance') } }
order by standings_rank
    );
  
  
[0m11:54:00.642764 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.stg_lines"
[0m11:54:00.642977 [debug] [Thread-3  ]: On model.nhl_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.my_first_dbt_model"} */

  
    
    

    create  table
      "nhl"."silver"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m11:54:00.643340 [debug] [Thread-2  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    games_played,
    games_started,
    wins,
    losses,
    ties,
    otLosses as ot_losses,
    shotsAgainst as shots_against,
    saves,
    goals_against,
    savePercentage as save_percentage,
    goalsAgainstAverage as goals_against_average,
    timeOnIce as time_on_ice,
    timeOnIcePerGame as time_on_ice_per_game,
    shutouts,
    lowDangerGoals as low_danger_goals,
    mediumDangerGoals as medium_danger_goals,
    highDangerGoals as high_danger_goals,
    blocked_shot_attempts,
    penalityMinutes as penalty_minutes,
    penalties,
    -- Add data quality flags
    case
        when games_played > 0
        and saves > 0 then true
        else false
    end as is_active_goalie,
    -- Calculate additional metrics
    case
        when shotsAgainst > 0 then round(saves * 100.0 / shotsAgainst, 2)
        else null
    end as calculated_save_percentage,
    current_timestamp as loaded_at
from { { source('bronze', 'goalies') } }
where playerId is not null
    and season is not null
  );

[0m11:54:00.643572 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m11:54:00.643812 [debug] [Thread-4  ]: On model.nhl_analytics.stg_lines: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_lines"} */

  
  create view "nhl"."silver"."stg_lines__dbt_tmp" as (
    { { config(materialized = 'view') } }
select season,
    team,
    l1 as line_player_1,
    l2 as line_player_2,
    l3 as line_player_3,
    games_played,
    icetime as ice_time,
    icetimeRank as ice_time_rank,
    -- Offensive stats
    goals,
    assists,
    points,
    shots,
    shotsFor as shots_for,
    shotsAgainst as shots_against,
    -- Advanced stats
    corsiFor as corsi_for,
    corsiAgainst as corsi_against,
    corsiForPct as corsi_for_percentage,
    fenwickFor as fenwick_for,
    fenwickAgainst as fenwick_against,
    fenwickForPct as fenwick_for_percentage,
    -- Goals for/against
    goalsFor as goals_for,
    goalsAgainst as goals_against,
    goalDifferential as goal_differential,
    -- Add line identification
    concat(team, '_', l1, '_', l2, '_', l3) as line_id,
    -- Calculate additional metrics
    case
        when icetime > 0 then round(points * 60.0 / icetime, 2)
        else null
    end as points_per_60,
    case
        when shots > 0 then round(goals * 100.0 / shots, 2)
        else null
    end as shooting_percentage,
    current_timestamp as loaded_at
from { { source('bronze', 'lines') } }
where season is not null
    and team is not null
    and l1 is not null
    and l2 is not null
    and l3 is not null
  );

[0m11:54:00.644139 [debug] [Thread-2  ]: DuckDB adapter: Rolling back transaction.
[0m11:54:00.644417 [debug] [Thread-1  ]: On model.nhl_analytics.mart_team_standings: ROLLBACK
[0m11:54:00.644863 [debug] [Thread-4  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_lines"} */

  
  create view "nhl"."silver"."stg_lines__dbt_tmp" as (
    { { config(materialized = 'view') } }
select season,
    team,
    l1 as line_player_1,
    l2 as line_player_2,
    l3 as line_player_3,
    games_played,
    icetime as ice_time,
    icetimeRank as ice_time_rank,
    -- Offensive stats
    goals,
    assists,
    points,
    shots,
    shotsFor as shots_for,
    shotsAgainst as shots_against,
    -- Advanced stats
    corsiFor as corsi_for,
    corsiAgainst as corsi_against,
    corsiForPct as corsi_for_percentage,
    fenwickFor as fenwick_for,
    fenwickAgainst as fenwick_against,
    fenwickForPct as fenwick_for_percentage,
    -- Goals for/against
    goalsFor as goals_for,
    goalsAgainst as goals_against,
    goalDifferential as goal_differential,
    -- Add line identification
    concat(team, '_', l1, '_', l2, '_', l3) as line_id,
    -- Calculate additional metrics
    case
        when icetime > 0 then round(points * 60.0 / icetime, 2)
        else null
    end as points_per_60,
    case
        when shots > 0 then round(goals * 100.0 / shots, 2)
        else null
    end as shooting_percentage,
    current_timestamp as loaded_at
from { { source('bronze', 'lines') } }
where season is not null
    and team is not null
    and l1 is not null
    and l2 is not null
    and l3 is not null
  );

[0m11:54:00.645210 [debug] [Thread-2  ]: On model.nhl_analytics.stg_goalies: ROLLBACK
[0m11:54:00.645516 [debug] [Thread-4  ]: DuckDB adapter: Rolling back transaction.
[0m11:54:00.645905 [debug] [Thread-4  ]: On model.nhl_analytics.stg_lines: ROLLBACK
[0m11:54:00.649236 [debug] [Thread-1  ]: Failed to rollback 'model.nhl_analytics.mart_team_standings'
[0m11:54:00.649459 [debug] [Thread-1  ]: On model.nhl_analytics.mart_team_standings: Close
[0m11:54:00.649841 [debug] [Thread-3  ]: SQL status: OK in 0.006 seconds
[0m11:54:00.653142 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.my_first_dbt_model"
[0m11:54:00.655842 [debug] [Thread-2  ]: Failed to rollback 'model.nhl_analytics.stg_goalies'
[0m11:54:00.656067 [debug] [Thread-3  ]: On model.nhl_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.my_first_dbt_model"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'silver'
      AND table_name = 'my_first_dbt_model'
  
[0m11:54:00.656312 [debug] [Thread-2  ]: On model.nhl_analytics.stg_goalies: Close
[0m11:54:00.659169 [debug] [Thread-4  ]: Failed to rollback 'model.nhl_analytics.stg_lines'
[0m11:54:00.659396 [debug] [Thread-4  ]: On model.nhl_analytics.stg_lines: Close
[0m11:54:00.659609 [debug] [Thread-3  ]: SQL status: OK in 0.003 seconds
[0m11:54:00.662377 [debug] [Thread-1  ]: Runtime Error in model mart_team_standings (models/marts/mart_team_standings.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 11:       { { config(materialized = 'table') } }
                 ^
[0m11:54:00.662890 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1afc9a99-6bf1-4def-9da2-fc57aeb28326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096b4d90>]}
[0m11:54:00.663936 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.my_first_dbt_model"
[0m11:54:00.663268 [error] [Thread-1  ]: 5 of 11 ERROR creating sql table model silver.mart_team_standings .............. [[31mERROR[0m in 0.04s]
[0m11:54:00.664260 [debug] [Thread-3  ]: On model.nhl_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.my_first_dbt_model"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'silver'
      AND table_name = 'my_first_dbt_model'
  
[0m11:54:00.664569 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.mart_team_standings
[0m11:54:00.667315 [debug] [Thread-2  ]: Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m11:54:00.667568 [debug] [Thread-1  ]: Began running node model.nhl_analytics.stg_skaters
[0m11:54:00.667783 [debug] [Thread-3  ]: SQL status: OK in 0.003 seconds
[0m11:54:00.668046 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.mart_team_standings' to be skipped because of status 'error'.  Reason: Runtime Error in model mart_team_standings (models/marts/mart_team_standings.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 11:       { { config(materialized = 'table') } }
                 ^.
[0m11:54:00.668313 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1afc9a99-6bf1-4def-9da2-fc57aeb28326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097a9c70>]}
[0m11:54:00.671295 [debug] [Thread-4  ]: Runtime Error in model stg_lines (models/staging/stg_lines.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m11:54:00.668607 [info ] [Thread-1  ]: 9 of 11 START sql view model silver.stg_skaters ................................ [RUN]
[0m11:54:00.675364 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.my_first_dbt_model"
[0m11:54:00.675734 [error] [Thread-2  ]: 7 of 11 ERROR creating sql view model silver.stg_goalies ....................... [[31mERROR[0m in 0.05s]
[0m11:54:00.676025 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1afc9a99-6bf1-4def-9da2-fc57aeb28326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10969b250>]}
[0m11:54:00.676276 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.mart_team_standings, now model.nhl_analytics.stg_skaters)
[0m11:54:00.676496 [debug] [Thread-3  ]: On model.nhl_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.my_first_dbt_model"} */
alter table "nhl"."silver"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m11:54:00.676778 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.stg_goalies
[0m11:54:00.677102 [error] [Thread-4  ]: 8 of 11 ERROR creating sql view model silver.stg_lines ......................... [[31mERROR[0m in 0.06s]
[0m11:54:00.677343 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.stg_skaters
[0m11:54:00.677644 [debug] [Thread-2  ]: Began running node model.nhl_analytics.stg_teams
[0m11:54:00.678003 [debug] [Thread-4  ]: Finished running node model.nhl_analytics.stg_lines
[0m11:54:00.678204 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m11:54:00.678454 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_goalies' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^.
[0m11:54:00.679990 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.stg_skaters"
[0m11:54:00.680278 [info ] [Thread-2  ]: 10 of 11 START sql view model silver.stg_teams ................................. [RUN]
[0m11:54:00.682275 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.my_first_dbt_model"
[0m11:54:00.682570 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_lines' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_lines (models/staging/stg_lines.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^.
[0m11:54:00.682863 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.stg_goalies, now model.nhl_analytics.stg_teams)
[0m11:54:00.683112 [debug] [Thread-3  ]: On model.nhl_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.my_first_dbt_model"} */
alter table "nhl"."silver"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m11:54:00.683374 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.stg_skaters
[0m11:54:00.683586 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.stg_teams
[0m11:54:00.686504 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.stg_skaters"
[0m11:54:00.687837 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.stg_teams"
[0m11:54:00.688056 [debug] [Thread-3  ]: SQL status: OK in 0.004 seconds
[0m11:54:00.697525 [debug] [Thread-3  ]: On model.nhl_analytics.my_first_dbt_model: COMMIT
[0m11:54:00.697775 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.my_first_dbt_model"
[0m11:54:00.697983 [debug] [Thread-3  ]: On model.nhl_analytics.my_first_dbt_model: COMMIT
[0m11:54:00.698361 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m11:54:00.698609 [debug] [Thread-1  ]: On model.nhl_analytics.stg_skaters: BEGIN
[0m11:54:00.698863 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.stg_teams
[0m11:54:00.699108 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:54:00.699313 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m11:54:00.701567 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.stg_teams"
[0m11:54:00.705049 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.my_first_dbt_model"
[0m11:54:00.705340 [debug] [Thread-3  ]: On model.nhl_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.my_first_dbt_model"} */

      drop table if exists "nhl"."silver"."my_first_dbt_model__dbt_backup" cascade
    
[0m11:54:00.705553 [debug] [Thread-1  ]: SQL status: OK in 0.006 seconds
[0m11:54:00.705859 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m11:54:00.706080 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m11:54:00.706333 [debug] [Thread-1  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    games_played,
    time_on_ice,
    assists,
    goals,
    shots,
    points,
    plusMinus as plus_minus,
    penalityMinutes as penalty_minutes,
    faceOffWins as faceoff_wins,
    faceoffTaken as faceoff_taken,
    takeaways,
    giveaways,
    shortHandedGoals as short_handed_goals,
    shortHandedAssists as short_handed_assists,
    shortHandedPoints as short_handed_points,
    powerPlayGoals as power_play_goals,
    powerPlayAssists as power_play_assists,
    powerPlayPoints as power_play_points,
    gameWinningGoals as game_winning_goals,
    overtimeGoals as overtime_goals,
    shootoutGoals as shootout_goals,
    shootoutAttempts as shootout_attempts,
    hits,
    blocked,
    shifts,
    -- Add data quality flags
    case
        when games_played > 0 then true
        else false
    end as is_active_player,
    -- Calculate additional metrics
    case
        when games_played > 0 then round(points * 1.0 / games_played, 2)
        else null
    end as points_per_game,
    case
        when faceoffTaken > 0 then round(faceOffWins * 100.0 / faceoffTaken, 2)
        else null
    end as faceoff_percentage,
    case
        when shots > 0 then round(goals * 100.0 / shots, 2)
        else null
    end as shooting_percentage,
    current_timestamp as loaded_at
from { { source('bronze', 'skaters') } }
where playerId is not null
    and season is not null
  );

[0m11:54:00.706581 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m11:54:00.706767 [debug] [Thread-2  ]: On model.nhl_analytics.stg_teams: BEGIN
[0m11:54:00.707157 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    games_played,
    time_on_ice,
    assists,
    goals,
    shots,
    points,
    plusMinus as plus_minus,
    penalityMinutes as penalty_minutes,
    faceOffWins as faceoff_wins,
    faceoffTaken as faceoff_taken,
    takeaways,
    giveaways,
    shortHandedGoals as short_handed_goals,
    shortHandedAssists as short_handed_assists,
    shortHandedPoints as short_handed_points,
    powerPlayGoals as power_play_goals,
    powerPlayAssists as power_play_assists,
    powerPlayPoints as power_play_points,
    gameWinningGoals as game_winning_goals,
    overtimeGoals as overtime_goals,
    shootoutGoals as shootout_goals,
    shootoutAttempts as shootout_attempts,
    hits,
    blocked,
    shifts,
    -- Add data quality flags
    case
        when games_played > 0 then true
        else false
    end as is_active_player,
    -- Calculate additional metrics
    case
        when games_played > 0 then round(points * 1.0 / games_played, 2)
        else null
    end as points_per_game,
    case
        when faceoffTaken > 0 then round(faceOffWins * 100.0 / faceoffTaken, 2)
        else null
    end as faceoff_percentage,
    case
        when shots > 0 then round(goals * 100.0 / shots, 2)
        else null
    end as shooting_percentage,
    current_timestamp as loaded_at
from { { source('bronze', 'skaters') } }
where playerId is not null
    and season is not null
  );

[0m11:54:00.708594 [debug] [Thread-3  ]: On model.nhl_analytics.my_first_dbt_model: Close
[0m11:54:00.708805 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:54:00.709016 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m11:54:00.709346 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1afc9a99-6bf1-4def-9da2-fc57aeb28326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106454670>]}
[0m11:54:00.709677 [debug] [Thread-1  ]: On model.nhl_analytics.stg_skaters: ROLLBACK
[0m11:54:00.709963 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m11:54:00.710261 [info ] [Thread-3  ]: 6 of 11 OK created sql table model silver.my_first_dbt_model ................... [[32mOK[0m in 0.09s]
[0m11:54:00.710533 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m11:54:00.710836 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.my_first_dbt_model
[0m11:54:00.711100 [debug] [Thread-2  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

  
  create view "nhl"."silver"."stg_teams__dbt_tmp" as (
    { { config(materialized = 'view') } }
select season,
    name as team_name,
    wins,
    losses,
    ot as overtime_losses,
    points as team_points,
    pointPctg as points_percentage,
    goalsPerGame as goals_per_game,
    goalsAgainstPerGame as goals_against_per_game,
    powerPlayPercentage as power_play_percentage,
    powerPlayGoals as power_play_goals,
    powerPlayOpportunities as power_play_opportunities,
    penaltyKillPercentage as penalty_kill_percentage,
    shotsPerGame as shots_per_game,
    shotsAllowed as shots_allowed_per_game,
    winScoreFirst as wins_when_scoring_first,
    winOppScoreFirst as wins_when_opponent_scores_first,
    winLeadFirstPer as wins_leading_first_period,
    winLeadSecondPer as wins_leading_second_period,
    winOutshootOpp as wins_when_outshooting_opponent,
    winOutshotByOpp as wins_when_outshot_by_opponent,
    faceOffsTaken as faceoffs_taken,
    faceOffsWon as faceoffs_won,
    -- Calculate additional metrics
    case
        when faceOffsTaken > 0 then round(faceOffsWon * 100.0 / faceOffsTaken, 2)
        else null
    end as faceoff_percentage,
    wins + losses + ot as games_played,
    current_timestamp as loaded_at
from { { source('bronze', 'teams') } }
where season is not null
    and name is not null
  );

[0m11:54:00.711736 [debug] [Thread-2  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

  
  create view "nhl"."silver"."stg_teams__dbt_tmp" as (
    { { config(materialized = 'view') } }
select season,
    name as team_name,
    wins,
    losses,
    ot as overtime_losses,
    points as team_points,
    pointPctg as points_percentage,
    goalsPerGame as goals_per_game,
    goalsAgainstPerGame as goals_against_per_game,
    powerPlayPercentage as power_play_percentage,
    powerPlayGoals as power_play_goals,
    powerPlayOpportunities as power_play_opportunities,
    penaltyKillPercentage as penalty_kill_percentage,
    shotsPerGame as shots_per_game,
    shotsAllowed as shots_allowed_per_game,
    winScoreFirst as wins_when_scoring_first,
    winOppScoreFirst as wins_when_opponent_scores_first,
    winLeadFirstPer as wins_leading_first_period,
    winLeadSecondPer as wins_leading_second_period,
    winOutshootOpp as wins_when_outshooting_opponent,
    winOutshotByOpp as wins_when_outshot_by_opponent,
    faceOffsTaken as faceoffs_taken,
    faceOffsWon as faceoffs_won,
    -- Calculate additional metrics
    case
        when faceOffsTaken > 0 then round(faceOffsWon * 100.0 / faceOffsTaken, 2)
        else null
    end as faceoff_percentage,
    wins + losses + ot as games_played,
    current_timestamp as loaded_at
from { { source('bronze', 'teams') } }
where season is not null
    and name is not null
  );

[0m11:54:00.712009 [debug] [Thread-4  ]: Began running node model.nhl_analytics.my_second_dbt_model
[0m11:54:00.712242 [debug] [Thread-2  ]: DuckDB adapter: Rolling back transaction.
[0m11:54:00.712538 [info ] [Thread-4  ]: 11 of 11 START sql table model silver.my_second_dbt_model ...................... [RUN]
[0m11:54:00.712838 [debug] [Thread-2  ]: On model.nhl_analytics.stg_teams: ROLLBACK
[0m11:54:00.713098 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.stg_lines, now model.nhl_analytics.my_second_dbt_model)
[0m11:54:00.716237 [debug] [Thread-1  ]: Failed to rollback 'model.nhl_analytics.stg_skaters'
[0m11:54:00.716491 [debug] [Thread-4  ]: Began compiling node model.nhl_analytics.my_second_dbt_model
[0m11:54:00.716727 [debug] [Thread-1  ]: On model.nhl_analytics.stg_skaters: Close
[0m11:54:00.718664 [debug] [Thread-4  ]: Writing injected SQL for node "model.nhl_analytics.my_second_dbt_model"
[0m11:54:00.721557 [debug] [Thread-2  ]: Failed to rollback 'model.nhl_analytics.stg_teams'
[0m11:54:00.721779 [debug] [Thread-2  ]: On model.nhl_analytics.stg_teams: Close
[0m11:54:00.724703 [debug] [Thread-1  ]: Runtime Error in model stg_skaters (models/staging/stg_skaters.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m11:54:00.724938 [debug] [Thread-4  ]: Began executing node model.nhl_analytics.my_second_dbt_model
[0m11:54:00.725193 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1afc9a99-6bf1-4def-9da2-fc57aeb28326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109221f40>]}
[0m11:54:00.727794 [debug] [Thread-2  ]: Runtime Error in model stg_teams (models/staging/stg_teams.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m11:54:00.730249 [debug] [Thread-4  ]: Writing runtime sql for node "model.nhl_analytics.my_second_dbt_model"
[0m11:54:00.730605 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1afc9a99-6bf1-4def-9da2-fc57aeb28326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097ad970>]}
[0m11:54:00.730911 [error] [Thread-1  ]: 9 of 11 ERROR creating sql view model silver.stg_skaters ....................... [[31mERROR[0m in 0.05s]
[0m11:54:00.731615 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.stg_skaters
[0m11:54:00.731336 [error] [Thread-2  ]: 10 of 11 ERROR creating sql view model silver.stg_teams ........................ [[31mERROR[0m in 0.05s]
[0m11:54:00.732035 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.stg_teams
[0m11:54:00.732280 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.my_second_dbt_model"
[0m11:54:00.732535 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_skaters' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_skaters (models/staging/stg_skaters.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^.
[0m11:54:00.732770 [debug] [Thread-4  ]: On model.nhl_analytics.my_second_dbt_model: BEGIN
[0m11:54:00.733055 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_teams' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_teams (models/staging/stg_teams.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^.
[0m11:54:00.733259 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m11:54:00.733648 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m11:54:00.733845 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.my_second_dbt_model"
[0m11:54:00.734033 [debug] [Thread-4  ]: On model.nhl_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.my_second_dbt_model"} */

  
    
    

    create  table
      "nhl"."silver"."my_second_dbt_model__dbt_tmp"
  
    as (
      -- Use the `ref` function to select from other models

select *
from "nhl"."silver"."my_first_dbt_model"
where id = 1
    );
  
  
[0m11:54:00.734729 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m11:54:00.735303 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.my_second_dbt_model"
[0m11:54:00.735500 [debug] [Thread-4  ]: On model.nhl_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.my_second_dbt_model"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'silver'
      AND table_name = 'my_second_dbt_model'
  
[0m11:54:00.735975 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m11:54:00.736627 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.my_second_dbt_model"
[0m11:54:00.736881 [debug] [Thread-4  ]: On model.nhl_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.my_second_dbt_model"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'silver'
      AND table_name = 'my_second_dbt_model'
  
[0m11:54:00.737419 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m11:54:00.740192 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.my_second_dbt_model"
[0m11:54:00.740404 [debug] [Thread-4  ]: On model.nhl_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.my_second_dbt_model"} */
alter table "nhl"."silver"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m11:54:00.740742 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m11:54:00.742548 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.my_second_dbt_model"
[0m11:54:00.742764 [debug] [Thread-4  ]: On model.nhl_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.my_second_dbt_model"} */
alter table "nhl"."silver"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m11:54:00.743111 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m11:54:00.744110 [debug] [Thread-4  ]: On model.nhl_analytics.my_second_dbt_model: COMMIT
[0m11:54:00.744307 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.my_second_dbt_model"
[0m11:54:00.744501 [debug] [Thread-4  ]: On model.nhl_analytics.my_second_dbt_model: COMMIT
[0m11:54:00.744931 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m11:54:00.746736 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.my_second_dbt_model"
[0m11:54:00.746940 [debug] [Thread-4  ]: On model.nhl_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.my_second_dbt_model"} */

      drop table if exists "nhl"."silver"."my_second_dbt_model__dbt_backup" cascade
    
[0m11:54:00.747355 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m11:54:00.748047 [debug] [Thread-4  ]: On model.nhl_analytics.my_second_dbt_model: Close
[0m11:54:00.748353 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1afc9a99-6bf1-4def-9da2-fc57aeb28326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099167f0>]}
[0m11:54:00.748685 [info ] [Thread-4  ]: 11 of 11 OK created sql table model silver.my_second_dbt_model ................. [[32mOK[0m in 0.04s]
[0m11:54:00.748998 [debug] [Thread-4  ]: Finished running node model.nhl_analytics.my_second_dbt_model
[0m11:54:00.749599 [debug] [MainThread]: Using duckdb connection "master"
[0m11:54:00.749770 [debug] [MainThread]: On master: BEGIN
[0m11:54:00.749919 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:54:00.750186 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:54:00.750352 [debug] [MainThread]: On master: COMMIT
[0m11:54:00.750507 [debug] [MainThread]: Using duckdb connection "master"
[0m11:54:00.750653 [debug] [MainThread]: On master: COMMIT
[0m11:54:00.750881 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:54:00.751048 [debug] [MainThread]: On master: Close
[0m11:54:00.751245 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:54:00.751391 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_skaters' was properly closed.
[0m11:54:00.751529 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_teams' was properly closed.
[0m11:54:00.751666 [debug] [MainThread]: Connection 'model.nhl_analytics.my_first_dbt_model' was properly closed.
[0m11:54:00.751802 [debug] [MainThread]: Connection 'model.nhl_analytics.my_second_dbt_model' was properly closed.
[0m11:54:00.752012 [info ] [MainThread]: 
[0m11:54:00.752199 [info ] [MainThread]: Finished running 5 table models, 6 view models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m11:54:00.753211 [debug] [MainThread]: Command end result
[0m11:54:00.769196 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m11:54:00.770112 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m11:54:00.774348 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/run_results.json
[0m11:54:00.774540 [info ] [MainThread]: 
[0m11:54:00.774767 [info ] [MainThread]: [31mCompleted with 9 errors, 0 partial successes, and 0 warnings:[0m
[0m11:54:00.774952 [info ] [MainThread]: 
[0m11:54:00.775168 [error] [MainThread]: [31mFailure in model int_all_players (models/intermediate/int_all_players.sql)[0m
[0m11:54:00.775383 [error] [MainThread]:   Runtime Error in model int_all_players (models/intermediate/int_all_players.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } } with all_players as (
              ^
[0m11:54:00.775556 [info ] [MainThread]: 
[0m11:54:00.775755 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/intermediate/int_all_players.sql
[0m11:54:00.775929 [info ] [MainThread]: 
[0m11:54:00.776133 [error] [MainThread]: [31mFailure in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)[0m
[0m11:54:00.776343 [error] [MainThread]:   Runtime Error in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 11:       { { config(materialized = 'table') } }
                 ^
[0m11:54:00.776510 [info ] [MainThread]: 
[0m11:54:00.776705 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/marts/mart_goalie_performance.sql
[0m11:54:00.776874 [info ] [MainThread]: 
[0m11:54:00.777077 [error] [MainThread]: [31mFailure in model int_team_performance (models/intermediate/int_team_performance.sql)[0m
[0m11:54:00.777283 [error] [MainThread]:   Runtime Error in model int_team_performance (models/intermediate/int_team_performance.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } } with team_stats as (
              ^
[0m11:54:00.777451 [info ] [MainThread]: 
[0m11:54:00.777646 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/intermediate/int_team_performance.sql
[0m11:54:00.777816 [info ] [MainThread]: 
[0m11:54:00.778119 [error] [MainThread]: [31mFailure in model mart_player_performance (models/marts/mart_player_performance.sql)[0m
[0m11:54:00.778352 [error] [MainThread]:   Runtime Error in model mart_player_performance (models/marts/mart_player_performance.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 11:       { { config(materialized = 'table') } }
                 ^
[0m11:54:00.778536 [info ] [MainThread]: 
[0m11:54:00.778747 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/marts/mart_player_performance.sql
[0m11:54:00.778928 [info ] [MainThread]: 
[0m11:54:00.779220 [error] [MainThread]: [31mFailure in model mart_team_standings (models/marts/mart_team_standings.sql)[0m
[0m11:54:00.779441 [error] [MainThread]:   Runtime Error in model mart_team_standings (models/marts/mart_team_standings.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 11:       { { config(materialized = 'table') } }
                 ^
[0m11:54:00.779620 [info ] [MainThread]: 
[0m11:54:00.779823 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/marts/mart_team_standings.sql
[0m11:54:00.780000 [info ] [MainThread]: 
[0m11:54:00.780210 [error] [MainThread]: [31mFailure in model stg_goalies (models/staging/stg_goalies.sql)[0m
[0m11:54:00.780964 [error] [MainThread]:   Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m11:54:00.781167 [info ] [MainThread]: 
[0m11:54:00.781368 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_goalies.sql
[0m11:54:00.781545 [info ] [MainThread]: 
[0m11:54:00.781752 [error] [MainThread]: [31mFailure in model stg_lines (models/staging/stg_lines.sql)[0m
[0m11:54:00.781959 [error] [MainThread]:   Runtime Error in model stg_lines (models/staging/stg_lines.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m11:54:00.782128 [info ] [MainThread]: 
[0m11:54:00.782322 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_lines.sql
[0m11:54:00.782493 [info ] [MainThread]: 
[0m11:54:00.782695 [error] [MainThread]: [31mFailure in model stg_skaters (models/staging/stg_skaters.sql)[0m
[0m11:54:00.782901 [error] [MainThread]:   Runtime Error in model stg_skaters (models/staging/stg_skaters.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m11:54:00.783068 [info ] [MainThread]: 
[0m11:54:00.783264 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_skaters.sql
[0m11:54:00.783434 [info ] [MainThread]: 
[0m11:54:00.783632 [error] [MainThread]: [31mFailure in model stg_teams (models/staging/stg_teams.sql)[0m
[0m11:54:00.783832 [error] [MainThread]:   Runtime Error in model stg_teams (models/staging/stg_teams.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m11:54:00.783998 [info ] [MainThread]: 
[0m11:54:00.784224 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_teams.sql
[0m11:54:00.784401 [info ] [MainThread]: 
[0m11:54:00.784596 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=9 SKIP=0 NO-OP=0 TOTAL=11
[0m11:54:00.785508 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.070362, "process_in_blocks": "0", "process_kernel_time": 0.191227, "process_mem_max_rss": "148291584", "process_out_blocks": "0", "process_user_time": 1.640765}
[0m11:54:00.785750 [debug] [MainThread]: Command `dbt run` failed at 11:54:00.785703 after 1.07 seconds
[0m11:54:00.785972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ae0ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10841a400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d52220>]}
[0m11:54:00.786206 [debug] [MainThread]: Flushing usage events
[0m11:54:01.069615 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:55:29.628056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10797ca30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111428430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111428250>]}


============================== 11:55:29.630840 | 163df7aa-aca2-4dc0-b454-aad13c293aaf ==============================
[0m11:55:29.630840 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:55:29.631190 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'partial_parse': 'True', 'target_path': 'None', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'warn_error': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --profiles-dir=. --select stg_goalies', 'quiet': 'False', 'static_parser': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'debug': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'use_colors': 'True', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'printer_width': '80'}
[0m11:55:29.763133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '163df7aa-aca2-4dc0-b454-aad13c293aaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130d62e0>]}
[0m11:55:29.797383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '163df7aa-aca2-4dc0-b454-aad13c293aaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130f18e0>]}
[0m11:55:29.798721 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:55:29.867151 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:55:29.867627 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:55:29.867870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '163df7aa-aca2-4dc0-b454-aad13c293aaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113bc0d0>]}
[0m11:55:30.637014 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.nhl_analytics.marts
- models.nhl_analytics.intermediate
[0m11:55:30.645604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '163df7aa-aca2-4dc0-b454-aad13c293aaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139f7130>]}
[0m11:55:30.733408 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m11:55:30.734879 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m11:55:30.745042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '163df7aa-aca2-4dc0-b454-aad13c293aaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139576a0>]}
[0m11:55:30.745356 [info ] [MainThread]: Found 3 models, 6 data tests, 4 sources, 444 macros
[0m11:55:30.745574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '163df7aa-aca2-4dc0-b454-aad13c293aaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138f7ca0>]}
[0m11:55:30.746241 [info ] [MainThread]: 
[0m11:55:30.746454 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:55:30.746631 [info ] [MainThread]: 
[0m11:55:30.746911 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:55:30.747379 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl'
[0m11:55:30.778402 [debug] [ThreadPool]: Using duckdb connection "list_nhl"
[0m11:55:30.778694 [debug] [ThreadPool]: On list_nhl: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m11:55:30.778895 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:30.813498 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m11:55:30.814644 [debug] [ThreadPool]: On list_nhl: Close
[0m11:55:30.815100 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nhl, now create_nhl_silver)
[0m11:55:30.815385 [debug] [ThreadPool]: Creating schema "database: "nhl"
schema: "silver"
"
[0m11:55:30.819789 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:55:30.819983 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nhl'
        and type='sqlite'
    
  
[0m11:55:30.820149 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:55:30.820615 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:55:30.821321 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:55:30.821504 [debug] [ThreadPool]: On create_nhl_silver: BEGIN
[0m11:55:30.821758 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:55:30.821928 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:55:30.822100 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
    
        create schema if not exists "nhl"."silver"
    
[0m11:55:30.822374 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:55:30.822830 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m11:55:30.823000 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:55:30.823152 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m11:55:30.823391 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:55:30.823564 [debug] [ThreadPool]: On create_nhl_silver: Close
[0m11:55:30.826802 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nhl_silver, now list_nhl_silver)
[0m11:55:30.830745 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m11:55:30.830941 [debug] [ThreadPool]: On list_nhl_silver: BEGIN
[0m11:55:30.831104 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:55:30.831405 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:55:30.831568 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m11:55:30.831735 [debug] [ThreadPool]: On list_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl_silver"} */
select
      'nhl' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'silver'
    and lower(table_catalog) = 'nhl'
  
[0m11:55:30.838626 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m11:55:30.839337 [debug] [ThreadPool]: On list_nhl_silver: ROLLBACK
[0m11:55:30.840738 [debug] [ThreadPool]: Failed to rollback 'list_nhl_silver'
[0m11:55:30.840945 [debug] [ThreadPool]: On list_nhl_silver: Close
[0m11:55:30.841443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '163df7aa-aca2-4dc0-b454-aad13c293aaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11399db50>]}
[0m11:55:30.841718 [debug] [MainThread]: Using duckdb connection "master"
[0m11:55:30.841883 [debug] [MainThread]: On master: BEGIN
[0m11:55:30.842032 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:55:30.842297 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:55:30.842467 [debug] [MainThread]: On master: COMMIT
[0m11:55:30.842633 [debug] [MainThread]: Using duckdb connection "master"
[0m11:55:30.842781 [debug] [MainThread]: On master: COMMIT
[0m11:55:30.843043 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:55:30.843214 [debug] [MainThread]: On master: Close
[0m11:55:30.844730 [debug] [Thread-1  ]: Began running node model.nhl_analytics.stg_goalies
[0m11:55:30.845046 [info ] [Thread-1  ]: 1 of 1 START sql view model silver.stg_goalies ................................. [RUN]
[0m11:55:30.845312 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_nhl_silver, now model.nhl_analytics.stg_goalies)
[0m11:55:30.845527 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.stg_goalies
[0m11:55:30.849873 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.stg_goalies"
[0m11:55:30.850399 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.stg_goalies
[0m11:55:30.869186 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.stg_goalies"
[0m11:55:30.869809 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:55:30.870020 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: BEGIN
[0m11:55:30.870206 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:55:30.870581 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m11:55:30.870769 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:55:30.870983 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    games_played,
    games_started,
    wins,
    losses,
    ties,
    otLosses as ot_losses,
    shotsAgainst as shots_against,
    saves,
    goals_against,
    savePercentage as save_percentage,
    goalsAgainstAverage as goals_against_average,
    timeOnIce as time_on_ice,
    timeOnIcePerGame as time_on_ice_per_game,
    shutouts,
    lowDangerGoals as low_danger_goals,
    mediumDangerGoals as medium_danger_goals,
    highDangerGoals as high_danger_goals,
    blocked_shot_attempts,
    penalityMinutes as penalty_minutes,
    penalties,
    -- Add data quality flags
    case
        when games_played > 0
        and saves > 0 then true
        else false
    end as is_active_goalie,
    -- Calculate additional metrics
    case
        when shotsAgainst > 0 then round(saves * 100.0 / shotsAgainst, 2)
        else null
    end as calculated_save_percentage,
    current_timestamp as loaded_at
from { { source('bronze', 'goalies') } }
where playerId is not null
    and season is not null
  );

[0m11:55:30.871633 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    games_played,
    games_started,
    wins,
    losses,
    ties,
    otLosses as ot_losses,
    shotsAgainst as shots_against,
    saves,
    goals_against,
    savePercentage as save_percentage,
    goalsAgainstAverage as goals_against_average,
    timeOnIce as time_on_ice,
    timeOnIcePerGame as time_on_ice_per_game,
    shutouts,
    lowDangerGoals as low_danger_goals,
    mediumDangerGoals as medium_danger_goals,
    highDangerGoals as high_danger_goals,
    blocked_shot_attempts,
    penalityMinutes as penalty_minutes,
    penalties,
    -- Add data quality flags
    case
        when games_played > 0
        and saves > 0 then true
        else false
    end as is_active_goalie,
    -- Calculate additional metrics
    case
        when shotsAgainst > 0 then round(saves * 100.0 / shotsAgainst, 2)
        else null
    end as calculated_save_percentage,
    current_timestamp as loaded_at
from { { source('bronze', 'goalies') } }
where playerId is not null
    and season is not null
  );

[0m11:55:30.871891 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m11:55:30.872164 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: ROLLBACK
[0m11:55:30.888162 [debug] [Thread-1  ]: Failed to rollback 'model.nhl_analytics.stg_goalies'
[0m11:55:30.888390 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: Close
[0m11:55:30.891507 [debug] [Thread-1  ]: Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m11:55:30.892760 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '163df7aa-aca2-4dc0-b454-aad13c293aaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113227730>]}
[0m11:55:30.893159 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model silver.stg_goalies ........................ [[31mERROR[0m in 0.05s]
[0m11:55:30.893496 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.stg_goalies
[0m11:55:30.893792 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_goalies' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^.
[0m11:55:30.894392 [debug] [MainThread]: Using duckdb connection "master"
[0m11:55:30.894609 [debug] [MainThread]: On master: BEGIN
[0m11:55:30.894789 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:55:30.895108 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:55:30.895287 [debug] [MainThread]: On master: COMMIT
[0m11:55:30.895453 [debug] [MainThread]: Using duckdb connection "master"
[0m11:55:30.895609 [debug] [MainThread]: On master: COMMIT
[0m11:55:30.895857 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:55:30.896031 [debug] [MainThread]: On master: Close
[0m11:55:30.896244 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:55:30.896393 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_goalies' was properly closed.
[0m11:55:30.896559 [info ] [MainThread]: 
[0m11:55:30.896748 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m11:55:30.897123 [debug] [MainThread]: Command end result
[0m11:55:30.911569 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m11:55:30.912623 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m11:55:30.916515 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/run_results.json
[0m11:55:30.916706 [info ] [MainThread]: 
[0m11:55:30.916940 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:55:30.917128 [info ] [MainThread]: 
[0m11:55:30.917352 [error] [MainThread]: [31mFailure in model stg_goalies (models/staging/stg_goalies.sql)[0m
[0m11:55:30.917574 [error] [MainThread]:   Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m11:55:30.917748 [info ] [MainThread]: 
[0m11:55:30.917948 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_goalies.sql
[0m11:55:30.918120 [info ] [MainThread]: 
[0m11:55:30.918311 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m11:55:30.919162 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3334018, "process_in_blocks": "0", "process_kernel_time": 0.173883, "process_mem_max_rss": "147767296", "process_out_blocks": "0", "process_user_time": 1.928981}
[0m11:55:30.919380 [debug] [MainThread]: Command `dbt run` failed at 11:55:30.919338 after 1.33 seconds
[0m11:55:30.919581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10797ca30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ce08e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113957bb0>]}
[0m11:55:30.919784 [debug] [MainThread]: Flushing usage events
[0m11:55:31.151192 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:56:00.919095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d7ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105928460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105928280>]}


============================== 11:56:00.921818 | 9e8d96d6-57ed-4cb3-aa74-15db38ce0393 ==============================
[0m11:56:00.921818 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:56:00.922157 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'version_check': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'profiles_dir': '.', 'partial_parse': 'True', 'log_format': 'default', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'no_print': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'fail_fast': 'False', 'invocation_command': 'dbt run --profiles-dir=. --select stg_goalies', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'use_colors': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'introspect': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'write_json': 'True'}
[0m11:56:01.096750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e8d96d6-57ed-4cb3-aa74-15db38ce0393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059ec6a0>]}
[0m11:56:01.131249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e8d96d6-57ed-4cb3-aa74-15db38ce0393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047de760>]}
[0m11:56:01.132879 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:56:01.202110 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:56:01.293314 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:56:01.293686 [debug] [MainThread]: Partial parsing: updated file: nhl_analytics://models/staging/stg_goalies.sql
[0m11:56:01.441799 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.nhl_analytics.marts
- models.nhl_analytics.intermediate
[0m11:56:01.479645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e8d96d6-57ed-4cb3-aa74-15db38ce0393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cd9280>]}
[0m11:56:01.541875 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m11:56:01.543281 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m11:56:01.553423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e8d96d6-57ed-4cb3-aa74-15db38ce0393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cdfe20>]}
[0m11:56:01.553722 [info ] [MainThread]: Found 3 models, 6 data tests, 4 sources, 444 macros
[0m11:56:01.553953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e8d96d6-57ed-4cb3-aa74-15db38ce0393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c82e50>]}
[0m11:56:01.554612 [info ] [MainThread]: 
[0m11:56:01.554841 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:56:01.555016 [info ] [MainThread]: 
[0m11:56:01.555291 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:56:01.555747 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl'
[0m11:56:01.586506 [debug] [ThreadPool]: Using duckdb connection "list_nhl"
[0m11:56:01.586758 [debug] [ThreadPool]: On list_nhl: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m11:56:01.586936 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:56:01.628804 [debug] [ThreadPool]: SQL status: OK in 0.042 seconds
[0m11:56:01.629959 [debug] [ThreadPool]: On list_nhl: Close
[0m11:56:01.630354 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nhl, now create_nhl_silver)
[0m11:56:01.630622 [debug] [ThreadPool]: Creating schema "database: "nhl"
schema: "silver"
"
[0m11:56:01.635091 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:56:01.635288 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nhl'
        and type='sqlite'
    
  
[0m11:56:01.635455 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:56:01.636040 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:56:01.636838 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:56:01.637012 [debug] [ThreadPool]: On create_nhl_silver: BEGIN
[0m11:56:01.637267 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:56:01.637437 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:56:01.637608 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
    
        create schema if not exists "nhl"."silver"
    
[0m11:56:01.638013 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:56:01.638478 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m11:56:01.638642 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:56:01.638793 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m11:56:01.639032 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:56:01.639206 [debug] [ThreadPool]: On create_nhl_silver: Close
[0m11:56:01.642393 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nhl_silver, now list_nhl_silver)
[0m11:56:01.645979 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m11:56:01.646183 [debug] [ThreadPool]: On list_nhl_silver: BEGIN
[0m11:56:01.646345 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:56:01.646635 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:56:01.646812 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m11:56:01.646995 [debug] [ThreadPool]: On list_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl_silver"} */
select
      'nhl' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'silver'
    and lower(table_catalog) = 'nhl'
  
[0m11:56:01.656746 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m11:56:01.657610 [debug] [ThreadPool]: On list_nhl_silver: ROLLBACK
[0m11:56:01.658818 [debug] [ThreadPool]: Failed to rollback 'list_nhl_silver'
[0m11:56:01.659000 [debug] [ThreadPool]: On list_nhl_silver: Close
[0m11:56:01.659701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e8d96d6-57ed-4cb3-aa74-15db38ce0393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059ec850>]}
[0m11:56:01.659961 [debug] [MainThread]: Using duckdb connection "master"
[0m11:56:01.660131 [debug] [MainThread]: On master: BEGIN
[0m11:56:01.660277 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:56:01.660544 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:56:01.660716 [debug] [MainThread]: On master: COMMIT
[0m11:56:01.660883 [debug] [MainThread]: Using duckdb connection "master"
[0m11:56:01.661076 [debug] [MainThread]: On master: COMMIT
[0m11:56:01.661376 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:56:01.661602 [debug] [MainThread]: On master: Close
[0m11:56:01.663083 [debug] [Thread-1  ]: Began running node model.nhl_analytics.stg_goalies
[0m11:56:01.663390 [info ] [Thread-1  ]: 1 of 1 START sql view model silver.stg_goalies ................................. [RUN]
[0m11:56:01.663659 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_nhl_silver, now model.nhl_analytics.stg_goalies)
[0m11:56:01.663877 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.stg_goalies
[0m11:56:01.668985 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.stg_goalies"
[0m11:56:01.669392 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.stg_goalies
[0m11:56:01.688226 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.stg_goalies"
[0m11:56:01.688735 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:56:01.688954 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: BEGIN
[0m11:56:01.689140 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:56:01.689533 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m11:56:01.689739 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:56:01.689927 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    

select
    playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position
from "nhl"."bronze"."goalies"
where playerId is not null
    and season is not null
    limit 10
  );

[0m11:56:01.690360 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m11:56:01.693978 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:56:01.694190 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */
alter view "nhl"."silver"."stg_goalies__dbt_tmp" rename to "stg_goalies"
[0m11:56:01.694950 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m11:56:01.701603 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: COMMIT
[0m11:56:01.701833 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:56:01.702034 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: COMMIT
[0m11:56:01.703243 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m11:56:01.706582 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:56:01.706795 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

      drop view if exists "nhl"."silver"."stg_goalies__dbt_backup" cascade
    
[0m11:56:01.707147 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m11:56:01.708482 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: Close
[0m11:56:01.709555 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e8d96d6-57ed-4cb3-aa74-15db38ce0393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106edc640>]}
[0m11:56:01.709909 [info ] [Thread-1  ]: 1 of 1 OK created sql view model silver.stg_goalies ............................ [[32mOK[0m in 0.05s]
[0m11:56:01.710235 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.stg_goalies
[0m11:56:01.710812 [debug] [MainThread]: Using duckdb connection "master"
[0m11:56:01.711015 [debug] [MainThread]: On master: BEGIN
[0m11:56:01.711202 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:56:01.711526 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:56:01.711732 [debug] [MainThread]: On master: COMMIT
[0m11:56:01.711900 [debug] [MainThread]: Using duckdb connection "master"
[0m11:56:01.712056 [debug] [MainThread]: On master: COMMIT
[0m11:56:01.712322 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:56:01.712504 [debug] [MainThread]: On master: Close
[0m11:56:01.712714 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:56:01.712866 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_goalies' was properly closed.
[0m11:56:01.713025 [info ] [MainThread]: 
[0m11:56:01.713216 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m11:56:01.713581 [debug] [MainThread]: Command end result
[0m11:56:01.727449 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m11:56:01.728444 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m11:56:01.732499 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/run_results.json
[0m11:56:01.732699 [info ] [MainThread]: 
[0m11:56:01.732955 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:56:01.733137 [info ] [MainThread]: 
[0m11:56:01.733337 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:56:01.734215 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.85662293, "process_in_blocks": "0", "process_kernel_time": 0.179525, "process_mem_max_rss": "144621568", "process_out_blocks": "0", "process_user_time": 1.40406}
[0m11:56:01.734428 [debug] [MainThread]: Command `dbt run` succeeded at 11:56:01.734389 after 0.86 seconds
[0m11:56:01.734628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d7ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030fba60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cdfe20>]}
[0m11:56:01.734833 [debug] [MainThread]: Flushing usage events
[0m11:56:01.945870 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:56:58.849299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b74a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bf8430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bf8250>]}


============================== 11:56:58.852553 | dd01eb8a-2d50-4ef3-8f49-a9ae8154f6f7 ==============================
[0m11:56:58.852553 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:56:58.852935 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'debug': 'False', 'printer_width': '80', 'invocation_command': 'dbt run --profiles-dir=.', 'cache_selected_only': 'False', 'static_parser': 'True', 'no_print': 'None', 'introspect': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'version_check': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'quiet': 'False', 'partial_parse': 'True', 'profiles_dir': '.', 'log_cache_events': 'False', 'log_format': 'default', 'empty': 'False', 'write_json': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False'}
[0m11:56:59.020301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd01eb8a-2d50-4ef3-8f49-a9ae8154f6f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104506940>]}
[0m11:56:59.054329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd01eb8a-2d50-4ef3-8f49-a9ae8154f6f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ce1a90>]}
[0m11:56:59.055636 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:56:59.125745 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:56:59.215616 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 2 files changed.
[0m11:56:59.215938 [debug] [MainThread]: Partial parsing: added file: nhl_analytics://models/intermediate/int_all_players.sql
[0m11:56:59.216136 [debug] [MainThread]: Partial parsing: added file: nhl_analytics://models/marts/mart_team_standings.sql
[0m11:56:59.216315 [debug] [MainThread]: Partial parsing: added file: nhl_analytics://models/marts/mart_player_performance.sql
[0m11:56:59.216540 [debug] [MainThread]: Partial parsing: updated file: nhl_analytics://models/staging/stg_skaters.sql
[0m11:56:59.216747 [debug] [MainThread]: Partial parsing: updated file: nhl_analytics://models/staging/stg_teams.sql
[0m11:56:59.407919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd01eb8a-2d50-4ef3-8f49-a9ae8154f6f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ded070>]}
[0m11:56:59.470667 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m11:56:59.472202 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m11:56:59.482318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd01eb8a-2d50-4ef3-8f49-a9ae8154f6f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de2e20>]}
[0m11:56:59.482616 [info ] [MainThread]: Found 6 data tests, 6 models, 4 sources, 444 macros
[0m11:56:59.482837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd01eb8a-2d50-4ef3-8f49-a9ae8154f6f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ded340>]}
[0m11:56:59.483710 [info ] [MainThread]: 
[0m11:56:59.483914 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:56:59.484089 [info ] [MainThread]: 
[0m11:56:59.484361 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:56:59.487396 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl'
[0m11:56:59.515629 [debug] [ThreadPool]: Using duckdb connection "list_nhl"
[0m11:56:59.515880 [debug] [ThreadPool]: On list_nhl: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m11:56:59.516053 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:56:59.562043 [debug] [ThreadPool]: SQL status: OK in 0.046 seconds
[0m11:56:59.562966 [debug] [ThreadPool]: On list_nhl: Close
[0m11:56:59.563416 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nhl, now create_nhl_silver)
[0m11:56:59.563691 [debug] [ThreadPool]: Creating schema "database: "nhl"
schema: "silver"
"
[0m11:56:59.568679 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:56:59.568948 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nhl'
        and type='sqlite'
    
  
[0m11:56:59.569144 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:56:59.569883 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:56:59.570807 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:56:59.571001 [debug] [ThreadPool]: On create_nhl_silver: BEGIN
[0m11:56:59.571290 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:56:59.571465 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:56:59.571637 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
    
        create schema if not exists "nhl"."silver"
    
[0m11:56:59.572069 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:56:59.572548 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m11:56:59.572725 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:56:59.572884 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m11:56:59.573132 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:56:59.573311 [debug] [ThreadPool]: On create_nhl_silver: Close
[0m11:56:59.574159 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nhl_silver, now list_nhl_silver)
[0m11:56:59.577714 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m11:56:59.577927 [debug] [ThreadPool]: On list_nhl_silver: BEGIN
[0m11:56:59.578099 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:56:59.578383 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:56:59.578548 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m11:56:59.578723 [debug] [ThreadPool]: On list_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl_silver"} */
select
      'nhl' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'silver'
    and lower(table_catalog) = 'nhl'
  
[0m11:56:59.588610 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m11:56:59.589490 [debug] [ThreadPool]: On list_nhl_silver: ROLLBACK
[0m11:56:59.590652 [debug] [ThreadPool]: Failed to rollback 'list_nhl_silver'
[0m11:56:59.590829 [debug] [ThreadPool]: On list_nhl_silver: Close
[0m11:56:59.591402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd01eb8a-2d50-4ef3-8f49-a9ae8154f6f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045cd7c0>]}
[0m11:56:59.591682 [debug] [MainThread]: Using duckdb connection "master"
[0m11:56:59.591853 [debug] [MainThread]: On master: BEGIN
[0m11:56:59.592002 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:56:59.592283 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:56:59.592456 [debug] [MainThread]: On master: COMMIT
[0m11:56:59.592623 [debug] [MainThread]: Using duckdb connection "master"
[0m11:56:59.592778 [debug] [MainThread]: On master: COMMIT
[0m11:56:59.593007 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:56:59.593177 [debug] [MainThread]: On master: Close
[0m11:56:59.594653 [debug] [Thread-1  ]: Began running node model.nhl_analytics.stg_goalies
[0m11:56:59.594938 [debug] [Thread-2  ]: Began running node model.nhl_analytics.stg_skaters
[0m11:56:59.595407 [debug] [Thread-3  ]: Began running node model.nhl_analytics.stg_teams
[0m11:56:59.595228 [info ] [Thread-1  ]: 1 of 6 START sql view model silver.stg_goalies ................................. [RUN]
[0m11:56:59.595744 [info ] [Thread-2  ]: 2 of 6 START sql view model silver.stg_skaters ................................. [RUN]
[0m11:56:59.596047 [info ] [Thread-3  ]: 3 of 6 START sql view model silver.stg_teams ................................... [RUN]
[0m11:56:59.596329 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_nhl_silver, now model.nhl_analytics.stg_goalies)
[0m11:56:59.596600 [debug] [Thread-2  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_skaters'
[0m11:56:59.596861 [debug] [Thread-3  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_teams'
[0m11:56:59.597061 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.stg_goalies
[0m11:56:59.597258 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.stg_skaters
[0m11:56:59.597449 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.stg_teams
[0m11:56:59.602675 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.stg_goalies"
[0m11:56:59.604671 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.stg_skaters"
[0m11:56:59.606573 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.stg_teams"
[0m11:56:59.607032 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.stg_skaters
[0m11:56:59.607257 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.stg_goalies
[0m11:56:59.627161 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.stg_teams
[0m11:56:59.635679 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.stg_skaters"
[0m11:56:59.637906 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.stg_teams"
[0m11:56:59.638248 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.stg_goalies"
[0m11:56:59.638968 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m11:56:59.639249 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m11:56:59.639469 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: BEGIN
[0m11:56:59.639685 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:56:59.639890 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: BEGIN
[0m11:56:59.640079 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:56:59.640267 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: BEGIN
[0m11:56:59.640455 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:56:59.640765 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:56:59.641089 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m11:56:59.641366 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m11:56:59.641573 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m11:56:59.641794 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

  
  create view "nhl"."silver"."stg_teams__dbt_tmp" as (
    

select
    season,
    name as team_name,
    wins,
    losses,
    ot as overtime_losses,
    points as team_points,
    pointPctg as points_percentage,
    goalsPerGame as goals_per_game,
    goalsAgainstPerGame as goals_against_per_game,
    wins + losses + ot as games_played,
    current_timestamp as loaded_at
from "nhl"."bronze"."teams"
where season is not null
    and name is not null
  );

[0m11:56:59.642012 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m11:56:59.642201 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m11:56:59.642498 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:56:59.642738 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    

select
    playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    games_played,
    assists,
    goals,
    shots,
    points,
    plusMinus as plus_minus,
    penalityMinutes as penalty_minutes,
    case 
        when games_played > 0 then true 
        else false 
    end as is_active_player,
    case 
        when games_played > 0 then round(points * 1.0 / games_played, 2)
        else null 
    end as points_per_game,
    case 
        when shots > 0 then round(goals * 100.0 / shots, 2)
        else null 
    end as shooting_percentage,
    current_timestamp as loaded_at
from "nhl"."bronze"."skaters"
where playerId is not null
    and season is not null
  );

[0m11:56:59.642988 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    

select
    playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position
from "nhl"."bronze"."goalies"
where playerId is not null
    and season is not null
    limit 10
  );

[0m11:56:59.643951 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m11:56:59.647916 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:56:59.648303 [debug] [Thread-3  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

  
  create view "nhl"."silver"."stg_teams__dbt_tmp" as (
    

select
    season,
    name as team_name,
    wins,
    losses,
    ot as overtime_losses,
    points as team_points,
    pointPctg as points_percentage,
    goalsPerGame as goals_per_game,
    goalsAgainstPerGame as goals_against_per_game,
    wins + losses + ot as games_played,
    current_timestamp as loaded_at
from "nhl"."bronze"."teams"
where season is not null
    and name is not null
  );

[0m11:56:59.648605 [debug] [Thread-2  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    

select
    playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    games_played,
    assists,
    goals,
    shots,
    points,
    plusMinus as plus_minus,
    penalityMinutes as penalty_minutes,
    case 
        when games_played > 0 then true 
        else false 
    end as is_active_player,
    case 
        when games_played > 0 then round(points * 1.0 / games_played, 2)
        else null 
    end as points_per_game,
    case 
        when shots > 0 then round(goals * 100.0 / shots, 2)
        else null 
    end as shooting_percentage,
    current_timestamp as loaded_at
from "nhl"."bronze"."skaters"
where playerId is not null
    and season is not null
  );

[0m11:56:59.648833 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */
alter view "nhl"."silver"."stg_goalies" rename to "stg_goalies__dbt_backup"
[0m11:56:59.649045 [debug] [Thread-3  ]: DuckDB adapter: Rolling back transaction.
[0m11:56:59.649253 [debug] [Thread-2  ]: DuckDB adapter: Rolling back transaction.
[0m11:56:59.649585 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: ROLLBACK
[0m11:56:59.649854 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: ROLLBACK
[0m11:56:59.650068 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m11:56:59.654198 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:56:59.655643 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */
alter view "nhl"."silver"."stg_goalies__dbt_tmp" rename to "stg_goalies"
[0m11:56:59.658466 [debug] [Thread-1  ]: SQL status: OK in 0.003 seconds
[0m11:56:59.665484 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: COMMIT
[0m11:56:59.665755 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:56:59.666029 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: COMMIT
[0m11:56:59.668188 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m11:56:59.671573 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:56:59.672348 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

      drop view if exists "nhl"."silver"."stg_goalies__dbt_backup" cascade
    
[0m11:56:59.673417 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m11:56:59.674822 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: Close
[0m11:56:59.680509 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd01eb8a-2d50-4ef3-8f49-a9ae8154f6f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c79d60>]}
[0m11:56:59.682517 [info ] [Thread-1  ]: 1 of 6 OK created sql view model silver.stg_goalies ............................ [[32mOK[0m in 0.08s]
[0m11:56:59.684524 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.stg_goalies
[0m11:56:59.693165 [debug] [Thread-3  ]: Failed to rollback 'model.nhl_analytics.stg_teams'
[0m11:56:59.693384 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: Close
[0m11:56:59.693821 [debug] [Thread-2  ]: Failed to rollback 'model.nhl_analytics.stg_skaters'
[0m11:56:59.694044 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: Close
[0m11:56:59.697184 [debug] [Thread-2  ]: Runtime Error in model stg_skaters (models/staging/stg_skaters.sql)
  Binder Error: Referenced column "assists" not found in FROM clause!
  Candidate bindings: "shifts", "I_F_shifts", "I_F_xGoals_with_earned_rebounds_scoreFlurryAdjusted", "position", "penalityMinutesDrawn"
  
  LINE 14:     assists,
               ^
[0m11:56:59.700098 [debug] [Thread-3  ]: Runtime Error in model stg_teams (models/staging/stg_teams.sql)
  Binder Error: Referenced column "wins" not found in FROM clause!
  Candidate bindings: "hitsFor", "hitsAgainst", "reboundsFor", "takeawaysFor", "xReboundsFor"
  
  LINE 10:     wins,
               ^
[0m11:56:59.700395 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd01eb8a-2d50-4ef3-8f49-a9ae8154f6f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107223250>]}
[0m11:56:59.700657 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd01eb8a-2d50-4ef3-8f49-a9ae8154f6f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107821580>]}
[0m11:56:59.701092 [error] [Thread-2  ]: 2 of 6 ERROR creating sql view model silver.stg_skaters ........................ [[31mERROR[0m in 0.10s]
[0m11:56:59.701415 [error] [Thread-3  ]: 3 of 6 ERROR creating sql view model silver.stg_teams .......................... [[31mERROR[0m in 0.10s]
[0m11:56:59.701758 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.stg_skaters
[0m11:56:59.702050 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.stg_teams
[0m11:56:59.702337 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_skaters' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_skaters (models/staging/stg_skaters.sql)
  Binder Error: Referenced column "assists" not found in FROM clause!
  Candidate bindings: "shifts", "I_F_shifts", "I_F_xGoals_with_earned_rebounds_scoreFlurryAdjusted", "position", "penalityMinutesDrawn"
  
  LINE 14:     assists,
               ^.
[0m11:56:59.702669 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_teams' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_teams (models/staging/stg_teams.sql)
  Binder Error: Referenced column "wins" not found in FROM clause!
  Candidate bindings: "hitsFor", "hitsAgainst", "reboundsFor", "takeawaysFor", "xReboundsFor"
  
  LINE 10:     wins,
               ^.
[0m11:56:59.702960 [debug] [Thread-4  ]: Began running node model.nhl_analytics.int_all_players
[0m11:56:59.703380 [debug] [Thread-2  ]: Began running node model.nhl_analytics.mart_team_standings
[0m11:56:59.703211 [info ] [Thread-4  ]: 4 of 6 SKIP relation silver.int_all_players .................................... [[33mSKIP[0m]
[0m11:56:59.703600 [info ] [Thread-2  ]: 5 of 6 SKIP relation silver.mart_team_standings ................................ [[33mSKIP[0m]
[0m11:56:59.703907 [debug] [Thread-4  ]: Finished running node model.nhl_analytics.int_all_players
[0m11:56:59.704131 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.mart_team_standings
[0m11:56:59.704429 [debug] [Thread-1  ]: Began running node model.nhl_analytics.mart_player_performance
[0m11:56:59.704698 [info ] [Thread-1  ]: 6 of 6 SKIP relation silver.mart_player_performance ............................ [[33mSKIP[0m]
[0m11:56:59.704929 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.mart_player_performance
[0m11:56:59.705532 [debug] [MainThread]: Using duckdb connection "master"
[0m11:56:59.705707 [debug] [MainThread]: On master: BEGIN
[0m11:56:59.705879 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:56:59.706287 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:56:59.706453 [debug] [MainThread]: On master: COMMIT
[0m11:56:59.706635 [debug] [MainThread]: Using duckdb connection "master"
[0m11:56:59.706801 [debug] [MainThread]: On master: COMMIT
[0m11:56:59.707092 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:56:59.707266 [debug] [MainThread]: On master: Close
[0m11:56:59.707494 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:56:59.707662 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_goalies' was properly closed.
[0m11:56:59.707799 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_skaters' was properly closed.
[0m11:56:59.707934 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_teams' was properly closed.
[0m11:56:59.708136 [info ] [MainThread]: 
[0m11:56:59.708326 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m11:56:59.708876 [debug] [MainThread]: Command end result
[0m11:56:59.725850 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m11:56:59.726918 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m11:56:59.731563 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/run_results.json
[0m11:56:59.731787 [info ] [MainThread]: 
[0m11:56:59.732017 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m11:56:59.732213 [info ] [MainThread]: 
[0m11:56:59.732435 [error] [MainThread]: [31mFailure in model stg_skaters (models/staging/stg_skaters.sql)[0m
[0m11:56:59.732652 [error] [MainThread]:   Runtime Error in model stg_skaters (models/staging/stg_skaters.sql)
  Binder Error: Referenced column "assists" not found in FROM clause!
  Candidate bindings: "shifts", "I_F_shifts", "I_F_xGoals_with_earned_rebounds_scoreFlurryAdjusted", "position", "penalityMinutesDrawn"
  
  LINE 14:     assists,
               ^
[0m11:56:59.732830 [info ] [MainThread]: 
[0m11:56:59.733029 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_skaters.sql
[0m11:56:59.733203 [info ] [MainThread]: 
[0m11:56:59.733405 [error] [MainThread]: [31mFailure in model stg_teams (models/staging/stg_teams.sql)[0m
[0m11:56:59.733610 [error] [MainThread]:   Runtime Error in model stg_teams (models/staging/stg_teams.sql)
  Binder Error: Referenced column "wins" not found in FROM clause!
  Candidate bindings: "hitsFor", "hitsAgainst", "reboundsFor", "takeawaysFor", "xReboundsFor"
  
  LINE 10:     wins,
               ^
[0m11:56:59.733779 [info ] [MainThread]: 
[0m11:56:59.733975 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_teams.sql
[0m11:56:59.734145 [info ] [MainThread]: 
[0m11:56:59.734332 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=3 NO-OP=0 TOTAL=6
[0m11:56:59.735222 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9328495, "process_in_blocks": "0", "process_kernel_time": 0.183715, "process_mem_max_rss": "147030016", "process_out_blocks": "0", "process_user_time": 1.49225}
[0m11:56:59.735438 [debug] [MainThread]: Command `dbt run` failed at 11:56:59.735396 after 0.93 seconds
[0m11:56:59.735642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b74a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de2550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077bcf10>]}
[0m11:56:59.735842 [debug] [MainThread]: Flushing usage events
[0m11:56:59.927766 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:57:45.579316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d6aaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106df04f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106df0310>]}


============================== 11:57:45.581486 | bf2edf27-aa88-4bb7-a664-383b652c6ed1 ==============================
[0m11:57:45.581486 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:57:45.581836 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'write_json': 'True', 'empty': 'False', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir=.', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'static_parser': 'True', 'fail_fast': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'partial_parse': 'True', 'quiet': 'False', 'version_check': 'True', 'profiles_dir': '.', 'use_colors': 'True', 'indirect_selection': 'eager'}
[0m11:57:45.701909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf2edf27-aa88-4bb7-a664-383b652c6ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ef91c0>]}
[0m11:57:45.736158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf2edf27-aa88-4bb7-a664-383b652c6ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e85190>]}
[0m11:57:45.737189 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:57:45.803260 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:57:45.890909 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:57:45.891329 [debug] [MainThread]: Partial parsing: updated file: nhl_analytics://models/staging/stg_skaters.sql
[0m11:57:45.891586 [debug] [MainThread]: Partial parsing: updated file: nhl_analytics://models/staging/stg_teams.sql
[0m11:57:46.101836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf2edf27-aa88-4bb7-a664-383b652c6ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10605eb20>]}
[0m11:57:46.169230 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m11:57:46.171126 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m11:57:46.181488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf2edf27-aa88-4bb7-a664-383b652c6ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e24550>]}
[0m11:57:46.181837 [info ] [MainThread]: Found 6 data tests, 6 models, 4 sources, 444 macros
[0m11:57:46.182063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf2edf27-aa88-4bb7-a664-383b652c6ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106706400>]}
[0m11:57:46.183023 [info ] [MainThread]: 
[0m11:57:46.183254 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:57:46.183436 [info ] [MainThread]: 
[0m11:57:46.183730 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:57:46.187085 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl'
[0m11:57:46.220297 [debug] [ThreadPool]: Using duckdb connection "list_nhl"
[0m11:57:46.220612 [debug] [ThreadPool]: On list_nhl: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m11:57:46.220803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:57:46.256096 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m11:57:46.257115 [debug] [ThreadPool]: On list_nhl: Close
[0m11:57:46.257608 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nhl, now create_nhl_silver)
[0m11:57:46.257914 [debug] [ThreadPool]: Creating schema "database: "nhl"
schema: "silver"
"
[0m11:57:46.269361 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:57:46.269827 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nhl'
        and type='sqlite'
    
  
[0m11:57:46.270045 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:57:46.270604 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:57:46.271366 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:57:46.271561 [debug] [ThreadPool]: On create_nhl_silver: BEGIN
[0m11:57:46.271830 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:57:46.272003 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:57:46.272177 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
    
        create schema if not exists "nhl"."silver"
    
[0m11:57:46.272445 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:57:46.272901 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m11:57:46.273079 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:57:46.273245 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m11:57:46.273475 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:57:46.273650 [debug] [ThreadPool]: On create_nhl_silver: Close
[0m11:57:46.274534 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nhl_silver, now list_nhl_silver)
[0m11:57:46.279524 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m11:57:46.280040 [debug] [ThreadPool]: On list_nhl_silver: BEGIN
[0m11:57:46.280427 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:57:46.281843 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:57:46.282234 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m11:57:46.282617 [debug] [ThreadPool]: On list_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl_silver"} */
select
      'nhl' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'silver'
    and lower(table_catalog) = 'nhl'
  
[0m11:57:46.294518 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m11:57:46.296338 [debug] [ThreadPool]: On list_nhl_silver: ROLLBACK
[0m11:57:46.298940 [debug] [ThreadPool]: Failed to rollback 'list_nhl_silver'
[0m11:57:46.299169 [debug] [ThreadPool]: On list_nhl_silver: Close
[0m11:57:46.299793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf2edf27-aa88-4bb7-a664-383b652c6ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047c5940>]}
[0m11:57:46.300084 [debug] [MainThread]: Using duckdb connection "master"
[0m11:57:46.300262 [debug] [MainThread]: On master: BEGIN
[0m11:57:46.300427 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:57:46.300733 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:57:46.300906 [debug] [MainThread]: On master: COMMIT
[0m11:57:46.301074 [debug] [MainThread]: Using duckdb connection "master"
[0m11:57:46.301237 [debug] [MainThread]: On master: COMMIT
[0m11:57:46.302414 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:57:46.302980 [debug] [MainThread]: On master: Close
[0m11:57:46.310670 [debug] [Thread-1  ]: Began running node model.nhl_analytics.stg_goalies
[0m11:57:46.311382 [info ] [Thread-1  ]: 1 of 6 START sql view model silver.stg_goalies ................................. [RUN]
[0m11:57:46.312172 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_nhl_silver, now model.nhl_analytics.stg_goalies)
[0m11:57:46.312695 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.stg_goalies
[0m11:57:46.320316 [debug] [Thread-2  ]: Began running node model.nhl_analytics.stg_skaters
[0m11:57:46.322460 [info ] [Thread-2  ]: 2 of 6 START sql view model silver.stg_skaters ................................. [RUN]
[0m11:57:46.323195 [debug] [Thread-2  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_skaters'
[0m11:57:46.323662 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.stg_skaters
[0m11:57:46.327142 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.stg_goalies"
[0m11:57:46.328054 [debug] [Thread-3  ]: Began running node model.nhl_analytics.stg_teams
[0m11:57:46.331896 [info ] [Thread-3  ]: 3 of 6 START sql view model silver.stg_teams ................................... [RUN]
[0m11:57:46.332734 [debug] [Thread-3  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_teams'
[0m11:57:46.333204 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.stg_teams
[0m11:57:46.337469 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.stg_skaters"
[0m11:57:46.342071 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.stg_teams"
[0m11:57:46.346088 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.stg_skaters
[0m11:57:46.346481 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.stg_goalies
[0m11:57:46.368098 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.stg_skaters"
[0m11:57:46.370705 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.stg_goalies"
[0m11:57:46.371115 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.stg_teams
[0m11:57:46.373576 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.stg_teams"
[0m11:57:46.373951 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m11:57:46.374224 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:57:46.374472 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: BEGIN
[0m11:57:46.374695 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: BEGIN
[0m11:57:46.374928 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m11:57:46.375151 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:57:46.375361 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:57:46.375581 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: BEGIN
[0m11:57:46.376054 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m11:57:46.376250 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:57:46.376444 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m11:57:46.376652 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m11:57:46.376908 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:57:46.377144 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    

select
    playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    games_played,
    icetime as ice_time,
    I_F_goals as goals,
    I_F_points as points,
    I_F_shotsOnGoal as shots_on_goal,
    I_F_primaryAssists as primary_assists,
    I_F_secondaryAssists as secondary_assists,
    case 
        when games_played > 0 then true 
        else false 
    end as is_active_player,
    case 
        when games_played > 0 then round(I_F_points * 1.0 / games_played, 2)
        else null 
    end as points_per_game,
    case 
        when I_F_shotsOnGoal > 0 then round(I_F_goals * 100.0 / I_F_shotsOnGoal, 2)
        else null 
    end as shooting_percentage,
    current_timestamp as loaded_at
from "nhl"."bronze"."skaters"
where playerId is not null
    and season is not null
  );

[0m11:57:46.377367 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m11:57:46.377623 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    

select
    playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position
from "nhl"."bronze"."goalies"
where playerId is not null
    and season is not null
    limit 10
  );

[0m11:57:46.378044 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m11:57:46.378372 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

  
  create view "nhl"."silver"."stg_teams__dbt_tmp" as (
    

select
    season,
    name as team_name,
    team as team_code,
    games_played,
    goalsFor,
    goalsAgainst,
    goalsFor - goalsAgainst as goal_differential,
    xGoalsFor,
    xGoalsAgainst,
    current_timestamp as loaded_at
from "nhl"."bronze"."teams"
where season is not null
    and name is not null
    and situation = 'all'
  );

[0m11:57:46.378668 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m11:57:46.382677 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:57:46.382911 [debug] [Thread-2  ]: SQL status: OK in 0.005 seconds
[0m11:57:46.383126 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */
alter view "nhl"."silver"."stg_goalies" rename to "stg_goalies__dbt_backup"
[0m11:57:46.383337 [debug] [Thread-3  ]: SQL status: OK in 0.005 seconds
[0m11:57:46.385305 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m11:57:46.387293 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m11:57:46.387531 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */
alter view "nhl"."silver"."stg_skaters__dbt_tmp" rename to "stg_skaters"
[0m11:57:46.387746 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m11:57:46.388395 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */
alter view "nhl"."silver"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m11:57:46.390379 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:57:46.390665 [debug] [Thread-2  ]: SQL status: OK in 0.002 seconds
[0m11:57:46.390877 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */
alter view "nhl"."silver"."stg_goalies__dbt_tmp" rename to "stg_goalies"
[0m11:57:46.397397 [debug] [Thread-3  ]: SQL status: OK in 0.007 seconds
[0m11:57:46.397182 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: COMMIT
[0m11:57:46.398356 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: COMMIT
[0m11:57:46.398588 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m11:57:46.398799 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m11:57:46.399006 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m11:57:46.399216 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: COMMIT
[0m11:57:46.401208 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: COMMIT
[0m11:57:46.401435 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: COMMIT
[0m11:57:46.401708 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:57:46.402035 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: COMMIT
[0m11:57:46.402318 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m11:57:46.402540 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m11:57:46.406189 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m11:57:46.406407 [debug] [Thread-1  ]: SQL status: OK in 0.004 seconds
[0m11:57:46.408147 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m11:57:46.408380 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

      drop view if exists "nhl"."silver"."stg_teams__dbt_backup" cascade
    
[0m11:57:46.410063 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:57:46.410291 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

      drop view if exists "nhl"."silver"."stg_skaters__dbt_backup" cascade
    
[0m11:57:46.410583 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

      drop view if exists "nhl"."silver"."stg_goalies__dbt_backup" cascade
    
[0m11:57:46.410873 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m11:57:46.412494 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: Close
[0m11:57:46.412721 [debug] [Thread-2  ]: SQL status: OK in 0.002 seconds
[0m11:57:46.412953 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m11:57:46.414035 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: Close
[0m11:57:46.415169 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: Close
[0m11:57:46.415684 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf2edf27-aa88-4bb7-a664-383b652c6ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079abb50>]}
[0m11:57:46.415873 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf2edf27-aa88-4bb7-a664-383b652c6ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a1c190>]}
[0m11:57:46.416066 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf2edf27-aa88-4bb7-a664-383b652c6ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10792a0d0>]}
[0m11:57:46.416450 [info ] [Thread-3  ]: 3 of 6 OK created sql view model silver.stg_teams .............................. [[32mOK[0m in 0.08s]
[0m11:57:46.416837 [info ] [Thread-2  ]: 2 of 6 OK created sql view model silver.stg_skaters ............................ [[32mOK[0m in 0.09s]
[0m11:57:46.417216 [info ] [Thread-1  ]: 1 of 6 OK created sql view model silver.stg_goalies ............................ [[32mOK[0m in 0.10s]
[0m11:57:46.417535 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.stg_teams
[0m11:57:46.417824 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.stg_skaters
[0m11:57:46.418104 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.stg_goalies
[0m11:57:46.418436 [debug] [Thread-4  ]: Began running node model.nhl_analytics.mart_team_standings
[0m11:57:46.418819 [info ] [Thread-4  ]: 4 of 6 START sql table model silver.mart_team_standings ........................ [RUN]
[0m11:57:46.419153 [debug] [Thread-4  ]: Acquiring new duckdb connection 'model.nhl_analytics.mart_team_standings'
[0m11:57:46.419379 [debug] [Thread-2  ]: Began running node model.nhl_analytics.int_all_players
[0m11:57:46.419581 [debug] [Thread-4  ]: Began compiling node model.nhl_analytics.mart_team_standings
[0m11:57:46.419852 [info ] [Thread-2  ]: 5 of 6 START sql view model silver.int_all_players ............................. [RUN]
[0m11:57:46.421934 [debug] [Thread-4  ]: Writing injected SQL for node "model.nhl_analytics.mart_team_standings"
[0m11:57:46.422197 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.stg_skaters, now model.nhl_analytics.int_all_players)
[0m11:57:46.422461 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.int_all_players
[0m11:57:46.424801 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.int_all_players"
[0m11:57:46.425269 [debug] [Thread-4  ]: Began executing node model.nhl_analytics.mart_team_standings
[0m11:57:46.432177 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.int_all_players
[0m11:57:46.441088 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.int_all_players"
[0m11:57:46.442806 [debug] [Thread-4  ]: Writing runtime sql for node "model.nhl_analytics.mart_team_standings"
[0m11:57:46.443382 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m11:57:46.443633 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m11:57:46.443848 [debug] [Thread-2  ]: On model.nhl_analytics.int_all_players: BEGIN
[0m11:57:46.444068 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: BEGIN
[0m11:57:46.444282 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:57:46.444551 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:57:46.445182 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m11:57:46.445492 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m11:57:46.445735 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m11:57:46.446006 [debug] [Thread-2  ]: On model.nhl_analytics.int_all_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */

  
  create view "nhl"."silver"."int_all_players__dbt_tmp" as (
    

with all_players as (
    select 
        player_id,
        season,
        player_name,
        team_code,
        'G' as position,
        null as games_played,
        null as points_per_game,
        null as shooting_percentage,
        loaded_at
    from "nhl"."silver"."stg_goalies"
    
    union all
    
    select 
        player_id,
        season,
        player_name,
        team_code,
        position,
        games_played,
        points_per_game,
        shooting_percentage,
        loaded_at
    from "nhl"."silver"."stg_skaters"
)

select *,
    case 
        when position = 'G' then 'Goalie'
        when position in ('C', 'L', 'R', 'LW', 'RW') then 'Forward'
        when position in ('D') then 'Defense'
        else 'Unknown'
    end as position_group
from all_players
  );

[0m11:57:46.446256 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m11:57:46.446608 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

  
    
    

    create  table
      "nhl"."silver"."mart_team_standings__dbt_tmp"
  
    as (
      

select 
    season,
    team_name,
    team_points,
    wins,
    losses,
    overtime_losses,
    games_played,
    points_percentage,
    goals_per_game,
    goals_against_per_game,
    goals_per_game - goals_against_per_game as goal_differential_per_game,
    row_number() over (order by team_points desc, points_percentage desc) as standings_rank,
    loaded_at
from "nhl"."silver"."stg_teams"
order by standings_rank
    );
  
  
[0m11:57:46.447026 [debug] [Thread-2  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */

  
  create view "nhl"."silver"."int_all_players__dbt_tmp" as (
    

with all_players as (
    select 
        player_id,
        season,
        player_name,
        team_code,
        'G' as position,
        null as games_played,
        null as points_per_game,
        null as shooting_percentage,
        loaded_at
    from "nhl"."silver"."stg_goalies"
    
    union all
    
    select 
        player_id,
        season,
        player_name,
        team_code,
        position,
        games_played,
        points_per_game,
        shooting_percentage,
        loaded_at
    from "nhl"."silver"."stg_skaters"
)

select *,
    case 
        when position = 'G' then 'Goalie'
        when position in ('C', 'L', 'R', 'LW', 'RW') then 'Forward'
        when position in ('D') then 'Defense'
        else 'Unknown'
    end as position_group
from all_players
  );

[0m11:57:46.447276 [debug] [Thread-2  ]: DuckDB adapter: Rolling back transaction.
[0m11:57:46.447558 [debug] [Thread-2  ]: On model.nhl_analytics.int_all_players: ROLLBACK
[0m11:57:46.447851 [debug] [Thread-4  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

  
    
    

    create  table
      "nhl"."silver"."mart_team_standings__dbt_tmp"
  
    as (
      

select 
    season,
    team_name,
    team_points,
    wins,
    losses,
    overtime_losses,
    games_played,
    points_percentage,
    goals_per_game,
    goals_against_per_game,
    goals_per_game - goals_against_per_game as goal_differential_per_game,
    row_number() over (order by team_points desc, points_percentage desc) as standings_rank,
    loaded_at
from "nhl"."silver"."stg_teams"
order by standings_rank
    );
  
  
[0m11:57:46.448165 [debug] [Thread-4  ]: DuckDB adapter: Rolling back transaction.
[0m11:57:46.448442 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: ROLLBACK
[0m11:57:46.476010 [debug] [Thread-4  ]: Failed to rollback 'model.nhl_analytics.mart_team_standings'
[0m11:57:46.476525 [debug] [Thread-2  ]: Failed to rollback 'model.nhl_analytics.int_all_players'
[0m11:57:46.476747 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: Close
[0m11:57:46.476967 [debug] [Thread-2  ]: On model.nhl_analytics.int_all_players: Close
[0m11:57:46.480231 [debug] [Thread-4  ]: Runtime Error in model mart_team_standings (models/marts/mart_team_standings.sql)
  Binder Error: Referenced column "team_points" not found in FROM clause!
  Candidate bindings: "team_name", "team_code", "season", "goal_differential", "goalsAgainst"
  
  LINE 16:     team_points,
               ^
[0m11:57:46.483031 [debug] [Thread-2  ]: Runtime Error in model int_all_players (models/intermediate/int_all_players.sql)
  Binder Error: Referenced column "loaded_at" not found in FROM clause!
  Candidate bindings: "player_name", "player_id", "season"
  
  LINE 17:         loaded_at
                   ^
[0m11:57:46.483349 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf2edf27-aa88-4bb7-a664-383b652c6ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10792a0d0>]}
[0m11:57:46.483620 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf2edf27-aa88-4bb7-a664-383b652c6ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107af5eb0>]}
[0m11:57:46.484068 [error] [Thread-4  ]: 4 of 6 ERROR creating sql table model silver.mart_team_standings ............... [[31mERROR[0m in 0.06s]
[0m11:57:46.484420 [error] [Thread-2  ]: 5 of 6 ERROR creating sql view model silver.int_all_players .................... [[31mERROR[0m in 0.06s]
[0m11:57:46.484787 [debug] [Thread-4  ]: Finished running node model.nhl_analytics.mart_team_standings
[0m11:57:46.485085 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.int_all_players
[0m11:57:46.485409 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.mart_team_standings' to be skipped because of status 'error'.  Reason: Runtime Error in model mart_team_standings (models/marts/mart_team_standings.sql)
  Binder Error: Referenced column "team_points" not found in FROM clause!
  Candidate bindings: "team_name", "team_code", "season", "goal_differential", "goalsAgainst"
  
  LINE 16:     team_points,
               ^.
[0m11:57:46.485743 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.int_all_players' to be skipped because of status 'error'.  Reason: Runtime Error in model int_all_players (models/intermediate/int_all_players.sql)
  Binder Error: Referenced column "loaded_at" not found in FROM clause!
  Candidate bindings: "player_name", "player_id", "season"
  
  LINE 17:         loaded_at
                   ^.
[0m11:57:46.486127 [debug] [Thread-1  ]: Began running node model.nhl_analytics.mart_player_performance
[0m11:57:46.486398 [info ] [Thread-1  ]: 6 of 6 SKIP relation silver.mart_player_performance ............................ [[33mSKIP[0m]
[0m11:57:46.486650 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.mart_player_performance
[0m11:57:46.487246 [debug] [MainThread]: Using duckdb connection "master"
[0m11:57:46.487426 [debug] [MainThread]: On master: BEGIN
[0m11:57:46.487588 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:57:46.487937 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:57:46.488107 [debug] [MainThread]: On master: COMMIT
[0m11:57:46.488273 [debug] [MainThread]: Using duckdb connection "master"
[0m11:57:46.488429 [debug] [MainThread]: On master: COMMIT
[0m11:57:46.488675 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:57:46.488846 [debug] [MainThread]: On master: Close
[0m11:57:46.489062 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:57:46.489217 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_goalies' was properly closed.
[0m11:57:46.489365 [debug] [MainThread]: Connection 'model.nhl_analytics.int_all_players' was properly closed.
[0m11:57:46.489511 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_teams' was properly closed.
[0m11:57:46.489656 [debug] [MainThread]: Connection 'model.nhl_analytics.mart_team_standings' was properly closed.
[0m11:57:46.489877 [info ] [MainThread]: 
[0m11:57:46.490067 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m11:57:46.490871 [debug] [MainThread]: Command end result
[0m11:57:46.507791 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m11:57:46.509137 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m11:57:46.514142 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/run_results.json
[0m11:57:46.514425 [info ] [MainThread]: 
[0m11:57:46.514681 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m11:57:46.514891 [info ] [MainThread]: 
[0m11:57:46.515128 [error] [MainThread]: [31mFailure in model mart_team_standings (models/marts/mart_team_standings.sql)[0m
[0m11:57:46.515357 [error] [MainThread]:   Runtime Error in model mart_team_standings (models/marts/mart_team_standings.sql)
  Binder Error: Referenced column "team_points" not found in FROM clause!
  Candidate bindings: "team_name", "team_code", "season", "goal_differential", "goalsAgainst"
  
  LINE 16:     team_points,
               ^
[0m11:57:46.515543 [info ] [MainThread]: 
[0m11:57:46.515754 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/marts/mart_team_standings.sql
[0m11:57:46.515939 [info ] [MainThread]: 
[0m11:57:46.516152 [error] [MainThread]: [31mFailure in model int_all_players (models/intermediate/int_all_players.sql)[0m
[0m11:57:46.516366 [error] [MainThread]:   Runtime Error in model int_all_players (models/intermediate/int_all_players.sql)
  Binder Error: Referenced column "loaded_at" not found in FROM clause!
  Candidate bindings: "player_name", "player_id", "season"
  
  LINE 17:         loaded_at
                   ^
[0m11:57:46.516543 [info ] [MainThread]: 
[0m11:57:46.516746 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/intermediate/int_all_players.sql
[0m11:57:46.516924 [info ] [MainThread]: 
[0m11:57:46.517122 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=1 NO-OP=0 TOTAL=6
[0m11:57:46.518139 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.97819674, "process_in_blocks": "0", "process_kernel_time": 0.16356, "process_mem_max_rss": "147718144", "process_out_blocks": "0", "process_user_time": 1.557669}
[0m11:57:46.518387 [debug] [MainThread]: Command `dbt run` failed at 11:57:46.518339 after 0.98 seconds
[0m11:57:46.518625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d6aaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10708e8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10707e970>]}
[0m11:57:46.518869 [debug] [MainThread]: Flushing usage events
[0m11:57:46.750677 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:58:18.524169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fe8a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ba8430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ba8250>]}


============================== 11:58:18.526623 | 91df6f80-8795-4b3d-b514-96bfe5a72e03 ==============================
[0m11:58:18.526623 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:58:18.526983 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --profiles-dir=.', 'profiles_dir': '.', 'use_experimental_parser': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'empty': 'False', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'log_cache_events': 'False', 'log_format': 'default', 'static_parser': 'True', 'fail_fast': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'debug': 'False', 'printer_width': '80', 'partial_parse': 'True', 'warn_error': 'None'}
[0m11:58:18.654642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91df6f80-8795-4b3d-b514-96bfe5a72e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e1a940>]}
[0m11:58:18.693540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91df6f80-8795-4b3d-b514-96bfe5a72e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c90a90>]}
[0m11:58:18.695118 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:58:18.776969 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:58:18.868512 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:58:18.869022 [debug] [MainThread]: Partial parsing: updated file: nhl_analytics://models/marts/mart_team_standings.sql
[0m11:58:18.869320 [debug] [MainThread]: Partial parsing: updated file: nhl_analytics://models/intermediate/int_all_players.sql
[0m11:58:19.078369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91df6f80-8795-4b3d-b514-96bfe5a72e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1185f1250>]}
[0m11:58:19.147083 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m11:58:19.148369 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m11:58:19.156012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91df6f80-8795-4b3d-b514-96bfe5a72e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11821ea60>]}
[0m11:58:19.156393 [info ] [MainThread]: Found 6 data tests, 6 models, 4 sources, 444 macros
[0m11:58:19.156632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91df6f80-8795-4b3d-b514-96bfe5a72e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11819c340>]}
[0m11:58:19.157618 [info ] [MainThread]: 
[0m11:58:19.157852 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:58:19.158039 [info ] [MainThread]: 
[0m11:58:19.158336 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:58:19.163014 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl'
[0m11:58:19.188604 [debug] [ThreadPool]: Using duckdb connection "list_nhl"
[0m11:58:19.188885 [debug] [ThreadPool]: On list_nhl: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m11:58:19.189082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:58:19.212319 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m11:58:19.213137 [debug] [ThreadPool]: On list_nhl: Close
[0m11:58:19.213550 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nhl, now create_nhl_silver)
[0m11:58:19.213839 [debug] [ThreadPool]: Creating schema "database: "nhl"
schema: "silver"
"
[0m11:58:19.218141 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:58:19.218357 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nhl'
        and type='sqlite'
    
  
[0m11:58:19.218528 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:58:19.219012 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:58:19.219657 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:58:19.219832 [debug] [ThreadPool]: On create_nhl_silver: BEGIN
[0m11:58:19.220093 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:58:19.220252 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:58:19.220413 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
    
        create schema if not exists "nhl"."silver"
    
[0m11:58:19.220701 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:58:19.221125 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m11:58:19.221294 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m11:58:19.221459 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m11:58:19.221707 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:58:19.221867 [debug] [ThreadPool]: On create_nhl_silver: Close
[0m11:58:19.222632 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nhl_silver, now list_nhl_silver)
[0m11:58:19.226091 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m11:58:19.226275 [debug] [ThreadPool]: On list_nhl_silver: BEGIN
[0m11:58:19.226434 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:58:19.226713 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:58:19.226871 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m11:58:19.227035 [debug] [ThreadPool]: On list_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl_silver"} */
select
      'nhl' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'silver'
    and lower(table_catalog) = 'nhl'
  
[0m11:58:19.235022 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m11:58:19.235701 [debug] [ThreadPool]: On list_nhl_silver: ROLLBACK
[0m11:58:19.236593 [debug] [ThreadPool]: Failed to rollback 'list_nhl_silver'
[0m11:58:19.236761 [debug] [ThreadPool]: On list_nhl_silver: Close
[0m11:58:19.237458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91df6f80-8795-4b3d-b514-96bfe5a72e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ee17c0>]}
[0m11:58:19.237703 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:19.237871 [debug] [MainThread]: On master: BEGIN
[0m11:58:19.238021 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:58:19.238302 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:58:19.238459 [debug] [MainThread]: On master: COMMIT
[0m11:58:19.238612 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:19.238764 [debug] [MainThread]: On master: COMMIT
[0m11:58:19.239006 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:58:19.239163 [debug] [MainThread]: On master: Close
[0m11:58:19.240310 [debug] [Thread-1  ]: Began running node model.nhl_analytics.stg_goalies
[0m11:58:19.240539 [debug] [Thread-2  ]: Began running node model.nhl_analytics.stg_skaters
[0m11:58:19.240819 [info ] [Thread-1  ]: 1 of 6 START sql view model silver.stg_goalies ................................. [RUN]
[0m11:58:19.241120 [debug] [Thread-3  ]: Began running node model.nhl_analytics.stg_teams
[0m11:58:19.241412 [info ] [Thread-2  ]: 2 of 6 START sql view model silver.stg_skaters ................................. [RUN]
[0m11:58:19.241711 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_nhl_silver, now model.nhl_analytics.stg_goalies)
[0m11:58:19.242000 [info ] [Thread-3  ]: 3 of 6 START sql view model silver.stg_teams ................................... [RUN]
[0m11:58:19.242302 [debug] [Thread-2  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_skaters'
[0m11:58:19.242520 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.stg_goalies
[0m11:58:19.242773 [debug] [Thread-3  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_teams'
[0m11:58:19.242979 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.stg_skaters
[0m11:58:19.248150 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.stg_goalies"
[0m11:58:19.248401 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.stg_teams
[0m11:58:19.250344 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.stg_skaters"
[0m11:58:19.252249 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.stg_teams"
[0m11:58:19.252636 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.stg_goalies
[0m11:58:19.271421 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.stg_skaters
[0m11:58:19.275201 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.stg_skaters"
[0m11:58:19.276010 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.stg_goalies"
[0m11:58:19.276386 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.stg_teams
[0m11:58:19.278787 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.stg_teams"
[0m11:58:19.279167 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:58:19.279423 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m11:58:19.279645 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: BEGIN
[0m11:58:19.279897 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: BEGIN
[0m11:58:19.280134 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m11:58:19.280334 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:58:19.280539 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:58:19.280739 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: BEGIN
[0m11:58:19.281121 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:58:19.281340 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m11:58:19.281583 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m11:58:19.281785 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:58:19.281998 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m11:58:19.282186 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m11:58:19.282402 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    

select
    playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position
from "nhl"."bronze"."goalies"
where playerId is not null
    and season is not null
    limit 10
  );

[0m11:58:19.282615 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m11:58:19.282840 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    

select
    playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    games_played,
    icetime as ice_time,
    I_F_goals as goals,
    I_F_points as points,
    I_F_shotsOnGoal as shots_on_goal,
    I_F_primaryAssists as primary_assists,
    I_F_secondaryAssists as secondary_assists,
    case 
        when games_played > 0 then true 
        else false 
    end as is_active_player,
    case 
        when games_played > 0 then round(I_F_points * 1.0 / games_played, 2)
        else null 
    end as points_per_game,
    case 
        when I_F_shotsOnGoal > 0 then round(I_F_goals * 100.0 / I_F_shotsOnGoal, 2)
        else null 
    end as shooting_percentage,
    current_timestamp as loaded_at
from "nhl"."bronze"."skaters"
where playerId is not null
    and season is not null
  );

[0m11:58:19.283149 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

  
  create view "nhl"."silver"."stg_teams__dbt_tmp" as (
    

select
    season,
    name as team_name,
    team as team_code,
    games_played,
    goalsFor,
    goalsAgainst,
    goalsFor - goalsAgainst as goal_differential,
    xGoalsFor,
    xGoalsAgainst,
    current_timestamp as loaded_at
from "nhl"."bronze"."teams"
where season is not null
    and name is not null
    and situation = 'all'
  );

[0m11:58:19.283447 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m11:58:19.287286 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:58:19.287539 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */
alter view "nhl"."silver"."stg_goalies" rename to "stg_goalies__dbt_backup"
[0m11:58:19.287825 [debug] [Thread-3  ]: SQL status: OK in 0.004 seconds
[0m11:58:19.288038 [debug] [Thread-2  ]: SQL status: OK in 0.005 seconds
[0m11:58:19.289987 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m11:58:19.290211 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m11:58:19.292456 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m11:58:19.292693 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */
alter view "nhl"."silver"."stg_teams" rename to "stg_teams__dbt_backup"
[0m11:58:19.294632 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:58:19.294854 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */
alter view "nhl"."silver"."stg_skaters" rename to "stg_skaters__dbt_backup"
[0m11:58:19.295151 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */
alter view "nhl"."silver"."stg_goalies__dbt_tmp" rename to "stg_goalies"
[0m11:58:19.295470 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m11:58:19.297322 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m11:58:19.297537 [debug] [Thread-2  ]: SQL status: OK in 0.002 seconds
[0m11:58:19.297750 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */
alter view "nhl"."silver"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m11:58:19.297959 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m11:58:19.299815 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m11:58:19.306948 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: COMMIT
[0m11:58:19.307182 [debug] [Thread-3  ]: SQL status: OK in 0.007 seconds
[0m11:58:19.307412 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */
alter view "nhl"."silver"."stg_skaters__dbt_tmp" rename to "stg_skaters"
[0m11:58:19.307647 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:58:19.308503 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: COMMIT
[0m11:58:19.308793 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: COMMIT
[0m11:58:19.309033 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m11:58:19.309235 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m11:58:19.309479 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: COMMIT
[0m11:58:19.310343 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: COMMIT
[0m11:58:19.310587 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m11:58:19.310824 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m11:58:19.314302 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m11:58:19.314511 [debug] [Thread-3  ]: SQL status: OK in 0.004 seconds
[0m11:58:19.314731 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: COMMIT
[0m11:58:19.314955 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

      drop view if exists "nhl"."silver"."stg_goalies__dbt_backup" cascade
    
[0m11:58:19.316528 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m11:58:19.316872 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

      drop view if exists "nhl"."silver"."stg_teams__dbt_backup" cascade
    
[0m11:58:19.317127 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m11:58:19.319188 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m11:58:19.319409 [debug] [Thread-1  ]: SQL status: OK in 0.003 seconds
[0m11:58:19.319622 [debug] [Thread-3  ]: SQL status: OK in 0.003 seconds
[0m11:58:19.319828 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

      drop view if exists "nhl"."silver"."stg_skaters__dbt_backup" cascade
    
[0m11:58:19.321196 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: Close
[0m11:58:19.321870 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: Close
[0m11:58:19.323519 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m11:58:19.324195 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: Close
[0m11:58:19.324591 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91df6f80-8795-4b3d-b514-96bfe5a72e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dfb610>]}
[0m11:58:19.324805 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91df6f80-8795-4b3d-b514-96bfe5a72e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118dccfd0>]}
[0m11:58:19.325046 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91df6f80-8795-4b3d-b514-96bfe5a72e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118d7db50>]}
[0m11:58:19.325346 [info ] [Thread-1  ]: 1 of 6 OK created sql view model silver.stg_goalies ............................ [[32mOK[0m in 0.08s]
[0m11:58:19.325696 [info ] [Thread-3  ]: 3 of 6 OK created sql view model silver.stg_teams .............................. [[32mOK[0m in 0.08s]
[0m11:58:19.326081 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.stg_goalies
[0m11:58:19.326364 [info ] [Thread-2  ]: 2 of 6 OK created sql view model silver.stg_skaters ............................ [[32mOK[0m in 0.08s]
[0m11:58:19.326688 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.stg_teams
[0m11:58:19.327037 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.stg_skaters
[0m11:58:19.327369 [debug] [Thread-4  ]: Began running node model.nhl_analytics.mart_team_standings
[0m11:58:19.327855 [debug] [Thread-3  ]: Began running node model.nhl_analytics.int_all_players
[0m11:58:19.327680 [info ] [Thread-4  ]: 4 of 6 START sql table model silver.mart_team_standings ........................ [RUN]
[0m11:58:19.328185 [info ] [Thread-3  ]: 5 of 6 START sql view model silver.int_all_players ............................. [RUN]
[0m11:58:19.328506 [debug] [Thread-4  ]: Acquiring new duckdb connection 'model.nhl_analytics.mart_team_standings'
[0m11:58:19.328762 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.stg_teams, now model.nhl_analytics.int_all_players)
[0m11:58:19.328980 [debug] [Thread-4  ]: Began compiling node model.nhl_analytics.mart_team_standings
[0m11:58:19.329187 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.int_all_players
[0m11:58:19.331091 [debug] [Thread-4  ]: Writing injected SQL for node "model.nhl_analytics.mart_team_standings"
[0m11:58:19.333125 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.int_all_players"
[0m11:58:19.333518 [debug] [Thread-4  ]: Began executing node model.nhl_analytics.mart_team_standings
[0m11:58:19.333742 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.int_all_players
[0m11:58:19.346043 [debug] [Thread-4  ]: Writing runtime sql for node "model.nhl_analytics.mart_team_standings"
[0m11:58:19.348730 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.int_all_players"
[0m11:58:19.349189 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m11:58:19.349433 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m11:58:19.349652 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: BEGIN
[0m11:58:19.349859 [debug] [Thread-3  ]: On model.nhl_analytics.int_all_players: BEGIN
[0m11:58:19.350050 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:58:19.350233 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m11:58:19.350648 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m11:58:19.350844 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m11:58:19.351045 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m11:58:19.351256 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

  
    
    

    create  table
      "nhl"."silver"."mart_team_standings__dbt_tmp"
  
    as (
      

select 
    season,
    team_name,
    team_code,
    games_played,
    goalsFor,
    goalsAgainst,
    goal_differential,
    xGoalsFor,
    xGoalsAgainst,
    row_number() over (order by goalsFor desc, goal_differential desc) as standings_rank,
    loaded_at
from "nhl"."silver"."stg_teams"
order by standings_rank
    );
  
  
[0m11:58:19.351468 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m11:58:19.351767 [debug] [Thread-3  ]: On model.nhl_analytics.int_all_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */

  
  create view "nhl"."silver"."int_all_players__dbt_tmp" as (
    

with all_players as (
    select 
        player_id,
        season,
        player_name,
        team_code,
        'G' as position,
        null as games_played,
        null as points_per_game,
        null as shooting_percentage
    from "nhl"."silver"."stg_goalies"
    
    union all
    
    select 
        player_id,
        season,
        player_name,
        team_code,
        position,
        games_played,
        points_per_game,
        shooting_percentage
    from "nhl"."silver"."stg_skaters"
)

select *,
    case 
        when position = 'G' then 'Goalie'
        when position in ('C', 'L', 'R', 'LW', 'RW') then 'Forward'
        when position in ('D') then 'Defense'
        else 'Unknown'
    end as position_group,
    current_timestamp as loaded_at
from all_players
  );

[0m11:58:19.352867 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m11:58:19.354878 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m11:58:19.355109 [debug] [Thread-3  ]: On model.nhl_analytics.int_all_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */
alter view "nhl"."silver"."int_all_players__dbt_tmp" rename to "int_all_players"
[0m11:58:19.355507 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m11:58:19.356359 [debug] [Thread-3  ]: On model.nhl_analytics.int_all_players: COMMIT
[0m11:58:19.356583 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m11:58:19.356798 [debug] [Thread-3  ]: On model.nhl_analytics.int_all_players: COMMIT
[0m11:58:19.357217 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m11:58:19.358853 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m11:58:19.359062 [debug] [Thread-3  ]: On model.nhl_analytics.int_all_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */

      drop view if exists "nhl"."silver"."int_all_players__dbt_backup" cascade
    
[0m11:58:19.359322 [debug] [Thread-4  ]: SQL status: OK in 0.008 seconds
[0m11:58:19.361910 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m11:58:19.362125 [debug] [Thread-3  ]: SQL status: OK in 0.003 seconds
[0m11:58:19.362368 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */
alter table "nhl"."silver"."mart_team_standings__dbt_tmp" rename to "mart_team_standings"
[0m11:58:19.363077 [debug] [Thread-3  ]: On model.nhl_analytics.int_all_players: Close
[0m11:58:19.363485 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91df6f80-8795-4b3d-b514-96bfe5a72e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1198f8be0>]}
[0m11:58:19.363761 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m11:58:19.366812 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: COMMIT
[0m11:58:19.364065 [info ] [Thread-3  ]: 5 of 6 OK created sql view model silver.int_all_players ........................ [[32mOK[0m in 0.03s]
[0m11:58:19.367095 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m11:58:19.367392 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.int_all_players
[0m11:58:19.367596 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: COMMIT
[0m11:58:19.367932 [debug] [Thread-1  ]: Began running node model.nhl_analytics.mart_player_performance
[0m11:58:19.368283 [info ] [Thread-1  ]: 6 of 6 START sql table model silver.mart_player_performance .................... [RUN]
[0m11:58:19.368558 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.stg_goalies, now model.nhl_analytics.mart_player_performance)
[0m11:58:19.368774 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m11:58:19.368989 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.mart_player_performance
[0m11:58:19.370778 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m11:58:19.372679 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.mart_player_performance"
[0m11:58:19.372920 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

      drop table if exists "nhl"."silver"."mart_team_standings__dbt_backup" cascade
    
[0m11:58:19.373306 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m11:58:19.373980 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: Close
[0m11:58:19.374303 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91df6f80-8795-4b3d-b514-96bfe5a72e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ee17c0>]}
[0m11:58:19.374595 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.mart_player_performance
[0m11:58:19.376889 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.mart_player_performance"
[0m11:58:19.377198 [info ] [Thread-4  ]: 4 of 6 OK created sql table model silver.mart_team_standings ................... [[32mOK[0m in 0.05s]
[0m11:58:19.377577 [debug] [Thread-4  ]: Finished running node model.nhl_analytics.mart_team_standings
[0m11:58:19.377901 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m11:58:19.378130 [debug] [Thread-1  ]: On model.nhl_analytics.mart_player_performance: BEGIN
[0m11:58:19.378332 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:58:19.378709 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m11:58:19.378918 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m11:58:19.379134 [debug] [Thread-1  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */

  
    
    

    create  table
      "nhl"."silver"."mart_player_performance__dbt_tmp"
  
    as (
      

select 
    player_id,
    player_name,
    team_code,
    position,
    position_group,
    games_played,
    points_per_game,
    shooting_percentage,
    case 
        when points_per_game >= 1.0 then 'Elite'
        when points_per_game >= 0.7 then 'Very Good'
        when points_per_game >= 0.5 then 'Good'
        when points_per_game >= 0.3 then 'Average'
        else 'Below Average'
    end as offensive_rating,
    loaded_at
from "nhl"."silver"."int_all_players"
where position_group in ('Forward', 'Defense')
    and games_played >= 10
    );
  
  
[0m11:58:19.385925 [debug] [Thread-1  ]: SQL status: OK in 0.007 seconds
[0m11:58:19.387952 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m11:58:19.388160 [debug] [Thread-1  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */
alter table "nhl"."silver"."mart_player_performance__dbt_tmp" rename to "mart_player_performance"
[0m11:58:19.388499 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m11:58:19.389407 [debug] [Thread-1  ]: On model.nhl_analytics.mart_player_performance: COMMIT
[0m11:58:19.389628 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m11:58:19.389818 [debug] [Thread-1  ]: On model.nhl_analytics.mart_player_performance: COMMIT
[0m11:58:19.390716 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m11:58:19.392280 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m11:58:19.392480 [debug] [Thread-1  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */

      drop table if exists "nhl"."silver"."mart_player_performance__dbt_backup" cascade
    
[0m11:58:19.392779 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m11:58:19.393471 [debug] [Thread-1  ]: On model.nhl_analytics.mart_player_performance: Close
[0m11:58:19.393786 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91df6f80-8795-4b3d-b514-96bfe5a72e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119914940>]}
[0m11:58:19.394125 [info ] [Thread-1  ]: 6 of 6 OK created sql table model silver.mart_player_performance ............... [[32mOK[0m in 0.03s]
[0m11:58:19.394509 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.mart_player_performance
[0m11:58:19.395137 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:19.395332 [debug] [MainThread]: On master: BEGIN
[0m11:58:19.395501 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:58:19.395894 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:58:19.396069 [debug] [MainThread]: On master: COMMIT
[0m11:58:19.396242 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:19.396405 [debug] [MainThread]: On master: COMMIT
[0m11:58:19.396639 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:58:19.396813 [debug] [MainThread]: On master: Close
[0m11:58:19.397020 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:58:19.397171 [debug] [MainThread]: Connection 'model.nhl_analytics.mart_player_performance' was properly closed.
[0m11:58:19.397314 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_skaters' was properly closed.
[0m11:58:19.397453 [debug] [MainThread]: Connection 'model.nhl_analytics.int_all_players' was properly closed.
[0m11:58:19.397592 [debug] [MainThread]: Connection 'model.nhl_analytics.mart_team_standings' was properly closed.
[0m11:58:19.397796 [info ] [MainThread]: 
[0m11:58:19.397992 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m11:58:19.398674 [debug] [MainThread]: Command end result
[0m11:58:19.413649 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m11:58:19.414620 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m11:58:19.418381 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/run_results.json
[0m11:58:19.418575 [info ] [MainThread]: 
[0m11:58:19.418807 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:58:19.418997 [info ] [MainThread]: 
[0m11:58:19.419195 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m11:58:19.420060 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.94032544, "process_in_blocks": "0", "process_kernel_time": 0.140823, "process_mem_max_rss": "154320896", "process_out_blocks": "0", "process_user_time": 1.611834}
[0m11:58:19.420281 [debug] [MainThread]: Command `dbt run` succeeded at 11:58:19.420240 after 0.94 seconds
[0m11:58:19.420482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fe8a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118157df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11821ea60>]}
[0m11:58:19.420686 [debug] [MainThread]: Flushing usage events
[0m11:58:19.688394 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:58:50.041638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b22af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113da74c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113da72e0>]}


============================== 11:58:50.044467 | ef92972e-f60d-43d9-b840-752d46f13af1 ==============================
[0m11:58:50.044467 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:58:50.044827 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'profiles_dir': '.', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'cache_selected_only': 'False', 'version_check': 'True', 'write_json': 'True', 'log_format': 'default', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'introspect': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt test --profiles-dir=.', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'target_path': 'None', 'warn_error': 'None', 'printer_width': '80', 'no_print': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False'}
[0m11:58:50.183285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef92972e-f60d-43d9-b840-752d46f13af1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113eafb80>]}
[0m11:58:50.219492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef92972e-f60d-43d9-b840-752d46f13af1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d65eb0>]}
[0m11:58:50.220891 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:58:50.295637 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:58:50.391192 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:58:50.391492 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:58:50.428170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef92972e-f60d-43d9-b840-752d46f13af1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1146c6130>]}
[0m11:58:50.508086 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m11:58:50.509766 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m11:58:50.526494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef92972e-f60d-43d9-b840-752d46f13af1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115012e80>]}
[0m11:58:50.526907 [info ] [MainThread]: Found 6 data tests, 6 models, 4 sources, 444 macros
[0m11:58:50.527149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef92972e-f60d-43d9-b840-752d46f13af1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114690700>]}
[0m11:58:50.528372 [info ] [MainThread]: 
[0m11:58:50.528666 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:58:50.528861 [info ] [MainThread]: 
[0m11:58:50.529178 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:58:50.565161 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl_silver'
[0m11:58:50.594684 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m11:58:50.595050 [debug] [ThreadPool]: On list_nhl_silver: BEGIN
[0m11:58:50.595316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:58:50.630343 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m11:58:50.630682 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m11:58:50.630900 [debug] [ThreadPool]: On list_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl_silver"} */
select
      'nhl' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'silver'
    and lower(table_catalog) = 'nhl'
  
[0m11:58:50.638445 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m11:58:50.639485 [debug] [ThreadPool]: On list_nhl_silver: ROLLBACK
[0m11:58:50.640836 [debug] [ThreadPool]: Failed to rollback 'list_nhl_silver'
[0m11:58:50.641056 [debug] [ThreadPool]: On list_nhl_silver: Close
[0m11:58:50.642093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef92972e-f60d-43d9-b840-752d46f13af1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104caaaf0>]}
[0m11:58:50.642405 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:50.642581 [debug] [MainThread]: On master: BEGIN
[0m11:58:50.642746 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:58:50.643073 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:58:50.643247 [debug] [MainThread]: On master: COMMIT
[0m11:58:50.643417 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:50.643581 [debug] [MainThread]: On master: COMMIT
[0m11:58:50.643838 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:58:50.644013 [debug] [MainThread]: On master: Close
[0m11:58:50.645863 [debug] [Thread-1  ]: Began running node test.nhl_analytics.source_not_null_bronze_goalies_playerId.ea8839b69c
[0m11:58:50.646108 [debug] [Thread-2  ]: Began running node test.nhl_analytics.source_not_null_bronze_goalies_season.412c0679ce
[0m11:58:50.646350 [debug] [Thread-3  ]: Began running node test.nhl_analytics.source_not_null_bronze_lines_season.c13bc81444
[0m11:58:50.646558 [debug] [Thread-4  ]: Began running node test.nhl_analytics.source_not_null_bronze_skaters_playerId.85905f90b2
[0m11:58:50.646790 [info ] [Thread-1  ]: 1 of 6 START test source_not_null_bronze_goalies_playerId ...................... [RUN]
[0m11:58:50.647064 [info ] [Thread-2  ]: 2 of 6 START test source_not_null_bronze_goalies_season ........................ [RUN]
[0m11:58:50.647358 [info ] [Thread-3  ]: 3 of 6 START test source_not_null_bronze_lines_season .......................... [RUN]
[0m11:58:50.647859 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_nhl_silver, now test.nhl_analytics.source_not_null_bronze_goalies_playerId.ea8839b69c)
[0m11:58:50.647615 [info ] [Thread-4  ]: 4 of 6 START test source_not_null_bronze_skaters_playerId ...................... [RUN]
[0m11:58:50.648228 [debug] [Thread-2  ]: Acquiring new duckdb connection 'test.nhl_analytics.source_not_null_bronze_goalies_season.412c0679ce'
[0m11:58:50.648505 [debug] [Thread-3  ]: Acquiring new duckdb connection 'test.nhl_analytics.source_not_null_bronze_lines_season.c13bc81444'
[0m11:58:50.648736 [debug] [Thread-1  ]: Began compiling node test.nhl_analytics.source_not_null_bronze_goalies_playerId.ea8839b69c
[0m11:58:50.649003 [debug] [Thread-4  ]: Acquiring new duckdb connection 'test.nhl_analytics.source_not_null_bronze_skaters_playerId.85905f90b2'
[0m11:58:50.649220 [debug] [Thread-2  ]: Began compiling node test.nhl_analytics.source_not_null_bronze_goalies_season.412c0679ce
[0m11:58:50.649437 [debug] [Thread-3  ]: Began compiling node test.nhl_analytics.source_not_null_bronze_lines_season.c13bc81444
[0m11:58:50.661097 [debug] [Thread-1  ]: Writing injected SQL for node "test.nhl_analytics.source_not_null_bronze_goalies_playerId.ea8839b69c"
[0m11:58:50.661452 [debug] [Thread-4  ]: Began compiling node test.nhl_analytics.source_not_null_bronze_skaters_playerId.85905f90b2
[0m11:58:50.665221 [debug] [Thread-2  ]: Writing injected SQL for node "test.nhl_analytics.source_not_null_bronze_goalies_season.412c0679ce"
[0m11:58:50.667961 [debug] [Thread-3  ]: Writing injected SQL for node "test.nhl_analytics.source_not_null_bronze_lines_season.c13bc81444"
[0m11:58:50.670669 [debug] [Thread-4  ]: Writing injected SQL for node "test.nhl_analytics.source_not_null_bronze_skaters_playerId.85905f90b2"
[0m11:58:50.671290 [debug] [Thread-1  ]: Began executing node test.nhl_analytics.source_not_null_bronze_goalies_playerId.ea8839b69c
[0m11:58:50.671546 [debug] [Thread-2  ]: Began executing node test.nhl_analytics.source_not_null_bronze_goalies_season.412c0679ce
[0m11:58:50.671784 [debug] [Thread-4  ]: Began executing node test.nhl_analytics.source_not_null_bronze_skaters_playerId.85905f90b2
[0m11:58:50.677506 [debug] [Thread-3  ]: Began executing node test.nhl_analytics.source_not_null_bronze_lines_season.c13bc81444
[0m11:58:50.683726 [debug] [Thread-1  ]: Writing runtime sql for node "test.nhl_analytics.source_not_null_bronze_goalies_playerId.ea8839b69c"
[0m11:58:50.685684 [debug] [Thread-2  ]: Writing runtime sql for node "test.nhl_analytics.source_not_null_bronze_goalies_season.412c0679ce"
[0m11:58:50.687466 [debug] [Thread-4  ]: Writing runtime sql for node "test.nhl_analytics.source_not_null_bronze_skaters_playerId.85905f90b2"
[0m11:58:50.689869 [debug] [Thread-3  ]: Writing runtime sql for node "test.nhl_analytics.source_not_null_bronze_lines_season.c13bc81444"
[0m11:58:50.690597 [debug] [Thread-1  ]: Using duckdb connection "test.nhl_analytics.source_not_null_bronze_goalies_playerId.ea8839b69c"
[0m11:58:50.690860 [debug] [Thread-1  ]: On test.nhl_analytics.source_not_null_bronze_goalies_playerId.ea8839b69c: BEGIN
[0m11:58:50.691119 [debug] [Thread-3  ]: Using duckdb connection "test.nhl_analytics.source_not_null_bronze_lines_season.c13bc81444"
[0m11:58:50.691374 [debug] [Thread-2  ]: Using duckdb connection "test.nhl_analytics.source_not_null_bronze_goalies_season.412c0679ce"
[0m11:58:50.691584 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:58:50.691803 [debug] [Thread-4  ]: Using duckdb connection "test.nhl_analytics.source_not_null_bronze_skaters_playerId.85905f90b2"
[0m11:58:50.692021 [debug] [Thread-3  ]: On test.nhl_analytics.source_not_null_bronze_lines_season.c13bc81444: BEGIN
[0m11:58:50.692228 [debug] [Thread-2  ]: On test.nhl_analytics.source_not_null_bronze_goalies_season.412c0679ce: BEGIN
[0m11:58:50.692581 [debug] [Thread-4  ]: On test.nhl_analytics.source_not_null_bronze_skaters_playerId.85905f90b2: BEGIN
[0m11:58:50.692808 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:58:50.693023 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m11:58:50.693227 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:58:50.693431 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:58:50.693712 [debug] [Thread-1  ]: Using duckdb connection "test.nhl_analytics.source_not_null_bronze_goalies_playerId.ea8839b69c"
[0m11:58:50.693968 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m11:58:50.694315 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m11:58:50.694584 [debug] [Thread-1  ]: On test.nhl_analytics.source_not_null_bronze_goalies_playerId.ea8839b69c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "test.nhl_analytics.source_not_null_bronze_goalies_playerId.ea8839b69c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select playerId
from "nhl"."bronze"."goalies"
where playerId is null



  
  
      
    ) dbt_internal_test
[0m11:58:50.694823 [debug] [Thread-3  ]: Using duckdb connection "test.nhl_analytics.source_not_null_bronze_lines_season.c13bc81444"
[0m11:58:50.695040 [debug] [Thread-4  ]: SQL status: OK in 0.002 seconds
[0m11:58:50.695238 [debug] [Thread-2  ]: Using duckdb connection "test.nhl_analytics.source_not_null_bronze_goalies_season.412c0679ce"
[0m11:58:50.695557 [debug] [Thread-3  ]: On test.nhl_analytics.source_not_null_bronze_lines_season.c13bc81444: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "test.nhl_analytics.source_not_null_bronze_lines_season.c13bc81444"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select season
from "nhl"."bronze"."lines"
where season is null



  
  
      
    ) dbt_internal_test
[0m11:58:50.695792 [debug] [Thread-4  ]: Using duckdb connection "test.nhl_analytics.source_not_null_bronze_skaters_playerId.85905f90b2"
[0m11:58:50.696044 [debug] [Thread-2  ]: On test.nhl_analytics.source_not_null_bronze_goalies_season.412c0679ce: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "test.nhl_analytics.source_not_null_bronze_goalies_season.412c0679ce"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select season
from "nhl"."bronze"."goalies"
where season is null



  
  
      
    ) dbt_internal_test
[0m11:58:50.696374 [debug] [Thread-4  ]: On test.nhl_analytics.source_not_null_bronze_skaters_playerId.85905f90b2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "test.nhl_analytics.source_not_null_bronze_skaters_playerId.85905f90b2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select playerId
from "nhl"."bronze"."skaters"
where playerId is null



  
  
      
    ) dbt_internal_test
[0m11:58:50.696589 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m11:58:50.696896 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m11:58:50.697152 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m11:58:50.697496 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m11:58:50.700107 [debug] [Thread-3  ]: On test.nhl_analytics.source_not_null_bronze_lines_season.c13bc81444: ROLLBACK
[0m11:58:50.700992 [debug] [Thread-2  ]: On test.nhl_analytics.source_not_null_bronze_goalies_season.412c0679ce: ROLLBACK
[0m11:58:50.701715 [debug] [Thread-1  ]: On test.nhl_analytics.source_not_null_bronze_goalies_playerId.ea8839b69c: ROLLBACK
[0m11:58:50.702582 [debug] [Thread-4  ]: On test.nhl_analytics.source_not_null_bronze_skaters_playerId.85905f90b2: ROLLBACK
[0m11:58:50.702821 [debug] [Thread-3  ]: Failed to rollback 'test.nhl_analytics.source_not_null_bronze_lines_season.c13bc81444'
[0m11:58:50.703053 [debug] [Thread-2  ]: Failed to rollback 'test.nhl_analytics.source_not_null_bronze_goalies_season.412c0679ce'
[0m11:58:50.703301 [debug] [Thread-1  ]: Failed to rollback 'test.nhl_analytics.source_not_null_bronze_goalies_playerId.ea8839b69c'
[0m11:58:50.703549 [debug] [Thread-4  ]: Failed to rollback 'test.nhl_analytics.source_not_null_bronze_skaters_playerId.85905f90b2'
[0m11:58:50.703752 [debug] [Thread-3  ]: On test.nhl_analytics.source_not_null_bronze_lines_season.c13bc81444: Close
[0m11:58:50.703967 [debug] [Thread-2  ]: On test.nhl_analytics.source_not_null_bronze_goalies_season.412c0679ce: Close
[0m11:58:50.704177 [debug] [Thread-1  ]: On test.nhl_analytics.source_not_null_bronze_goalies_playerId.ea8839b69c: Close
[0m11:58:50.704383 [debug] [Thread-4  ]: On test.nhl_analytics.source_not_null_bronze_skaters_playerId.85905f90b2: Close
[0m11:58:50.704813 [info ] [Thread-3  ]: 3 of 6 PASS source_not_null_bronze_lines_season ................................ [[32mPASS[0m in 0.06s]
[0m11:58:50.705168 [info ] [Thread-2  ]: 2 of 6 PASS source_not_null_bronze_goalies_season .............................. [[32mPASS[0m in 0.06s]
[0m11:58:50.705529 [info ] [Thread-1  ]: 1 of 6 PASS source_not_null_bronze_goalies_playerId ............................ [[32mPASS[0m in 0.06s]
[0m11:58:50.705892 [debug] [Thread-3  ]: Finished running node test.nhl_analytics.source_not_null_bronze_lines_season.c13bc81444
[0m11:58:50.706234 [info ] [Thread-4  ]: 4 of 6 PASS source_not_null_bronze_skaters_playerId ............................ [[32mPASS[0m in 0.06s]
[0m11:58:50.706597 [debug] [Thread-2  ]: Finished running node test.nhl_analytics.source_not_null_bronze_goalies_season.412c0679ce
[0m11:58:50.706919 [debug] [Thread-1  ]: Finished running node test.nhl_analytics.source_not_null_bronze_goalies_playerId.ea8839b69c
[0m11:58:50.707178 [debug] [Thread-3  ]: Began running node test.nhl_analytics.source_not_null_bronze_skaters_season.0f5502a7cb
[0m11:58:50.707516 [debug] [Thread-4  ]: Finished running node test.nhl_analytics.source_not_null_bronze_skaters_playerId.85905f90b2
[0m11:58:50.707752 [debug] [Thread-2  ]: Began running node test.nhl_analytics.source_not_null_bronze_teams_season.9d88656159
[0m11:58:50.708056 [info ] [Thread-3  ]: 5 of 6 START test source_not_null_bronze_skaters_season ........................ [RUN]
[0m11:58:50.708362 [info ] [Thread-2  ]: 6 of 6 START test source_not_null_bronze_teams_season .......................... [RUN]
[0m11:58:50.708664 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.nhl_analytics.source_not_null_bronze_lines_season.c13bc81444, now test.nhl_analytics.source_not_null_bronze_skaters_season.0f5502a7cb)
[0m11:58:50.708910 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.nhl_analytics.source_not_null_bronze_goalies_season.412c0679ce, now test.nhl_analytics.source_not_null_bronze_teams_season.9d88656159)
[0m11:58:50.709142 [debug] [Thread-3  ]: Began compiling node test.nhl_analytics.source_not_null_bronze_skaters_season.0f5502a7cb
[0m11:58:50.709347 [debug] [Thread-2  ]: Began compiling node test.nhl_analytics.source_not_null_bronze_teams_season.9d88656159
[0m11:58:50.712871 [debug] [Thread-3  ]: Writing injected SQL for node "test.nhl_analytics.source_not_null_bronze_skaters_season.0f5502a7cb"
[0m11:58:50.715788 [debug] [Thread-2  ]: Writing injected SQL for node "test.nhl_analytics.source_not_null_bronze_teams_season.9d88656159"
[0m11:58:50.716358 [debug] [Thread-3  ]: Began executing node test.nhl_analytics.source_not_null_bronze_skaters_season.0f5502a7cb
[0m11:58:50.716606 [debug] [Thread-2  ]: Began executing node test.nhl_analytics.source_not_null_bronze_teams_season.9d88656159
[0m11:58:50.718531 [debug] [Thread-3  ]: Writing runtime sql for node "test.nhl_analytics.source_not_null_bronze_skaters_season.0f5502a7cb"
[0m11:58:50.720323 [debug] [Thread-2  ]: Writing runtime sql for node "test.nhl_analytics.source_not_null_bronze_teams_season.9d88656159"
[0m11:58:50.720816 [debug] [Thread-2  ]: Using duckdb connection "test.nhl_analytics.source_not_null_bronze_teams_season.9d88656159"
[0m11:58:50.721067 [debug] [Thread-3  ]: Using duckdb connection "test.nhl_analytics.source_not_null_bronze_skaters_season.0f5502a7cb"
[0m11:58:50.721294 [debug] [Thread-2  ]: On test.nhl_analytics.source_not_null_bronze_teams_season.9d88656159: BEGIN
[0m11:58:50.721521 [debug] [Thread-3  ]: On test.nhl_analytics.source_not_null_bronze_skaters_season.0f5502a7cb: BEGIN
[0m11:58:50.721733 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:58:50.721939 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m11:58:50.722401 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m11:58:50.722614 [debug] [Thread-2  ]: Using duckdb connection "test.nhl_analytics.source_not_null_bronze_teams_season.9d88656159"
[0m11:58:50.722822 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m11:58:50.723033 [debug] [Thread-2  ]: On test.nhl_analytics.source_not_null_bronze_teams_season.9d88656159: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "test.nhl_analytics.source_not_null_bronze_teams_season.9d88656159"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select season
from "nhl"."bronze"."teams"
where season is null



  
  
      
    ) dbt_internal_test
[0m11:58:50.723257 [debug] [Thread-3  ]: Using duckdb connection "test.nhl_analytics.source_not_null_bronze_skaters_season.0f5502a7cb"
[0m11:58:50.723573 [debug] [Thread-3  ]: On test.nhl_analytics.source_not_null_bronze_skaters_season.0f5502a7cb: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "test.nhl_analytics.source_not_null_bronze_skaters_season.0f5502a7cb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select season
from "nhl"."bronze"."skaters"
where season is null



  
  
      
    ) dbt_internal_test
[0m11:58:50.723973 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m11:58:50.724199 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m11:58:50.725093 [debug] [Thread-2  ]: On test.nhl_analytics.source_not_null_bronze_teams_season.9d88656159: ROLLBACK
[0m11:58:50.725909 [debug] [Thread-3  ]: On test.nhl_analytics.source_not_null_bronze_skaters_season.0f5502a7cb: ROLLBACK
[0m11:58:50.726180 [debug] [Thread-2  ]: Failed to rollback 'test.nhl_analytics.source_not_null_bronze_teams_season.9d88656159'
[0m11:58:50.726435 [debug] [Thread-3  ]: Failed to rollback 'test.nhl_analytics.source_not_null_bronze_skaters_season.0f5502a7cb'
[0m11:58:50.726638 [debug] [Thread-2  ]: On test.nhl_analytics.source_not_null_bronze_teams_season.9d88656159: Close
[0m11:58:50.726846 [debug] [Thread-3  ]: On test.nhl_analytics.source_not_null_bronze_skaters_season.0f5502a7cb: Close
[0m11:58:50.727227 [info ] [Thread-2  ]: 6 of 6 PASS source_not_null_bronze_teams_season ................................ [[32mPASS[0m in 0.02s]
[0m11:58:50.727521 [info ] [Thread-3  ]: 5 of 6 PASS source_not_null_bronze_skaters_season .............................. [[32mPASS[0m in 0.02s]
[0m11:58:50.727932 [debug] [Thread-2  ]: Finished running node test.nhl_analytics.source_not_null_bronze_teams_season.9d88656159
[0m11:58:50.728225 [debug] [Thread-3  ]: Finished running node test.nhl_analytics.source_not_null_bronze_skaters_season.0f5502a7cb
[0m11:58:50.729098 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:50.729293 [debug] [MainThread]: On master: BEGIN
[0m11:58:50.729463 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:58:50.730000 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:58:50.730183 [debug] [MainThread]: On master: COMMIT
[0m11:58:50.730358 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:50.730562 [debug] [MainThread]: On master: COMMIT
[0m11:58:50.730946 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:58:50.731222 [debug] [MainThread]: On master: Close
[0m11:58:50.731474 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:58:50.731644 [debug] [MainThread]: Connection 'test.nhl_analytics.source_not_null_bronze_goalies_playerId.ea8839b69c' was properly closed.
[0m11:58:50.731803 [debug] [MainThread]: Connection 'test.nhl_analytics.source_not_null_bronze_teams_season.9d88656159' was properly closed.
[0m11:58:50.731958 [debug] [MainThread]: Connection 'test.nhl_analytics.source_not_null_bronze_skaters_season.0f5502a7cb' was properly closed.
[0m11:58:50.732111 [debug] [MainThread]: Connection 'test.nhl_analytics.source_not_null_bronze_skaters_playerId.85905f90b2' was properly closed.
[0m11:58:50.732307 [info ] [MainThread]: 
[0m11:58:50.732525 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m11:58:50.733710 [debug] [MainThread]: Command end result
[0m11:58:50.750629 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m11:58:50.751934 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m11:58:50.756831 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/run_results.json
[0m11:58:50.757116 [info ] [MainThread]: 
[0m11:58:50.757389 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:58:50.757591 [info ] [MainThread]: 
[0m11:58:50.757796 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m11:58:50.758779 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.76209885, "process_in_blocks": "0", "process_kernel_time": 0.166365, "process_mem_max_rss": "144228352", "process_out_blocks": "0", "process_user_time": 1.416368}
[0m11:58:50.759032 [debug] [MainThread]: Command `dbt test` succeeded at 11:58:50.758985 after 0.76 seconds
[0m11:58:50.759265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b22af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d65eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114254190>]}
[0m11:58:50.759504 [debug] [MainThread]: Flushing usage events
[0m11:58:50.905655 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:32:50.892268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040ad3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056394c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056392e0>]}


============================== 13:32:50.895239 | f1086798-18bb-4c4e-9bd1-dd7c5604fb79 ==============================
[0m13:32:50.895239 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:32:50.895608 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'version_check': 'True', 'debug': 'False', 'profiles_dir': '.', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'no_print': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'log_format': 'default', 'fail_fast': 'False', 'target_path': 'None', 'warn_error': 'None', 'empty': 'False', 'invocation_command': 'dbt run --profiles-dir .', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True'}
[0m13:32:51.017678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1086798-18bb-4c4e-9bd1-dd7c5604fb79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10560fb50>]}
[0m13:32:51.052207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1086798-18bb-4c4e-9bd1-dd7c5604fb79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10591b340>]}
[0m13:32:51.053240 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m13:32:51.122948 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:32:51.216691 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 3 files changed.
[0m13:32:51.217020 [debug] [MainThread]: Partial parsing: added file: nhl_analytics://models/marts/mart_goalie_performance.sql
[0m13:32:51.217240 [debug] [MainThread]: Partial parsing: added file: nhl_analytics://macros/macro.sql
[0m13:32:51.217458 [debug] [MainThread]: Partial parsing: updated file: nhl_analytics://models/marts/mart_team_standings.sql
[0m13:32:51.217672 [debug] [MainThread]: Partial parsing: updated file: nhl_analytics://models/staging/stg_goalies.sql
[0m13:32:51.217886 [debug] [MainThread]: Partial parsing: updated file: nhl_analytics://models/marts/mart_player_performance.sql
[0m13:32:51.413631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1086798-18bb-4c4e-9bd1-dd7c5604fb79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ee0400>]}
[0m13:32:51.475138 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m13:32:51.476340 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m13:32:51.487518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1086798-18bb-4c4e-9bd1-dd7c5604fb79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f3e940>]}
[0m13:32:51.487827 [info ] [MainThread]: Found 6 data tests, 7 models, 4 sources, 444 macros
[0m13:32:51.488056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1086798-18bb-4c4e-9bd1-dd7c5604fb79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f8bfa0>]}
[0m13:32:51.489020 [info ] [MainThread]: 
[0m13:32:51.489274 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:32:51.489455 [info ] [MainThread]: 
[0m13:32:51.489741 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:32:51.492909 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl'
[0m13:32:51.534458 [debug] [ThreadPool]: Using duckdb connection "list_nhl"
[0m13:32:51.534735 [debug] [ThreadPool]: On list_nhl: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m13:32:51.534916 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:32:51.542088 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m13:32:51.542322 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m13:32:51.542757 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:32:51.542945 [debug] [MainThread]: Connection 'list_nhl' was properly closed.
[0m13:32:51.543124 [info ] [MainThread]: 
[0m13:32:51.543332 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.05 seconds (0.05s).
[0m13:32:51.543625 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/../nhl.duckdb": Conflicting lock is held in /opt/homebrew/Cellar/duckdb/1.4.1/bin/duckdb (PID 43098) by user izaakford. See also https://duckdb.org/docs/stable/connect/concurrency
[0m13:32:51.545016 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.69632715, "process_in_blocks": "0", "process_kernel_time": 0.124575, "process_mem_max_rss": "134512640", "process_out_blocks": "0", "process_user_time": 1.263914}
[0m13:32:51.545272 [debug] [MainThread]: Command `python -m dbt.cli.main run` failed at 13:32:51.545221 after 0.70 seconds
[0m13:32:51.545502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040ad3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f8bfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fc77f0>]}
[0m13:32:51.545735 [debug] [MainThread]: Flushing usage events
[0m13:32:51.760299 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:33:06.113189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d713a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111679460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111679280>]}


============================== 13:33:06.115441 | 70dca43e-b5b4-4437-b01d-a09287bcbef6 ==============================
[0m13:33:06.115441 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:33:06.115785 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'empty': 'False', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --profiles-dir .', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'warn_error': 'None', 'introspect': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'profiles_dir': '.', 'cache_selected_only': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'printer_width': '80', 'use_colors': 'True'}
[0m13:33:06.263876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70dca43e-b5b4-4437-b01d-a09287bcbef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119ba4f0>]}
[0m13:33:06.308246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70dca43e-b5b4-4437-b01d-a09287bcbef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11191a7f0>]}
[0m13:33:06.309386 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m13:33:06.374447 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:33:06.463664 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:33:06.463907 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:33:06.497325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70dca43e-b5b4-4437-b01d-a09287bcbef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11299f130>]}
[0m13:33:06.584426 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m13:33:06.585448 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m13:33:06.595227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70dca43e-b5b4-4437-b01d-a09287bcbef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11298b700>]}
[0m13:33:06.595562 [info ] [MainThread]: Found 6 data tests, 7 models, 4 sources, 444 macros
[0m13:33:06.595791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70dca43e-b5b4-4437-b01d-a09287bcbef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111df9190>]}
[0m13:33:06.596750 [info ] [MainThread]: 
[0m13:33:06.596971 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:33:06.597155 [info ] [MainThread]: 
[0m13:33:06.597450 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:33:06.600619 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl'
[0m13:33:06.628693 [debug] [ThreadPool]: Using duckdb connection "list_nhl"
[0m13:33:06.628949 [debug] [ThreadPool]: On list_nhl: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m13:33:06.629136 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:33:06.675357 [debug] [ThreadPool]: SQL status: OK in 0.046 seconds
[0m13:33:06.676628 [debug] [ThreadPool]: On list_nhl: Close
[0m13:33:06.677101 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nhl, now create_nhl_silver)
[0m13:33:06.677431 [debug] [ThreadPool]: Creating schema "database: "nhl"
schema: "silver"
"
[0m13:33:06.681776 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:33:06.681979 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nhl'
        and type='sqlite'
    
  
[0m13:33:06.682152 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:33:06.682847 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:33:06.683702 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:33:06.683881 [debug] [ThreadPool]: On create_nhl_silver: BEGIN
[0m13:33:06.684149 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:33:06.684333 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:33:06.684510 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
    
        create schema if not exists "nhl"."silver"
    
[0m13:33:06.684942 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:33:06.685401 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m13:33:06.685571 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:33:06.685728 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m13:33:06.686377 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:33:06.686561 [debug] [ThreadPool]: On create_nhl_silver: Close
[0m13:33:06.687421 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nhl_silver, now list_nhl_silver)
[0m13:33:06.690920 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m13:33:06.691106 [debug] [ThreadPool]: On list_nhl_silver: BEGIN
[0m13:33:06.691266 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:33:06.691543 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:33:06.691718 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m13:33:06.691903 [debug] [ThreadPool]: On list_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl_silver"} */
select
      'nhl' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'silver'
    and lower(table_catalog) = 'nhl'
  
[0m13:33:06.701516 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m13:33:06.702336 [debug] [ThreadPool]: On list_nhl_silver: ROLLBACK
[0m13:33:06.703532 [debug] [ThreadPool]: Failed to rollback 'list_nhl_silver'
[0m13:33:06.703720 [debug] [ThreadPool]: On list_nhl_silver: Close
[0m13:33:06.704031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70dca43e-b5b4-4437-b01d-a09287bcbef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110dba7f0>]}
[0m13:33:06.704332 [debug] [MainThread]: Using duckdb connection "master"
[0m13:33:06.704516 [debug] [MainThread]: On master: BEGIN
[0m13:33:06.704675 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:33:06.704963 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:33:06.705141 [debug] [MainThread]: On master: COMMIT
[0m13:33:06.705316 [debug] [MainThread]: Using duckdb connection "master"
[0m13:33:06.705476 [debug] [MainThread]: On master: COMMIT
[0m13:33:06.705709 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:33:06.705884 [debug] [MainThread]: On master: Close
[0m13:33:06.707408 [debug] [Thread-1  ]: Began running node model.nhl_analytics.mart_goalie_performance
[0m13:33:06.707650 [debug] [Thread-2  ]: Began running node model.nhl_analytics.mart_player_performance
[0m13:33:06.708142 [debug] [Thread-3  ]: Began running node model.nhl_analytics.mart_team_standings
[0m13:33:06.707955 [info ] [Thread-1  ]: 1 of 7 START sql table model silver.mart_goalie_performance .................... [RUN]
[0m13:33:06.708425 [debug] [Thread-4  ]: Began running node model.nhl_analytics.stg_goalies
[0m13:33:06.708693 [info ] [Thread-2  ]: 2 of 7 START sql table model silver.mart_player_performance .................... [RUN]
[0m13:33:06.709001 [info ] [Thread-3  ]: 3 of 7 START sql table model silver.mart_team_standings ........................ [RUN]
[0m13:33:06.709267 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_nhl_silver, now model.nhl_analytics.mart_goalie_performance)
[0m13:33:06.709546 [info ] [Thread-4  ]: 4 of 7 START sql view model silver.stg_goalies ................................. [RUN]
[0m13:33:06.709845 [debug] [Thread-2  ]: Acquiring new duckdb connection 'model.nhl_analytics.mart_player_performance'
[0m13:33:06.710119 [debug] [Thread-3  ]: Acquiring new duckdb connection 'model.nhl_analytics.mart_team_standings'
[0m13:33:06.710359 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.mart_goalie_performance
[0m13:33:06.710651 [debug] [Thread-4  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_goalies'
[0m13:33:06.710876 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.mart_player_performance
[0m13:33:06.711090 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.mart_team_standings
[0m13:33:06.716205 [debug] [Thread-4  ]: Began compiling node model.nhl_analytics.stg_goalies
[0m13:33:06.721162 [debug] [Thread-4  ]: Writing injected SQL for node "model.nhl_analytics.stg_goalies"
[0m13:33:06.725937 [debug] [Thread-4  ]: Began executing node model.nhl_analytics.stg_goalies
[0m13:33:06.748695 [debug] [Thread-4  ]: Writing runtime sql for node "model.nhl_analytics.stg_goalies"
[0m13:33:06.755347 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:33:06.756664 [debug] [Thread-4  ]: On model.nhl_analytics.stg_goalies: BEGIN
[0m13:33:06.756951 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:33:06.758640 [debug] [Thread-4  ]: SQL status: OK in 0.002 seconds
[0m13:33:06.759349 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:33:06.760030 [debug] [Thread-4  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position
from { { source('bronze', 'goalies') } }
where playerId is not null
    and season is not null
  );

[0m13:33:06.762014 [debug] [Thread-4  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position
from { { source('bronze', 'goalies') } }
where playerId is not null
    and season is not null
  );

[0m13:33:06.762329 [debug] [Thread-4  ]: DuckDB adapter: Rolling back transaction.
[0m13:33:06.762702 [debug] [Thread-4  ]: On model.nhl_analytics.stg_goalies: ROLLBACK
[0m13:33:06.769560 [debug] [Thread-3  ]: Compilation Error in model mart_team_standings (models/marts/mart_team_standings.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:33:06.769961 [debug] [Thread-1  ]: Compilation Error in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:33:06.770363 [debug] [Thread-2  ]: Compilation Error in model mart_player_performance (models/marts/mart_player_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:33:06.772650 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70dca43e-b5b4-4437-b01d-a09287bcbef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11310dbe0>]}
[0m13:33:06.772944 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70dca43e-b5b4-4437-b01d-a09287bcbef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e5a5e0>]}
[0m13:33:06.773155 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70dca43e-b5b4-4437-b01d-a09287bcbef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ce1070>]}
[0m13:33:06.773517 [error] [Thread-3  ]: 3 of 7 ERROR creating sql table model silver.mart_team_standings ............... [[31mERROR[0m in 0.06s]
[0m13:33:06.773846 [error] [Thread-1  ]: 1 of 7 ERROR creating sql table model silver.mart_goalie_performance ........... [[31mERROR[0m in 0.06s]
[0m13:33:06.777270 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.mart_team_standings
[0m13:33:06.776908 [error] [Thread-2  ]: 2 of 7 ERROR creating sql table model silver.mart_player_performance ........... [[31mERROR[0m in 0.06s]
[0m13:33:06.777653 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.mart_goalie_performance
[0m13:33:06.777924 [debug] [Thread-3  ]: Began running node model.nhl_analytics.stg_skaters
[0m13:33:06.778183 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.mart_team_standings' to be skipped because of status 'error'.  Reason: Compilation Error in model mart_team_standings (models/marts/mart_team_standings.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:33:06.779767 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.mart_player_performance
[0m13:33:06.780020 [debug] [Thread-1  ]: Began running node model.nhl_analytics.stg_teams
[0m13:33:06.781706 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.mart_goalie_performance' to be skipped because of status 'error'.  Reason: Compilation Error in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:33:06.781454 [info ] [Thread-3  ]: 5 of 7 START sql view model silver.stg_skaters ................................. [RUN]
[0m13:33:06.782090 [info ] [Thread-1  ]: 6 of 7 START sql view model silver.stg_teams ................................... [RUN]
[0m13:33:06.783569 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.mart_player_performance' to be skipped because of status 'error'.  Reason: Compilation Error in model mart_player_performance (models/marts/mart_player_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:33:06.783852 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.mart_team_standings, now model.nhl_analytics.stg_skaters)
[0m13:33:06.784302 [debug] [Thread-4  ]: Failed to rollback 'model.nhl_analytics.stg_goalies'
[0m13:33:06.784530 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.mart_goalie_performance, now model.nhl_analytics.stg_teams)
[0m13:33:06.784783 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.stg_skaters
[0m13:33:06.785002 [debug] [Thread-4  ]: On model.nhl_analytics.stg_goalies: Close
[0m13:33:06.785218 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.stg_teams
[0m13:33:06.787435 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.stg_skaters"
[0m13:33:06.789441 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.stg_teams"
[0m13:33:06.792385 [debug] [Thread-4  ]: Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m13:33:06.792682 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70dca43e-b5b4-4437-b01d-a09287bcbef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ce19a0>]}
[0m13:33:06.793267 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.stg_skaters
[0m13:33:06.793502 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.stg_teams
[0m13:33:06.793084 [error] [Thread-4  ]: 4 of 7 ERROR creating sql view model silver.stg_goalies ........................ [[31mERROR[0m in 0.08s]
[0m13:33:06.796122 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.stg_skaters"
[0m13:33:06.799363 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.stg_teams"
[0m13:33:06.799762 [debug] [Thread-4  ]: Finished running node model.nhl_analytics.stg_goalies
[0m13:33:06.800189 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_goalies' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^.
[0m13:33:06.800561 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:33:06.800806 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:33:06.801031 [debug] [Thread-3  ]: On model.nhl_analytics.stg_skaters: BEGIN
[0m13:33:06.801248 [debug] [Thread-1  ]: On model.nhl_analytics.stg_teams: BEGIN
[0m13:33:06.801458 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:33:06.801655 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:33:06.802084 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m13:33:06.802316 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:33:06.802543 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m13:33:06.802784 [debug] [Thread-3  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    

select
    playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    games_played,
    icetime as ice_time,
    I_F_goals as goals,
    I_F_points as points,
    I_F_shotsOnGoal as shots_on_goal,
    I_F_primaryAssists as primary_assists,
    I_F_secondaryAssists as secondary_assists,
    case 
        when games_played > 0 then true 
        else false 
    end as is_active_player,
    case 
        when games_played > 0 then round(I_F_points * 1.0 / games_played, 2)
        else null 
    end as points_per_game,
    case 
        when I_F_shotsOnGoal > 0 then round(I_F_goals * 100.0 / I_F_shotsOnGoal, 2)
        else null 
    end as shooting_percentage,
    current_timestamp as loaded_at
from "nhl"."bronze"."skaters"
where playerId is not null
    and season is not null
  );

[0m13:33:06.803028 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:33:06.803627 [debug] [Thread-1  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

  
  create view "nhl"."silver"."stg_teams__dbt_tmp" as (
    

select
    season,
    name as team_name,
    team as team_code,
    games_played,
    goalsFor,
    goalsAgainst,
    goalsFor - goalsAgainst as goal_differential,
    xGoalsFor,
    xGoalsAgainst,
    current_timestamp as loaded_at
from "nhl"."bronze"."teams"
where season is not null
    and name is not null
    and situation = 'all'
  );

[0m13:33:06.804277 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m13:33:06.808301 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:33:06.808532 [debug] [Thread-3  ]: SQL status: OK in 0.005 seconds
[0m13:33:06.808747 [debug] [Thread-1  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */
alter view "nhl"."silver"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m13:33:06.810704 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:33:06.811179 [debug] [Thread-3  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */
alter view "nhl"."silver"."stg_skaters__dbt_tmp" rename to "stg_skaters"
[0m13:33:06.811544 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m13:33:06.817569 [debug] [Thread-1  ]: On model.nhl_analytics.stg_teams: COMMIT
[0m13:33:06.817799 [debug] [Thread-3  ]: SQL status: OK in 0.006 seconds
[0m13:33:06.818005 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:33:06.818805 [debug] [Thread-3  ]: On model.nhl_analytics.stg_skaters: COMMIT
[0m13:33:06.819017 [debug] [Thread-1  ]: On model.nhl_analytics.stg_teams: COMMIT
[0m13:33:06.819226 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:33:06.819494 [debug] [Thread-3  ]: On model.nhl_analytics.stg_skaters: COMMIT
[0m13:33:06.820273 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m13:33:06.823730 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:33:06.823963 [debug] [Thread-3  ]: SQL status: OK in 0.004 seconds
[0m13:33:06.824175 [debug] [Thread-1  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

      drop view if exists "nhl"."silver"."stg_teams__dbt_backup" cascade
    
[0m13:33:06.825760 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:33:06.826298 [debug] [Thread-3  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

      drop view if exists "nhl"."silver"."stg_skaters__dbt_backup" cascade
    
[0m13:33:06.826553 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m13:33:06.828073 [debug] [Thread-1  ]: On model.nhl_analytics.stg_teams: Close
[0m13:33:06.828291 [debug] [Thread-3  ]: SQL status: OK in 0.002 seconds
[0m13:33:06.828633 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70dca43e-b5b4-4437-b01d-a09287bcbef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e5a5e0>]}
[0m13:33:06.829292 [debug] [Thread-3  ]: On model.nhl_analytics.stg_skaters: Close
[0m13:33:06.829918 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70dca43e-b5b4-4437-b01d-a09287bcbef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11046b1c0>]}
[0m13:33:06.829675 [info ] [Thread-1  ]: 6 of 7 OK created sql view model silver.stg_teams .............................. [[32mOK[0m in 0.04s]
[0m13:33:06.830602 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.stg_teams
[0m13:33:06.830340 [info ] [Thread-3  ]: 5 of 7 OK created sql view model silver.stg_skaters ............................ [[32mOK[0m in 0.05s]
[0m13:33:06.831023 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.stg_skaters
[0m13:33:06.831381 [debug] [Thread-2  ]: Began running node model.nhl_analytics.int_all_players
[0m13:33:06.831656 [info ] [Thread-2  ]: 7 of 7 SKIP relation silver.int_all_players .................................... [[33mSKIP[0m]
[0m13:33:06.831930 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.int_all_players
[0m13:33:06.832464 [debug] [MainThread]: Using duckdb connection "master"
[0m13:33:06.832649 [debug] [MainThread]: On master: BEGIN
[0m13:33:06.832809 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:33:06.833149 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:33:06.833485 [debug] [MainThread]: On master: COMMIT
[0m13:33:06.833650 [debug] [MainThread]: Using duckdb connection "master"
[0m13:33:06.833812 [debug] [MainThread]: On master: COMMIT
[0m13:33:06.835125 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:33:06.835334 [debug] [MainThread]: On master: Close
[0m13:33:06.835558 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:33:06.835882 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_teams' was properly closed.
[0m13:33:06.836053 [debug] [MainThread]: Connection 'model.nhl_analytics.mart_player_performance' was properly closed.
[0m13:33:06.836218 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_skaters' was properly closed.
[0m13:33:06.836377 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_goalies' was properly closed.
[0m13:33:06.836612 [info ] [MainThread]: 
[0m13:33:06.836808 [info ] [MainThread]: Finished running 3 table models, 4 view models in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m13:33:06.837476 [debug] [MainThread]: Command end result
[0m13:33:06.853029 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m13:33:06.854138 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m13:33:06.858016 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/run_results.json
[0m13:33:06.858222 [info ] [MainThread]: 
[0m13:33:06.858461 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m13:33:06.858662 [info ] [MainThread]: 
[0m13:33:06.858891 [error] [MainThread]: [31mFailure in model mart_team_standings (models/marts/mart_team_standings.sql)[0m
[0m13:33:06.859117 [error] [MainThread]:   Compilation Error in model mart_team_standings (models/marts/mart_team_standings.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:33:06.859308 [info ] [MainThread]: 
[0m13:33:06.859524 [error] [MainThread]: [31mFailure in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)[0m
[0m13:33:06.859743 [error] [MainThread]:   Compilation Error in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:33:06.859929 [info ] [MainThread]: 
[0m13:33:06.860143 [error] [MainThread]: [31mFailure in model mart_player_performance (models/marts/mart_player_performance.sql)[0m
[0m13:33:06.860766 [error] [MainThread]:   Compilation Error in model mart_player_performance (models/marts/mart_player_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:33:06.861169 [info ] [MainThread]: 
[0m13:33:06.861728 [error] [MainThread]: [31mFailure in model stg_goalies (models/staging/stg_goalies.sql)[0m
[0m13:33:06.862171 [error] [MainThread]:   Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m13:33:06.862370 [info ] [MainThread]: 
[0m13:33:06.862629 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_goalies.sql
[0m13:33:06.863344 [info ] [MainThread]: 
[0m13:33:06.865191 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=4 SKIP=1 NO-OP=0 TOTAL=7
[0m13:33:06.868363 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7976501, "process_in_blocks": "0", "process_kernel_time": 0.15315, "process_mem_max_rss": "146030592", "process_out_blocks": "0", "process_user_time": 1.408154}
[0m13:33:06.868693 [debug] [MainThread]: Command `python -m dbt.cli.main run` failed at 13:33:06.868629 after 0.80 seconds
[0m13:33:06.868985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d713a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11045b460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113223f40>]}
[0m13:33:06.869334 [debug] [MainThread]: Flushing usage events
[0m13:33:07.048632 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:35:14.390478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c913a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e19460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e19280>]}


============================== 13:35:14.393352 | 9a965f98-07ee-460a-ac7d-e38daebe732c ==============================
[0m13:35:14.393352 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:35:14.393727 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'printer_width': '80', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True'}
[0m13:35:14.568050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a965f98-07ee-460a-ac7d-e38daebe732c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102620640>]}
[0m13:35:14.601849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a965f98-07ee-460a-ac7d-e38daebe732c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ebc7f0>]}
[0m13:35:14.603007 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m13:35:14.672531 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:35:14.762749 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:35:14.762982 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:35:14.796121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a965f98-07ee-460a-ac7d-e38daebe732c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10543f130>]}
[0m13:35:14.882053 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m13:35:14.883452 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m13:35:14.893614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a965f98-07ee-460a-ac7d-e38daebe732c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10542b700>]}
[0m13:35:14.893918 [info ] [MainThread]: Found 6 data tests, 7 models, 4 sources, 444 macros
[0m13:35:14.894138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a965f98-07ee-460a-ac7d-e38daebe732c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105447eb0>]}
[0m13:35:14.895043 [info ] [MainThread]: 
[0m13:35:14.895265 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:35:14.895447 [info ] [MainThread]: 
[0m13:35:14.895731 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:35:14.898909 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl'
[0m13:35:14.930750 [debug] [ThreadPool]: Using duckdb connection "list_nhl"
[0m13:35:14.930996 [debug] [ThreadPool]: On list_nhl: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m13:35:14.931172 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:35:14.974191 [debug] [ThreadPool]: SQL status: OK in 0.043 seconds
[0m13:35:14.975454 [debug] [ThreadPool]: On list_nhl: Close
[0m13:35:14.975863 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nhl, now create_nhl_silver)
[0m13:35:14.976134 [debug] [ThreadPool]: Creating schema "database: "nhl"
schema: "silver"
"
[0m13:35:14.980467 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:35:14.980662 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nhl'
        and type='sqlite'
    
  
[0m13:35:14.980829 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:35:14.981409 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:35:14.982244 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:35:14.982441 [debug] [ThreadPool]: On create_nhl_silver: BEGIN
[0m13:35:14.982717 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:35:14.982898 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:35:14.983068 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
    
        create schema if not exists "nhl"."silver"
    
[0m13:35:14.983517 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:35:14.984027 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m13:35:14.984211 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:35:14.984376 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m13:35:14.984645 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:35:14.984829 [debug] [ThreadPool]: On create_nhl_silver: Close
[0m13:35:14.985656 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nhl_silver, now list_nhl_silver)
[0m13:35:14.989065 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m13:35:14.989253 [debug] [ThreadPool]: On list_nhl_silver: BEGIN
[0m13:35:14.989410 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:35:14.989689 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:35:14.989864 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m13:35:14.990041 [debug] [ThreadPool]: On list_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl_silver"} */
select
      'nhl' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'silver'
    and lower(table_catalog) = 'nhl'
  
[0m13:35:15.000809 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m13:35:15.001677 [debug] [ThreadPool]: On list_nhl_silver: ROLLBACK
[0m13:35:15.002859 [debug] [ThreadPool]: Failed to rollback 'list_nhl_silver'
[0m13:35:15.003050 [debug] [ThreadPool]: On list_nhl_silver: Close
[0m13:35:15.003606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a965f98-07ee-460a-ac7d-e38daebe732c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045597f0>]}
[0m13:35:15.003871 [debug] [MainThread]: Using duckdb connection "master"
[0m13:35:15.004032 [debug] [MainThread]: On master: BEGIN
[0m13:35:15.004181 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:35:15.004457 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:35:15.004633 [debug] [MainThread]: On master: COMMIT
[0m13:35:15.004794 [debug] [MainThread]: Using duckdb connection "master"
[0m13:35:15.004949 [debug] [MainThread]: On master: COMMIT
[0m13:35:15.005188 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:35:15.005364 [debug] [MainThread]: On master: Close
[0m13:35:15.006697 [debug] [Thread-1  ]: Began running node model.nhl_analytics.mart_goalie_performance
[0m13:35:15.006945 [debug] [Thread-2  ]: Began running node model.nhl_analytics.mart_player_performance
[0m13:35:15.007412 [debug] [Thread-3  ]: Began running node model.nhl_analytics.mart_team_standings
[0m13:35:15.007624 [debug] [Thread-4  ]: Began running node model.nhl_analytics.stg_goalies
[0m13:35:15.007236 [info ] [Thread-1  ]: 1 of 7 START sql table model silver.mart_goalie_performance .................... [RUN]
[0m13:35:15.007943 [info ] [Thread-2  ]: 2 of 7 START sql table model silver.mart_player_performance .................... [RUN]
[0m13:35:15.008236 [info ] [Thread-3  ]: 3 of 7 START sql table model silver.mart_team_standings ........................ [RUN]
[0m13:35:15.008554 [info ] [Thread-4  ]: 4 of 7 START sql view model silver.stg_goalies ................................. [RUN]
[0m13:35:15.008828 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_nhl_silver, now model.nhl_analytics.mart_goalie_performance)
[0m13:35:15.009109 [debug] [Thread-2  ]: Acquiring new duckdb connection 'model.nhl_analytics.mart_player_performance'
[0m13:35:15.009371 [debug] [Thread-3  ]: Acquiring new duckdb connection 'model.nhl_analytics.mart_team_standings'
[0m13:35:15.009631 [debug] [Thread-4  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_goalies'
[0m13:35:15.009839 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.mart_goalie_performance
[0m13:35:15.010048 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.mart_player_performance
[0m13:35:15.010249 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.mart_team_standings
[0m13:35:15.010445 [debug] [Thread-4  ]: Began compiling node model.nhl_analytics.stg_goalies
[0m13:35:15.020604 [debug] [Thread-4  ]: Writing injected SQL for node "model.nhl_analytics.stg_goalies"
[0m13:35:15.025631 [debug] [Thread-4  ]: Began executing node model.nhl_analytics.stg_goalies
[0m13:35:15.047548 [debug] [Thread-4  ]: Writing runtime sql for node "model.nhl_analytics.stg_goalies"
[0m13:35:15.048015 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:35:15.050641 [debug] [Thread-4  ]: On model.nhl_analytics.stg_goalies: BEGIN
[0m13:35:15.052133 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:35:15.055247 [debug] [Thread-4  ]: SQL status: OK in 0.003 seconds
[0m13:35:15.057040 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:35:15.057361 [debug] [Thread-4  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position
from { { source('bronze', 'goalies') } }
where playerId is not null
    and season is not null
  );

[0m13:35:15.060766 [debug] [Thread-4  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position
from { { source('bronze', 'goalies') } }
where playerId is not null
    and season is not null
  );

[0m13:35:15.061036 [debug] [Thread-4  ]: DuckDB adapter: Rolling back transaction.
[0m13:35:15.062160 [debug] [Thread-4  ]: On model.nhl_analytics.stg_goalies: ROLLBACK
[0m13:35:15.069665 [debug] [Thread-2  ]: Compilation Error in model mart_player_performance (models/marts/mart_player_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:35:15.070089 [debug] [Thread-3  ]: Compilation Error in model mart_team_standings (models/marts/mart_team_standings.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:35:15.071219 [debug] [Thread-1  ]: Compilation Error in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:35:15.072952 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a965f98-07ee-460a-ac7d-e38daebe732c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058fc9d0>]}
[0m13:35:15.073165 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a965f98-07ee-460a-ac7d-e38daebe732c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10585b670>]}
[0m13:35:15.076128 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a965f98-07ee-460a-ac7d-e38daebe732c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10577ca90>]}
[0m13:35:15.076506 [error] [Thread-3  ]: 3 of 7 ERROR creating sql table model silver.mart_team_standings ............... [[31mERROR[0m in 0.06s]
[0m13:35:15.076896 [error] [Thread-2  ]: 2 of 7 ERROR creating sql table model silver.mart_player_performance ........... [[31mERROR[0m in 0.06s]
[0m13:35:15.077529 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.mart_team_standings
[0m13:35:15.077292 [error] [Thread-1  ]: 1 of 7 ERROR creating sql table model silver.mart_goalie_performance ........... [[31mERROR[0m in 0.06s]
[0m13:35:15.079187 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.mart_player_performance
[0m13:35:15.079434 [debug] [Thread-3  ]: Began running node model.nhl_analytics.stg_skaters
[0m13:35:15.079693 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.mart_team_standings' to be skipped because of status 'error'.  Reason: Compilation Error in model mart_team_standings (models/marts/mart_team_standings.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:35:15.079998 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.mart_goalie_performance
[0m13:35:15.081379 [debug] [Thread-2  ]: Began running node model.nhl_analytics.stg_teams
[0m13:35:15.081666 [info ] [Thread-3  ]: 5 of 7 START sql view model silver.stg_skaters ................................. [RUN]
[0m13:35:15.082013 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.mart_player_performance' to be skipped because of status 'error'.  Reason: Compilation Error in model mart_player_performance (models/marts/mart_player_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:35:15.083908 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.mart_team_standings, now model.nhl_analytics.stg_skaters)
[0m13:35:15.083681 [info ] [Thread-2  ]: 6 of 7 START sql view model silver.stg_teams ................................... [RUN]
[0m13:35:15.084248 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.mart_goalie_performance' to be skipped because of status 'error'.  Reason: Compilation Error in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:35:15.084719 [debug] [Thread-4  ]: Failed to rollback 'model.nhl_analytics.stg_goalies'
[0m13:35:15.084927 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.stg_skaters
[0m13:35:15.085159 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.mart_player_performance, now model.nhl_analytics.stg_teams)
[0m13:35:15.085415 [debug] [Thread-4  ]: On model.nhl_analytics.stg_goalies: Close
[0m13:35:15.087808 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.stg_skaters"
[0m13:35:15.088066 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.stg_teams
[0m13:35:15.090171 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.stg_teams"
[0m13:35:15.090608 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.stg_teams
[0m13:35:15.090826 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.stg_skaters
[0m13:35:15.093272 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.stg_teams"
[0m13:35:15.101281 [debug] [Thread-4  ]: Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m13:35:15.134010 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.stg_skaters"
[0m13:35:15.134499 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a965f98-07ee-460a-ac7d-e38daebe732c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10585bdf0>]}
[0m13:35:15.135049 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:35:15.135761 [debug] [Thread-2  ]: On model.nhl_analytics.stg_teams: BEGIN
[0m13:35:15.135544 [error] [Thread-4  ]: 4 of 7 ERROR creating sql view model silver.stg_goalies ........................ [[31mERROR[0m in 0.12s]
[0m13:35:15.136092 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:35:15.136435 [debug] [Thread-4  ]: Finished running node model.nhl_analytics.stg_goalies
[0m13:35:15.136702 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:35:15.137157 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_goalies' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^.
[0m13:35:15.137398 [debug] [Thread-3  ]: On model.nhl_analytics.stg_skaters: BEGIN
[0m13:35:15.137701 [debug] [Thread-2  ]: SQL status: OK in 0.002 seconds
[0m13:35:15.137908 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:35:15.138123 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:35:15.138524 [debug] [Thread-2  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

  
  create view "nhl"."silver"."stg_teams__dbt_tmp" as (
    

select
    season,
    name as team_name,
    team as team_code,
    games_played,
    goalsFor,
    goalsAgainst,
    goalsFor - goalsAgainst as goal_differential,
    xGoalsFor,
    xGoalsAgainst,
    current_timestamp as loaded_at
from "nhl"."bronze"."teams"
where season is not null
    and name is not null
    and situation = 'all'
  );

[0m13:35:15.138863 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m13:35:15.139092 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:35:15.139332 [debug] [Thread-3  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    

select
    playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    games_played,
    icetime as ice_time,
    I_F_goals as goals,
    I_F_points as points,
    I_F_shotsOnGoal as shots_on_goal,
    I_F_primaryAssists as primary_assists,
    I_F_secondaryAssists as secondary_assists,
    case 
        when games_played > 0 then true 
        else false 
    end as is_active_player,
    case 
        when games_played > 0 then round(I_F_points * 1.0 / games_played, 2)
        else null 
    end as points_per_game,
    case 
        when I_F_shotsOnGoal > 0 then round(I_F_goals * 100.0 / I_F_shotsOnGoal, 2)
        else null 
    end as shooting_percentage,
    current_timestamp as loaded_at
from "nhl"."bronze"."skaters"
where playerId is not null
    and season is not null
  );

[0m13:35:15.140868 [debug] [Thread-2  ]: SQL status: OK in 0.002 seconds
[0m13:35:15.149418 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:35:15.149739 [debug] [Thread-3  ]: SQL status: OK in 0.010 seconds
[0m13:35:15.149967 [debug] [Thread-2  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */
alter view "nhl"."silver"."stg_teams" rename to "stg_teams__dbt_backup"
[0m13:35:15.152027 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:35:15.152572 [debug] [Thread-3  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */
alter view "nhl"."silver"."stg_skaters" rename to "stg_skaters__dbt_backup"
[0m13:35:15.152925 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m13:35:15.154801 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:35:15.155011 [debug] [Thread-3  ]: SQL status: OK in 0.002 seconds
[0m13:35:15.155215 [debug] [Thread-2  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */
alter view "nhl"."silver"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m13:35:15.157105 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:35:15.157386 [debug] [Thread-3  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */
alter view "nhl"."silver"."stg_skaters__dbt_tmp" rename to "stg_skaters"
[0m13:35:15.157643 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m13:35:15.164158 [debug] [Thread-3  ]: SQL status: OK in 0.007 seconds
[0m13:35:15.165466 [debug] [Thread-2  ]: On model.nhl_analytics.stg_teams: COMMIT
[0m13:35:15.166348 [debug] [Thread-3  ]: On model.nhl_analytics.stg_skaters: COMMIT
[0m13:35:15.166570 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:35:15.166771 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:35:15.166971 [debug] [Thread-2  ]: On model.nhl_analytics.stg_teams: COMMIT
[0m13:35:15.167161 [debug] [Thread-3  ]: On model.nhl_analytics.stg_skaters: COMMIT
[0m13:35:15.168087 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m13:35:15.171546 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:35:15.171768 [debug] [Thread-3  ]: SQL status: OK in 0.004 seconds
[0m13:35:15.171983 [debug] [Thread-2  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

      drop view if exists "nhl"."silver"."stg_teams__dbt_backup" cascade
    
[0m13:35:15.173573 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:35:15.174099 [debug] [Thread-3  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

      drop view if exists "nhl"."silver"."stg_skaters__dbt_backup" cascade
    
[0m13:35:15.174384 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m13:35:15.176500 [debug] [Thread-2  ]: On model.nhl_analytics.stg_teams: Close
[0m13:35:15.176727 [debug] [Thread-3  ]: SQL status: OK in 0.002 seconds
[0m13:35:15.177400 [debug] [Thread-3  ]: On model.nhl_analytics.stg_skaters: Close
[0m13:35:15.177721 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a965f98-07ee-460a-ac7d-e38daebe732c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102625f40>]}
[0m13:35:15.178027 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a965f98-07ee-460a-ac7d-e38daebe732c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058fc9d0>]}
[0m13:35:15.178451 [info ] [Thread-2  ]: 6 of 7 OK created sql view model silver.stg_teams .............................. [[32mOK[0m in 0.09s]
[0m13:35:15.178782 [info ] [Thread-3  ]: 5 of 7 OK created sql view model silver.stg_skaters ............................ [[32mOK[0m in 0.09s]
[0m13:35:15.179100 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.stg_teams
[0m13:35:15.179390 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.stg_skaters
[0m13:35:15.179816 [debug] [Thread-1  ]: Began running node model.nhl_analytics.int_all_players
[0m13:35:15.180109 [info ] [Thread-1  ]: 7 of 7 SKIP relation silver.int_all_players .................................... [[33mSKIP[0m]
[0m13:35:15.180385 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.int_all_players
[0m13:35:15.180946 [debug] [MainThread]: Using duckdb connection "master"
[0m13:35:15.181133 [debug] [MainThread]: On master: BEGIN
[0m13:35:15.181288 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:35:15.181592 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:35:15.181782 [debug] [MainThread]: On master: COMMIT
[0m13:35:15.181947 [debug] [MainThread]: Using duckdb connection "master"
[0m13:35:15.182103 [debug] [MainThread]: On master: COMMIT
[0m13:35:15.182354 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:35:15.182532 [debug] [MainThread]: On master: Close
[0m13:35:15.182754 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:35:15.182908 [debug] [MainThread]: Connection 'model.nhl_analytics.mart_goalie_performance' was properly closed.
[0m13:35:15.183053 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_teams' was properly closed.
[0m13:35:15.183195 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_skaters' was properly closed.
[0m13:35:15.183335 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_goalies' was properly closed.
[0m13:35:15.183542 [info ] [MainThread]: 
[0m13:35:15.183736 [info ] [MainThread]: Finished running 3 table models, 4 view models in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m13:35:15.184421 [debug] [MainThread]: Command end result
[0m13:35:15.199171 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m13:35:15.200125 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m13:35:15.203968 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/run_results.json
[0m13:35:15.204166 [info ] [MainThread]: 
[0m13:35:15.204401 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m13:35:15.204597 [info ] [MainThread]: 
[0m13:35:15.204823 [error] [MainThread]: [31mFailure in model mart_team_standings (models/marts/mart_team_standings.sql)[0m
[0m13:35:15.205046 [error] [MainThread]:   Compilation Error in model mart_team_standings (models/marts/mart_team_standings.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:35:15.205233 [info ] [MainThread]: 
[0m13:35:15.205447 [error] [MainThread]: [31mFailure in model mart_player_performance (models/marts/mart_player_performance.sql)[0m
[0m13:35:15.205662 [error] [MainThread]:   Compilation Error in model mart_player_performance (models/marts/mart_player_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:35:15.205841 [info ] [MainThread]: 
[0m13:35:15.206051 [error] [MainThread]: [31mFailure in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)[0m
[0m13:35:15.206268 [error] [MainThread]:   Compilation Error in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:35:15.206457 [info ] [MainThread]: 
[0m13:35:15.206664 [error] [MainThread]: [31mFailure in model stg_goalies (models/staging/stg_goalies.sql)[0m
[0m13:35:15.206872 [error] [MainThread]:   Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m13:35:15.207043 [info ] [MainThread]: 
[0m13:35:15.207249 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_goalies.sql
[0m13:35:15.207427 [info ] [MainThread]: 
[0m13:35:15.207619 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=4 SKIP=1 NO-OP=0 TOTAL=7
[0m13:35:15.208610 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8604819, "process_in_blocks": "0", "process_kernel_time": 0.16072, "process_mem_max_rss": "146604032", "process_out_blocks": "0", "process_user_time": 1.376472}
[0m13:35:15.208935 [debug] [MainThread]: Command `python -m dbt.cli.main run` failed at 13:35:15.208870 after 0.86 seconds
[0m13:35:15.209185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c913a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f30460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059b5940>]}
[0m13:35:15.209421 [debug] [MainThread]: Flushing usage events
[0m13:35:15.447132 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:36:24.510589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079853d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120e394c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120e392e0>]}


============================== 13:36:24.513434 | f9f9e2ee-4056-4ea1-a208-6fbeae341b3d ==============================
[0m13:36:24.513434 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:36:24.513777 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'profiles_dir': '.', 'printer_width': '80', 'invocation_command': 'dbt run --profiles-dir .', 'use_colors': 'True', 'warn_error': 'None', 'static_parser': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'write_json': 'True', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'no_print': 'None', 'introspect': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'use_experimental_parser': 'False'}
[0m13:36:24.678762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9f9e2ee-4056-4ea1-a208-6fbeae341b3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121905ac0>]}
[0m13:36:24.712995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9f9e2ee-4056-4ea1-a208-6fbeae341b3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120e052e0>]}
[0m13:36:24.714606 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m13:36:24.784681 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:36:24.874386 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:36:24.874642 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:36:24.907969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9f9e2ee-4056-4ea1-a208-6fbeae341b3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121f5e130>]}
[0m13:36:24.995246 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m13:36:24.996606 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m13:36:25.006336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9f9e2ee-4056-4ea1-a208-6fbeae341b3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121f21d30>]}
[0m13:36:25.006656 [info ] [MainThread]: Found 6 data tests, 7 models, 4 sources, 444 macros
[0m13:36:25.006884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9f9e2ee-4056-4ea1-a208-6fbeae341b3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121f5e2e0>]}
[0m13:36:25.007937 [info ] [MainThread]: 
[0m13:36:25.008174 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:36:25.008355 [info ] [MainThread]: 
[0m13:36:25.008641 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:36:25.011890 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl'
[0m13:36:25.043669 [debug] [ThreadPool]: Using duckdb connection "list_nhl"
[0m13:36:25.043918 [debug] [ThreadPool]: On list_nhl: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m13:36:25.044097 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:36:25.084820 [debug] [ThreadPool]: SQL status: OK in 0.041 seconds
[0m13:36:25.085667 [debug] [ThreadPool]: On list_nhl: Close
[0m13:36:25.086070 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nhl, now create_nhl_silver)
[0m13:36:25.086339 [debug] [ThreadPool]: Creating schema "database: "nhl"
schema: "silver"
"
[0m13:36:25.090872 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:36:25.091130 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nhl'
        and type='sqlite'
    
  
[0m13:36:25.091335 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:36:25.092049 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:36:25.092793 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:36:25.092975 [debug] [ThreadPool]: On create_nhl_silver: BEGIN
[0m13:36:25.093240 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:36:25.093415 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:36:25.093590 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
    
        create schema if not exists "nhl"."silver"
    
[0m13:36:25.093878 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:36:25.094345 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m13:36:25.094514 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:36:25.094667 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m13:36:25.094904 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:36:25.095079 [debug] [ThreadPool]: On create_nhl_silver: Close
[0m13:36:25.095909 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nhl_silver, now list_nhl_silver)
[0m13:36:25.099339 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m13:36:25.099522 [debug] [ThreadPool]: On list_nhl_silver: BEGIN
[0m13:36:25.099679 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:36:25.099948 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:36:25.100119 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m13:36:25.100307 [debug] [ThreadPool]: On list_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl_silver"} */
select
      'nhl' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'silver'
    and lower(table_catalog) = 'nhl'
  
[0m13:36:25.109557 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m13:36:25.110448 [debug] [ThreadPool]: On list_nhl_silver: ROLLBACK
[0m13:36:25.111659 [debug] [ThreadPool]: Failed to rollback 'list_nhl_silver'
[0m13:36:25.111845 [debug] [ThreadPool]: On list_nhl_silver: Close
[0m13:36:25.112342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9f9e2ee-4056-4ea1-a208-6fbeae341b3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120ec11f0>]}
[0m13:36:25.112614 [debug] [MainThread]: Using duckdb connection "master"
[0m13:36:25.112789 [debug] [MainThread]: On master: BEGIN
[0m13:36:25.112940 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:36:25.113218 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:36:25.113388 [debug] [MainThread]: On master: COMMIT
[0m13:36:25.113562 [debug] [MainThread]: Using duckdb connection "master"
[0m13:36:25.113723 [debug] [MainThread]: On master: COMMIT
[0m13:36:25.113959 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:36:25.114139 [debug] [MainThread]: On master: Close
[0m13:36:25.115551 [debug] [Thread-1  ]: Began running node model.nhl_analytics.mart_goalie_performance
[0m13:36:25.115789 [debug] [Thread-2  ]: Began running node model.nhl_analytics.mart_player_performance
[0m13:36:25.116258 [debug] [Thread-3  ]: Began running node model.nhl_analytics.mart_team_standings
[0m13:36:25.116078 [info ] [Thread-1  ]: 1 of 7 START sql table model silver.mart_goalie_performance .................... [RUN]
[0m13:36:25.116530 [debug] [Thread-4  ]: Began running node model.nhl_analytics.stg_goalies
[0m13:36:25.116807 [info ] [Thread-2  ]: 2 of 7 START sql table model silver.mart_player_performance .................... [RUN]
[0m13:36:25.117124 [info ] [Thread-3  ]: 3 of 7 START sql table model silver.mart_team_standings ........................ [RUN]
[0m13:36:25.117410 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_nhl_silver, now model.nhl_analytics.mart_goalie_performance)
[0m13:36:25.117702 [info ] [Thread-4  ]: 4 of 7 START sql view model silver.stg_goalies ................................. [RUN]
[0m13:36:25.118013 [debug] [Thread-2  ]: Acquiring new duckdb connection 'model.nhl_analytics.mart_player_performance'
[0m13:36:25.118302 [debug] [Thread-3  ]: Acquiring new duckdb connection 'model.nhl_analytics.mart_team_standings'
[0m13:36:25.118527 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.mart_goalie_performance
[0m13:36:25.118796 [debug] [Thread-4  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_goalies'
[0m13:36:25.119009 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.mart_player_performance
[0m13:36:25.119219 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.mart_team_standings
[0m13:36:25.124305 [debug] [Thread-4  ]: Began compiling node model.nhl_analytics.stg_goalies
[0m13:36:25.132792 [debug] [Thread-4  ]: Writing injected SQL for node "model.nhl_analytics.stg_goalies"
[0m13:36:25.136147 [debug] [Thread-4  ]: Began executing node model.nhl_analytics.stg_goalies
[0m13:36:25.161351 [debug] [Thread-4  ]: Writing runtime sql for node "model.nhl_analytics.stg_goalies"
[0m13:36:25.163938 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:36:25.165103 [debug] [Thread-4  ]: On model.nhl_analytics.stg_goalies: BEGIN
[0m13:36:25.166219 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:36:25.168187 [debug] [Thread-4  ]: SQL status: OK in 0.002 seconds
[0m13:36:25.168434 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:36:25.168993 [debug] [Thread-4  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position
from { { source('bronze', 'goalies') } }
where playerId is not null
    and season is not null
  );

[0m13:36:25.171932 [debug] [Thread-4  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position
from { { source('bronze', 'goalies') } }
where playerId is not null
    and season is not null
  );

[0m13:36:25.172220 [debug] [Thread-4  ]: DuckDB adapter: Rolling back transaction.
[0m13:36:25.172967 [debug] [Thread-4  ]: On model.nhl_analytics.stg_goalies: ROLLBACK
[0m13:36:25.180924 [debug] [Thread-3  ]: Compilation Error in model mart_team_standings (models/marts/mart_team_standings.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:36:25.181350 [debug] [Thread-1  ]: Compilation Error in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:36:25.181718 [debug] [Thread-2  ]: Compilation Error in model mart_player_performance (models/marts/mart_player_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:36:25.186351 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9f9e2ee-4056-4ea1-a208-6fbeae341b3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12241ba00>]}
[0m13:36:25.186614 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9f9e2ee-4056-4ea1-a208-6fbeae341b3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12237bd90>]}
[0m13:36:25.187132 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9f9e2ee-4056-4ea1-a208-6fbeae341b3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122490d60>]}
[0m13:36:25.186960 [error] [Thread-3  ]: 3 of 7 ERROR creating sql table model silver.mart_team_standings ............... [[31mERROR[0m in 0.06s]
[0m13:36:25.187567 [error] [Thread-1  ]: 1 of 7 ERROR creating sql table model silver.mart_goalie_performance ........... [[31mERROR[0m in 0.07s]
[0m13:36:25.188189 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.mart_team_standings
[0m13:36:25.187954 [error] [Thread-2  ]: 2 of 7 ERROR creating sql table model silver.mart_player_performance ........... [[31mERROR[0m in 0.07s]
[0m13:36:25.189698 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.mart_goalie_performance
[0m13:36:25.189943 [debug] [Thread-3  ]: Began running node model.nhl_analytics.stg_skaters
[0m13:36:25.190204 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.mart_team_standings' to be skipped because of status 'error'.  Reason: Compilation Error in model mart_team_standings (models/marts/mart_team_standings.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:36:25.190483 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.mart_player_performance
[0m13:36:25.192001 [debug] [Thread-1  ]: Began running node model.nhl_analytics.stg_teams
[0m13:36:25.192290 [info ] [Thread-3  ]: 5 of 7 START sql view model silver.stg_skaters ................................. [RUN]
[0m13:36:25.192648 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.mart_goalie_performance' to be skipped because of status 'error'.  Reason: Compilation Error in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:36:25.194235 [info ] [Thread-1  ]: 6 of 7 START sql view model silver.stg_teams ................................... [RUN]
[0m13:36:25.194518 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.mart_team_standings, now model.nhl_analytics.stg_skaters)
[0m13:36:25.194800 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.mart_player_performance' to be skipped because of status 'error'.  Reason: Compilation Error in model mart_player_performance (models/marts/mart_player_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:36:25.195249 [debug] [Thread-4  ]: Failed to rollback 'model.nhl_analytics.stg_goalies'
[0m13:36:25.195462 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.mart_goalie_performance, now model.nhl_analytics.stg_teams)
[0m13:36:25.195677 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.stg_skaters
[0m13:36:25.195917 [debug] [Thread-4  ]: On model.nhl_analytics.stg_goalies: Close
[0m13:36:25.196119 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.stg_teams
[0m13:36:25.198224 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.stg_skaters"
[0m13:36:25.200268 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.stg_teams"
[0m13:36:25.203195 [debug] [Thread-4  ]: Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m13:36:25.203483 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9f9e2ee-4056-4ea1-a208-6fbeae341b3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1224e0700>]}
[0m13:36:25.203769 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.stg_skaters
[0m13:36:25.206367 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.stg_skaters"
[0m13:36:25.204096 [error] [Thread-4  ]: 4 of 7 ERROR creating sql view model silver.stg_goalies ........................ [[31mERROR[0m in 0.08s]
[0m13:36:25.206653 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.stg_teams
[0m13:36:25.206992 [debug] [Thread-4  ]: Finished running node model.nhl_analytics.stg_goalies
[0m13:36:25.210281 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.stg_teams"
[0m13:36:25.210654 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_goalies' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^.
[0m13:36:25.210920 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:36:25.211266 [debug] [Thread-3  ]: On model.nhl_analytics.stg_skaters: BEGIN
[0m13:36:25.211523 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:36:25.211876 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:36:25.212096 [debug] [Thread-1  ]: On model.nhl_analytics.stg_teams: BEGIN
[0m13:36:25.212305 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m13:36:25.212505 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:36:25.212713 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:36:25.213010 [debug] [Thread-3  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    

select
    playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    games_played,
    icetime as ice_time,
    I_F_goals as goals,
    I_F_points as points,
    I_F_shotsOnGoal as shots_on_goal,
    I_F_primaryAssists as primary_assists,
    I_F_secondaryAssists as secondary_assists,
    case 
        when games_played > 0 then true 
        else false 
    end as is_active_player,
    case 
        when games_played > 0 then round(I_F_points * 1.0 / games_played, 2)
        else null 
    end as points_per_game,
    case 
        when I_F_shotsOnGoal > 0 then round(I_F_goals * 100.0 / I_F_shotsOnGoal, 2)
        else null 
    end as shooting_percentage,
    current_timestamp as loaded_at
from "nhl"."bronze"."skaters"
where playerId is not null
    and season is not null
  );

[0m13:36:25.213384 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m13:36:25.213583 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:36:25.213797 [debug] [Thread-1  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

  
  create view "nhl"."silver"."stg_teams__dbt_tmp" as (
    

select
    season,
    name as team_name,
    team as team_code,
    games_played,
    goalsFor,
    goalsAgainst,
    goalsFor - goalsAgainst as goal_differential,
    xGoalsFor,
    xGoalsAgainst,
    current_timestamp as loaded_at
from "nhl"."bronze"."teams"
where season is not null
    and name is not null
    and situation = 'all'
  );

[0m13:36:25.214073 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m13:36:25.218009 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:36:25.218287 [debug] [Thread-3  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */
alter view "nhl"."silver"."stg_skaters" rename to "stg_skaters__dbt_backup"
[0m13:36:25.218499 [debug] [Thread-1  ]: SQL status: OK in 0.004 seconds
[0m13:36:25.220472 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:36:25.220687 [debug] [Thread-1  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */
alter view "nhl"."silver"."stg_teams" rename to "stg_teams__dbt_backup"
[0m13:36:25.220893 [debug] [Thread-3  ]: SQL status: OK in 0.002 seconds
[0m13:36:25.222786 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:36:25.223007 [debug] [Thread-3  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */
alter view "nhl"."silver"."stg_skaters__dbt_tmp" rename to "stg_skaters"
[0m13:36:25.223209 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m13:36:25.225229 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:36:25.225545 [debug] [Thread-1  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */
alter view "nhl"."silver"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m13:36:25.225779 [debug] [Thread-3  ]: SQL status: OK in 0.002 seconds
[0m13:36:25.232820 [debug] [Thread-3  ]: On model.nhl_analytics.stg_skaters: COMMIT
[0m13:36:25.233051 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:36:25.233255 [debug] [Thread-1  ]: SQL status: OK in 0.007 seconds
[0m13:36:25.233453 [debug] [Thread-3  ]: On model.nhl_analytics.stg_skaters: COMMIT
[0m13:36:25.234298 [debug] [Thread-1  ]: On model.nhl_analytics.stg_teams: COMMIT
[0m13:36:25.234539 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:36:25.234783 [debug] [Thread-1  ]: On model.nhl_analytics.stg_teams: COMMIT
[0m13:36:25.235532 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m13:36:25.238974 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:36:25.239196 [debug] [Thread-1  ]: SQL status: OK in 0.004 seconds
[0m13:36:25.239414 [debug] [Thread-3  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

      drop view if exists "nhl"."silver"."stg_skaters__dbt_backup" cascade
    
[0m13:36:25.240981 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:36:25.241477 [debug] [Thread-1  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

      drop view if exists "nhl"."silver"."stg_teams__dbt_backup" cascade
    
[0m13:36:25.241825 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m13:36:25.243840 [debug] [Thread-3  ]: On model.nhl_analytics.stg_skaters: Close
[0m13:36:25.244053 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m13:36:25.244734 [debug] [Thread-1  ]: On model.nhl_analytics.stg_teams: Close
[0m13:36:25.245043 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9f9e2ee-4056-4ea1-a208-6fbeae341b3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d1eac0>]}
[0m13:36:25.245366 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9f9e2ee-4056-4ea1-a208-6fbeae341b3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122840a60>]}
[0m13:36:25.245766 [info ] [Thread-3  ]: 5 of 7 OK created sql view model silver.stg_skaters ............................ [[32mOK[0m in 0.05s]
[0m13:36:25.246351 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.stg_skaters
[0m13:36:25.246017 [info ] [Thread-1  ]: 6 of 7 OK created sql view model silver.stg_teams .............................. [[32mOK[0m in 0.05s]
[0m13:36:25.246800 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.stg_teams
[0m13:36:25.247017 [debug] [Thread-2  ]: Began running node model.nhl_analytics.int_all_players
[0m13:36:25.247291 [info ] [Thread-2  ]: 7 of 7 SKIP relation silver.int_all_players .................................... [[33mSKIP[0m]
[0m13:36:25.247534 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.int_all_players
[0m13:36:25.248088 [debug] [MainThread]: Using duckdb connection "master"
[0m13:36:25.248277 [debug] [MainThread]: On master: BEGIN
[0m13:36:25.248443 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:36:25.248740 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:36:25.248912 [debug] [MainThread]: On master: COMMIT
[0m13:36:25.249077 [debug] [MainThread]: Using duckdb connection "master"
[0m13:36:25.249227 [debug] [MainThread]: On master: COMMIT
[0m13:36:25.249457 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:36:25.249625 [debug] [MainThread]: On master: Close
[0m13:36:25.249833 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:36:25.249979 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_teams' was properly closed.
[0m13:36:25.250121 [debug] [MainThread]: Connection 'model.nhl_analytics.mart_player_performance' was properly closed.
[0m13:36:25.250261 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_skaters' was properly closed.
[0m13:36:25.250400 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_goalies' was properly closed.
[0m13:36:25.250604 [info ] [MainThread]: 
[0m13:36:25.250818 [info ] [MainThread]: Finished running 3 table models, 4 view models in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m13:36:25.251491 [debug] [MainThread]: Command end result
[0m13:36:25.265999 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m13:36:25.266933 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m13:36:25.270815 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/run_results.json
[0m13:36:25.271010 [info ] [MainThread]: 
[0m13:36:25.271242 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m13:36:25.271436 [info ] [MainThread]: 
[0m13:36:25.271663 [error] [MainThread]: [31mFailure in model mart_team_standings (models/marts/mart_team_standings.sql)[0m
[0m13:36:25.271887 [error] [MainThread]:   Compilation Error in model mart_team_standings (models/marts/mart_team_standings.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:36:25.272075 [info ] [MainThread]: 
[0m13:36:25.272290 [error] [MainThread]: [31mFailure in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)[0m
[0m13:36:25.272508 [error] [MainThread]:   Compilation Error in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:36:25.272689 [info ] [MainThread]: 
[0m13:36:25.272898 [error] [MainThread]: [31mFailure in model mart_player_performance (models/marts/mart_player_performance.sql)[0m
[0m13:36:25.273115 [error] [MainThread]:   Compilation Error in model mart_player_performance (models/marts/mart_player_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:36:25.273294 [info ] [MainThread]: 
[0m13:36:25.273500 [error] [MainThread]: [31mFailure in model stg_goalies (models/staging/stg_goalies.sql)[0m
[0m13:36:25.273705 [error] [MainThread]:   Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m13:36:25.273875 [info ] [MainThread]: 
[0m13:36:25.274078 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_goalies.sql
[0m13:36:25.274293 [info ] [MainThread]: 
[0m13:36:25.274507 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=4 SKIP=1 NO-OP=0 TOTAL=7
[0m13:36:25.275560 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.80900043, "process_in_blocks": "0", "process_kernel_time": 0.188089, "process_mem_max_rss": "143884288", "process_out_blocks": "0", "process_user_time": 1.376828}
[0m13:36:25.275803 [debug] [MainThread]: Command `python -m dbt.cli.main run` failed at 13:36:25.275756 after 0.81 seconds
[0m13:36:25.276065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079853d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d84220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1224ea220>]}
[0m13:36:25.276339 [debug] [MainThread]: Flushing usage events
[0m13:36:25.489259 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:36:33.743484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043893d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057394c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057392e0>]}


============================== 13:36:33.746183 | 1e9c8268-2c2d-4843-b215-98bc216cec99 ==============================
[0m13:36:33.746183 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:36:33.746547 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'version_check': 'True', 'printer_width': '80', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'partial_parse': 'True', 'target_path': 'None', 'write_json': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt clean --profiles-dir .', 'use_experimental_parser': 'False', 'warn_error': 'None', 'debug': 'False', 'quiet': 'False', 'profiles_dir': '.', 'introspect': 'True'}
[0m13:36:33.814229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e9c8268-2c2d-4843-b215-98bc216cec99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a33c10>]}
[0m13:36:33.826794 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.12754412, "process_in_blocks": "0", "process_kernel_time": 0.083013, "process_mem_max_rss": "100532224", "process_out_blocks": "0", "process_user_time": 0.839263}
[0m13:36:33.827061 [debug] [MainThread]: Command `python -m dbt.cli.main clean` succeeded at 13:36:33.827007 after 0.13 seconds
[0m13:36:33.827292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043893d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057f8a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105715310>]}
[0m13:36:33.827513 [debug] [MainThread]: Flushing usage events
[0m13:36:34.007625 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:36:39.115760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b013a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c89460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c89280>]}


============================== 13:36:39.118502 | 939ac182-de14-43bf-8a69-a571e16a3b01 ==============================
[0m13:36:39.118502 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:36:39.118859 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'target_path': 'None', 'fail_fast': 'False', 'debug': 'False', 'write_json': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'partial_parse': 'True', 'introspect': 'True', 'printer_width': '80', 'use_colors': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'no_print': 'None', 'cache_selected_only': 'False', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'profiles_dir': '.'}
[0m13:36:39.299622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '939ac182-de14-43bf-8a69-a571e16a3b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dca4f0>]}
[0m13:36:39.333937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '939ac182-de14-43bf-8a69-a571e16a3b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d2c7f0>]}
[0m13:36:39.335596 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m13:36:39.406407 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:36:39.406856 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:36:39.407102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '939ac182-de14-43bf-8a69-a571e16a3b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ee0e20>]}
[0m13:36:40.213601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '939ac182-de14-43bf-8a69-a571e16a3b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10961a130>]}
[0m13:36:40.302039 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m13:36:40.303458 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m13:36:40.313887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '939ac182-de14-43bf-8a69-a571e16a3b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095013d0>]}
[0m13:36:40.314202 [info ] [MainThread]: Found 7 models, 6 data tests, 4 sources, 444 macros
[0m13:36:40.314422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '939ac182-de14-43bf-8a69-a571e16a3b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109628640>]}
[0m13:36:40.315376 [info ] [MainThread]: 
[0m13:36:40.315589 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:36:40.315767 [info ] [MainThread]: 
[0m13:36:40.316053 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:36:40.319288 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl'
[0m13:36:40.350477 [debug] [ThreadPool]: Using duckdb connection "list_nhl"
[0m13:36:40.350755 [debug] [ThreadPool]: On list_nhl: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m13:36:40.350932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:36:40.391016 [debug] [ThreadPool]: SQL status: OK in 0.040 seconds
[0m13:36:40.392248 [debug] [ThreadPool]: On list_nhl: Close
[0m13:36:40.392651 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nhl, now create_nhl_silver)
[0m13:36:40.392921 [debug] [ThreadPool]: Creating schema "database: "nhl"
schema: "silver"
"
[0m13:36:40.397091 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:36:40.397291 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nhl'
        and type='sqlite'
    
  
[0m13:36:40.397458 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:36:40.398054 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:36:40.398836 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:36:40.399018 [debug] [ThreadPool]: On create_nhl_silver: BEGIN
[0m13:36:40.399273 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:36:40.399444 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:36:40.399611 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
    
        create schema if not exists "nhl"."silver"
    
[0m13:36:40.399878 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:36:40.400321 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m13:36:40.400493 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:36:40.400649 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m13:36:40.400885 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:36:40.401062 [debug] [ThreadPool]: On create_nhl_silver: Close
[0m13:36:40.401868 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nhl_silver, now list_nhl_silver)
[0m13:36:40.405262 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m13:36:40.405440 [debug] [ThreadPool]: On list_nhl_silver: BEGIN
[0m13:36:40.405595 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:36:40.405864 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:36:40.406036 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m13:36:40.406209 [debug] [ThreadPool]: On list_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl_silver"} */
select
      'nhl' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'silver'
    and lower(table_catalog) = 'nhl'
  
[0m13:36:40.416250 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m13:36:40.417097 [debug] [ThreadPool]: On list_nhl_silver: ROLLBACK
[0m13:36:40.418257 [debug] [ThreadPool]: Failed to rollback 'list_nhl_silver'
[0m13:36:40.418436 [debug] [ThreadPool]: On list_nhl_silver: Close
[0m13:36:40.419023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '939ac182-de14-43bf-8a69-a571e16a3b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106525100>]}
[0m13:36:40.419276 [debug] [MainThread]: Using duckdb connection "master"
[0m13:36:40.419440 [debug] [MainThread]: On master: BEGIN
[0m13:36:40.419588 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:36:40.419860 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:36:40.420033 [debug] [MainThread]: On master: COMMIT
[0m13:36:40.420197 [debug] [MainThread]: Using duckdb connection "master"
[0m13:36:40.420348 [debug] [MainThread]: On master: COMMIT
[0m13:36:40.420619 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:36:40.420852 [debug] [MainThread]: On master: Close
[0m13:36:40.422266 [debug] [Thread-1  ]: Began running node model.nhl_analytics.mart_goalie_performance
[0m13:36:40.422507 [debug] [Thread-2  ]: Began running node model.nhl_analytics.mart_player_performance
[0m13:36:40.422999 [debug] [Thread-3  ]: Began running node model.nhl_analytics.mart_team_standings
[0m13:36:40.422817 [info ] [Thread-1  ]: 1 of 7 START sql table model silver.mart_goalie_performance .................... [RUN]
[0m13:36:40.423284 [debug] [Thread-4  ]: Began running node model.nhl_analytics.stg_goalies
[0m13:36:40.423543 [info ] [Thread-2  ]: 2 of 7 START sql table model silver.mart_player_performance .................... [RUN]
[0m13:36:40.423842 [info ] [Thread-3  ]: 3 of 7 START sql table model silver.mart_team_standings ........................ [RUN]
[0m13:36:40.424132 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_nhl_silver, now model.nhl_analytics.mart_goalie_performance)
[0m13:36:40.424418 [info ] [Thread-4  ]: 4 of 7 START sql view model silver.stg_goalies ................................. [RUN]
[0m13:36:40.424726 [debug] [Thread-2  ]: Acquiring new duckdb connection 'model.nhl_analytics.mart_player_performance'
[0m13:36:40.425003 [debug] [Thread-3  ]: Acquiring new duckdb connection 'model.nhl_analytics.mart_team_standings'
[0m13:36:40.425217 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.mart_goalie_performance
[0m13:36:40.425473 [debug] [Thread-4  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_goalies'
[0m13:36:40.425678 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.mart_player_performance
[0m13:36:40.425876 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.mart_team_standings
[0m13:36:40.430961 [debug] [Thread-4  ]: Began compiling node model.nhl_analytics.stg_goalies
[0m13:36:40.435846 [debug] [Thread-4  ]: Writing injected SQL for node "model.nhl_analytics.stg_goalies"
[0m13:36:40.443489 [debug] [Thread-4  ]: Began executing node model.nhl_analytics.stg_goalies
[0m13:36:40.468142 [debug] [Thread-4  ]: Writing runtime sql for node "model.nhl_analytics.stg_goalies"
[0m13:36:40.473140 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:36:40.473850 [debug] [Thread-4  ]: On model.nhl_analytics.stg_goalies: BEGIN
[0m13:36:40.474109 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:36:40.475202 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m13:36:40.475427 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:36:40.476048 [debug] [Thread-4  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position
from { { source('bronze', 'goalies') } }
where playerId is not null
    and season is not null
  );

[0m13:36:40.478594 [debug] [Thread-4  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position
from { { source('bronze', 'goalies') } }
where playerId is not null
    and season is not null
  );

[0m13:36:40.478891 [debug] [Thread-4  ]: DuckDB adapter: Rolling back transaction.
[0m13:36:40.479612 [debug] [Thread-4  ]: On model.nhl_analytics.stg_goalies: ROLLBACK
[0m13:36:40.487039 [debug] [Thread-1  ]: Compilation Error in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:36:40.487472 [debug] [Thread-2  ]: Compilation Error in model mart_player_performance (models/marts/mart_player_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:36:40.487815 [debug] [Thread-3  ]: Compilation Error in model mart_team_standings (models/marts/mart_team_standings.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:36:40.492752 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '939ac182-de14-43bf-8a69-a571e16a3b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10922c760>]}
[0m13:36:40.492977 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '939ac182-de14-43bf-8a69-a571e16a3b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092487c0>]}
[0m13:36:40.493258 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '939ac182-de14-43bf-8a69-a571e16a3b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10918d880>]}
[0m13:36:40.493588 [error] [Thread-1  ]: 1 of 7 ERROR creating sql table model silver.mart_goalie_performance ........... [[31mERROR[0m in 0.06s]
[0m13:36:40.495185 [error] [Thread-3  ]: 3 of 7 ERROR creating sql table model silver.mart_team_standings ............... [[31mERROR[0m in 0.06s]
[0m13:36:40.495835 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.mart_goalie_performance
[0m13:36:40.495588 [error] [Thread-2  ]: 2 of 7 ERROR creating sql table model silver.mart_player_performance ........... [[31mERROR[0m in 0.06s]
[0m13:36:40.497344 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.mart_team_standings
[0m13:36:40.498792 [debug] [Thread-1  ]: Began running node model.nhl_analytics.stg_skaters
[0m13:36:40.499153 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.mart_player_performance
[0m13:36:40.499438 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.mart_goalie_performance' to be skipped because of status 'error'.  Reason: Compilation Error in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:36:40.499677 [debug] [Thread-3  ]: Began running node model.nhl_analytics.stg_teams
[0m13:36:40.500147 [debug] [Thread-4  ]: Failed to rollback 'model.nhl_analytics.stg_goalies'
[0m13:36:40.500448 [info ] [Thread-1  ]: 5 of 7 START sql view model silver.stg_skaters ................................. [RUN]
[0m13:36:40.500781 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.mart_team_standings' to be skipped because of status 'error'.  Reason: Compilation Error in model mart_team_standings (models/marts/mart_team_standings.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:36:40.501065 [info ] [Thread-3  ]: 6 of 7 START sql view model silver.stg_teams ................................... [RUN]
[0m13:36:40.501312 [debug] [Thread-4  ]: On model.nhl_analytics.stg_goalies: Close
[0m13:36:40.501570 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.mart_goalie_performance, now model.nhl_analytics.stg_skaters)
[0m13:36:40.501832 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.mart_player_performance' to be skipped because of status 'error'.  Reason: Compilation Error in model mart_player_performance (models/marts/mart_player_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:36:40.502065 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.mart_team_standings, now model.nhl_analytics.stg_teams)
[0m13:36:40.502380 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.stg_skaters
[0m13:36:40.502667 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.stg_teams
[0m13:36:40.504820 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.stg_skaters"
[0m13:36:40.506890 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.stg_teams"
[0m13:36:40.509942 [debug] [Thread-4  ]: Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m13:36:40.510429 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '939ac182-de14-43bf-8a69-a571e16a3b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10934b220>]}
[0m13:36:40.511140 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.stg_teams
[0m13:36:40.510930 [error] [Thread-4  ]: 4 of 7 ERROR creating sql view model silver.stg_goalies ........................ [[31mERROR[0m in 0.08s]
[0m13:36:40.511444 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.stg_skaters
[0m13:36:40.513887 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.stg_teams"
[0m13:36:40.514210 [debug] [Thread-4  ]: Finished running node model.nhl_analytics.stg_goalies
[0m13:36:40.517147 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.stg_skaters"
[0m13:36:40.517525 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_goalies' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^.
[0m13:36:40.517893 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:36:40.518121 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: BEGIN
[0m13:36:40.518320 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:36:40.518550 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:36:40.518879 [debug] [Thread-1  ]: On model.nhl_analytics.stg_skaters: BEGIN
[0m13:36:40.519084 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:36:40.519289 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m13:36:40.519559 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:36:40.519778 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

  
  create view "nhl"."silver"."stg_teams__dbt_tmp" as (
    

select
    season,
    name as team_name,
    team as team_code,
    games_played,
    goalsFor,
    goalsAgainst,
    goalsFor - goalsAgainst as goal_differential,
    xGoalsFor,
    xGoalsAgainst,
    current_timestamp as loaded_at
from "nhl"."bronze"."teams"
where season is not null
    and name is not null
    and situation = 'all'
  );

[0m13:36:40.520007 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m13:36:40.520301 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:36:40.520537 [debug] [Thread-1  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    

select
    playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    games_played,
    icetime as ice_time,
    I_F_goals as goals,
    I_F_points as points,
    I_F_shotsOnGoal as shots_on_goal,
    I_F_primaryAssists as primary_assists,
    I_F_secondaryAssists as secondary_assists,
    case 
        when games_played > 0 then true 
        else false 
    end as is_active_player,
    case 
        when games_played > 0 then round(I_F_points * 1.0 / games_played, 2)
        else null 
    end as points_per_game,
    case 
        when I_F_shotsOnGoal > 0 then round(I_F_goals * 100.0 / I_F_shotsOnGoal, 2)
        else null 
    end as shooting_percentage,
    current_timestamp as loaded_at
from "nhl"."bronze"."skaters"
where playerId is not null
    and season is not null
  );

[0m13:36:40.521179 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m13:36:40.525268 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:36:40.525580 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */
alter view "nhl"."silver"."stg_teams" rename to "stg_teams__dbt_backup"
[0m13:36:40.525805 [debug] [Thread-1  ]: SQL status: OK in 0.005 seconds
[0m13:36:40.528259 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:36:40.528500 [debug] [Thread-1  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */
alter view "nhl"."silver"."stg_skaters" rename to "stg_skaters__dbt_backup"
[0m13:36:40.528713 [debug] [Thread-3  ]: SQL status: OK in 0.003 seconds
[0m13:36:40.530612 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:36:40.530829 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */
alter view "nhl"."silver"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m13:36:40.531039 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m13:36:40.532963 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:36:40.533179 [debug] [Thread-1  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */
alter view "nhl"."silver"."stg_skaters__dbt_tmp" rename to "stg_skaters"
[0m13:36:40.533385 [debug] [Thread-3  ]: SQL status: OK in 0.002 seconds
[0m13:36:40.540342 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: COMMIT
[0m13:36:40.540598 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:36:40.540842 [debug] [Thread-1  ]: SQL status: OK in 0.007 seconds
[0m13:36:40.541061 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: COMMIT
[0m13:36:40.542036 [debug] [Thread-1  ]: On model.nhl_analytics.stg_skaters: COMMIT
[0m13:36:40.542336 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:36:40.542556 [debug] [Thread-1  ]: On model.nhl_analytics.stg_skaters: COMMIT
[0m13:36:40.542949 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m13:36:40.546317 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:36:40.546538 [debug] [Thread-1  ]: SQL status: OK in 0.004 seconds
[0m13:36:40.546741 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

      drop view if exists "nhl"."silver"."stg_teams__dbt_backup" cascade
    
[0m13:36:40.548291 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:36:40.548823 [debug] [Thread-1  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

      drop view if exists "nhl"."silver"."stg_skaters__dbt_backup" cascade
    
[0m13:36:40.549113 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m13:36:40.551092 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: Close
[0m13:36:40.551303 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m13:36:40.551624 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '939ac182-de14-43bf-8a69-a571e16a3b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106495f40>]}
[0m13:36:40.552283 [debug] [Thread-1  ]: On model.nhl_analytics.stg_skaters: Close
[0m13:36:40.552661 [info ] [Thread-3  ]: 6 of 7 OK created sql view model silver.stg_teams .............................. [[32mOK[0m in 0.05s]
[0m13:36:40.552974 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '939ac182-de14-43bf-8a69-a571e16a3b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10922c760>]}
[0m13:36:40.553281 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.stg_teams
[0m13:36:40.553610 [info ] [Thread-1  ]: 5 of 7 OK created sql view model silver.stg_skaters ............................ [[32mOK[0m in 0.05s]
[0m13:36:40.553985 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.stg_skaters
[0m13:36:40.554340 [debug] [Thread-2  ]: Began running node model.nhl_analytics.int_all_players
[0m13:36:40.554613 [info ] [Thread-2  ]: 7 of 7 SKIP relation silver.int_all_players .................................... [[33mSKIP[0m]
[0m13:36:40.554878 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.int_all_players
[0m13:36:40.555410 [debug] [MainThread]: Using duckdb connection "master"
[0m13:36:40.555590 [debug] [MainThread]: On master: BEGIN
[0m13:36:40.555744 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:36:40.556030 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:36:40.556202 [debug] [MainThread]: On master: COMMIT
[0m13:36:40.556364 [debug] [MainThread]: Using duckdb connection "master"
[0m13:36:40.556515 [debug] [MainThread]: On master: COMMIT
[0m13:36:40.556749 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:36:40.556921 [debug] [MainThread]: On master: Close
[0m13:36:40.557127 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:36:40.557295 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_skaters' was properly closed.
[0m13:36:40.557465 [debug] [MainThread]: Connection 'model.nhl_analytics.mart_player_performance' was properly closed.
[0m13:36:40.557633 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_teams' was properly closed.
[0m13:36:40.557799 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_goalies' was properly closed.
[0m13:36:40.558016 [info ] [MainThread]: 
[0m13:36:40.558208 [info ] [MainThread]: Finished running 3 table models, 4 view models in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m13:36:40.558900 [debug] [MainThread]: Command end result
[0m13:36:40.573146 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m13:36:40.574127 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m13:36:40.578121 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/run_results.json
[0m13:36:40.578320 [info ] [MainThread]: 
[0m13:36:40.578550 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m13:36:40.578742 [info ] [MainThread]: 
[0m13:36:40.578967 [error] [MainThread]: [31mFailure in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)[0m
[0m13:36:40.579189 [error] [MainThread]:   Compilation Error in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:36:40.579373 [info ] [MainThread]: 
[0m13:36:40.579583 [error] [MainThread]: [31mFailure in model mart_team_standings (models/marts/mart_team_standings.sql)[0m
[0m13:36:40.579796 [error] [MainThread]:   Compilation Error in model mart_team_standings (models/marts/mart_team_standings.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:36:40.579976 [info ] [MainThread]: 
[0m13:36:40.580185 [error] [MainThread]: [31mFailure in model mart_player_performance (models/marts/mart_player_performance.sql)[0m
[0m13:36:40.580399 [error] [MainThread]:   Compilation Error in model mart_player_performance (models/marts/mart_player_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:36:40.580579 [info ] [MainThread]: 
[0m13:36:40.580785 [error] [MainThread]: [31mFailure in model stg_goalies (models/staging/stg_goalies.sql)[0m
[0m13:36:40.580993 [error] [MainThread]:   Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m13:36:40.581164 [info ] [MainThread]: 
[0m13:36:40.581362 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_goalies.sql
[0m13:36:40.581538 [info ] [MainThread]: 
[0m13:36:40.581730 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=4 SKIP=1 NO-OP=0 TOTAL=7
[0m13:36:40.582660 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.510599, "process_in_blocks": "0", "process_kernel_time": 0.180915, "process_mem_max_rss": "149192704", "process_out_blocks": "0", "process_user_time": 2.035623}
[0m13:36:40.582888 [debug] [MainThread]: Command `python -m dbt.cli.main run` failed at 13:36:40.582845 after 1.51 seconds
[0m13:36:40.583092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b013a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d9f460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10936d5b0>]}
[0m13:36:40.583295 [debug] [MainThread]: Flushing usage events
[0m13:36:40.760884 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:37:16.551909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060c93a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107579460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107579280>]}


============================== 13:37:16.554689 | 2d991f20-0981-4b15-a0c9-23724a49cccb ==============================
[0m13:37:16.554689 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:37:16.555034 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'use_colors': 'True', 'introspect': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'target_path': 'None', 'log_format': 'default', 'profiles_dir': '.', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'invocation_command': 'dbt run --profiles-dir .', 'quiet': 'False', 'static_parser': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'no_print': 'None', 'debug': 'False', 'log_cache_events': 'False', 'empty': 'False'}
[0m13:37:16.718271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d991f20-0981-4b15-a0c9-23724a49cccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10493d640>]}
[0m13:37:16.752964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d991f20-0981-4b15-a0c9-23724a49cccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10781b7f0>]}
[0m13:37:16.754641 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m13:37:16.824326 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:37:16.916592 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:37:16.916911 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:37:16.955911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d991f20-0981-4b15-a0c9-23724a49cccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11089f130>]}
[0m13:37:17.050638 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m13:37:17.051896 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m13:37:17.062262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d991f20-0981-4b15-a0c9-23724a49cccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108a9bb0>]}
[0m13:37:17.062573 [info ] [MainThread]: Found 7 models, 6 data tests, 4 sources, 444 macros
[0m13:37:17.062794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d991f20-0981-4b15-a0c9-23724a49cccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108c29a0>]}
[0m13:37:17.063721 [info ] [MainThread]: 
[0m13:37:17.063944 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:37:17.064128 [info ] [MainThread]: 
[0m13:37:17.064425 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:37:17.067614 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl'
[0m13:37:17.096628 [debug] [ThreadPool]: Using duckdb connection "list_nhl"
[0m13:37:17.096873 [debug] [ThreadPool]: On list_nhl: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m13:37:17.097049 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:37:17.134318 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m13:37:17.135120 [debug] [ThreadPool]: On list_nhl: Close
[0m13:37:17.135507 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nhl, now create_nhl_silver)
[0m13:37:17.135772 [debug] [ThreadPool]: Creating schema "database: "nhl"
schema: "silver"
"
[0m13:37:17.139984 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:37:17.140248 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nhl'
        and type='sqlite'
    
  
[0m13:37:17.140459 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:37:17.141121 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:37:17.141836 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:37:17.142011 [debug] [ThreadPool]: On create_nhl_silver: BEGIN
[0m13:37:17.142261 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:37:17.142432 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:37:17.142598 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
    
        create schema if not exists "nhl"."silver"
    
[0m13:37:17.142868 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:37:17.143305 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m13:37:17.143471 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:37:17.143631 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m13:37:17.143868 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:37:17.144044 [debug] [ThreadPool]: On create_nhl_silver: Close
[0m13:37:17.144849 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nhl_silver, now list_nhl_silver)
[0m13:37:17.148210 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m13:37:17.148390 [debug] [ThreadPool]: On list_nhl_silver: BEGIN
[0m13:37:17.148547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:37:17.148813 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:37:17.148984 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m13:37:17.149153 [debug] [ThreadPool]: On list_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl_silver"} */
select
      'nhl' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'silver'
    and lower(table_catalog) = 'nhl'
  
[0m13:37:17.157528 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m13:37:17.158253 [debug] [ThreadPool]: On list_nhl_silver: ROLLBACK
[0m13:37:17.159451 [debug] [ThreadPool]: Failed to rollback 'list_nhl_silver'
[0m13:37:17.159629 [debug] [ThreadPool]: On list_nhl_silver: Close
[0m13:37:17.160125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d991f20-0981-4b15-a0c9-23724a49cccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104587cd0>]}
[0m13:37:17.160389 [debug] [MainThread]: Using duckdb connection "master"
[0m13:37:17.160549 [debug] [MainThread]: On master: BEGIN
[0m13:37:17.160697 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:37:17.160967 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:37:17.161139 [debug] [MainThread]: On master: COMMIT
[0m13:37:17.161302 [debug] [MainThread]: Using duckdb connection "master"
[0m13:37:17.161453 [debug] [MainThread]: On master: COMMIT
[0m13:37:17.161688 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:37:17.161861 [debug] [MainThread]: On master: Close
[0m13:37:17.163202 [debug] [Thread-1  ]: Began running node model.nhl_analytics.mart_goalie_performance
[0m13:37:17.163459 [debug] [Thread-2  ]: Began running node model.nhl_analytics.mart_player_performance
[0m13:37:17.163951 [debug] [Thread-3  ]: Began running node model.nhl_analytics.mart_team_standings
[0m13:37:17.163759 [info ] [Thread-1  ]: 1 of 7 START sql table model silver.mart_goalie_performance .................... [RUN]
[0m13:37:17.164244 [debug] [Thread-4  ]: Began running node model.nhl_analytics.stg_goalies
[0m13:37:17.164503 [info ] [Thread-2  ]: 2 of 7 START sql table model silver.mart_player_performance .................... [RUN]
[0m13:37:17.164793 [info ] [Thread-3  ]: 3 of 7 START sql table model silver.mart_team_standings ........................ [RUN]
[0m13:37:17.165066 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_nhl_silver, now model.nhl_analytics.mart_goalie_performance)
[0m13:37:17.165329 [info ] [Thread-4  ]: 4 of 7 START sql view model silver.stg_goalies ................................. [RUN]
[0m13:37:17.165619 [debug] [Thread-2  ]: Acquiring new duckdb connection 'model.nhl_analytics.mart_player_performance'
[0m13:37:17.165882 [debug] [Thread-3  ]: Acquiring new duckdb connection 'model.nhl_analytics.mart_team_standings'
[0m13:37:17.166098 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.mart_goalie_performance
[0m13:37:17.166352 [debug] [Thread-4  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_goalies'
[0m13:37:17.166553 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.mart_player_performance
[0m13:37:17.166750 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.mart_team_standings
[0m13:37:17.171726 [debug] [Thread-4  ]: Began compiling node model.nhl_analytics.stg_goalies
[0m13:37:17.177132 [debug] [Thread-4  ]: Writing injected SQL for node "model.nhl_analytics.stg_goalies"
[0m13:37:17.182366 [debug] [Thread-4  ]: Began executing node model.nhl_analytics.stg_goalies
[0m13:37:17.203894 [debug] [Thread-4  ]: Writing runtime sql for node "model.nhl_analytics.stg_goalies"
[0m13:37:17.208437 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:37:17.208712 [debug] [Thread-4  ]: On model.nhl_analytics.stg_goalies: BEGIN
[0m13:37:17.212311 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:37:17.213656 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m13:37:17.214984 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:37:17.215267 [debug] [Thread-4  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position
from { { source('bronze', 'goalies') } }
where playerId is not null
    and season is not null
  );

[0m13:37:17.218513 [debug] [Thread-4  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position
from { { source('bronze', 'goalies') } }
where playerId is not null
    and season is not null
  );

[0m13:37:17.218757 [debug] [Thread-4  ]: DuckDB adapter: Rolling back transaction.
[0m13:37:17.219797 [debug] [Thread-4  ]: On model.nhl_analytics.stg_goalies: ROLLBACK
[0m13:37:17.229496 [debug] [Thread-1  ]: Compilation Error in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:37:17.229921 [debug] [Thread-3  ]: Compilation Error in model mart_team_standings (models/marts/mart_team_standings.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:37:17.230678 [debug] [Thread-2  ]: Compilation Error in model mart_player_performance (models/marts/mart_player_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:37:17.235100 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d991f20-0981-4b15-a0c9-23724a49cccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11295b9d0>]}
[0m13:37:17.235314 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d991f20-0981-4b15-a0c9-23724a49cccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128529a0>]}
[0m13:37:17.236994 [error] [Thread-3  ]: 3 of 7 ERROR creating sql table model silver.mart_team_standings ............... [[31mERROR[0m in 0.07s]
[0m13:37:17.237252 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d991f20-0981-4b15-a0c9-23724a49cccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11295b940>]}
[0m13:37:17.237604 [error] [Thread-2  ]: 2 of 7 ERROR creating sql table model silver.mart_player_performance ........... [[31mERROR[0m in 0.07s]
[0m13:37:17.237920 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.mart_team_standings
[0m13:37:17.239780 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.mart_player_performance
[0m13:37:17.239544 [error] [Thread-1  ]: 1 of 7 ERROR creating sql table model silver.mart_goalie_performance ........... [[31mERROR[0m in 0.07s]
[0m13:37:17.241568 [debug] [Thread-3  ]: Began running node model.nhl_analytics.stg_skaters
[0m13:37:17.242027 [debug] [Thread-4  ]: Failed to rollback 'model.nhl_analytics.stg_goalies'
[0m13:37:17.242244 [debug] [Thread-2  ]: Began running node model.nhl_analytics.stg_teams
[0m13:37:17.242487 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.mart_team_standings' to be skipped because of status 'error'.  Reason: Compilation Error in model mart_team_standings (models/marts/mart_team_standings.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:37:17.242772 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.mart_goalie_performance
[0m13:37:17.243043 [info ] [Thread-3  ]: 5 of 7 START sql view model silver.stg_skaters ................................. [RUN]
[0m13:37:17.243305 [debug] [Thread-4  ]: On model.nhl_analytics.stg_goalies: Close
[0m13:37:17.243591 [info ] [Thread-2  ]: 6 of 7 START sql view model silver.stg_teams ................................... [RUN]
[0m13:37:17.243922 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.mart_player_performance' to be skipped because of status 'error'.  Reason: Compilation Error in model mart_player_performance (models/marts/mart_player_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:37:17.244219 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.mart_team_standings, now model.nhl_analytics.stg_skaters)
[0m13:37:17.244546 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.mart_player_performance, now model.nhl_analytics.stg_teams)
[0m13:37:17.244818 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.mart_goalie_performance' to be skipped because of status 'error'.  Reason: Compilation Error in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:37:17.245088 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.stg_skaters
[0m13:37:17.245303 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.stg_teams
[0m13:37:17.247440 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.stg_skaters"
[0m13:37:17.249346 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.stg_teams"
[0m13:37:17.252465 [debug] [Thread-4  ]: Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m13:37:17.252822 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d991f20-0981-4b15-a0c9-23724a49cccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b19f10>]}
[0m13:37:17.253219 [error] [Thread-4  ]: 4 of 7 ERROR creating sql view model silver.stg_goalies ........................ [[31mERROR[0m in 0.09s]
[0m13:37:17.253579 [debug] [Thread-4  ]: Finished running node model.nhl_analytics.stg_goalies
[0m13:37:17.253802 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.stg_skaters
[0m13:37:17.254017 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.stg_teams
[0m13:37:17.254329 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_goalies' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^.
[0m13:37:17.256708 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.stg_skaters"
[0m13:37:17.260003 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.stg_teams"
[0m13:37:17.260535 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:37:17.260802 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:37:17.261034 [debug] [Thread-2  ]: On model.nhl_analytics.stg_teams: BEGIN
[0m13:37:17.261251 [debug] [Thread-3  ]: On model.nhl_analytics.stg_skaters: BEGIN
[0m13:37:17.261473 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:37:17.261672 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:37:17.262089 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m13:37:17.262311 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:37:17.262512 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m13:37:17.262734 [debug] [Thread-2  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

  
  create view "nhl"."silver"."stg_teams__dbt_tmp" as (
    

select
    season,
    name as team_name,
    team as team_code,
    games_played,
    goalsFor,
    goalsAgainst,
    goalsFor - goalsAgainst as goal_differential,
    xGoalsFor,
    xGoalsAgainst,
    current_timestamp as loaded_at
from "nhl"."bronze"."teams"
where season is not null
    and name is not null
    and situation = 'all'
  );

[0m13:37:17.262958 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:37:17.263279 [debug] [Thread-3  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    

select
    playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    games_played,
    icetime as ice_time,
    I_F_goals as goals,
    I_F_points as points,
    I_F_shotsOnGoal as shots_on_goal,
    I_F_primaryAssists as primary_assists,
    I_F_secondaryAssists as secondary_assists,
    case 
        when games_played > 0 then true 
        else false 
    end as is_active_player,
    case 
        when games_played > 0 then round(I_F_points * 1.0 / games_played, 2)
        else null 
    end as points_per_game,
    case 
        when I_F_shotsOnGoal > 0 then round(I_F_goals * 100.0 / I_F_shotsOnGoal, 2)
        else null 
    end as shooting_percentage,
    current_timestamp as loaded_at
from "nhl"."bronze"."skaters"
where playerId is not null
    and season is not null
  );

[0m13:37:17.263677 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m13:37:17.267598 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:37:17.267832 [debug] [Thread-2  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */
alter view "nhl"."silver"."stg_teams" rename to "stg_teams__dbt_backup"
[0m13:37:17.268048 [debug] [Thread-3  ]: SQL status: OK in 0.005 seconds
[0m13:37:17.270054 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:37:17.270271 [debug] [Thread-3  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */
alter view "nhl"."silver"."stg_skaters" rename to "stg_skaters__dbt_backup"
[0m13:37:17.270480 [debug] [Thread-2  ]: SQL status: OK in 0.002 seconds
[0m13:37:17.272310 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:37:17.272528 [debug] [Thread-2  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */
alter view "nhl"."silver"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m13:37:17.272734 [debug] [Thread-3  ]: SQL status: OK in 0.002 seconds
[0m13:37:17.274849 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:37:17.275096 [debug] [Thread-3  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */
alter view "nhl"."silver"."stg_skaters__dbt_tmp" rename to "stg_skaters"
[0m13:37:17.275321 [debug] [Thread-2  ]: SQL status: OK in 0.002 seconds
[0m13:37:17.282272 [debug] [Thread-2  ]: On model.nhl_analytics.stg_teams: COMMIT
[0m13:37:17.282491 [debug] [Thread-3  ]: SQL status: OK in 0.007 seconds
[0m13:37:17.282692 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:37:17.283539 [debug] [Thread-3  ]: On model.nhl_analytics.stg_skaters: COMMIT
[0m13:37:17.283750 [debug] [Thread-2  ]: On model.nhl_analytics.stg_teams: COMMIT
[0m13:37:17.283960 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:37:17.284224 [debug] [Thread-3  ]: On model.nhl_analytics.stg_skaters: COMMIT
[0m13:37:17.284609 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m13:37:17.287991 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:37:17.288220 [debug] [Thread-3  ]: SQL status: OK in 0.004 seconds
[0m13:37:17.288432 [debug] [Thread-2  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

      drop view if exists "nhl"."silver"."stg_teams__dbt_backup" cascade
    
[0m13:37:17.289965 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:37:17.290426 [debug] [Thread-3  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

      drop view if exists "nhl"."silver"."stg_skaters__dbt_backup" cascade
    
[0m13:37:17.290744 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m13:37:17.292821 [debug] [Thread-2  ]: On model.nhl_analytics.stg_teams: Close
[0m13:37:17.293051 [debug] [Thread-3  ]: SQL status: OK in 0.002 seconds
[0m13:37:17.293403 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d991f20-0981-4b15-a0c9-23724a49cccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104941f40>]}
[0m13:37:17.294067 [debug] [Thread-3  ]: On model.nhl_analytics.stg_skaters: Close
[0m13:37:17.294454 [info ] [Thread-2  ]: 6 of 7 OK created sql view model silver.stg_teams .............................. [[32mOK[0m in 0.05s]
[0m13:37:17.294784 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d991f20-0981-4b15-a0c9-23724a49cccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079d7100>]}
[0m13:37:17.295102 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.stg_teams
[0m13:37:17.295515 [info ] [Thread-3  ]: 5 of 7 OK created sql view model silver.stg_skaters ............................ [[32mOK[0m in 0.05s]
[0m13:37:17.295830 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.stg_skaters
[0m13:37:17.296197 [debug] [Thread-1  ]: Began running node model.nhl_analytics.int_all_players
[0m13:37:17.296448 [info ] [Thread-1  ]: 7 of 7 SKIP relation silver.int_all_players .................................... [[33mSKIP[0m]
[0m13:37:17.296691 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.int_all_players
[0m13:37:17.297209 [debug] [MainThread]: Using duckdb connection "master"
[0m13:37:17.297393 [debug] [MainThread]: On master: BEGIN
[0m13:37:17.297549 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:37:17.297846 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:37:17.298019 [debug] [MainThread]: On master: COMMIT
[0m13:37:17.298183 [debug] [MainThread]: Using duckdb connection "master"
[0m13:37:17.298334 [debug] [MainThread]: On master: COMMIT
[0m13:37:17.298563 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:37:17.298734 [debug] [MainThread]: On master: Close
[0m13:37:17.298942 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:37:17.299091 [debug] [MainThread]: Connection 'model.nhl_analytics.mart_goalie_performance' was properly closed.
[0m13:37:17.299233 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_teams' was properly closed.
[0m13:37:17.299374 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_skaters' was properly closed.
[0m13:37:17.299513 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_goalies' was properly closed.
[0m13:37:17.299713 [info ] [MainThread]: 
[0m13:37:17.299904 [info ] [MainThread]: Finished running 3 table models, 4 view models in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m13:37:17.300608 [debug] [MainThread]: Command end result
[0m13:37:17.315021 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m13:37:17.315930 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m13:37:17.319757 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/run_results.json
[0m13:37:17.319954 [info ] [MainThread]: 
[0m13:37:17.320187 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m13:37:17.320389 [info ] [MainThread]: 
[0m13:37:17.320617 [error] [MainThread]: [31mFailure in model mart_team_standings (models/marts/mart_team_standings.sql)[0m
[0m13:37:17.320842 [error] [MainThread]:   Compilation Error in model mart_team_standings (models/marts/mart_team_standings.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:37:17.321026 [info ] [MainThread]: 
[0m13:37:17.321238 [error] [MainThread]: [31mFailure in model mart_player_performance (models/marts/mart_player_performance.sql)[0m
[0m13:37:17.321457 [error] [MainThread]:   Compilation Error in model mart_player_performance (models/marts/mart_player_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:37:17.321636 [info ] [MainThread]: 
[0m13:37:17.321846 [error] [MainThread]: [31mFailure in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)[0m
[0m13:37:17.322059 [error] [MainThread]:   Compilation Error in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:37:17.322236 [info ] [MainThread]: 
[0m13:37:17.322445 [error] [MainThread]: [31mFailure in model stg_goalies (models/staging/stg_goalies.sql)[0m
[0m13:37:17.322654 [error] [MainThread]:   Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m13:37:17.322828 [info ] [MainThread]: 
[0m13:37:17.323031 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_goalies.sql
[0m13:37:17.323207 [info ] [MainThread]: 
[0m13:37:17.323398 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=4 SKIP=1 NO-OP=0 TOTAL=7
[0m13:37:17.324717 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.81612325, "process_in_blocks": "0", "process_kernel_time": 0.168401, "process_mem_max_rss": "145473536", "process_out_blocks": "0", "process_user_time": 1.385031}
[0m13:37:17.324962 [debug] [MainThread]: Command `python -m dbt.cli.main run` failed at 13:37:17.324913 after 0.82 seconds
[0m13:37:17.325187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060c93a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b0c9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b0c370>]}
[0m13:37:17.325403 [debug] [MainThread]: Flushing usage events
[0m13:37:17.504407 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:37:53.018975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050912e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106219490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062192b0>]}


============================== 13:37:53.021631 | 04786adb-0a8d-4260-9bbd-20bd1fd85fdb ==============================
[0m13:37:53.021631 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:37:53.021997 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'profiles_dir': '.', 'log_format': 'default', 'use_colors': 'True', 'version_check': 'True', 'introspect': 'True', 'partial_parse': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean --profiles-dir .', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'quiet': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'empty': 'None', 'fail_fast': 'False'}
[0m13:37:53.089399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04786adb-0a8d-4260-9bbd-20bd1fd85fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a215b0>]}
[0m13:37:53.100621 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.12449225, "process_in_blocks": "0", "process_kernel_time": 0.085484, "process_mem_max_rss": "101105664", "process_out_blocks": "0", "process_user_time": 0.786154}
[0m13:37:53.100904 [debug] [MainThread]: Command `python -m dbt.cli.main clean` succeeded at 13:37:53.100847 after 0.12 seconds
[0m13:37:53.101131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050912e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106312af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a215b0>]}
[0m13:37:53.101363 [debug] [MainThread]: Flushing usage events
[0m13:37:53.308260 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:38:01.194829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d803a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a238460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a238280>]}


============================== 13:38:01.197129 | c8eee242-dcbf-4ac0-b4eb-fa3c0c986150 ==============================
[0m13:38:01.197129 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:38:01.197479 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'empty': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'no_print': 'None', 'profiles_dir': '.', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir .', 'send_anonymous_usage_stats': 'True', 'quiet': 'False'}
[0m13:38:01.322971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8eee242-dcbf-4ac0-b4eb-fa3c0c986150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a47a4f0>]}
[0m13:38:01.357502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8eee242-dcbf-4ac0-b4eb-fa3c0c986150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2da7f0>]}
[0m13:38:01.359218 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m13:38:01.428458 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:38:01.428929 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:38:01.429179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c8eee242-dcbf-4ac0-b4eb-fa3c0c986150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a59de20>]}
[0m13:38:02.228348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8eee242-dcbf-4ac0-b4eb-fa3c0c986150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0cb130>]}
[0m13:38:02.317600 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m13:38:02.318946 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m13:38:02.329324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8eee242-dcbf-4ac0-b4eb-fa3c0c986150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10beb23d0>]}
[0m13:38:02.329644 [info ] [MainThread]: Found 7 models, 6 data tests, 4 sources, 444 macros
[0m13:38:02.329861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8eee242-dcbf-4ac0-b4eb-fa3c0c986150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0d8640>]}
[0m13:38:02.330848 [info ] [MainThread]: 
[0m13:38:02.331067 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:38:02.331253 [info ] [MainThread]: 
[0m13:38:02.331540 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:38:02.334752 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl'
[0m13:38:02.366367 [debug] [ThreadPool]: Using duckdb connection "list_nhl"
[0m13:38:02.366625 [debug] [ThreadPool]: On list_nhl: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m13:38:02.366803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:38:02.397849 [debug] [ThreadPool]: SQL status: OK in 0.031 seconds
[0m13:38:02.398639 [debug] [ThreadPool]: On list_nhl: Close
[0m13:38:02.399042 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nhl, now create_nhl_silver)
[0m13:38:02.399309 [debug] [ThreadPool]: Creating schema "database: "nhl"
schema: "silver"
"
[0m13:38:02.403583 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:38:02.403783 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nhl'
        and type='sqlite'
    
  
[0m13:38:02.403957 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:38:02.404407 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:38:02.405072 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:38:02.405260 [debug] [ThreadPool]: On create_nhl_silver: BEGIN
[0m13:38:02.405522 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:38:02.405693 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:38:02.405859 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
    
        create schema if not exists "nhl"."silver"
    
[0m13:38:02.406122 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:38:02.406624 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m13:38:02.406849 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:38:02.407021 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m13:38:02.407291 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:38:02.407474 [debug] [ThreadPool]: On create_nhl_silver: Close
[0m13:38:02.408307 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nhl_silver, now list_nhl_silver)
[0m13:38:02.411764 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m13:38:02.411949 [debug] [ThreadPool]: On list_nhl_silver: BEGIN
[0m13:38:02.412105 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:38:02.412385 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:38:02.412561 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m13:38:02.412726 [debug] [ThreadPool]: On list_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl_silver"} */
select
      'nhl' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'silver'
    and lower(table_catalog) = 'nhl'
  
[0m13:38:02.419408 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m13:38:02.420122 [debug] [ThreadPool]: On list_nhl_silver: ROLLBACK
[0m13:38:02.421329 [debug] [ThreadPool]: Failed to rollback 'list_nhl_silver'
[0m13:38:02.421514 [debug] [ThreadPool]: On list_nhl_silver: Close
[0m13:38:02.422000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8eee242-dcbf-4ac0-b4eb-fa3c0c986150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074f9100>]}
[0m13:38:02.422256 [debug] [MainThread]: Using duckdb connection "master"
[0m13:38:02.422425 [debug] [MainThread]: On master: BEGIN
[0m13:38:02.422576 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:38:02.422887 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:38:02.423075 [debug] [MainThread]: On master: COMMIT
[0m13:38:02.423255 [debug] [MainThread]: Using duckdb connection "master"
[0m13:38:02.423409 [debug] [MainThread]: On master: COMMIT
[0m13:38:02.423657 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:38:02.423816 [debug] [MainThread]: On master: Close
[0m13:38:02.425247 [debug] [Thread-1  ]: Began running node model.nhl_analytics.mart_goalie_performance
[0m13:38:02.425484 [debug] [Thread-2  ]: Began running node model.nhl_analytics.mart_player_performance
[0m13:38:02.425714 [debug] [Thread-3  ]: Began running node model.nhl_analytics.mart_team_standings
[0m13:38:02.426165 [debug] [Thread-4  ]: Began running node model.nhl_analytics.stg_goalies
[0m13:38:02.425994 [info ] [Thread-1  ]: 1 of 7 START sql table model silver.mart_goalie_performance .................... [RUN]
[0m13:38:02.426495 [info ] [Thread-2  ]: 2 of 7 START sql table model silver.mart_player_performance .................... [RUN]
[0m13:38:02.426809 [info ] [Thread-3  ]: 3 of 7 START sql table model silver.mart_team_standings ........................ [RUN]
[0m13:38:02.427099 [info ] [Thread-4  ]: 4 of 7 START sql view model silver.stg_goalies ................................. [RUN]
[0m13:38:02.427355 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_nhl_silver, now model.nhl_analytics.mart_goalie_performance)
[0m13:38:02.427636 [debug] [Thread-2  ]: Acquiring new duckdb connection 'model.nhl_analytics.mart_player_performance'
[0m13:38:02.427902 [debug] [Thread-3  ]: Acquiring new duckdb connection 'model.nhl_analytics.mart_team_standings'
[0m13:38:02.428155 [debug] [Thread-4  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_goalies'
[0m13:38:02.428369 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.mart_goalie_performance
[0m13:38:02.428571 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.mart_player_performance
[0m13:38:02.428766 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.mart_team_standings
[0m13:38:02.428971 [debug] [Thread-4  ]: Began compiling node model.nhl_analytics.stg_goalies
[0m13:38:02.438674 [debug] [Thread-4  ]: Writing injected SQL for node "model.nhl_analytics.stg_goalies"
[0m13:38:02.444123 [debug] [Thread-4  ]: Began executing node model.nhl_analytics.stg_goalies
[0m13:38:02.466579 [debug] [Thread-4  ]: Writing runtime sql for node "model.nhl_analytics.stg_goalies"
[0m13:38:02.473839 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:38:02.475137 [debug] [Thread-4  ]: On model.nhl_analytics.stg_goalies: BEGIN
[0m13:38:02.476013 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:38:02.477122 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m13:38:02.477809 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:38:02.478092 [debug] [Thread-4  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position
from { { source('bronze', 'goalies') } }
where playerId is not null
    and season is not null
  );

[0m13:38:02.478986 [debug] [Thread-4  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position
from { { source('bronze', 'goalies') } }
where playerId is not null
    and season is not null
  );

[0m13:38:02.479676 [debug] [Thread-4  ]: DuckDB adapter: Rolling back transaction.
[0m13:38:02.479971 [debug] [Thread-4  ]: On model.nhl_analytics.stg_goalies: ROLLBACK
[0m13:38:02.486980 [debug] [Thread-1  ]: Compilation Error in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:38:02.487420 [debug] [Thread-2  ]: Compilation Error in model mart_player_performance (models/marts/mart_player_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:38:02.487804 [debug] [Thread-3  ]: Compilation Error in model mart_team_standings (models/marts/mart_team_standings.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:38:02.492886 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8eee242-dcbf-4ac0-b4eb-fa3c0c986150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8f9a30>]}
[0m13:38:02.493108 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8eee242-dcbf-4ac0-b4eb-fa3c0c986150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10902f1c0>]}
[0m13:38:02.493364 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8eee242-dcbf-4ac0-b4eb-fa3c0c986150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8f99a0>]}
[0m13:38:02.493762 [error] [Thread-2  ]: 2 of 7 ERROR creating sql table model silver.mart_player_performance ........... [[31mERROR[0m in 0.06s]
[0m13:38:02.494110 [error] [Thread-1  ]: 1 of 7 ERROR creating sql table model silver.mart_goalie_performance ........... [[31mERROR[0m in 0.06s]
[0m13:38:02.495929 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.mart_player_performance
[0m13:38:02.494514 [error] [Thread-3  ]: 3 of 7 ERROR creating sql table model silver.mart_team_standings ............... [[31mERROR[0m in 0.06s]
[0m13:38:02.496271 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.mart_goalie_performance
[0m13:38:02.497697 [debug] [Thread-2  ]: Began running node model.nhl_analytics.stg_skaters
[0m13:38:02.498007 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.mart_team_standings
[0m13:38:02.498256 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.mart_player_performance' to be skipped because of status 'error'.  Reason: Compilation Error in model mart_player_performance (models/marts/mart_player_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:38:02.499746 [debug] [Thread-1  ]: Began running node model.nhl_analytics.stg_teams
[0m13:38:02.500481 [debug] [Thread-4  ]: Failed to rollback 'model.nhl_analytics.stg_goalies'
[0m13:38:02.500048 [info ] [Thread-2  ]: 5 of 7 START sql view model silver.stg_skaters ................................. [RUN]
[0m13:38:02.500876 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.mart_goalie_performance' to be skipped because of status 'error'.  Reason: Compilation Error in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:38:02.501156 [info ] [Thread-1  ]: 6 of 7 START sql view model silver.stg_teams ................................... [RUN]
[0m13:38:02.501396 [debug] [Thread-4  ]: On model.nhl_analytics.stg_goalies: Close
[0m13:38:02.501654 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.mart_player_performance, now model.nhl_analytics.stg_skaters)
[0m13:38:02.501908 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.mart_team_standings' to be skipped because of status 'error'.  Reason: Compilation Error in model mart_team_standings (models/marts/mart_team_standings.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:38:02.502129 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.mart_goalie_performance, now model.nhl_analytics.stg_teams)
[0m13:38:02.502364 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.stg_skaters
[0m13:38:02.502720 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.stg_teams
[0m13:38:02.504861 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.stg_skaters"
[0m13:38:02.506999 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.stg_teams"
[0m13:38:02.510387 [debug] [Thread-4  ]: Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m13:38:02.510785 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8eee242-dcbf-4ac0-b4eb-fa3c0c986150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9fc3d0>]}
[0m13:38:02.511136 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.stg_skaters
[0m13:38:02.513596 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.stg_skaters"
[0m13:38:02.513848 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.stg_teams
[0m13:38:02.514175 [error] [Thread-4  ]: 4 of 7 ERROR creating sql view model silver.stg_goalies ........................ [[31mERROR[0m in 0.08s]
[0m13:38:02.517131 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.stg_teams"
[0m13:38:02.517458 [debug] [Thread-4  ]: Finished running node model.nhl_analytics.stg_goalies
[0m13:38:02.517752 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:38:02.518054 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_goalies' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^.
[0m13:38:02.518290 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: BEGIN
[0m13:38:02.518596 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:38:02.518799 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:38:02.518998 [debug] [Thread-1  ]: On model.nhl_analytics.stg_teams: BEGIN
[0m13:38:02.519305 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:38:02.519565 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m13:38:02.519772 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:38:02.519979 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m13:38:02.520225 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    

select
    playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    games_played,
    icetime as ice_time,
    I_F_goals as goals,
    I_F_points as points,
    I_F_shotsOnGoal as shots_on_goal,
    I_F_primaryAssists as primary_assists,
    I_F_secondaryAssists as secondary_assists,
    case 
        when games_played > 0 then true 
        else false 
    end as is_active_player,
    case 
        when games_played > 0 then round(I_F_points * 1.0 / games_played, 2)
        else null 
    end as points_per_game,
    case 
        when I_F_shotsOnGoal > 0 then round(I_F_goals * 100.0 / I_F_shotsOnGoal, 2)
        else null 
    end as shooting_percentage,
    current_timestamp as loaded_at
from "nhl"."bronze"."skaters"
where playerId is not null
    and season is not null
  );

[0m13:38:02.520463 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:38:02.520848 [debug] [Thread-1  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

  
  create view "nhl"."silver"."stg_teams__dbt_tmp" as (
    

select
    season,
    name as team_name,
    team as team_code,
    games_played,
    goalsFor,
    goalsAgainst,
    goalsFor - goalsAgainst as goal_differential,
    xGoalsFor,
    xGoalsAgainst,
    current_timestamp as loaded_at
from "nhl"."bronze"."teams"
where season is not null
    and name is not null
    and situation = 'all'
  );

[0m13:38:02.521451 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m13:38:02.525757 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:38:02.525994 [debug] [Thread-1  ]: SQL status: OK in 0.005 seconds
[0m13:38:02.526208 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */
alter view "nhl"."silver"."stg_skaters" rename to "stg_skaters__dbt_backup"
[0m13:38:02.528129 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:38:02.528435 [debug] [Thread-1  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */
alter view "nhl"."silver"."stg_teams" rename to "stg_teams__dbt_backup"
[0m13:38:02.528698 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m13:38:02.530544 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:38:02.530751 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m13:38:02.530949 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */
alter view "nhl"."silver"."stg_skaters__dbt_tmp" rename to "stg_skaters"
[0m13:38:02.532744 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:38:02.533034 [debug] [Thread-1  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */
alter view "nhl"."silver"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m13:38:02.533303 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m13:38:02.539528 [debug] [Thread-1  ]: SQL status: OK in 0.006 seconds
[0m13:38:02.540768 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: COMMIT
[0m13:38:02.541651 [debug] [Thread-1  ]: On model.nhl_analytics.stg_teams: COMMIT
[0m13:38:02.541879 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:38:02.542088 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:38:02.542281 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: COMMIT
[0m13:38:02.542475 [debug] [Thread-1  ]: On model.nhl_analytics.stg_teams: COMMIT
[0m13:38:02.543110 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m13:38:02.546522 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:38:02.546757 [debug] [Thread-1  ]: SQL status: OK in 0.004 seconds
[0m13:38:02.546984 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

      drop view if exists "nhl"."silver"."stg_skaters__dbt_backup" cascade
    
[0m13:38:02.548508 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:38:02.548790 [debug] [Thread-1  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

      drop view if exists "nhl"."silver"."stg_teams__dbt_backup" cascade
    
[0m13:38:02.549094 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m13:38:02.551099 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: Close
[0m13:38:02.551318 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m13:38:02.551653 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8eee242-dcbf-4ac0-b4eb-fa3c0c986150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107469f40>]}
[0m13:38:02.552317 [debug] [Thread-1  ]: On model.nhl_analytics.stg_teams: Close
[0m13:38:02.552699 [info ] [Thread-2  ]: 5 of 7 OK created sql view model silver.stg_skaters ............................ [[32mOK[0m in 0.05s]
[0m13:38:02.553014 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8eee242-dcbf-4ac0-b4eb-fa3c0c986150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8cab80>]}
[0m13:38:02.553304 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.stg_skaters
[0m13:38:02.553701 [info ] [Thread-1  ]: 6 of 7 OK created sql view model silver.stg_teams .............................. [[32mOK[0m in 0.05s]
[0m13:38:02.554061 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.stg_teams
[0m13:38:02.554285 [debug] [Thread-3  ]: Began running node model.nhl_analytics.int_all_players
[0m13:38:02.554549 [info ] [Thread-3  ]: 7 of 7 SKIP relation silver.int_all_players .................................... [[33mSKIP[0m]
[0m13:38:02.554786 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.int_all_players
[0m13:38:02.555441 [debug] [MainThread]: Using duckdb connection "master"
[0m13:38:02.555627 [debug] [MainThread]: On master: BEGIN
[0m13:38:02.555796 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:38:02.556104 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:38:02.556300 [debug] [MainThread]: On master: COMMIT
[0m13:38:02.556475 [debug] [MainThread]: Using duckdb connection "master"
[0m13:38:02.556631 [debug] [MainThread]: On master: COMMIT
[0m13:38:02.556886 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:38:02.557064 [debug] [MainThread]: On master: Close
[0m13:38:02.557281 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:38:02.557434 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_teams' was properly closed.
[0m13:38:02.557595 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_skaters' was properly closed.
[0m13:38:02.557744 [debug] [MainThread]: Connection 'model.nhl_analytics.mart_team_standings' was properly closed.
[0m13:38:02.557891 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_goalies' was properly closed.
[0m13:38:02.558093 [info ] [MainThread]: 
[0m13:38:02.558339 [info ] [MainThread]: Finished running 3 table models, 4 view models in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m13:38:02.559045 [debug] [MainThread]: Command end result
[0m13:38:02.573538 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m13:38:02.574678 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m13:38:02.578421 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/run_results.json
[0m13:38:02.578613 [info ] [MainThread]: 
[0m13:38:02.578838 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m13:38:02.579030 [info ] [MainThread]: 
[0m13:38:02.579257 [error] [MainThread]: [31mFailure in model mart_player_performance (models/marts/mart_player_performance.sql)[0m
[0m13:38:02.579480 [error] [MainThread]:   Compilation Error in model mart_player_performance (models/marts/mart_player_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:38:02.579665 [info ] [MainThread]: 
[0m13:38:02.579880 [error] [MainThread]: [31mFailure in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)[0m
[0m13:38:02.580093 [error] [MainThread]:   Compilation Error in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:38:02.580273 [info ] [MainThread]: 
[0m13:38:02.580483 [error] [MainThread]: [31mFailure in model mart_team_standings (models/marts/mart_team_standings.sql)[0m
[0m13:38:02.580696 [error] [MainThread]:   Compilation Error in model mart_team_standings (models/marts/mart_team_standings.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:38:02.580878 [info ] [MainThread]: 
[0m13:38:02.581085 [error] [MainThread]: [31mFailure in model stg_goalies (models/staging/stg_goalies.sql)[0m
[0m13:38:02.581293 [error] [MainThread]:   Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m13:38:02.581468 [info ] [MainThread]: 
[0m13:38:02.581668 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_goalies.sql
[0m13:38:02.581842 [info ] [MainThread]: 
[0m13:38:02.582034 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=4 SKIP=1 NO-OP=0 TOTAL=7
[0m13:38:02.582963 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.42901, "process_in_blocks": "0", "process_kernel_time": 0.164465, "process_mem_max_rss": "149176320", "process_out_blocks": "0", "process_user_time": 2.036586}
[0m13:38:02.583186 [debug] [MainThread]: Command `python -m dbt.cli.main run` failed at 13:38:02.583143 after 1.43 seconds
[0m13:38:02.583410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d803a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109020460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be667f0>]}
[0m13:38:02.583613 [debug] [MainThread]: Flushing usage events
[0m13:38:02.762148 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:38:33.118545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10599d3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b254c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b252e0>]}


============================== 13:38:33.120808 | b8427bc4-bac5-49d3-913b-b03b829702c5 ==============================
[0m13:38:33.120808 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:38:33.121178 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'version_check': 'True', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'target_path': 'None', 'debug': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'warn_error': 'None', 'empty': 'False', 'printer_width': '80', 'log_format': 'default', 'use_experimental_parser': 'False', 'profiles_dir': '.', 'static_parser': 'True', 'introspect': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'indirect_selection': 'eager', 'fail_fast': 'False'}
[0m13:38:33.246171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8427bc4-bac5-49d3-913b-b03b829702c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bef280>]}
[0m13:38:33.281189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8427bc4-bac5-49d3-913b-b03b829702c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106af42e0>]}
[0m13:38:33.283271 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m13:38:33.354401 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:38:33.444551 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:38:33.444929 [debug] [MainThread]: Partial parsing: updated file: nhl_analytics://models/staging/stg_goalies.sql
[0m13:38:33.627310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8427bc4-bac5-49d3-913b-b03b829702c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071f7970>]}
[0m13:38:33.689680 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m13:38:33.690917 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m13:38:33.700404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8427bc4-bac5-49d3-913b-b03b829702c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c0e3d0>]}
[0m13:38:33.700707 [info ] [MainThread]: Found 7 models, 6 data tests, 4 sources, 444 macros
[0m13:38:33.700937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8427bc4-bac5-49d3-913b-b03b829702c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107279610>]}
[0m13:38:33.701857 [info ] [MainThread]: 
[0m13:38:33.702077 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:38:33.702257 [info ] [MainThread]: 
[0m13:38:33.702532 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:38:33.705691 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl'
[0m13:38:33.733422 [debug] [ThreadPool]: Using duckdb connection "list_nhl"
[0m13:38:33.733686 [debug] [ThreadPool]: On list_nhl: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m13:38:33.733863 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:38:33.765905 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m13:38:33.766750 [debug] [ThreadPool]: On list_nhl: Close
[0m13:38:33.767156 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nhl, now create_nhl_silver)
[0m13:38:33.767441 [debug] [ThreadPool]: Creating schema "database: "nhl"
schema: "silver"
"
[0m13:38:33.771827 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:38:33.772023 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nhl'
        and type='sqlite'
    
  
[0m13:38:33.772194 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:38:33.772678 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:38:33.773362 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:38:33.773535 [debug] [ThreadPool]: On create_nhl_silver: BEGIN
[0m13:38:33.773799 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:38:33.773972 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:38:33.774147 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
    
        create schema if not exists "nhl"."silver"
    
[0m13:38:33.774422 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:38:33.774883 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m13:38:33.775053 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:38:33.775209 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m13:38:33.775448 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:38:33.775626 [debug] [ThreadPool]: On create_nhl_silver: Close
[0m13:38:33.776472 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nhl_silver, now list_nhl_silver)
[0m13:38:33.780322 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m13:38:33.780513 [debug] [ThreadPool]: On list_nhl_silver: BEGIN
[0m13:38:33.780678 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:38:33.780965 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:38:33.781126 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m13:38:33.781294 [debug] [ThreadPool]: On list_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl_silver"} */
select
      'nhl' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'silver'
    and lower(table_catalog) = 'nhl'
  
[0m13:38:33.787968 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m13:38:33.788675 [debug] [ThreadPool]: On list_nhl_silver: ROLLBACK
[0m13:38:33.790041 [debug] [ThreadPool]: Failed to rollback 'list_nhl_silver'
[0m13:38:33.790241 [debug] [ThreadPool]: On list_nhl_silver: Close
[0m13:38:33.790749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8427bc4-bac5-49d3-913b-b03b829702c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072f8130>]}
[0m13:38:33.791031 [debug] [MainThread]: Using duckdb connection "master"
[0m13:38:33.791202 [debug] [MainThread]: On master: BEGIN
[0m13:38:33.791355 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:38:33.791627 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:38:33.791800 [debug] [MainThread]: On master: COMMIT
[0m13:38:33.791970 [debug] [MainThread]: Using duckdb connection "master"
[0m13:38:33.792124 [debug] [MainThread]: On master: COMMIT
[0m13:38:33.792355 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:38:33.792532 [debug] [MainThread]: On master: Close
[0m13:38:33.793838 [debug] [Thread-1  ]: Began running node model.nhl_analytics.mart_goalie_performance
[0m13:38:33.794157 [debug] [Thread-2  ]: Began running node model.nhl_analytics.mart_player_performance
[0m13:38:33.794637 [debug] [Thread-3  ]: Began running node model.nhl_analytics.mart_team_standings
[0m13:38:33.794456 [info ] [Thread-1  ]: 1 of 7 START sql table model silver.mart_goalie_performance .................... [RUN]
[0m13:38:33.794937 [debug] [Thread-4  ]: Began running node model.nhl_analytics.stg_goalies
[0m13:38:33.795223 [info ] [Thread-2  ]: 2 of 7 START sql table model silver.mart_player_performance .................... [RUN]
[0m13:38:33.795515 [info ] [Thread-3  ]: 3 of 7 START sql table model silver.mart_team_standings ........................ [RUN]
[0m13:38:33.795779 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_nhl_silver, now model.nhl_analytics.mart_goalie_performance)
[0m13:38:33.796067 [info ] [Thread-4  ]: 4 of 7 START sql view model silver.stg_goalies ................................. [RUN]
[0m13:38:33.796367 [debug] [Thread-2  ]: Acquiring new duckdb connection 'model.nhl_analytics.mart_player_performance'
[0m13:38:33.796650 [debug] [Thread-3  ]: Acquiring new duckdb connection 'model.nhl_analytics.mart_team_standings'
[0m13:38:33.796860 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.mart_goalie_performance
[0m13:38:33.797115 [debug] [Thread-4  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_goalies'
[0m13:38:33.797319 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.mart_player_performance
[0m13:38:33.797520 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.mart_team_standings
[0m13:38:33.802662 [debug] [Thread-4  ]: Began compiling node model.nhl_analytics.stg_goalies
[0m13:38:33.812448 [debug] [Thread-4  ]: Writing injected SQL for node "model.nhl_analytics.stg_goalies"
[0m13:38:33.812888 [debug] [Thread-4  ]: Began executing node model.nhl_analytics.stg_goalies
[0m13:38:33.835950 [debug] [Thread-4  ]: Writing runtime sql for node "model.nhl_analytics.stg_goalies"
[0m13:38:33.837669 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:38:33.840433 [debug] [Thread-4  ]: On model.nhl_analytics.stg_goalies: BEGIN
[0m13:38:33.840696 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:38:33.845486 [debug] [Thread-4  ]: SQL status: OK in 0.005 seconds
[0m13:38:33.845776 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:38:33.846147 [debug] [Thread-4  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    { { config(materialized = 'view') } } { { config(materialized = 'view') } }
select playerId as player_id,
    select season,
    playerId as player_id,
    name as player_name,
    season,
    team as team_code,
    name as player_name,
    position team as team_code,
    from { { source('bronze', 'goalies') } } positionwhere playerId is not null
from { { source('bronze', 'goalies') } }
    and season is not null
where playerId is not null
    and season is not null
  );

[0m13:38:33.847463 [debug] [Thread-4  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    { { config(materialized = 'view') } } { { config(materialized = 'view') } }
select playerId as player_id,
    select season,
    playerId as player_id,
    name as player_name,
    season,
    team as team_code,
    name as player_name,
    position team as team_code,
    from { { source('bronze', 'goalies') } } positionwhere playerId is not null
from { { source('bronze', 'goalies') } }
    and season is not null
where playerId is not null
    and season is not null
  );

[0m13:38:33.847769 [debug] [Thread-4  ]: DuckDB adapter: Rolling back transaction.
[0m13:38:33.848179 [debug] [Thread-4  ]: On model.nhl_analytics.stg_goalies: ROLLBACK
[0m13:38:33.857186 [debug] [Thread-2  ]: Compilation Error in model mart_player_performance (models/marts/mart_player_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:38:33.857619 [debug] [Thread-3  ]: Compilation Error in model mart_team_standings (models/marts/mart_team_standings.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:38:33.858418 [debug] [Thread-1  ]: Compilation Error in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:38:33.859656 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8427bc4-bac5-49d3-913b-b03b829702c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107758e50>]}
[0m13:38:33.859874 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8427bc4-bac5-49d3-913b-b03b829702c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10781b250>]}
[0m13:38:33.862816 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8427bc4-bac5-49d3-913b-b03b829702c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d7df70>]}
[0m13:38:33.863235 [error] [Thread-2  ]: 2 of 7 ERROR creating sql table model silver.mart_player_performance ........... [[31mERROR[0m in 0.06s]
[0m13:38:33.864194 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.mart_player_performance
[0m13:38:33.865666 [debug] [Thread-2  ]: Began running node model.nhl_analytics.stg_skaters
[0m13:38:33.863559 [error] [Thread-3  ]: 3 of 7 ERROR creating sql table model silver.mart_team_standings ............... [[31mERROR[0m in 0.06s]
[0m13:38:33.865983 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.mart_player_performance' to be skipped because of status 'error'.  Reason: Compilation Error in model mart_player_performance (models/marts/mart_player_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:38:33.863958 [error] [Thread-1  ]: 1 of 7 ERROR creating sql table model silver.mart_goalie_performance ........... [[31mERROR[0m in 0.06s]
[0m13:38:33.866296 [info ] [Thread-2  ]: 5 of 7 START sql view model silver.stg_skaters ................................. [RUN]
[0m13:38:33.867911 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.mart_team_standings
[0m13:38:33.869560 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.mart_goalie_performance
[0m13:38:33.869833 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.mart_player_performance, now model.nhl_analytics.stg_skaters)
[0m13:38:33.870292 [debug] [Thread-4  ]: Failed to rollback 'model.nhl_analytics.stg_goalies'
[0m13:38:33.870545 [debug] [Thread-3  ]: Began running node model.nhl_analytics.stg_teams
[0m13:38:33.870780 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.mart_team_standings' to be skipped because of status 'error'.  Reason: Compilation Error in model mart_team_standings (models/marts/mart_team_standings.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:38:33.871016 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.stg_skaters
[0m13:38:33.871216 [debug] [Thread-4  ]: On model.nhl_analytics.stg_goalies: Close
[0m13:38:33.871480 [info ] [Thread-3  ]: 6 of 7 START sql view model silver.stg_teams ................................... [RUN]
[0m13:38:33.871776 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.mart_goalie_performance' to be skipped because of status 'error'.  Reason: Compilation Error in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:38:33.874113 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.stg_skaters"
[0m13:38:33.874497 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.mart_team_standings, now model.nhl_analytics.stg_teams)
[0m13:38:33.874889 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.stg_teams
[0m13:38:33.877238 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.stg_teams"
[0m13:38:33.880670 [debug] [Thread-4  ]: Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } } { { config(materialized...
              ^
[0m13:38:33.880933 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.stg_skaters
[0m13:38:33.881221 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8427bc4-bac5-49d3-913b-b03b829702c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10724e070>]}
[0m13:38:33.883572 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.stg_skaters"
[0m13:38:33.883798 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.stg_teams
[0m13:38:33.884191 [error] [Thread-4  ]: 4 of 7 ERROR creating sql view model silver.stg_goalies ........................ [[31mERROR[0m in 0.08s]
[0m13:38:33.886525 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.stg_teams"
[0m13:38:33.886839 [debug] [Thread-4  ]: Finished running node model.nhl_analytics.stg_goalies
[0m13:38:33.887157 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:38:33.887443 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_goalies' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } } { { config(materialized...
              ^.
[0m13:38:33.887683 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: BEGIN
[0m13:38:33.888011 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:38:33.888225 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:38:33.888434 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: BEGIN
[0m13:38:33.888736 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:38:33.889016 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m13:38:33.889227 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:38:33.889430 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m13:38:33.889669 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    

select
    playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    games_played,
    icetime as ice_time,
    I_F_goals as goals,
    I_F_points as points,
    I_F_shotsOnGoal as shots_on_goal,
    I_F_primaryAssists as primary_assists,
    I_F_secondaryAssists as secondary_assists,
    case 
        when games_played > 0 then true 
        else false 
    end as is_active_player,
    case 
        when games_played > 0 then round(I_F_points * 1.0 / games_played, 2)
        else null 
    end as points_per_game,
    case 
        when I_F_shotsOnGoal > 0 then round(I_F_goals * 100.0 / I_F_shotsOnGoal, 2)
        else null 
    end as shooting_percentage,
    current_timestamp as loaded_at
from "nhl"."bronze"."skaters"
where playerId is not null
    and season is not null
  );

[0m13:38:33.889907 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:38:33.891068 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

  
  create view "nhl"."silver"."stg_teams__dbt_tmp" as (
    

select
    season,
    name as team_name,
    team as team_code,
    games_played,
    goalsFor,
    goalsAgainst,
    goalsFor - goalsAgainst as goal_differential,
    xGoalsFor,
    xGoalsAgainst,
    current_timestamp as loaded_at
from "nhl"."bronze"."teams"
where season is not null
    and name is not null
    and situation = 'all'
  );

[0m13:38:33.891758 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m13:38:33.891977 [debug] [Thread-2  ]: SQL status: OK in 0.002 seconds
[0m13:38:33.895838 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:38:33.898279 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:38:33.898503 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */
alter view "nhl"."silver"."stg_teams" rename to "stg_teams__dbt_backup"
[0m13:38:33.898726 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */
alter view "nhl"."silver"."stg_skaters" rename to "stg_skaters__dbt_backup"
[0m13:38:33.899113 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m13:38:33.901004 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:38:33.901214 [debug] [Thread-2  ]: SQL status: OK in 0.002 seconds
[0m13:38:33.901415 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */
alter view "nhl"."silver"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m13:38:33.903254 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:38:33.903553 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */
alter view "nhl"."silver"."stg_skaters__dbt_tmp" rename to "stg_skaters"
[0m13:38:33.903828 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m13:38:33.910348 [debug] [Thread-2  ]: SQL status: OK in 0.007 seconds
[0m13:38:33.911369 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: COMMIT
[0m13:38:33.912243 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: COMMIT
[0m13:38:33.912468 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:38:33.912673 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:38:33.912871 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: COMMIT
[0m13:38:33.913064 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: COMMIT
[0m13:38:33.913703 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m13:38:33.917110 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:38:33.917330 [debug] [Thread-3  ]: SQL status: OK in 0.004 seconds
[0m13:38:33.917534 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

      drop view if exists "nhl"."silver"."stg_skaters__dbt_backup" cascade
    
[0m13:38:33.919079 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:38:33.919356 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

      drop view if exists "nhl"."silver"."stg_teams__dbt_backup" cascade
    
[0m13:38:33.919651 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m13:38:33.921026 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: Close
[0m13:38:33.921240 [debug] [Thread-3  ]: SQL status: OK in 0.002 seconds
[0m13:38:33.921572 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8427bc4-bac5-49d3-913b-b03b829702c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107758e50>]}
[0m13:38:33.922235 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: Close
[0m13:38:33.922662 [info ] [Thread-2  ]: 5 of 7 OK created sql view model silver.stg_skaters ............................ [[32mOK[0m in 0.05s]
[0m13:38:33.923033 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8427bc4-bac5-49d3-913b-b03b829702c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10791eeb0>]}
[0m13:38:33.923345 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.stg_skaters
[0m13:38:33.923698 [info ] [Thread-3  ]: 6 of 7 OK created sql view model silver.stg_teams .............................. [[32mOK[0m in 0.05s]
[0m13:38:33.924051 [debug] [Thread-1  ]: Began running node model.nhl_analytics.int_all_players
[0m13:38:33.924352 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.stg_teams
[0m13:38:33.924594 [info ] [Thread-1  ]: 7 of 7 SKIP relation silver.int_all_players .................................... [[33mSKIP[0m]
[0m13:38:33.924900 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.int_all_players
[0m13:38:33.925482 [debug] [MainThread]: Using duckdb connection "master"
[0m13:38:33.925679 [debug] [MainThread]: On master: BEGIN
[0m13:38:33.925852 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:38:33.926158 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:38:33.926336 [debug] [MainThread]: On master: COMMIT
[0m13:38:33.926500 [debug] [MainThread]: Using duckdb connection "master"
[0m13:38:33.926652 [debug] [MainThread]: On master: COMMIT
[0m13:38:33.926922 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:38:33.927110 [debug] [MainThread]: On master: Close
[0m13:38:33.927322 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:38:33.927472 [debug] [MainThread]: Connection 'model.nhl_analytics.mart_goalie_performance' was properly closed.
[0m13:38:33.927617 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_skaters' was properly closed.
[0m13:38:33.927758 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_teams' was properly closed.
[0m13:38:33.927899 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_goalies' was properly closed.
[0m13:38:33.928104 [info ] [MainThread]: 
[0m13:38:33.928298 [info ] [MainThread]: Finished running 3 table models, 4 view models in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m13:38:33.929023 [debug] [MainThread]: Command end result
[0m13:38:33.944218 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m13:38:33.945189 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m13:38:33.948958 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/run_results.json
[0m13:38:33.949158 [info ] [MainThread]: 
[0m13:38:33.949396 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m13:38:33.949593 [info ] [MainThread]: 
[0m13:38:33.949826 [error] [MainThread]: [31mFailure in model mart_player_performance (models/marts/mart_player_performance.sql)[0m
[0m13:38:33.950047 [error] [MainThread]:   Compilation Error in model mart_player_performance (models/marts/mart_player_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:38:33.950242 [info ] [MainThread]: 
[0m13:38:33.950454 [error] [MainThread]: [31mFailure in model mart_team_standings (models/marts/mart_team_standings.sql)[0m
[0m13:38:33.950668 [error] [MainThread]:   Compilation Error in model mart_team_standings (models/marts/mart_team_standings.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:38:33.950858 [info ] [MainThread]: 
[0m13:38:33.951070 [error] [MainThread]: [31mFailure in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)[0m
[0m13:38:33.951286 [error] [MainThread]:   Compilation Error in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:38:33.951465 [info ] [MainThread]: 
[0m13:38:33.951681 [error] [MainThread]: [31mFailure in model stg_goalies (models/staging/stg_goalies.sql)[0m
[0m13:38:33.951891 [error] [MainThread]:   Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } } { { config(materialized...
              ^
[0m13:38:33.952065 [info ] [MainThread]: 
[0m13:38:33.952267 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_goalies.sql
[0m13:38:33.952446 [info ] [MainThread]: 
[0m13:38:33.952640 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=4 SKIP=1 NO-OP=0 TOTAL=7
[0m13:38:33.953596 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.87541795, "process_in_blocks": "0", "process_kernel_time": 0.141777, "process_mem_max_rss": "147963904", "process_out_blocks": "0", "process_user_time": 1.492645}
[0m13:38:33.953827 [debug] [MainThread]: Command `python -m dbt.cli.main run` failed at 13:38:33.953785 after 0.88 seconds
[0m13:38:33.954044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10599d3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c95fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079661c0>]}
[0m13:38:33.954254 [debug] [MainThread]: Flushing usage events
[0m13:38:34.135188 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:38:41.962492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fb13d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10913a5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10913a3d0>]}


============================== 13:38:41.965485 | 73674ddc-f9af-46c7-87b3-17c833550ad5 ==============================
[0m13:38:41.965485 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:38:41.965837 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'printer_width': '80', 'invocation_command': 'dbt run --select stg_goalies --profiles-dir .', 'use_colors': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'target_path': 'None', 'no_print': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'version_check': 'True', 'profiles_dir': '.', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'introspect': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'write_json': 'True', 'empty': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True'}
[0m13:38:42.084661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73674ddc-f9af-46c7-87b3-17c833550ad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091c55e0>]}
[0m13:38:42.118686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73674ddc-f9af-46c7-87b3-17c833550ad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090e33d0>]}
[0m13:38:42.119668 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m13:38:42.187998 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:38:42.277538 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:38:42.277774 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:38:42.311200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73674ddc-f9af-46c7-87b3-17c833550ad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10975d130>]}
[0m13:38:42.397878 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m13:38:42.398956 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m13:38:42.409024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73674ddc-f9af-46c7-87b3-17c833550ad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093e2550>]}
[0m13:38:42.409339 [info ] [MainThread]: Found 7 models, 6 data tests, 4 sources, 444 macros
[0m13:38:42.409566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73674ddc-f9af-46c7-87b3-17c833550ad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109526b20>]}
[0m13:38:42.410230 [info ] [MainThread]: 
[0m13:38:42.410445 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:38:42.410626 [info ] [MainThread]: 
[0m13:38:42.410907 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:38:42.411388 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl'
[0m13:38:42.439434 [debug] [ThreadPool]: Using duckdb connection "list_nhl"
[0m13:38:42.439765 [debug] [ThreadPool]: On list_nhl: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m13:38:42.439969 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:38:42.466497 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m13:38:42.467261 [debug] [ThreadPool]: On list_nhl: Close
[0m13:38:42.467712 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nhl, now create_nhl_silver)
[0m13:38:42.468022 [debug] [ThreadPool]: Creating schema "database: "nhl"
schema: "silver"
"
[0m13:38:42.472278 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:38:42.472530 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nhl'
        and type='sqlite'
    
  
[0m13:38:42.472735 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:38:42.473230 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:38:42.473946 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:38:42.474134 [debug] [ThreadPool]: On create_nhl_silver: BEGIN
[0m13:38:42.474405 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:38:42.474578 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:38:42.474752 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
    
        create schema if not exists "nhl"."silver"
    
[0m13:38:42.475044 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:38:42.475539 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m13:38:42.475719 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:38:42.475882 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m13:38:42.476161 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:38:42.476341 [debug] [ThreadPool]: On create_nhl_silver: Close
[0m13:38:42.480025 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nhl_silver, now list_nhl_silver)
[0m13:38:42.483450 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m13:38:42.483638 [debug] [ThreadPool]: On list_nhl_silver: BEGIN
[0m13:38:42.483797 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:38:42.484109 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:38:42.484282 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m13:38:42.484452 [debug] [ThreadPool]: On list_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl_silver"} */
select
      'nhl' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'silver'
    and lower(table_catalog) = 'nhl'
  
[0m13:38:42.491389 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m13:38:42.492043 [debug] [ThreadPool]: On list_nhl_silver: ROLLBACK
[0m13:38:42.493236 [debug] [ThreadPool]: Failed to rollback 'list_nhl_silver'
[0m13:38:42.493416 [debug] [ThreadPool]: On list_nhl_silver: Close
[0m13:38:42.493889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73674ddc-f9af-46c7-87b3-17c833550ad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091f7be0>]}
[0m13:38:42.494138 [debug] [MainThread]: Using duckdb connection "master"
[0m13:38:42.494303 [debug] [MainThread]: On master: BEGIN
[0m13:38:42.494457 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:38:42.494721 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:38:42.494876 [debug] [MainThread]: On master: COMMIT
[0m13:38:42.495029 [debug] [MainThread]: Using duckdb connection "master"
[0m13:38:42.495178 [debug] [MainThread]: On master: COMMIT
[0m13:38:42.495410 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:38:42.495567 [debug] [MainThread]: On master: Close
[0m13:38:42.496845 [debug] [Thread-1  ]: Began running node model.nhl_analytics.stg_goalies
[0m13:38:42.497128 [info ] [Thread-1  ]: 1 of 1 START sql view model silver.stg_goalies ................................. [RUN]
[0m13:38:42.497386 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_nhl_silver, now model.nhl_analytics.stg_goalies)
[0m13:38:42.497595 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.stg_goalies
[0m13:38:42.501935 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.stg_goalies"
[0m13:38:42.502292 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.stg_goalies
[0m13:38:42.520785 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.stg_goalies"
[0m13:38:42.521234 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:38:42.521448 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: BEGIN
[0m13:38:42.521641 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:38:42.522065 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m13:38:42.522376 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:38:42.522668 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    { { config(materialized = 'view') } } { { config(materialized = 'view') } }
select playerId as player_id,
    select season,
    playerId as player_id,
    name as player_name,
    season,
    team as team_code,
    name as player_name,
    position team as team_code,
    from { { source('bronze', 'goalies') } } positionwhere playerId is not null
from { { source('bronze', 'goalies') } }
    and season is not null
where playerId is not null
    and season is not null
  );

[0m13:38:42.523082 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    { { config(materialized = 'view') } } { { config(materialized = 'view') } }
select playerId as player_id,
    select season,
    playerId as player_id,
    name as player_name,
    season,
    team as team_code,
    name as player_name,
    position team as team_code,
    from { { source('bronze', 'goalies') } } positionwhere playerId is not null
from { { source('bronze', 'goalies') } }
    and season is not null
where playerId is not null
    and season is not null
  );

[0m13:38:42.523296 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m13:38:42.523548 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: ROLLBACK
[0m13:38:42.537111 [debug] [Thread-1  ]: Failed to rollback 'model.nhl_analytics.stg_goalies'
[0m13:38:42.537316 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: Close
[0m13:38:42.540152 [debug] [Thread-1  ]: Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } } { { config(materialized...
              ^
[0m13:38:42.541246 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73674ddc-f9af-46c7-87b3-17c833550ad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c20e20>]}
[0m13:38:42.541614 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model silver.stg_goalies ........................ [[31mERROR[0m in 0.04s]
[0m13:38:42.541955 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.stg_goalies
[0m13:38:42.542242 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_goalies' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } } { { config(materialized...
              ^.
[0m13:38:42.542820 [debug] [MainThread]: Using duckdb connection "master"
[0m13:38:42.542999 [debug] [MainThread]: On master: BEGIN
[0m13:38:42.543151 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:38:42.543437 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:38:42.543610 [debug] [MainThread]: On master: COMMIT
[0m13:38:42.543771 [debug] [MainThread]: Using duckdb connection "master"
[0m13:38:42.543921 [debug] [MainThread]: On master: COMMIT
[0m13:38:42.544155 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:38:42.544327 [debug] [MainThread]: On master: Close
[0m13:38:42.544533 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:38:42.544683 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_goalies' was properly closed.
[0m13:38:42.544843 [info ] [MainThread]: 
[0m13:38:42.545037 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m13:38:42.545407 [debug] [MainThread]: Command end result
[0m13:38:42.560671 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m13:38:42.561611 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m13:38:42.565234 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/run_results.json
[0m13:38:42.565424 [info ] [MainThread]: 
[0m13:38:42.565658 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:38:42.565852 [info ] [MainThread]: 
[0m13:38:42.566077 [error] [MainThread]: [31mFailure in model stg_goalies (models/staging/stg_goalies.sql)[0m
[0m13:38:42.566295 [error] [MainThread]:   Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } } { { config(materialized...
              ^
[0m13:38:42.566470 [info ] [MainThread]: 
[0m13:38:42.566675 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_goalies.sql
[0m13:38:42.566851 [info ] [MainThread]: 
[0m13:38:42.567042 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m13:38:42.567956 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.64596903, "process_in_blocks": "0", "process_kernel_time": 0.130891, "process_mem_max_rss": "143933440", "process_out_blocks": "0", "process_user_time": 1.271832}
[0m13:38:42.568189 [debug] [MainThread]: Command `python -m dbt.cli.main run` failed at 13:38:42.568145 after 0.65 seconds
[0m13:38:42.568405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fb13d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093e2220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108284220>]}
[0m13:38:42.568631 [debug] [MainThread]: Flushing usage events
[0m13:38:42.723542 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:38:53.781306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e733d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111739460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111739280>]}


============================== 13:38:53.783565 | d8253f9d-9f70-4ca0-a046-5b1c1a55076d ==============================
[0m13:38:53.783565 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:38:53.783903 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'partial_parse': 'True', 'log_format': 'default', 'empty': 'None', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'fail_fast': 'False', 'introspect': 'True', 'profiles_dir': '.', 'write_json': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt clean --profiles-dir .', 'indirect_selection': 'eager', 'warn_error': 'None', 'quiet': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'debug': 'False', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'printer_width': '80'}
[0m13:38:53.850499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8253f9d-9f70-4ca0-a046-5b1c1a55076d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110567460>]}
[0m13:38:53.859274 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.11886813, "process_in_blocks": "0", "process_kernel_time": 0.069406, "process_mem_max_rss": "100073472", "process_out_blocks": "0", "process_user_time": 0.782769}
[0m13:38:53.859523 [debug] [MainThread]: Command `python -m dbt.cli.main clean` succeeded at 13:38:53.859473 after 0.12 seconds
[0m13:38:53.859726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e733d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11180f670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111715340>]}
[0m13:38:53.859932 [debug] [MainThread]: Flushing usage events
[0m13:38:54.010993 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:39:19.869661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107225400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105ba520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105ba340>]}


============================== 13:39:19.872807 | 2e225850-1847-4c3e-8427-6b5e001c7188 ==============================
[0m13:39:19.872807 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:39:19.873172 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '.', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --select stg_goalies --profiles-dir .', 'debug': 'False', 'empty': 'False', 'target_path': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'use_colors': 'True', 'partial_parse': 'True', 'introspect': 'True', 'no_print': 'None', 'printer_width': '80', 'static_parser': 'True'}
[0m13:39:19.992833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e225850-1847-4c3e-8427-6b5e001c7188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bc4670>]}
[0m13:39:20.027533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e225850-1847-4c3e-8427-6b5e001c7188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e3fc10>]}
[0m13:39:20.028618 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m13:39:20.098319 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:39:20.098797 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:39:20.099039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2e225850-1847-4c3e-8427-6b5e001c7188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105ba520>]}
[0m13:39:20.890190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e225850-1847-4c3e-8427-6b5e001c7188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a499a0>]}
[0m13:39:20.981023 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m13:39:20.982450 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m13:39:20.992479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e225850-1847-4c3e-8427-6b5e001c7188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a23610>]}
[0m13:39:20.992790 [info ] [MainThread]: Found 7 models, 6 data tests, 4 sources, 444 macros
[0m13:39:20.993011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e225850-1847-4c3e-8427-6b5e001c7188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139cb160>]}
[0m13:39:20.993686 [info ] [MainThread]: 
[0m13:39:20.993900 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:39:20.994080 [info ] [MainThread]: 
[0m13:39:20.994365 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:39:20.994841 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl'
[0m13:39:21.026956 [debug] [ThreadPool]: Using duckdb connection "list_nhl"
[0m13:39:21.027271 [debug] [ThreadPool]: On list_nhl: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m13:39:21.027454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:39:21.059492 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m13:39:21.060320 [debug] [ThreadPool]: On list_nhl: Close
[0m13:39:21.060746 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nhl, now create_nhl_silver)
[0m13:39:21.061030 [debug] [ThreadPool]: Creating schema "database: "nhl"
schema: "silver"
"
[0m13:39:21.065419 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:39:21.065618 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nhl'
        and type='sqlite'
    
  
[0m13:39:21.065790 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:39:21.066239 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:39:21.066946 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:39:21.067128 [debug] [ThreadPool]: On create_nhl_silver: BEGIN
[0m13:39:21.067389 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:39:21.067562 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:39:21.067735 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
    
        create schema if not exists "nhl"."silver"
    
[0m13:39:21.068016 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:39:21.068463 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m13:39:21.068627 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:39:21.068780 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m13:39:21.069014 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:39:21.069190 [debug] [ThreadPool]: On create_nhl_silver: Close
[0m13:39:21.072627 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nhl_silver, now list_nhl_silver)
[0m13:39:21.076140 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m13:39:21.076322 [debug] [ThreadPool]: On list_nhl_silver: BEGIN
[0m13:39:21.076481 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:39:21.076769 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:39:21.076929 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m13:39:21.077091 [debug] [ThreadPool]: On list_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl_silver"} */
select
      'nhl' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'silver'
    and lower(table_catalog) = 'nhl'
  
[0m13:39:21.083626 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m13:39:21.084287 [debug] [ThreadPool]: On list_nhl_silver: ROLLBACK
[0m13:39:21.085613 [debug] [ThreadPool]: Failed to rollback 'list_nhl_silver'
[0m13:39:21.085809 [debug] [ThreadPool]: On list_nhl_silver: Close
[0m13:39:21.086300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e225850-1847-4c3e-8427-6b5e001c7188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11393ddc0>]}
[0m13:39:21.086556 [debug] [MainThread]: Using duckdb connection "master"
[0m13:39:21.086722 [debug] [MainThread]: On master: BEGIN
[0m13:39:21.086874 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:39:21.087148 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:39:21.087309 [debug] [MainThread]: On master: COMMIT
[0m13:39:21.087467 [debug] [MainThread]: Using duckdb connection "master"
[0m13:39:21.087617 [debug] [MainThread]: On master: COMMIT
[0m13:39:21.087853 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:39:21.088015 [debug] [MainThread]: On master: Close
[0m13:39:21.089564 [debug] [Thread-1  ]: Began running node model.nhl_analytics.stg_goalies
[0m13:39:21.089877 [info ] [Thread-1  ]: 1 of 1 START sql view model silver.stg_goalies ................................. [RUN]
[0m13:39:21.090146 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_nhl_silver, now model.nhl_analytics.stg_goalies)
[0m13:39:21.090363 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.stg_goalies
[0m13:39:21.095321 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.stg_goalies"
[0m13:39:21.095885 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.stg_goalies
[0m13:39:21.114886 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.stg_goalies"
[0m13:39:21.115538 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:39:21.115751 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: BEGIN
[0m13:39:21.115947 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:39:21.116359 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m13:39:21.116547 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:39:21.116742 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    

select 
    playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position
from "nhl"."bronze"."goalies"
where playerId is not null
    and season is not null
  );

[0m13:39:21.117171 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m13:39:21.121582 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:39:21.121873 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */
alter view "nhl"."silver"."stg_goalies__dbt_tmp" rename to "stg_goalies"
[0m13:39:21.122328 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m13:39:21.128311 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: COMMIT
[0m13:39:21.128536 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:39:21.128734 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: COMMIT
[0m13:39:21.129275 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m13:39:21.132685 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:39:21.132905 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

      drop view if exists "nhl"."silver"."stg_goalies__dbt_backup" cascade
    
[0m13:39:21.133245 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m13:39:21.134576 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: Close
[0m13:39:21.135633 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e225850-1847-4c3e-8427-6b5e001c7188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bbaf40>]}
[0m13:39:21.136003 [info ] [Thread-1  ]: 1 of 1 OK created sql view model silver.stg_goalies ............................ [[32mOK[0m in 0.04s]
[0m13:39:21.136337 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.stg_goalies
[0m13:39:21.136932 [debug] [MainThread]: Using duckdb connection "master"
[0m13:39:21.137131 [debug] [MainThread]: On master: BEGIN
[0m13:39:21.137295 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:39:21.137583 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:39:21.137756 [debug] [MainThread]: On master: COMMIT
[0m13:39:21.137915 [debug] [MainThread]: Using duckdb connection "master"
[0m13:39:21.138069 [debug] [MainThread]: On master: COMMIT
[0m13:39:21.138305 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:39:21.138481 [debug] [MainThread]: On master: Close
[0m13:39:21.138755 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:39:21.138949 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_goalies' was properly closed.
[0m13:39:21.139117 [info ] [MainThread]: 
[0m13:39:21.139308 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m13:39:21.139691 [debug] [MainThread]: Command end result
[0m13:39:21.154764 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m13:39:21.155813 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m13:39:21.159798 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/run_results.json
[0m13:39:21.159992 [info ] [MainThread]: 
[0m13:39:21.160236 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:39:21.160423 [info ] [MainThread]: 
[0m13:39:21.160624 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:39:21.161567 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3332127, "process_in_blocks": "0", "process_kernel_time": 0.163076, "process_mem_max_rss": "148193280", "process_out_blocks": "0", "process_user_time": 1.942072}
[0m13:39:21.161794 [debug] [MainThread]: Command `python -m dbt.cli.main run` succeeded at 13:39:21.161747 after 1.33 seconds
[0m13:39:21.161996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107225400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133142e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075106a0>]}
[0m13:39:21.162204 [debug] [MainThread]: Flushing usage events
[0m13:39:21.369211 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:39:27.650932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10500b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063b9460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063b9280>]}


============================== 13:39:27.653220 | 98c33518-4f4f-4a37-ba41-acbe52f7fff8 ==============================
[0m13:39:27.653220 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:39:27.653566 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'fail_fast': 'False', 'log_cache_events': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'profiles_dir': '.', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir .', 'debug': 'False', 'version_check': 'True', 'printer_width': '80', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'use_experimental_parser': 'False', 'use_colors': 'True', 'static_parser': 'True', 'no_print': 'None', 'quiet': 'False'}
[0m13:39:27.773438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98c33518-4f4f-4a37-ba41-acbe52f7fff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106580fd0>]}
[0m13:39:27.807638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98c33518-4f4f-4a37-ba41-acbe52f7fff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b70fd0>]}
[0m13:39:27.808674 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m13:39:27.879553 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:39:27.968697 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:39:27.968925 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:39:28.002540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98c33518-4f4f-4a37-ba41-acbe52f7fff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ddf130>]}
[0m13:39:28.089466 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m13:39:28.090539 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m13:39:28.100360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98c33518-4f4f-4a37-ba41-acbe52f7fff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dc3fa0>]}
[0m13:39:28.100670 [info ] [MainThread]: Found 7 models, 6 data tests, 4 sources, 444 macros
[0m13:39:28.100894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98c33518-4f4f-4a37-ba41-acbe52f7fff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de90d0>]}
[0m13:39:28.101836 [info ] [MainThread]: 
[0m13:39:28.102058 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:39:28.102242 [info ] [MainThread]: 
[0m13:39:28.102528 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:39:28.105859 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl'
[0m13:39:28.134339 [debug] [ThreadPool]: Using duckdb connection "list_nhl"
[0m13:39:28.134586 [debug] [ThreadPool]: On list_nhl: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m13:39:28.134762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:39:28.163523 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m13:39:28.164361 [debug] [ThreadPool]: On list_nhl: Close
[0m13:39:28.164785 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nhl, now create_nhl_silver)
[0m13:39:28.165057 [debug] [ThreadPool]: Creating schema "database: "nhl"
schema: "silver"
"
[0m13:39:28.169419 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:39:28.169641 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nhl'
        and type='sqlite'
    
  
[0m13:39:28.169829 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:39:28.170364 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:39:28.171211 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:39:28.171437 [debug] [ThreadPool]: On create_nhl_silver: BEGIN
[0m13:39:28.171743 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:39:28.171929 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:39:28.172108 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
    
        create schema if not exists "nhl"."silver"
    
[0m13:39:28.172389 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:39:28.172878 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m13:39:28.173061 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:39:28.173223 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m13:39:28.173454 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:39:28.173635 [debug] [ThreadPool]: On create_nhl_silver: Close
[0m13:39:28.174520 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nhl_silver, now list_nhl_silver)
[0m13:39:28.177947 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m13:39:28.178128 [debug] [ThreadPool]: On list_nhl_silver: BEGIN
[0m13:39:28.178288 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:39:28.178570 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:39:28.178729 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m13:39:28.178895 [debug] [ThreadPool]: On list_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl_silver"} */
select
      'nhl' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'silver'
    and lower(table_catalog) = 'nhl'
  
[0m13:39:28.185543 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m13:39:28.186198 [debug] [ThreadPool]: On list_nhl_silver: ROLLBACK
[0m13:39:28.187542 [debug] [ThreadPool]: Failed to rollback 'list_nhl_silver'
[0m13:39:28.187734 [debug] [ThreadPool]: On list_nhl_silver: Close
[0m13:39:28.188328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98c33518-4f4f-4a37-ba41-acbe52f7fff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101be3be0>]}
[0m13:39:28.188666 [debug] [MainThread]: Using duckdb connection "master"
[0m13:39:28.188849 [debug] [MainThread]: On master: BEGIN
[0m13:39:28.189013 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:39:28.189314 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:39:28.189493 [debug] [MainThread]: On master: COMMIT
[0m13:39:28.189667 [debug] [MainThread]: Using duckdb connection "master"
[0m13:39:28.189834 [debug] [MainThread]: On master: COMMIT
[0m13:39:28.190080 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:39:28.190257 [debug] [MainThread]: On master: Close
[0m13:39:28.191685 [debug] [Thread-1  ]: Began running node model.nhl_analytics.mart_goalie_performance
[0m13:39:28.191932 [debug] [Thread-2  ]: Began running node model.nhl_analytics.mart_player_performance
[0m13:39:28.192162 [debug] [Thread-3  ]: Began running node model.nhl_analytics.mart_team_standings
[0m13:39:28.192370 [debug] [Thread-4  ]: Began running node model.nhl_analytics.stg_goalies
[0m13:39:28.192655 [info ] [Thread-1  ]: 1 of 7 START sql table model silver.mart_goalie_performance .................... [RUN]
[0m13:39:28.192975 [info ] [Thread-2  ]: 2 of 7 START sql table model silver.mart_player_performance .................... [RUN]
[0m13:39:28.193273 [info ] [Thread-3  ]: 3 of 7 START sql table model silver.mart_team_standings ........................ [RUN]
[0m13:39:28.193557 [info ] [Thread-4  ]: 4 of 7 START sql view model silver.stg_goalies ................................. [RUN]
[0m13:39:28.193816 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_nhl_silver, now model.nhl_analytics.mart_goalie_performance)
[0m13:39:28.194104 [debug] [Thread-2  ]: Acquiring new duckdb connection 'model.nhl_analytics.mart_player_performance'
[0m13:39:28.194372 [debug] [Thread-3  ]: Acquiring new duckdb connection 'model.nhl_analytics.mart_team_standings'
[0m13:39:28.194627 [debug] [Thread-4  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_goalies'
[0m13:39:28.194839 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.mart_goalie_performance
[0m13:39:28.195046 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.mart_player_performance
[0m13:39:28.195251 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.mart_team_standings
[0m13:39:28.195451 [debug] [Thread-4  ]: Began compiling node model.nhl_analytics.stg_goalies
[0m13:39:28.205867 [debug] [Thread-4  ]: Writing injected SQL for node "model.nhl_analytics.stg_goalies"
[0m13:39:28.211074 [debug] [Thread-4  ]: Began executing node model.nhl_analytics.stg_goalies
[0m13:39:28.232461 [debug] [Thread-4  ]: Writing runtime sql for node "model.nhl_analytics.stg_goalies"
[0m13:39:28.239401 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:39:28.240689 [debug] [Thread-4  ]: On model.nhl_analytics.stg_goalies: BEGIN
[0m13:39:28.241506 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:39:28.242642 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m13:39:28.242872 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:39:28.243160 [debug] [Thread-4  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    

select 
    playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position
from "nhl"."bronze"."goalies"
where playerId is not null
    and season is not null
  );

[0m13:39:28.244824 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m13:39:28.253894 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:39:28.254160 [debug] [Thread-4  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */
alter view "nhl"."silver"."stg_goalies" rename to "stg_goalies__dbt_backup"
[0m13:39:28.254573 [debug] [Thread-1  ]: Compilation Error in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:39:28.254985 [debug] [Thread-2  ]: Compilation Error in model mart_player_performance (models/marts/mart_player_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:39:28.255395 [debug] [Thread-3  ]: Compilation Error in model mart_team_standings (models/marts/mart_team_standings.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:39:28.256531 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m13:39:28.259073 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:39:28.259333 [debug] [Thread-4  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */
alter view "nhl"."silver"."stg_goalies__dbt_tmp" rename to "stg_goalies"
[0m13:39:28.259638 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98c33518-4f4f-4a37-ba41-acbe52f7fff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11039ca90>]}
[0m13:39:28.259934 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m13:39:28.266784 [debug] [Thread-4  ]: On model.nhl_analytics.stg_goalies: COMMIT
[0m13:39:28.266991 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98c33518-4f4f-4a37-ba41-acbe52f7fff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065fa970>]}
[0m13:39:28.267477 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98c33518-4f4f-4a37-ba41-acbe52f7fff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102445b0>]}
[0m13:39:28.267688 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:39:28.267317 [error] [Thread-1  ]: 1 of 7 ERROR creating sql table model silver.mart_goalie_performance ........... [[31mERROR[0m in 0.06s]
[0m13:39:28.268087 [error] [Thread-2  ]: 2 of 7 ERROR creating sql table model silver.mart_player_performance ........... [[31mERROR[0m in 0.06s]
[0m13:39:28.268646 [debug] [Thread-4  ]: On model.nhl_analytics.stg_goalies: COMMIT
[0m13:39:28.268471 [error] [Thread-3  ]: 3 of 7 ERROR creating sql table model silver.mart_team_standings ............... [[31mERROR[0m in 0.06s]
[0m13:39:28.268977 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.mart_goalie_performance
[0m13:39:28.269241 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.mart_player_performance
[0m13:39:28.269560 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.mart_team_standings
[0m13:39:28.269805 [debug] [Thread-1  ]: Began running node model.nhl_analytics.stg_skaters
[0m13:39:28.270018 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m13:39:28.270248 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.mart_goalie_performance' to be skipped because of status 'error'.  Reason: Compilation Error in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:39:28.270467 [debug] [Thread-2  ]: Began running node model.nhl_analytics.stg_teams
[0m13:39:28.270748 [info ] [Thread-1  ]: 5 of 7 START sql view model silver.stg_skaters ................................. [RUN]
[0m13:39:28.274340 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:39:28.274661 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.mart_player_performance' to be skipped because of status 'error'.  Reason: Compilation Error in model mart_player_performance (models/marts/mart_player_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:39:28.274967 [info ] [Thread-2  ]: 6 of 7 START sql view model silver.stg_teams ................................... [RUN]
[0m13:39:28.275252 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.mart_goalie_performance, now model.nhl_analytics.stg_skaters)
[0m13:39:28.275482 [debug] [Thread-4  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

      drop view if exists "nhl"."silver"."stg_goalies__dbt_backup" cascade
    
[0m13:39:28.275747 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.mart_team_standings' to be skipped because of status 'error'.  Reason: Compilation Error in model mart_team_standings (models/marts/mart_team_standings.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:39:28.275980 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.mart_player_performance, now model.nhl_analytics.stg_teams)
[0m13:39:28.276187 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.stg_skaters
[0m13:39:28.276502 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.stg_teams
[0m13:39:28.279037 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.stg_skaters"
[0m13:39:28.279265 [debug] [Thread-4  ]: SQL status: OK in 0.003 seconds
[0m13:39:28.281045 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.stg_teams"
[0m13:39:28.282558 [debug] [Thread-4  ]: On model.nhl_analytics.stg_goalies: Close
[0m13:39:28.282995 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98c33518-4f4f-4a37-ba41-acbe52f7fff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10381aee0>]}
[0m13:39:28.283297 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.stg_skaters
[0m13:39:28.285610 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.stg_skaters"
[0m13:39:28.285838 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.stg_teams
[0m13:39:28.286133 [info ] [Thread-4  ]: 4 of 7 OK created sql view model silver.stg_goalies ............................ [[32mOK[0m in 0.09s]
[0m13:39:28.288465 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.stg_teams"
[0m13:39:28.288791 [debug] [Thread-4  ]: Finished running node model.nhl_analytics.stg_goalies
[0m13:39:28.289095 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:39:28.289391 [debug] [Thread-1  ]: On model.nhl_analytics.stg_skaters: BEGIN
[0m13:39:28.289624 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:39:28.289838 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:39:28.290046 [debug] [Thread-2  ]: On model.nhl_analytics.stg_teams: BEGIN
[0m13:39:28.290340 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:39:28.290603 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m13:39:28.290814 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:39:28.291017 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m13:39:28.291248 [debug] [Thread-1  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    

select
    playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    games_played,
    icetime as ice_time,
    I_F_goals as goals,
    I_F_points as points,
    I_F_shotsOnGoal as shots_on_goal,
    I_F_primaryAssists as primary_assists,
    I_F_secondaryAssists as secondary_assists,
    case 
        when games_played > 0 then true 
        else false 
    end as is_active_player,
    case 
        when games_played > 0 then round(I_F_points * 1.0 / games_played, 2)
        else null 
    end as points_per_game,
    case 
        when I_F_shotsOnGoal > 0 then round(I_F_goals * 100.0 / I_F_shotsOnGoal, 2)
        else null 
    end as shooting_percentage,
    current_timestamp as loaded_at
from "nhl"."bronze"."skaters"
where playerId is not null
    and season is not null
  );

[0m13:39:28.291483 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:39:28.291741 [debug] [Thread-2  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

  
  create view "nhl"."silver"."stg_teams__dbt_tmp" as (
    

select
    season,
    name as team_name,
    team as team_code,
    games_played,
    goalsFor,
    goalsAgainst,
    goalsFor - goalsAgainst as goal_differential,
    xGoalsFor,
    xGoalsAgainst,
    current_timestamp as loaded_at
from "nhl"."bronze"."teams"
where season is not null
    and name is not null
    and situation = 'all'
  );

[0m13:39:28.292917 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m13:39:28.295015 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:39:28.295240 [debug] [Thread-1  ]: SQL status: OK in 0.004 seconds
[0m13:39:28.295460 [debug] [Thread-2  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */
alter view "nhl"."silver"."stg_teams" rename to "stg_teams__dbt_backup"
[0m13:39:28.297360 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:39:28.297642 [debug] [Thread-1  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */
alter view "nhl"."silver"."stg_skaters" rename to "stg_skaters__dbt_backup"
[0m13:39:28.297891 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m13:39:28.299810 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:39:28.300015 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m13:39:28.300213 [debug] [Thread-2  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */
alter view "nhl"."silver"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m13:39:28.302572 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:39:28.302866 [debug] [Thread-1  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */
alter view "nhl"."silver"."stg_skaters__dbt_tmp" rename to "stg_skaters"
[0m13:39:28.303137 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m13:39:28.304057 [debug] [Thread-2  ]: On model.nhl_analytics.stg_teams: COMMIT
[0m13:39:28.304274 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:39:28.304476 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m13:39:28.304665 [debug] [Thread-2  ]: On model.nhl_analytics.stg_teams: COMMIT
[0m13:39:28.305621 [debug] [Thread-1  ]: On model.nhl_analytics.stg_skaters: COMMIT
[0m13:39:28.305938 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:39:28.306254 [debug] [Thread-1  ]: On model.nhl_analytics.stg_skaters: COMMIT
[0m13:39:28.306500 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m13:39:28.308172 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:39:28.308381 [debug] [Thread-2  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

      drop view if exists "nhl"."silver"."stg_teams__dbt_backup" cascade
    
[0m13:39:28.308581 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m13:39:28.310193 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:39:28.310414 [debug] [Thread-1  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

      drop view if exists "nhl"."silver"."stg_skaters__dbt_backup" cascade
    
[0m13:39:28.310617 [debug] [Thread-2  ]: SQL status: OK in 0.002 seconds
[0m13:39:28.311337 [debug] [Thread-2  ]: On model.nhl_analytics.stg_teams: Close
[0m13:39:28.311689 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98c33518-4f4f-4a37-ba41-acbe52f7fff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106aae50>]}
[0m13:39:28.311906 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m13:39:28.312632 [debug] [Thread-1  ]: On model.nhl_analytics.stg_skaters: Close
[0m13:39:28.312945 [info ] [Thread-2  ]: 6 of 7 OK created sql view model silver.stg_teams .............................. [[32mOK[0m in 0.04s]
[0m13:39:28.313286 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98c33518-4f4f-4a37-ba41-acbe52f7fff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102445b0>]}
[0m13:39:28.313573 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.stg_teams
[0m13:39:28.313939 [info ] [Thread-1  ]: 5 of 7 OK created sql view model silver.stg_skaters ............................ [[32mOK[0m in 0.04s]
[0m13:39:28.314281 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.stg_skaters
[0m13:39:28.314627 [debug] [Thread-3  ]: Began running node model.nhl_analytics.int_all_players
[0m13:39:28.314942 [info ] [Thread-3  ]: 7 of 7 START sql view model silver.int_all_players ............................. [RUN]
[0m13:39:28.315238 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.mart_team_standings, now model.nhl_analytics.int_all_players)
[0m13:39:28.315451 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.int_all_players
[0m13:39:28.317593 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.int_all_players"
[0m13:39:28.318048 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.int_all_players
[0m13:39:28.320356 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.int_all_players"
[0m13:39:28.320769 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m13:39:28.320969 [debug] [Thread-3  ]: On model.nhl_analytics.int_all_players: BEGIN
[0m13:39:28.321148 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:39:28.321460 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m13:39:28.321680 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m13:39:28.321919 [debug] [Thread-3  ]: On model.nhl_analytics.int_all_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */

  
  create view "nhl"."silver"."int_all_players__dbt_tmp" as (
    

with all_players as (
    select 
        player_id,
        season,
        player_name,
        team_code,
        'G' as position,
        null as games_played,
        null as points_per_game,
        null as shooting_percentage
    from "nhl"."silver"."stg_goalies"
    
    union all
    
    select 
        player_id,
        season,
        player_name,
        team_code,
        position,
        games_played,
        points_per_game,
        shooting_percentage
    from "nhl"."silver"."stg_skaters"
)

select *,
    case 
        when position = 'G' then 'Goalie'
        when position in ('C', 'L', 'R', 'LW', 'RW') then 'Forward'
        when position in ('D') then 'Defense'
        else 'Unknown'
    end as position_group,
    current_timestamp as loaded_at
from all_players
  );

[0m13:39:28.323081 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m13:39:28.325269 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m13:39:28.325491 [debug] [Thread-3  ]: On model.nhl_analytics.int_all_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */
alter view "nhl"."silver"."int_all_players__dbt_tmp" rename to "int_all_players"
[0m13:39:28.325847 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m13:39:28.326663 [debug] [Thread-3  ]: On model.nhl_analytics.int_all_players: COMMIT
[0m13:39:28.326859 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m13:39:28.327044 [debug] [Thread-3  ]: On model.nhl_analytics.int_all_players: COMMIT
[0m13:39:28.327463 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m13:39:28.328964 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m13:39:28.329166 [debug] [Thread-3  ]: On model.nhl_analytics.int_all_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */

      drop view if exists "nhl"."silver"."int_all_players__dbt_backup" cascade
    
[0m13:39:28.329465 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m13:39:28.330113 [debug] [Thread-3  ]: On model.nhl_analytics.int_all_players: Close
[0m13:39:28.330422 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98c33518-4f4f-4a37-ba41-acbe52f7fff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102aa130>]}
[0m13:39:28.330782 [info ] [Thread-3  ]: 7 of 7 OK created sql view model silver.int_all_players ........................ [[32mOK[0m in 0.02s]
[0m13:39:28.331103 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.int_all_players
[0m13:39:28.331681 [debug] [MainThread]: Using duckdb connection "master"
[0m13:39:28.331852 [debug] [MainThread]: On master: BEGIN
[0m13:39:28.332005 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:39:28.332277 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:39:28.332449 [debug] [MainThread]: On master: COMMIT
[0m13:39:28.332611 [debug] [MainThread]: Using duckdb connection "master"
[0m13:39:28.332760 [debug] [MainThread]: On master: COMMIT
[0m13:39:28.332997 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:39:28.333172 [debug] [MainThread]: On master: Close
[0m13:39:28.333393 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:39:28.333543 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_skaters' was properly closed.
[0m13:39:28.333691 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_teams' was properly closed.
[0m13:39:28.333831 [debug] [MainThread]: Connection 'model.nhl_analytics.int_all_players' was properly closed.
[0m13:39:28.333969 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_goalies' was properly closed.
[0m13:39:28.334176 [info ] [MainThread]: 
[0m13:39:28.334367 [info ] [MainThread]: Finished running 3 table models, 4 view models in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m13:39:28.335047 [debug] [MainThread]: Command end result
[0m13:39:28.350015 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m13:39:28.350972 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m13:39:28.354743 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/run_results.json
[0m13:39:28.354956 [info ] [MainThread]: 
[0m13:39:28.355205 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m13:39:28.355463 [info ] [MainThread]: 
[0m13:39:28.355709 [error] [MainThread]: [31mFailure in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)[0m
[0m13:39:28.355941 [error] [MainThread]:   Compilation Error in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:39:28.356135 [info ] [MainThread]: 
[0m13:39:28.356349 [error] [MainThread]: [31mFailure in model mart_player_performance (models/marts/mart_player_performance.sql)[0m
[0m13:39:28.356564 [error] [MainThread]:   Compilation Error in model mart_player_performance (models/marts/mart_player_performance.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:39:28.356755 [info ] [MainThread]: 
[0m13:39:28.356967 [error] [MainThread]: [31mFailure in model mart_team_standings (models/marts/mart_team_standings.sql)[0m
[0m13:39:28.357188 [error] [MainThread]:   Compilation Error in model mart_team_standings (models/marts/mart_team_standings.sql)
  'export_to_silver' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:39:28.357372 [info ] [MainThread]: 
[0m13:39:28.357565 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=7
[0m13:39:28.358499 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7495294, "process_in_blocks": "0", "process_kernel_time": 0.146358, "process_mem_max_rss": "145850368", "process_out_blocks": "0", "process_user_time": 1.39077}
[0m13:39:28.358715 [debug] [MainThread]: Command `python -m dbt.cli.main run` failed at 13:39:28.358674 after 0.75 seconds
[0m13:39:28.358919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10500b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107a4d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065cb370>]}
[0m13:39:28.359124 [debug] [MainThread]: Flushing usage events
[0m13:39:28.591088 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:40:03.967815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107db3400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111eb9460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111eb9280>]}


============================== 13:40:03.970683 | ceb9d48f-fa64-4e2e-b59a-1b8580cecc00 ==============================
[0m13:40:03.970683 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:40:03.971049 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'profiles_dir': '.', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'partial_parse': 'True', 'write_json': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'empty': 'False', 'warn_error': 'None', 'printer_width': '80', 'introspect': 'True', 'no_print': 'None', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'log_format': 'default'}
[0m13:40:04.148830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ceb9d48f-fa64-4e2e-b59a-1b8580cecc00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10697cb20>]}
[0m13:40:04.182876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ceb9d48f-fa64-4e2e-b59a-1b8580cecc00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d70a90>]}
[0m13:40:04.184513 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m13:40:04.254305 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:40:04.344255 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:40:04.344609 [debug] [MainThread]: Partial parsing: updated file: nhl_analytics://macros/export_to_silver.sql
[0m13:40:04.409626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ceb9d48f-fa64-4e2e-b59a-1b8580cecc00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112814130>]}
[0m13:40:04.496845 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m13:40:04.498140 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m13:40:04.508657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ceb9d48f-fa64-4e2e-b59a-1b8580cecc00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126ed250>]}
[0m13:40:04.508978 [info ] [MainThread]: Found 7 models, 6 data tests, 4 sources, 445 macros
[0m13:40:04.509209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ceb9d48f-fa64-4e2e-b59a-1b8580cecc00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126bef70>]}
[0m13:40:04.510162 [info ] [MainThread]: 
[0m13:40:04.510378 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:40:04.510556 [info ] [MainThread]: 
[0m13:40:04.510842 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:40:04.514033 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl'
[0m13:40:04.542491 [debug] [ThreadPool]: Using duckdb connection "list_nhl"
[0m13:40:04.542732 [debug] [ThreadPool]: On list_nhl: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m13:40:04.542908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:40:04.585188 [debug] [ThreadPool]: SQL status: OK in 0.042 seconds
[0m13:40:04.586449 [debug] [ThreadPool]: On list_nhl: Close
[0m13:40:04.586845 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nhl, now create_nhl_silver)
[0m13:40:04.587116 [debug] [ThreadPool]: Creating schema "database: "nhl"
schema: "silver"
"
[0m13:40:04.591524 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:40:04.591729 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nhl'
        and type='sqlite'
    
  
[0m13:40:04.591902 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:40:04.592527 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:40:04.593318 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:40:04.593491 [debug] [ThreadPool]: On create_nhl_silver: BEGIN
[0m13:40:04.593752 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:40:04.593925 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:40:04.594100 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
    
        create schema if not exists "nhl"."silver"
    
[0m13:40:04.594390 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:40:04.594844 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m13:40:04.595011 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:40:04.595168 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m13:40:04.595433 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:40:04.595621 [debug] [ThreadPool]: On create_nhl_silver: Close
[0m13:40:04.596485 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nhl_silver, now list_nhl_silver)
[0m13:40:04.599898 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m13:40:04.600089 [debug] [ThreadPool]: On list_nhl_silver: BEGIN
[0m13:40:04.600251 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:40:04.600546 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:40:04.600722 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m13:40:04.600904 [debug] [ThreadPool]: On list_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl_silver"} */
select
      'nhl' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'silver'
    and lower(table_catalog) = 'nhl'
  
[0m13:40:04.611076 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m13:40:04.611952 [debug] [ThreadPool]: On list_nhl_silver: ROLLBACK
[0m13:40:04.613134 [debug] [ThreadPool]: Failed to rollback 'list_nhl_silver'
[0m13:40:04.613314 [debug] [ThreadPool]: On list_nhl_silver: Close
[0m13:40:04.614041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ceb9d48f-fa64-4e2e-b59a-1b8580cecc00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126b17f0>]}
[0m13:40:04.614309 [debug] [MainThread]: Using duckdb connection "master"
[0m13:40:04.614484 [debug] [MainThread]: On master: BEGIN
[0m13:40:04.614645 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:40:04.614919 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:40:04.615092 [debug] [MainThread]: On master: COMMIT
[0m13:40:04.615260 [debug] [MainThread]: Using duckdb connection "master"
[0m13:40:04.615426 [debug] [MainThread]: On master: COMMIT
[0m13:40:04.615697 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:40:04.615902 [debug] [MainThread]: On master: Close
[0m13:40:04.617725 [debug] [Thread-1  ]: Began running node model.nhl_analytics.mart_goalie_performance
[0m13:40:04.617968 [debug] [Thread-2  ]: Began running node model.nhl_analytics.mart_player_performance
[0m13:40:04.618447 [debug] [Thread-3  ]: Began running node model.nhl_analytics.mart_team_standings
[0m13:40:04.618268 [info ] [Thread-1  ]: 1 of 7 START sql table model silver.mart_goalie_performance .................... [RUN]
[0m13:40:04.618727 [debug] [Thread-4  ]: Began running node model.nhl_analytics.stg_goalies
[0m13:40:04.618994 [info ] [Thread-2  ]: 2 of 7 START sql table model silver.mart_player_performance .................... [RUN]
[0m13:40:04.619302 [info ] [Thread-3  ]: 3 of 7 START sql table model silver.mart_team_standings ........................ [RUN]
[0m13:40:04.619569 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_nhl_silver, now model.nhl_analytics.mart_goalie_performance)
[0m13:40:04.619845 [info ] [Thread-4  ]: 4 of 7 START sql view model silver.stg_goalies ................................. [RUN]
[0m13:40:04.620147 [debug] [Thread-2  ]: Acquiring new duckdb connection 'model.nhl_analytics.mart_player_performance'
[0m13:40:04.620421 [debug] [Thread-3  ]: Acquiring new duckdb connection 'model.nhl_analytics.mart_team_standings'
[0m13:40:04.620629 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.mart_goalie_performance
[0m13:40:04.620881 [debug] [Thread-4  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_goalies'
[0m13:40:04.621108 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.mart_player_performance
[0m13:40:04.621324 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.mart_team_standings
[0m13:40:04.627319 [info ] [Thread-1  ]: Exporting mart_goalie_performance to silver folder
[0m13:40:04.627591 [debug] [Thread-4  ]: Began compiling node model.nhl_analytics.stg_goalies
[0m13:40:04.629359 [info ] [Thread-2  ]: Exporting mart_player_performance to silver folder
[0m13:40:04.631151 [info ] [Thread-3  ]: Exporting mart_team_standings to silver folder
[0m13:40:04.631482 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.mart_goalie_performance"
[0m13:40:04.633383 [debug] [Thread-4  ]: Writing injected SQL for node "model.nhl_analytics.stg_goalies"
[0m13:40:04.633647 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.mart_player_performance"
[0m13:40:04.633869 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.mart_team_standings"
[0m13:40:04.634355 [debug] [Thread-4  ]: Began executing node model.nhl_analytics.stg_goalies
[0m13:40:04.652896 [debug] [Thread-4  ]: Writing runtime sql for node "model.nhl_analytics.stg_goalies"
[0m13:40:04.653293 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.mart_goalie_performance
[0m13:40:04.653537 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.mart_team_standings
[0m13:40:04.653780 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.mart_player_performance
[0m13:40:04.671290 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.mart_team_standings"
[0m13:40:04.671600 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:40:04.672633 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.mart_goalie_performance"
[0m13:40:04.674616 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.mart_player_performance"
[0m13:40:04.674933 [debug] [Thread-4  ]: On model.nhl_analytics.stg_goalies: BEGIN
[0m13:40:04.675300 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:40:04.675721 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m13:40:04.675958 [debug] [Thread-3  ]: On model.nhl_analytics.mart_team_standings: BEGIN
[0m13:40:04.676190 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:40:04.676400 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m13:40:04.676640 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m13:40:04.676938 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m13:40:04.677165 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:40:04.677371 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m13:40:04.677562 [debug] [Thread-1  ]: On model.nhl_analytics.mart_goalie_performance: BEGIN
[0m13:40:04.677770 [debug] [Thread-2  ]: On model.nhl_analytics.mart_player_performance: BEGIN
[0m13:40:04.677978 [debug] [Thread-4  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    

select 
    playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position
from "nhl"."bronze"."goalies"
where playerId is not null
    and season is not null
  );

[0m13:40:04.678195 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m13:40:04.678392 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:40:04.678593 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:40:04.678892 [debug] [Thread-3  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

  
    
    

    create  table
      "nhl"."silver"."mart_team_standings__dbt_tmp"
  
    as (
      { { config(
    materialized = 'table',
    post_hook = "


COPY (
    SELECT *
    FROM "nhl"."silver"."mart_team_standings"
) TO '../data/silver/mart_team_standings.parquet' (FORMAT PARQUET);

"
) } }
select season,
    team_name,
    team_code,
    games_played,
    goalsFor,
    goalsAgainst,
    goal_differential,
    xGoalsFor,
    xGoalsAgainst,
    row_number() over (
        order by goalsFor desc,
            goal_differential desc
    ) as standings_rank,
    loaded_at
from { { ref('stg_teams') } }
order by standings_rank
    );
  
  
[0m13:40:04.679169 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m13:40:04.679419 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m13:40:04.682131 [debug] [Thread-3  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

  
    
    

    create  table
      "nhl"."silver"."mart_team_standings__dbt_tmp"
  
    as (
      { { config(
    materialized = 'table',
    post_hook = "


COPY (
    SELECT *
    FROM "nhl"."silver"."mart_team_standings"
) TO '../data/silver/mart_team_standings.parquet' (FORMAT PARQUET);

"
) } }
select season,
    team_name,
    team_code,
    games_played,
    goalsFor,
    goalsAgainst,
    goal_differential,
    xGoalsFor,
    xGoalsAgainst,
    row_number() over (
        order by goalsFor desc,
            goal_differential desc
    ) as standings_rank,
    loaded_at
from { { ref('stg_teams') } }
order by standings_rank
    );
  
  
[0m13:40:04.682364 [debug] [Thread-2  ]: SQL status: OK in 0.004 seconds
[0m13:40:04.686048 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:40:04.686280 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m13:40:04.687042 [debug] [Thread-3  ]: DuckDB adapter: Rolling back transaction.
[0m13:40:04.687260 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m13:40:04.687472 [debug] [Thread-4  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */
alter view "nhl"."silver"."stg_goalies" rename to "stg_goalies__dbt_backup"
[0m13:40:04.687707 [debug] [Thread-1  ]: On model.nhl_analytics.mart_goalie_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */

  
    
    

    create  table
      "nhl"."silver"."mart_goalie_performance__dbt_tmp"
  
    as (
      { { config(
    materialized = 'table',
    post_hook = "


COPY (
    SELECT *
    FROM "nhl"."silver"."mart_goalie_performance"
) TO '../data/silver/mart_goalie_performance.parquet' (FORMAT PARQUET);

"
) } }
select player_id,
    player_name,
    season,
    team_code,
    position,
    loaded_at
from { { ref('int_all_players') } }
where position_group in ('Goalie')
    and games_played >= 10
    );
  
  
[0m13:40:04.688045 [debug] [Thread-3  ]: On model.nhl_analytics.mart_team_standings: ROLLBACK
[0m13:40:04.688298 [debug] [Thread-2  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */

  
    
    

    create  table
      "nhl"."silver"."mart_player_performance__dbt_tmp"
  
    as (
      { { config(
    materialized = 'table',
    post_hook = "


COPY (
    SELECT *
    FROM "nhl"."silver"."mart_player_performance"
) TO '../data/silver/mart_player_performance.parquet' (FORMAT PARQUET);

"
) } }
select player_id,
    player_name,
    team_code,
    position,
    position_group,
    games_played,
    points_per_game,
    shooting_percentage,
    case
        when points_per_game >= 1.0 then 'Elite'
        when points_per_game >= 0.7 then 'Very Good'
        when points_per_game >= 0.5 then 'Good'
        when points_per_game >= 0.3 then 'Average'
        else 'Below Average'
    end as offensive_rating,
    loaded_at
from { { ref('int_all_players') } }
where position_group in ('Forward', 'Defense')
    and games_played >= 10
    );
  
  
[0m13:40:04.688919 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */

  
    
    

    create  table
      "nhl"."silver"."mart_goalie_performance__dbt_tmp"
  
    as (
      { { config(
    materialized = 'table',
    post_hook = "


COPY (
    SELECT *
    FROM "nhl"."silver"."mart_goalie_performance"
) TO '../data/silver/mart_goalie_performance.parquet' (FORMAT PARQUET);

"
) } }
select player_id,
    player_name,
    season,
    team_code,
    position,
    loaded_at
from { { ref('int_all_players') } }
where position_group in ('Goalie')
    and games_played >= 10
    );
  
  
[0m13:40:04.689244 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m13:40:04.689614 [debug] [Thread-2  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */

  
    
    

    create  table
      "nhl"."silver"."mart_player_performance__dbt_tmp"
  
    as (
      { { config(
    materialized = 'table',
    post_hook = "


COPY (
    SELECT *
    FROM "nhl"."silver"."mart_player_performance"
) TO '../data/silver/mart_player_performance.parquet' (FORMAT PARQUET);

"
) } }
select player_id,
    player_name,
    team_code,
    position,
    position_group,
    games_played,
    points_per_game,
    shooting_percentage,
    case
        when points_per_game >= 1.0 then 'Elite'
        when points_per_game >= 0.7 then 'Very Good'
        when points_per_game >= 0.5 then 'Good'
        when points_per_game >= 0.3 then 'Average'
        else 'Below Average'
    end as offensive_rating,
    loaded_at
from { { ref('int_all_players') } }
where position_group in ('Forward', 'Defense')
    and games_played >= 10
    );
  
  
[0m13:40:04.691531 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m13:40:04.693406 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:40:04.693646 [debug] [Thread-2  ]: DuckDB adapter: Rolling back transaction.
[0m13:40:04.695150 [debug] [Thread-1  ]: On model.nhl_analytics.mart_goalie_performance: ROLLBACK
[0m13:40:04.695376 [debug] [Thread-4  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */
alter view "nhl"."silver"."stg_goalies__dbt_tmp" rename to "stg_goalies"
[0m13:40:04.695668 [debug] [Thread-2  ]: On model.nhl_analytics.mart_player_performance: ROLLBACK
[0m13:40:04.697454 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m13:40:04.706105 [debug] [Thread-4  ]: On model.nhl_analytics.stg_goalies: COMMIT
[0m13:40:04.706355 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:40:04.707484 [debug] [Thread-4  ]: On model.nhl_analytics.stg_goalies: COMMIT
[0m13:40:04.709509 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m13:40:04.714130 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:40:04.714365 [debug] [Thread-4  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

      drop view if exists "nhl"."silver"."stg_goalies__dbt_backup" cascade
    
[0m13:40:04.715368 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m13:40:04.716784 [debug] [Thread-4  ]: On model.nhl_analytics.stg_goalies: Close
[0m13:40:04.731740 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ceb9d48f-fa64-4e2e-b59a-1b8580cecc00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107caf730>]}
[0m13:40:04.732170 [info ] [Thread-4  ]: 4 of 7 OK created sql view model silver.stg_goalies ............................ [[32mOK[0m in 0.10s]
[0m13:40:04.736135 [debug] [Thread-4  ]: Finished running node model.nhl_analytics.stg_goalies
[0m13:40:04.737087 [debug] [Thread-4  ]: Began running node model.nhl_analytics.stg_skaters
[0m13:40:04.737422 [info ] [Thread-4  ]: 5 of 7 START sql view model silver.stg_skaters ................................. [RUN]
[0m13:40:04.737859 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.stg_goalies, now model.nhl_analytics.stg_skaters)
[0m13:40:04.740622 [debug] [Thread-4  ]: Began compiling node model.nhl_analytics.stg_skaters
[0m13:40:04.742722 [debug] [Thread-4  ]: Writing injected SQL for node "model.nhl_analytics.stg_skaters"
[0m13:40:04.743298 [debug] [Thread-1  ]: Failed to rollback 'model.nhl_analytics.mart_goalie_performance'
[0m13:40:04.743757 [debug] [Thread-3  ]: Failed to rollback 'model.nhl_analytics.mart_team_standings'
[0m13:40:04.743981 [debug] [Thread-1  ]: On model.nhl_analytics.mart_goalie_performance: Close
[0m13:40:04.744388 [debug] [Thread-2  ]: Failed to rollback 'model.nhl_analytics.mart_player_performance'
[0m13:40:04.744606 [debug] [Thread-3  ]: On model.nhl_analytics.mart_team_standings: Close
[0m13:40:04.744819 [debug] [Thread-4  ]: Began executing node model.nhl_analytics.stg_skaters
[0m13:40:04.745121 [debug] [Thread-2  ]: On model.nhl_analytics.mart_player_performance: Close
[0m13:40:04.747311 [debug] [Thread-4  ]: Writing runtime sql for node "model.nhl_analytics.stg_skaters"
[0m13:40:04.750372 [debug] [Thread-1  ]: Runtime Error in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 11:       { { config(
                 ^
[0m13:40:04.750651 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ceb9d48f-fa64-4e2e-b59a-1b8580cecc00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bdeee0>]}
[0m13:40:04.753390 [debug] [Thread-3  ]: Runtime Error in model mart_team_standings (models/marts/mart_team_standings.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 11:       { { config(
                 ^
[0m13:40:04.753656 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:40:04.753913 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ceb9d48f-fa64-4e2e-b59a-1b8580cecc00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c17520>]}
[0m13:40:04.754237 [error] [Thread-1  ]: 1 of 7 ERROR creating sql table model silver.mart_goalie_performance ........... [[31mERROR[0m in 0.13s]
[0m13:40:04.757326 [debug] [Thread-2  ]: Runtime Error in model mart_player_performance (models/marts/mart_player_performance.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 11:       { { config(
                 ^
[0m13:40:04.757547 [debug] [Thread-4  ]: On model.nhl_analytics.stg_skaters: BEGIN
[0m13:40:04.757915 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.mart_goalie_performance
[0m13:40:04.758191 [error] [Thread-3  ]: 3 of 7 ERROR creating sql table model silver.mart_team_standings ............... [[31mERROR[0m in 0.13s]
[0m13:40:04.758484 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ceb9d48f-fa64-4e2e-b59a-1b8580cecc00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112be1340>]}
[0m13:40:04.758708 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m13:40:04.758937 [debug] [Thread-1  ]: Began running node model.nhl_analytics.stg_teams
[0m13:40:04.759212 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.mart_goalie_performance' to be skipped because of status 'error'.  Reason: Runtime Error in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 11:       { { config(
                 ^.
[0m13:40:04.759502 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.mart_team_standings
[0m13:40:04.759897 [error] [Thread-2  ]: 2 of 7 ERROR creating sql table model silver.mart_player_performance ........... [[31mERROR[0m in 0.14s]
[0m13:40:04.760297 [info ] [Thread-1  ]: 6 of 7 START sql view model silver.stg_teams ................................... [RUN]
[0m13:40:04.760611 [debug] [Thread-4  ]: SQL status: OK in 0.002 seconds
[0m13:40:04.760889 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.mart_team_standings' to be skipped because of status 'error'.  Reason: Runtime Error in model mart_team_standings (models/marts/mart_team_standings.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 11:       { { config(
                 ^.
[0m13:40:04.761182 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.mart_player_performance
[0m13:40:04.761417 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.mart_goalie_performance, now model.nhl_analytics.stg_teams)
[0m13:40:04.761625 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:40:04.761935 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.mart_player_performance' to be skipped because of status 'error'.  Reason: Runtime Error in model mart_player_performance (models/marts/mart_player_performance.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 11:       { { config(
                 ^.
[0m13:40:04.762149 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.stg_teams
[0m13:40:04.762374 [debug] [Thread-4  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    

select
    playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    games_played,
    icetime as ice_time,
    I_F_goals as goals,
    I_F_points as points,
    I_F_shotsOnGoal as shots_on_goal,
    I_F_primaryAssists as primary_assists,
    I_F_secondaryAssists as secondary_assists,
    case 
        when games_played > 0 then true 
        else false 
    end as is_active_player,
    case 
        when games_played > 0 then round(I_F_points * 1.0 / games_played, 2)
        else null 
    end as points_per_game,
    case 
        when I_F_shotsOnGoal > 0 then round(I_F_goals * 100.0 / I_F_shotsOnGoal, 2)
        else null 
    end as shooting_percentage,
    current_timestamp as loaded_at
from "nhl"."bronze"."skaters"
where playerId is not null
    and season is not null
  );

[0m13:40:04.764372 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.stg_teams"
[0m13:40:04.765099 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.stg_teams
[0m13:40:04.767304 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.stg_teams"
[0m13:40:04.767547 [debug] [Thread-4  ]: SQL status: OK in 0.003 seconds
[0m13:40:04.769413 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:40:04.769630 [debug] [Thread-4  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */
alter view "nhl"."silver"."stg_skaters" rename to "stg_skaters__dbt_backup"
[0m13:40:04.769943 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:40:04.770152 [debug] [Thread-1  ]: On model.nhl_analytics.stg_teams: BEGIN
[0m13:40:04.770340 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m13:40:04.770532 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:40:04.773291 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:40:04.773614 [debug] [Thread-4  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */
alter view "nhl"."silver"."stg_skaters__dbt_tmp" rename to "stg_skaters"
[0m13:40:04.773877 [debug] [Thread-1  ]: SQL status: OK in 0.003 seconds
[0m13:40:04.774082 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:40:04.774280 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m13:40:04.774480 [debug] [Thread-1  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

  
  create view "nhl"."silver"."stg_teams__dbt_tmp" as (
    

select
    season,
    name as team_name,
    team as team_code,
    games_played,
    goalsFor,
    goalsAgainst,
    goalsFor - goalsAgainst as goal_differential,
    xGoalsFor,
    xGoalsAgainst,
    current_timestamp as loaded_at
from "nhl"."bronze"."teams"
where season is not null
    and name is not null
    and situation = 'all'
  );

[0m13:40:04.775183 [debug] [Thread-4  ]: On model.nhl_analytics.stg_skaters: COMMIT
[0m13:40:04.775460 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:40:04.775652 [debug] [Thread-4  ]: On model.nhl_analytics.stg_skaters: COMMIT
[0m13:40:04.775885 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m13:40:04.777719 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:40:04.777927 [debug] [Thread-4  ]: SQL status: OK in 0.002 seconds
[0m13:40:04.778126 [debug] [Thread-1  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */
alter view "nhl"."silver"."stg_teams" rename to "stg_teams__dbt_backup"
[0m13:40:04.779619 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:40:04.779887 [debug] [Thread-4  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

      drop view if exists "nhl"."silver"."stg_skaters__dbt_backup" cascade
    
[0m13:40:04.780132 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m13:40:04.781883 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:40:04.782084 [debug] [Thread-4  ]: SQL status: OK in 0.002 seconds
[0m13:40:04.782279 [debug] [Thread-1  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */
alter view "nhl"."silver"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m13:40:04.782934 [debug] [Thread-4  ]: On model.nhl_analytics.stg_skaters: Close
[0m13:40:04.783316 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ceb9d48f-fa64-4e2e-b59a-1b8580cecc00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bf83d0>]}
[0m13:40:04.783581 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m13:40:04.784231 [debug] [Thread-1  ]: On model.nhl_analytics.stg_teams: COMMIT
[0m13:40:04.784521 [info ] [Thread-4  ]: 5 of 7 OK created sql view model silver.stg_skaters ............................ [[32mOK[0m in 0.05s]
[0m13:40:04.784769 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:40:04.785091 [debug] [Thread-4  ]: Finished running node model.nhl_analytics.stg_skaters
[0m13:40:04.785297 [debug] [Thread-1  ]: On model.nhl_analytics.stg_teams: COMMIT
[0m13:40:04.785612 [debug] [Thread-3  ]: Began running node model.nhl_analytics.int_all_players
[0m13:40:04.785918 [info ] [Thread-3  ]: 7 of 7 START sql view model silver.int_all_players ............................. [RUN]
[0m13:40:04.786144 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m13:40:04.786367 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.mart_team_standings, now model.nhl_analytics.int_all_players)
[0m13:40:04.787941 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:40:04.788180 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.int_all_players
[0m13:40:04.788425 [debug] [Thread-1  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

      drop view if exists "nhl"."silver"."stg_teams__dbt_backup" cascade
    
[0m13:40:04.790492 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.int_all_players"
[0m13:40:04.790916 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m13:40:04.791138 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.int_all_players
[0m13:40:04.791855 [debug] [Thread-1  ]: On model.nhl_analytics.stg_teams: Close
[0m13:40:04.793860 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.int_all_players"
[0m13:40:04.794212 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ceb9d48f-fa64-4e2e-b59a-1b8580cecc00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e8f430>]}
[0m13:40:04.794575 [info ] [Thread-1  ]: 6 of 7 OK created sql view model silver.stg_teams .............................. [[32mOK[0m in 0.03s]
[0m13:40:04.794839 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m13:40:04.795123 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.stg_teams
[0m13:40:04.795328 [debug] [Thread-3  ]: On model.nhl_analytics.int_all_players: BEGIN
[0m13:40:04.795577 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:40:04.795886 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m13:40:04.796085 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m13:40:04.796287 [debug] [Thread-3  ]: On model.nhl_analytics.int_all_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */

  
  create view "nhl"."silver"."int_all_players__dbt_tmp" as (
    

with all_players as (
    select 
        player_id,
        season,
        player_name,
        team_code,
        'G' as position,
        null as games_played,
        null as points_per_game,
        null as shooting_percentage
    from "nhl"."silver"."stg_goalies"
    
    union all
    
    select 
        player_id,
        season,
        player_name,
        team_code,
        position,
        games_played,
        points_per_game,
        shooting_percentage
    from "nhl"."silver"."stg_skaters"
)

select *,
    case 
        when position = 'G' then 'Goalie'
        when position in ('C', 'L', 'R', 'LW', 'RW') then 'Forward'
        when position in ('D') then 'Defense'
        else 'Unknown'
    end as position_group,
    current_timestamp as loaded_at
from all_players
  );

[0m13:40:04.797320 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m13:40:04.799775 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m13:40:04.799980 [debug] [Thread-3  ]: On model.nhl_analytics.int_all_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */
alter view "nhl"."silver"."int_all_players" rename to "int_all_players__dbt_backup"
[0m13:40:04.800301 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m13:40:04.802073 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m13:40:04.802299 [debug] [Thread-3  ]: On model.nhl_analytics.int_all_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */
alter view "nhl"."silver"."int_all_players__dbt_tmp" rename to "int_all_players"
[0m13:40:04.802671 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m13:40:04.803395 [debug] [Thread-3  ]: On model.nhl_analytics.int_all_players: COMMIT
[0m13:40:04.803594 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m13:40:04.803780 [debug] [Thread-3  ]: On model.nhl_analytics.int_all_players: COMMIT
[0m13:40:04.804198 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m13:40:04.805819 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m13:40:04.806035 [debug] [Thread-3  ]: On model.nhl_analytics.int_all_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */

      drop view if exists "nhl"."silver"."int_all_players__dbt_backup" cascade
    
[0m13:40:04.806423 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m13:40:04.807120 [debug] [Thread-3  ]: On model.nhl_analytics.int_all_players: Close
[0m13:40:04.807440 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ceb9d48f-fa64-4e2e-b59a-1b8580cecc00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112be3700>]}
[0m13:40:04.807766 [info ] [Thread-3  ]: 7 of 7 OK created sql view model silver.int_all_players ........................ [[32mOK[0m in 0.02s]
[0m13:40:04.808079 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.int_all_players
[0m13:40:04.808656 [debug] [MainThread]: Using duckdb connection "master"
[0m13:40:04.808842 [debug] [MainThread]: On master: BEGIN
[0m13:40:04.808996 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:40:04.809261 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:40:04.809431 [debug] [MainThread]: On master: COMMIT
[0m13:40:04.809589 [debug] [MainThread]: Using duckdb connection "master"
[0m13:40:04.809740 [debug] [MainThread]: On master: COMMIT
[0m13:40:04.809960 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:40:04.810126 [debug] [MainThread]: On master: Close
[0m13:40:04.810326 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:40:04.810474 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_teams' was properly closed.
[0m13:40:04.810615 [debug] [MainThread]: Connection 'model.nhl_analytics.mart_player_performance' was properly closed.
[0m13:40:04.810755 [debug] [MainThread]: Connection 'model.nhl_analytics.int_all_players' was properly closed.
[0m13:40:04.810892 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_skaters' was properly closed.
[0m13:40:04.811093 [info ] [MainThread]: 
[0m13:40:04.811281 [info ] [MainThread]: Finished running 3 table models, 4 view models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m13:40:04.812019 [debug] [MainThread]: Command end result
[0m13:40:04.826859 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m13:40:04.827780 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m13:40:04.831557 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/run_results.json
[0m13:40:04.831749 [info ] [MainThread]: 
[0m13:40:04.831983 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m13:40:04.832175 [info ] [MainThread]: 
[0m13:40:04.832399 [error] [MainThread]: [31mFailure in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)[0m
[0m13:40:04.832620 [error] [MainThread]:   Runtime Error in model mart_goalie_performance (models/marts/mart_goalie_performance.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 11:       { { config(
                 ^
[0m13:40:04.832797 [info ] [MainThread]: 
[0m13:40:04.833002 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/marts/mart_goalie_performance.sql
[0m13:40:04.833179 [info ] [MainThread]: 
[0m13:40:04.833388 [error] [MainThread]: [31mFailure in model mart_team_standings (models/marts/mart_team_standings.sql)[0m
[0m13:40:04.833596 [error] [MainThread]:   Runtime Error in model mart_team_standings (models/marts/mart_team_standings.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 11:       { { config(
                 ^
[0m13:40:04.833766 [info ] [MainThread]: 
[0m13:40:04.833966 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/marts/mart_team_standings.sql
[0m13:40:04.834138 [info ] [MainThread]: 
[0m13:40:04.834345 [error] [MainThread]: [31mFailure in model mart_player_performance (models/marts/mart_player_performance.sql)[0m
[0m13:40:04.834552 [error] [MainThread]:   Runtime Error in model mart_player_performance (models/marts/mart_player_performance.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 11:       { { config(
                 ^
[0m13:40:04.834722 [info ] [MainThread]: 
[0m13:40:04.834919 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/marts/mart_player_performance.sql
[0m13:40:04.835093 [info ] [MainThread]: 
[0m13:40:04.835283 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=7
[0m13:40:04.836215 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9117002, "process_in_blocks": "0", "process_kernel_time": 0.176491, "process_mem_max_rss": "144637952", "process_out_blocks": "0", "process_user_time": 1.466476}
[0m13:40:04.836435 [debug] [MainThread]: Command `python -m dbt.cli.main run` failed at 13:40:04.836387 after 0.91 seconds
[0m13:40:04.836669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107db3400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c35ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126ed250>]}
[0m13:40:04.836891 [debug] [MainThread]: Flushing usage events
[0m13:40:05.028962 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:41:01.348353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10546b370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065f1490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065f12b0>]}


============================== 13:41:01.351106 | 6e51f3b8-79d9-44c1-9f99-7495e05b4928 ==============================
[0m13:41:01.351106 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:41:01.351457 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'static_parser': 'True', 'indirect_selection': 'eager', 'empty': 'None', 'write_json': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'no_print': 'None', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '.', 'quiet': 'False', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'invocation_command': 'dbt clean --profiles-dir .', 'target_path': 'None', 'use_experimental_parser': 'False', 'log_format': 'default', 'use_colors': 'True', 'version_check': 'True'}
[0m13:41:01.420992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e51f3b8-79d9-44c1-9f99-7495e05b4928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ee86a0>]}
[0m13:41:01.432985 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.12618938, "process_in_blocks": "0", "process_kernel_time": 0.086503, "process_mem_max_rss": "100728832", "process_out_blocks": "0", "process_user_time": 0.794994}
[0m13:41:01.433255 [debug] [MainThread]: Command `python -m dbt.cli.main clean` succeeded at 13:41:01.433201 after 0.13 seconds
[0m13:41:01.433477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10546b370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10669db80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ee86a0>]}
[0m13:41:01.433704 [debug] [MainThread]: Flushing usage events
[0m13:41:01.684456 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:41:08.694066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047713a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063f9460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063f9280>]}


============================== 13:41:08.696712 | 750a97b3-3ce2-4cae-9899-b70a01f61425 ==============================
[0m13:41:08.696712 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:41:08.697057 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'use_colors': 'True', 'debug': 'False', 'invocation_command': 'dbt run --profiles-dir .', 'empty': 'False', 'no_print': 'None', 'log_format': 'default', 'warn_error': 'None', 'printer_width': '80', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'version_check': 'True', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'target_path': 'None', 'cache_selected_only': 'False', 'profiles_dir': '.', 'write_json': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False'}
[0m13:41:08.875396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '750a97b3-3ce2-4cae-9899-b70a01f61425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067384f0>]}
[0m13:41:08.911550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '750a97b3-3ce2-4cae-9899-b70a01f61425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10659a7f0>]}
[0m13:41:08.913252 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m13:41:08.983435 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:41:08.983893 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:41:08.984146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '750a97b3-3ce2-4cae-9899-b70a01f61425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10685be20>]}
[0m13:41:09.562603 [info ] [MainThread]: Exporting mart_goalie_performance to silver folder
[0m13:41:09.566413 [info ] [MainThread]: Exporting mart_player_performance to silver folder
[0m13:41:09.570300 [info ] [MainThread]: Exporting mart_team_standings to silver folder
[0m13:41:09.776316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '750a97b3-3ce2-4cae-9899-b70a01f61425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d67130>]}
[0m13:41:09.864802 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m13:41:09.866276 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m13:41:09.876722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '750a97b3-3ce2-4cae-9899-b70a01f61425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b3ec70>]}
[0m13:41:09.877044 [info ] [MainThread]: Found 7 models, 6 data tests, 4 sources, 445 macros
[0m13:41:09.877268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '750a97b3-3ce2-4cae-9899-b70a01f61425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d071f0>]}
[0m13:41:09.878190 [info ] [MainThread]: 
[0m13:41:09.878412 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:41:09.878595 [info ] [MainThread]: 
[0m13:41:09.878888 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:41:09.882107 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl'
[0m13:41:09.913211 [debug] [ThreadPool]: Using duckdb connection "list_nhl"
[0m13:41:09.913455 [debug] [ThreadPool]: On list_nhl: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m13:41:09.913653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:41:09.951717 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m13:41:09.952699 [debug] [ThreadPool]: On list_nhl: Close
[0m13:41:09.953114 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nhl, now create_nhl_silver)
[0m13:41:09.953385 [debug] [ThreadPool]: Creating schema "database: "nhl"
schema: "silver"
"
[0m13:41:09.957680 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:41:09.957892 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nhl'
        and type='sqlite'
    
  
[0m13:41:09.958067 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:41:09.958731 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:41:09.959590 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:41:09.959773 [debug] [ThreadPool]: On create_nhl_silver: BEGIN
[0m13:41:09.960037 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:41:09.960217 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:41:09.960389 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
    
        create schema if not exists "nhl"."silver"
    
[0m13:41:09.960672 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:41:09.961123 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m13:41:09.961289 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:41:09.961445 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m13:41:09.961682 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:41:09.961858 [debug] [ThreadPool]: On create_nhl_silver: Close
[0m13:41:09.962656 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nhl_silver, now list_nhl_silver)
[0m13:41:09.966061 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m13:41:09.966246 [debug] [ThreadPool]: On list_nhl_silver: BEGIN
[0m13:41:09.966404 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:41:09.966676 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:41:09.966848 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m13:41:09.967025 [debug] [ThreadPool]: On list_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl_silver"} */
select
      'nhl' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'silver'
    and lower(table_catalog) = 'nhl'
  
[0m13:41:09.975866 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m13:41:09.976595 [debug] [ThreadPool]: On list_nhl_silver: ROLLBACK
[0m13:41:09.977768 [debug] [ThreadPool]: Failed to rollback 'list_nhl_silver'
[0m13:41:09.977967 [debug] [ThreadPool]: On list_nhl_silver: Close
[0m13:41:09.978587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '750a97b3-3ce2-4cae-9899-b70a01f61425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107be4eb0>]}
[0m13:41:09.978854 [debug] [MainThread]: Using duckdb connection "master"
[0m13:41:09.979020 [debug] [MainThread]: On master: BEGIN
[0m13:41:09.979171 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:41:09.979453 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:41:09.979634 [debug] [MainThread]: On master: COMMIT
[0m13:41:09.979806 [debug] [MainThread]: Using duckdb connection "master"
[0m13:41:09.979967 [debug] [MainThread]: On master: COMMIT
[0m13:41:09.980202 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:41:09.980378 [debug] [MainThread]: On master: Close
[0m13:41:09.981726 [debug] [Thread-1  ]: Began running node model.nhl_analytics.stg_goalies
[0m13:41:09.981966 [debug] [Thread-2  ]: Began running node model.nhl_analytics.stg_skaters
[0m13:41:09.982442 [debug] [Thread-3  ]: Began running node model.nhl_analytics.stg_teams
[0m13:41:09.982262 [info ] [Thread-1  ]: 1 of 7 START sql view model silver.stg_goalies ................................. [RUN]
[0m13:41:09.982781 [info ] [Thread-2  ]: 2 of 7 START sql view model silver.stg_skaters ................................. [RUN]
[0m13:41:09.983069 [info ] [Thread-3  ]: 3 of 7 START sql view model silver.stg_teams ................................... [RUN]
[0m13:41:09.983362 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_nhl_silver, now model.nhl_analytics.stg_goalies)
[0m13:41:09.983640 [debug] [Thread-2  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_skaters'
[0m13:41:09.983905 [debug] [Thread-3  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_teams'
[0m13:41:09.984115 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.stg_goalies
[0m13:41:09.984327 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.stg_skaters
[0m13:41:09.984532 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.stg_teams
[0m13:41:09.989731 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.stg_goalies"
[0m13:41:09.991685 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.stg_skaters"
[0m13:41:09.993473 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.stg_teams"
[0m13:41:09.994105 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.stg_skaters
[0m13:41:09.994338 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.stg_teams
[0m13:41:09.994599 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.stg_goalies
[0m13:41:10.016123 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.stg_teams"
[0m13:41:10.017265 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.stg_skaters"
[0m13:41:10.019314 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.stg_goalies"
[0m13:41:10.020151 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:41:10.020453 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: BEGIN
[0m13:41:10.020741 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:41:10.021193 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:41:10.021431 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:41:10.021658 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: BEGIN
[0m13:41:10.021898 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: BEGIN
[0m13:41:10.022227 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:41:10.022450 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:41:10.022674 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m13:41:10.022994 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:41:10.023205 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m13:41:10.023447 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    

select
    playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    games_played,
    icetime as ice_time,
    I_F_goals as goals,
    I_F_points as points,
    I_F_shotsOnGoal as shots_on_goal,
    I_F_primaryAssists as primary_assists,
    I_F_secondaryAssists as secondary_assists,
    case 
        when games_played > 0 then true 
        else false 
    end as is_active_player,
    case 
        when games_played > 0 then round(I_F_points * 1.0 / games_played, 2)
        else null 
    end as points_per_game,
    case 
        when I_F_shotsOnGoal > 0 then round(I_F_goals * 100.0 / I_F_shotsOnGoal, 2)
        else null 
    end as shooting_percentage,
    current_timestamp as loaded_at
from "nhl"."bronze"."skaters"
where playerId is not null
    and season is not null
  );

[0m13:41:10.023679 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m13:41:10.023876 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:41:10.024223 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:41:10.024449 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    

select 
    playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position
from "nhl"."bronze"."goalies"
where playerId is not null
    and season is not null
  );

[0m13:41:10.024690 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

  
  create view "nhl"."silver"."stg_teams__dbt_tmp" as (
    

select
    season,
    name as team_name,
    team as team_code,
    games_played,
    goalsFor,
    goalsAgainst,
    goalsFor - goalsAgainst as goal_differential,
    xGoalsFor,
    xGoalsAgainst,
    current_timestamp as loaded_at
from "nhl"."bronze"."teams"
where season is not null
    and name is not null
    and situation = 'all'
  );

[0m13:41:10.025139 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m13:41:10.028865 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:41:10.029104 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */
alter view "nhl"."silver"."stg_goalies" rename to "stg_goalies__dbt_backup"
[0m13:41:10.029319 [debug] [Thread-3  ]: SQL status: OK in 0.004 seconds
[0m13:41:10.029531 [debug] [Thread-2  ]: SQL status: OK in 0.005 seconds
[0m13:41:10.031622 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:41:10.033928 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:41:10.034144 [debug] [Thread-1  ]: SQL status: OK in 0.004 seconds
[0m13:41:10.034362 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */
alter view "nhl"."silver"."stg_teams" rename to "stg_teams__dbt_backup"
[0m13:41:10.034583 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */
alter view "nhl"."silver"."stg_skaters" rename to "stg_skaters__dbt_backup"
[0m13:41:10.036344 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:41:10.036703 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */
alter view "nhl"."silver"."stg_goalies__dbt_tmp" rename to "stg_goalies"
[0m13:41:10.036980 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m13:41:10.038850 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:41:10.039075 [debug] [Thread-3  ]: SQL status: OK in 0.002 seconds
[0m13:41:10.039291 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */
alter view "nhl"."silver"."stg_skaters__dbt_tmp" rename to "stg_skaters"
[0m13:41:10.039497 [debug] [Thread-1  ]: SQL status: OK in 0.003 seconds
[0m13:41:10.041280 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:41:10.047939 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */
alter view "nhl"."silver"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m13:41:10.048165 [debug] [Thread-2  ]: SQL status: OK in 0.007 seconds
[0m13:41:10.048435 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: COMMIT
[0m13:41:10.049149 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: COMMIT
[0m13:41:10.049388 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:41:10.049590 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m13:41:10.049790 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:41:10.049992 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: COMMIT
[0m13:41:10.050637 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: COMMIT
[0m13:41:10.050850 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: COMMIT
[0m13:41:10.051137 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:41:10.051427 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: COMMIT
[0m13:41:10.051725 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m13:41:10.051953 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m13:41:10.055325 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:41:10.055532 [debug] [Thread-3  ]: SQL status: OK in 0.004 seconds
[0m13:41:10.057073 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:41:10.057290 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

      drop view if exists "nhl"."silver"."stg_goalies__dbt_backup" cascade
    
[0m13:41:10.059280 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:41:10.059499 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

      drop view if exists "nhl"."silver"."stg_skaters__dbt_backup" cascade
    
[0m13:41:10.059792 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

      drop view if exists "nhl"."silver"."stg_teams__dbt_backup" cascade
    
[0m13:41:10.060088 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m13:41:10.061463 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: Close
[0m13:41:10.061688 [debug] [Thread-2  ]: SQL status: OK in 0.002 seconds
[0m13:41:10.061891 [debug] [Thread-3  ]: SQL status: OK in 0.002 seconds
[0m13:41:10.062935 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: Close
[0m13:41:10.063980 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: Close
[0m13:41:10.064644 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '750a97b3-3ce2-4cae-9899-b70a01f61425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10635c040>]}
[0m13:41:10.064850 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '750a97b3-3ce2-4cae-9899-b70a01f61425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065bef10>]}
[0m13:41:10.065045 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '750a97b3-3ce2-4cae-9899-b70a01f61425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063bfa90>]}
[0m13:41:10.065418 [info ] [Thread-1  ]: 1 of 7 OK created sql view model silver.stg_goalies ............................ [[32mOK[0m in 0.08s]
[0m13:41:10.065796 [info ] [Thread-2  ]: 2 of 7 OK created sql view model silver.stg_skaters ............................ [[32mOK[0m in 0.08s]
[0m13:41:10.066426 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.stg_goalies
[0m13:41:10.066163 [info ] [Thread-3  ]: 3 of 7 OK created sql view model silver.stg_teams .............................. [[32mOK[0m in 0.08s]
[0m13:41:10.066770 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.stg_skaters
[0m13:41:10.067121 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.stg_teams
[0m13:41:10.067440 [debug] [Thread-4  ]: Began running node model.nhl_analytics.int_all_players
[0m13:41:10.067977 [debug] [Thread-2  ]: Began running node model.nhl_analytics.mart_team_standings
[0m13:41:10.067792 [info ] [Thread-4  ]: 4 of 7 START sql view model silver.int_all_players ............................. [RUN]
[0m13:41:10.068306 [info ] [Thread-2  ]: 5 of 7 START sql table model silver.mart_team_standings ........................ [RUN]
[0m13:41:10.068619 [debug] [Thread-4  ]: Acquiring new duckdb connection 'model.nhl_analytics.int_all_players'
[0m13:41:10.068865 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.stg_skaters, now model.nhl_analytics.mart_team_standings)
[0m13:41:10.069101 [debug] [Thread-4  ]: Began compiling node model.nhl_analytics.int_all_players
[0m13:41:10.069314 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.mart_team_standings
[0m13:41:10.071631 [debug] [Thread-4  ]: Writing injected SQL for node "model.nhl_analytics.int_all_players"
[0m13:41:10.073522 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.mart_team_standings"
[0m13:41:10.073999 [debug] [Thread-4  ]: Began executing node model.nhl_analytics.int_all_players
[0m13:41:10.074218 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.mart_team_standings
[0m13:41:10.076190 [debug] [Thread-4  ]: Writing runtime sql for node "model.nhl_analytics.int_all_players"
[0m13:41:10.088447 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.mart_team_standings"
[0m13:41:10.089507 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m13:41:10.089755 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m13:41:10.089975 [debug] [Thread-2  ]: On model.nhl_analytics.mart_team_standings: BEGIN
[0m13:41:10.090188 [debug] [Thread-4  ]: On model.nhl_analytics.int_all_players: BEGIN
[0m13:41:10.090386 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:41:10.090575 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:41:10.090997 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m13:41:10.091193 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m13:41:10.091396 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m13:41:10.091608 [debug] [Thread-2  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

  
    
    

    create  table
      "nhl"."silver"."mart_team_standings__dbt_tmp"
  
    as (
      

select 
    season,
    team_name,
    team_code,
    games_played,
    goalsFor,
    goalsAgainst,
    goal_differential,
    xGoalsFor,
    xGoalsAgainst,
    row_number() over (
        order by goalsFor desc,
            goal_differential desc
    ) as standings_rank,
    loaded_at
from "nhl"."silver"."stg_teams"
order by standings_rank
    );
  
  
[0m13:41:10.091826 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m13:41:10.092131 [debug] [Thread-4  ]: On model.nhl_analytics.int_all_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */

  
  create view "nhl"."silver"."int_all_players__dbt_tmp" as (
    

with all_players as (
    select 
        player_id,
        season,
        player_name,
        team_code,
        'G' as position,
        null as games_played,
        null as points_per_game,
        null as shooting_percentage
    from "nhl"."silver"."stg_goalies"
    
    union all
    
    select 
        player_id,
        season,
        player_name,
        team_code,
        position,
        games_played,
        points_per_game,
        shooting_percentage
    from "nhl"."silver"."stg_skaters"
)

select *,
    case 
        when position = 'G' then 'Goalie'
        when position in ('C', 'L', 'R', 'LW', 'RW') then 'Forward'
        when position in ('D') then 'Defense'
        else 'Unknown'
    end as position_group,
    current_timestamp as loaded_at
from all_players
  );

[0m13:41:10.093341 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m13:41:10.095436 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m13:41:10.095670 [debug] [Thread-4  ]: On model.nhl_analytics.int_all_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */
alter view "nhl"."silver"."int_all_players" rename to "int_all_players__dbt_backup"
[0m13:41:10.096085 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m13:41:10.098732 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m13:41:10.098983 [debug] [Thread-4  ]: On model.nhl_analytics.int_all_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */
alter view "nhl"."silver"."int_all_players__dbt_tmp" rename to "int_all_players"
[0m13:41:10.099378 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m13:41:10.100106 [debug] [Thread-4  ]: On model.nhl_analytics.int_all_players: COMMIT
[0m13:41:10.100318 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m13:41:10.100533 [debug] [Thread-2  ]: SQL status: OK in 0.009 seconds
[0m13:41:10.100733 [debug] [Thread-4  ]: On model.nhl_analytics.int_all_players: COMMIT
[0m13:41:10.102498 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m13:41:10.102776 [debug] [Thread-2  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */
alter table "nhl"."silver"."mart_team_standings__dbt_tmp" rename to "mart_team_standings"
[0m13:41:10.103031 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m13:41:10.104725 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m13:41:10.104965 [debug] [Thread-2  ]: SQL status: OK in 0.002 seconds
[0m13:41:10.105177 [debug] [Thread-4  ]: On model.nhl_analytics.int_all_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */

      drop view if exists "nhl"."silver"."int_all_players__dbt_backup" cascade
    
[0m13:41:10.108046 [info ] [Thread-2  ]: Exporting mart_team_standings to silver folder
[0m13:41:10.108460 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m13:41:10.108693 [debug] [Thread-2  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

        COPY (
    SELECT *
    FROM "nhl"."silver"."mart_team_standings"
) TO '../data/silver/mart_team_standings.parquet' (FORMAT PARQUET);
      
[0m13:41:10.108913 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m13:41:10.109689 [debug] [Thread-4  ]: On model.nhl_analytics.int_all_players: Close
[0m13:41:10.110175 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '750a97b3-3ce2-4cae-9899-b70a01f61425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c587c0>]}
[0m13:41:10.110573 [info ] [Thread-4  ]: 4 of 7 OK created sql view model silver.int_all_players ........................ [[32mOK[0m in 0.04s]
[0m13:41:10.110901 [debug] [Thread-4  ]: Finished running node model.nhl_analytics.int_all_players
[0m13:41:10.111247 [debug] [Thread-1  ]: Began running node model.nhl_analytics.mart_goalie_performance
[0m13:41:10.111469 [debug] [Thread-3  ]: Began running node model.nhl_analytics.mart_player_performance
[0m13:41:10.111750 [info ] [Thread-1  ]: 6 of 7 START sql table model silver.mart_goalie_performance .................... [RUN]
[0m13:41:10.112056 [info ] [Thread-3  ]: 7 of 7 START sql table model silver.mart_player_performance .................... [RUN]
[0m13:41:10.112339 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.stg_goalies, now model.nhl_analytics.mart_goalie_performance)
[0m13:41:10.112543 [debug] [Thread-2  ]: SQL status: OK in 0.003 seconds
[0m13:41:10.112764 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.stg_teams, now model.nhl_analytics.mart_player_performance)
[0m13:41:10.112973 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.mart_goalie_performance
[0m13:41:10.113626 [debug] [Thread-2  ]: On model.nhl_analytics.mart_team_standings: COMMIT
[0m13:41:10.113867 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.mart_player_performance
[0m13:41:10.115904 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.mart_goalie_performance"
[0m13:41:10.116141 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m13:41:10.118049 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.mart_player_performance"
[0m13:41:10.118323 [debug] [Thread-2  ]: On model.nhl_analytics.mart_team_standings: COMMIT
[0m13:41:10.118693 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.mart_goalie_performance
[0m13:41:10.118916 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.mart_player_performance
[0m13:41:10.121192 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.mart_goalie_performance"
[0m13:41:10.123217 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.mart_player_performance"
[0m13:41:10.123445 [debug] [Thread-2  ]: SQL status: OK in 0.005 seconds
[0m13:41:10.125692 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m13:41:10.125928 [debug] [Thread-2  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

      drop table if exists "nhl"."silver"."mart_team_standings__dbt_backup" cascade
    
[0m13:41:10.126258 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m13:41:10.126502 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m13:41:10.126724 [debug] [Thread-1  ]: On model.nhl_analytics.mart_goalie_performance: BEGIN
[0m13:41:10.126926 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m13:41:10.127124 [debug] [Thread-3  ]: On model.nhl_analytics.mart_player_performance: BEGIN
[0m13:41:10.127330 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:41:10.128036 [debug] [Thread-2  ]: On model.nhl_analytics.mart_team_standings: Close
[0m13:41:10.128240 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:41:10.128713 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '750a97b3-3ce2-4cae-9899-b70a01f61425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b67640>]}
[0m13:41:10.128943 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m13:41:10.129316 [info ] [Thread-2  ]: 5 of 7 OK created sql table model silver.mart_team_standings ................... [[32mOK[0m in 0.06s]
[0m13:41:10.129559 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m13:41:10.129771 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m13:41:10.130063 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.mart_team_standings
[0m13:41:10.130266 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m13:41:10.130480 [debug] [Thread-1  ]: On model.nhl_analytics.mart_goalie_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */

  
    
    

    create  table
      "nhl"."silver"."mart_goalie_performance__dbt_tmp"
  
    as (
      

select 
    player_id,
    player_name,
    season,
    team_code,
    position,
    loaded_at
from "nhl"."silver"."int_all_players"
where position_group in ('Goalie')
    and games_played >= 10
    );
  
  
[0m13:41:10.130776 [debug] [Thread-3  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */

  
    
    

    create  table
      "nhl"."silver"."mart_player_performance__dbt_tmp"
  
    as (
      

select 
    player_id,
    player_name,
    team_code,
    position,
    position_group,
    games_played,
    points_per_game,
    shooting_percentage,
    case
        when points_per_game >= 1.0 then 'Elite'
        when points_per_game >= 0.7 then 'Very Good'
        when points_per_game >= 0.5 then 'Good'
        when points_per_game >= 0.3 then 'Average'
        else 'Below Average'
    end as offensive_rating,
    loaded_at
from "nhl"."silver"."int_all_players"
where position_group in ('Forward', 'Defense')
    and games_played >= 10
    );
  
  
[0m13:41:10.134822 [debug] [Thread-1  ]: SQL status: OK in 0.004 seconds
[0m13:41:10.136851 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m13:41:10.137102 [debug] [Thread-1  ]: On model.nhl_analytics.mart_goalie_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */
alter table "nhl"."silver"."mart_goalie_performance__dbt_tmp" rename to "mart_goalie_performance"
[0m13:41:10.137567 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m13:41:10.137789 [debug] [Thread-3  ]: SQL status: OK in 0.007 seconds
[0m13:41:10.139008 [info ] [Thread-1  ]: Exporting mart_goalie_performance to silver folder
[0m13:41:10.140906 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m13:41:10.141225 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m13:41:10.141459 [debug] [Thread-3  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */
alter table "nhl"."silver"."mart_player_performance__dbt_tmp" rename to "mart_player_performance"
[0m13:41:10.141683 [debug] [Thread-1  ]: On model.nhl_analytics.mart_goalie_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */

        COPY (
    SELECT *
    FROM "nhl"."silver"."mart_goalie_performance"
) TO '../data/silver/mart_goalie_performance.parquet' (FORMAT PARQUET);
      
[0m13:41:10.142071 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m13:41:10.143070 [info ] [Thread-3  ]: Exporting mart_player_performance to silver folder
[0m13:41:10.143386 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m13:41:10.143603 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m13:41:10.143816 [debug] [Thread-3  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */

        COPY (
    SELECT *
    FROM "nhl"."silver"."mart_player_performance"
) TO '../data/silver/mart_player_performance.parquet' (FORMAT PARQUET);
      
[0m13:41:10.144445 [debug] [Thread-1  ]: On model.nhl_analytics.mart_goalie_performance: COMMIT
[0m13:41:10.144783 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m13:41:10.144994 [debug] [Thread-1  ]: On model.nhl_analytics.mart_goalie_performance: COMMIT
[0m13:41:10.145380 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m13:41:10.146985 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m13:41:10.147202 [debug] [Thread-1  ]: On model.nhl_analytics.mart_goalie_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */

      drop table if exists "nhl"."silver"."mart_goalie_performance__dbt_backup" cascade
    
[0m13:41:10.147407 [debug] [Thread-3  ]: SQL status: OK in 0.003 seconds
[0m13:41:10.148053 [debug] [Thread-3  ]: On model.nhl_analytics.mart_player_performance: COMMIT
[0m13:41:10.148260 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m13:41:10.148457 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m13:41:10.148648 [debug] [Thread-3  ]: On model.nhl_analytics.mart_player_performance: COMMIT
[0m13:41:10.149319 [debug] [Thread-1  ]: On model.nhl_analytics.mart_goalie_performance: Close
[0m13:41:10.149715 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '750a97b3-3ce2-4cae-9899-b70a01f61425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10267d5e0>]}
[0m13:41:10.150107 [info ] [Thread-1  ]: 6 of 7 OK created sql table model silver.mart_goalie_performance ............... [[32mOK[0m in 0.04s]
[0m13:41:10.150434 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.mart_goalie_performance
[0m13:41:10.150673 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m13:41:10.152209 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m13:41:10.152424 [debug] [Thread-3  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */

      drop table if exists "nhl"."silver"."mart_player_performance__dbt_backup" cascade
    
[0m13:41:10.152741 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m13:41:10.153380 [debug] [Thread-3  ]: On model.nhl_analytics.mart_player_performance: Close
[0m13:41:10.153700 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '750a97b3-3ce2-4cae-9899-b70a01f61425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fca880>]}
[0m13:41:10.154054 [info ] [Thread-3  ]: 7 of 7 OK created sql table model silver.mart_player_performance ............... [[32mOK[0m in 0.04s]
[0m13:41:10.154368 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.mart_player_performance
[0m13:41:10.155141 [debug] [MainThread]: Using duckdb connection "master"
[0m13:41:10.155345 [debug] [MainThread]: On master: BEGIN
[0m13:41:10.155522 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:41:10.155893 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:41:10.156088 [debug] [MainThread]: On master: COMMIT
[0m13:41:10.156260 [debug] [MainThread]: Using duckdb connection "master"
[0m13:41:10.156417 [debug] [MainThread]: On master: COMMIT
[0m13:41:10.156656 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:41:10.156834 [debug] [MainThread]: On master: Close
[0m13:41:10.157062 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:41:10.157221 [debug] [MainThread]: Connection 'model.nhl_analytics.mart_goalie_performance' was properly closed.
[0m13:41:10.157374 [debug] [MainThread]: Connection 'model.nhl_analytics.mart_team_standings' was properly closed.
[0m13:41:10.157526 [debug] [MainThread]: Connection 'model.nhl_analytics.mart_player_performance' was properly closed.
[0m13:41:10.157676 [debug] [MainThread]: Connection 'model.nhl_analytics.int_all_players' was properly closed.
[0m13:41:10.157897 [info ] [MainThread]: 
[0m13:41:10.158091 [info ] [MainThread]: Finished running 3 table models, 4 view models in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m13:41:10.158842 [debug] [MainThread]: Command end result
[0m13:41:10.174441 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m13:41:10.175395 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m13:41:10.179250 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/run_results.json
[0m13:41:10.179453 [info ] [MainThread]: 
[0m13:41:10.179685 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:41:10.179875 [info ] [MainThread]: 
[0m13:41:10.180076 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m13:41:10.181148 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5293477, "process_in_blocks": "0", "process_kernel_time": 0.186301, "process_mem_max_rss": "160055296", "process_out_blocks": "0", "process_user_time": 2.084053}
[0m13:41:10.181371 [debug] [MainThread]: Command `python -m dbt.cli.main run` succeeded at 13:41:10.181327 after 1.53 seconds
[0m13:41:10.181588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047713a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d13e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b10460>]}
[0m13:41:10.181801 [debug] [MainThread]: Flushing usage events
[0m13:41:10.365731 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:43:30.209189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f072b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10708d490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10708d2b0>]}


============================== 13:43:30.212015 | 47478fd8-c39f-4840-9e3e-4d3db37d93df ==============================
[0m13:43:30.212015 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:43:30.212355 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir .', 'empty': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'version_check': 'True', 'target_path': 'None', 'warn_error': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'debug': 'False', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'use_colors': 'True'}
[0m13:43:30.419986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47478fd8-c39f-4840-9e3e-4d3db37d93df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104894b20>]}
[0m13:43:30.453659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47478fd8-c39f-4840-9e3e-4d3db37d93df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10702c4f0>]}
[0m13:43:30.455237 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m13:43:30.524076 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:43:30.613491 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:43:30.613710 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:43:30.647275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47478fd8-c39f-4840-9e3e-4d3db37d93df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076b8130>]}
[0m13:43:30.732637 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m13:43:30.733883 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m13:43:30.744350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47478fd8-c39f-4840-9e3e-4d3db37d93df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074bcf10>]}
[0m13:43:30.744676 [info ] [MainThread]: Found 7 models, 6 data tests, 4 sources, 445 macros
[0m13:43:30.744901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47478fd8-c39f-4840-9e3e-4d3db37d93df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076dcf70>]}
[0m13:43:30.745825 [info ] [MainThread]: 
[0m13:43:30.746039 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:43:30.746216 [info ] [MainThread]: 
[0m13:43:30.746511 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:43:30.749778 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl'
[0m13:43:30.781891 [debug] [ThreadPool]: Using duckdb connection "list_nhl"
[0m13:43:30.782124 [debug] [ThreadPool]: On list_nhl: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m13:43:30.782295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:30.824358 [debug] [ThreadPool]: SQL status: OK in 0.042 seconds
[0m13:43:30.825333 [debug] [ThreadPool]: On list_nhl: Close
[0m13:43:30.825741 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nhl, now create_nhl_silver)
[0m13:43:30.826018 [debug] [ThreadPool]: Creating schema "database: "nhl"
schema: "silver"
"
[0m13:43:30.830351 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:43:30.830549 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nhl'
        and type='sqlite'
    
  
[0m13:43:30.830715 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:30.831373 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:43:30.832238 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:43:30.832410 [debug] [ThreadPool]: On create_nhl_silver: BEGIN
[0m13:43:30.832669 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:43:30.832839 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:43:30.833003 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
    
        create schema if not exists "nhl"."silver"
    
[0m13:43:30.833565 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:43:30.834013 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m13:43:30.834178 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:43:30.834329 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m13:43:30.834563 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:43:30.834732 [debug] [ThreadPool]: On create_nhl_silver: Close
[0m13:43:30.835577 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nhl_silver, now list_nhl_silver)
[0m13:43:30.839281 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m13:43:30.839480 [debug] [ThreadPool]: On list_nhl_silver: BEGIN
[0m13:43:30.839642 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:30.839934 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:43:30.840108 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m13:43:30.840282 [debug] [ThreadPool]: On list_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl_silver"} */
select
      'nhl' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'silver'
    and lower(table_catalog) = 'nhl'
  
[0m13:43:30.848841 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m13:43:30.849747 [debug] [ThreadPool]: On list_nhl_silver: ROLLBACK
[0m13:43:30.850907 [debug] [ThreadPool]: Failed to rollback 'list_nhl_silver'
[0m13:43:30.851104 [debug] [ThreadPool]: On list_nhl_silver: Close
[0m13:43:30.851987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47478fd8-c39f-4840-9e3e-4d3db37d93df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c96940>]}
[0m13:43:30.852252 [debug] [MainThread]: Using duckdb connection "master"
[0m13:43:30.852438 [debug] [MainThread]: On master: BEGIN
[0m13:43:30.852594 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:43:30.852871 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:43:30.853041 [debug] [MainThread]: On master: COMMIT
[0m13:43:30.853205 [debug] [MainThread]: Using duckdb connection "master"
[0m13:43:30.853352 [debug] [MainThread]: On master: COMMIT
[0m13:43:30.853580 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:43:30.853749 [debug] [MainThread]: On master: Close
[0m13:43:30.855120 [debug] [Thread-1  ]: Began running node model.nhl_analytics.stg_goalies
[0m13:43:30.855370 [debug] [Thread-2  ]: Began running node model.nhl_analytics.stg_skaters
[0m13:43:30.855836 [debug] [Thread-3  ]: Began running node model.nhl_analytics.stg_teams
[0m13:43:30.855657 [info ] [Thread-1  ]: 1 of 7 START sql view model silver.stg_goalies ................................. [RUN]
[0m13:43:30.856111 [info ] [Thread-2  ]: 2 of 7 START sql view model silver.stg_skaters ................................. [RUN]
[0m13:43:30.856680 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_nhl_silver, now model.nhl_analytics.stg_goalies)
[0m13:43:30.856413 [info ] [Thread-3  ]: 3 of 7 START sql view model silver.stg_teams ................................... [RUN]
[0m13:43:30.857007 [debug] [Thread-2  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_skaters'
[0m13:43:30.857218 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.stg_goalies
[0m13:43:30.857468 [debug] [Thread-3  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_teams'
[0m13:43:30.857672 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.stg_skaters
[0m13:43:30.862846 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.stg_goalies"
[0m13:43:30.863100 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.stg_teams
[0m13:43:30.865354 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.stg_skaters"
[0m13:43:30.867263 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.stg_teams"
[0m13:43:30.867626 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.stg_goalies
[0m13:43:30.874125 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.stg_skaters
[0m13:43:30.887223 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.stg_teams
[0m13:43:30.896083 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.stg_skaters"
[0m13:43:30.898094 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.stg_teams"
[0m13:43:30.899305 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.stg_goalies"
[0m13:43:30.899742 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:43:30.899988 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: BEGIN
[0m13:43:30.900226 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:43:30.900471 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:43:30.900797 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:43:30.901018 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: BEGIN
[0m13:43:30.901238 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m13:43:30.901429 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: BEGIN
[0m13:43:30.901651 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:43:30.901857 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:43:30.902056 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:43:30.902341 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    

select
    playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    games_played,
    icetime as ice_time,
    I_F_goals as goals,
    I_F_points as points,
    I_F_shotsOnGoal as shots_on_goal,
    I_F_primaryAssists as primary_assists,
    I_F_secondaryAssists as secondary_assists,
    case 
        when games_played > 0 then true 
        else false 
    end as is_active_player,
    case 
        when games_played > 0 then round(I_F_points * 1.0 / games_played, 2)
        else null 
    end as points_per_game,
    case 
        when I_F_shotsOnGoal > 0 then round(I_F_goals * 100.0 / I_F_shotsOnGoal, 2)
        else null 
    end as shooting_percentage,
    current_timestamp as loaded_at
from "nhl"."bronze"."skaters"
where playerId is not null
    and season is not null
  );

[0m13:43:30.902615 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m13:43:30.902964 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m13:43:30.903159 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:43:30.903371 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:43:30.903592 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

  
  create view "nhl"."silver"."stg_teams__dbt_tmp" as (
    

select
    season,
    name as team_name,
    team as team_code,
    games_played,
    goalsFor,
    goalsAgainst,
    goalsFor - goalsAgainst as goal_differential,
    xGoalsFor,
    xGoalsAgainst,
    current_timestamp as loaded_at
from "nhl"."bronze"."teams"
where season is not null
    and name is not null
    and situation = 'all'
  );

[0m13:43:30.903820 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    

select 
    playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position
from "nhl"."bronze"."goalies"
where playerId is not null
    and season is not null
  );

[0m13:43:30.904205 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m13:43:30.907864 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:43:30.908095 [debug] [Thread-1  ]: SQL status: OK in 0.004 seconds
[0m13:43:30.908299 [debug] [Thread-3  ]: SQL status: OK in 0.004 seconds
[0m13:43:30.908504 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */
alter view "nhl"."silver"."stg_skaters" rename to "stg_skaters__dbt_backup"
[0m13:43:30.910368 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:43:30.912538 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:43:30.912984 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */
alter view "nhl"."silver"."stg_goalies" rename to "stg_goalies__dbt_backup"
[0m13:43:30.913212 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */
alter view "nhl"."silver"."stg_teams" rename to "stg_teams__dbt_backup"
[0m13:43:30.913424 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m13:43:30.915402 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:43:30.915633 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */
alter view "nhl"."silver"."stg_skaters__dbt_tmp" rename to "stg_skaters"
[0m13:43:30.915854 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m13:43:30.916054 [debug] [Thread-3  ]: SQL status: OK in 0.002 seconds
[0m13:43:30.917882 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:43:30.919715 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:43:30.919930 [debug] [Thread-2  ]: SQL status: OK in 0.004 seconds
[0m13:43:30.920134 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */
alter view "nhl"."silver"."stg_goalies__dbt_tmp" rename to "stg_goalies"
[0m13:43:30.920365 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */
alter view "nhl"."silver"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m13:43:30.927061 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: COMMIT
[0m13:43:30.927377 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:43:30.927597 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m13:43:30.927793 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: COMMIT
[0m13:43:30.927973 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m13:43:30.928620 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: COMMIT
[0m13:43:30.929451 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: COMMIT
[0m13:43:30.929679 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:43:30.929876 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m13:43:30.930072 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:43:30.930271 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: COMMIT
[0m13:43:30.933513 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:43:30.933732 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: COMMIT
[0m13:43:30.933988 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

      drop view if exists "nhl"."silver"."stg_skaters__dbt_backup" cascade
    
[0m13:43:30.934228 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m13:43:30.934503 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m13:43:30.936042 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:43:30.936248 [debug] [Thread-2  ]: SQL status: OK in 0.002 seconds
[0m13:43:30.938178 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:43:30.938391 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

      drop view if exists "nhl"."silver"."stg_goalies__dbt_backup" cascade
    
[0m13:43:30.939686 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: Close
[0m13:43:30.939898 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

      drop view if exists "nhl"."silver"."stg_teams__dbt_backup" cascade
    
[0m13:43:30.940735 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m13:43:30.941164 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m13:43:30.941847 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: Close
[0m13:43:30.942555 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: Close
[0m13:43:30.942920 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47478fd8-c39f-4840-9e3e-4d3db37d93df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104899e50>]}
[0m13:43:30.943117 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47478fd8-c39f-4840-9e3e-4d3db37d93df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bf6070>]}
[0m13:43:30.943405 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47478fd8-c39f-4840-9e3e-4d3db37d93df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bddbb0>]}
[0m13:43:30.943754 [info ] [Thread-2  ]: 2 of 7 OK created sql view model silver.stg_skaters ............................ [[32mOK[0m in 0.08s]
[0m13:43:30.944108 [info ] [Thread-3  ]: 3 of 7 OK created sql view model silver.stg_teams .............................. [[32mOK[0m in 0.09s]
[0m13:43:30.944693 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.stg_skaters
[0m13:43:30.944394 [info ] [Thread-1  ]: 1 of 7 OK created sql view model silver.stg_goalies ............................ [[32mOK[0m in 0.09s]
[0m13:43:30.945035 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.stg_teams
[0m13:43:30.945380 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.stg_goalies
[0m13:43:30.945680 [debug] [Thread-4  ]: Began running node model.nhl_analytics.mart_team_standings
[0m13:43:30.946174 [debug] [Thread-3  ]: Began running node model.nhl_analytics.int_all_players
[0m13:43:30.946000 [info ] [Thread-4  ]: 4 of 7 START sql table model silver.mart_team_standings ........................ [RUN]
[0m13:43:30.946500 [info ] [Thread-3  ]: 5 of 7 START sql view model silver.int_all_players ............................. [RUN]
[0m13:43:30.946812 [debug] [Thread-4  ]: Acquiring new duckdb connection 'model.nhl_analytics.mart_team_standings'
[0m13:43:30.947048 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.stg_teams, now model.nhl_analytics.int_all_players)
[0m13:43:30.947264 [debug] [Thread-4  ]: Began compiling node model.nhl_analytics.mart_team_standings
[0m13:43:30.947459 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.int_all_players
[0m13:43:30.949409 [debug] [Thread-4  ]: Writing injected SQL for node "model.nhl_analytics.mart_team_standings"
[0m13:43:30.951510 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.int_all_players"
[0m13:43:30.952089 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.int_all_players
[0m13:43:30.952479 [debug] [Thread-4  ]: Began executing node model.nhl_analytics.mart_team_standings
[0m13:43:30.954628 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.int_all_players"
[0m13:43:30.966690 [debug] [Thread-4  ]: Writing runtime sql for node "model.nhl_analytics.mart_team_standings"
[0m13:43:30.967108 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m13:43:30.967355 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m13:43:30.967573 [debug] [Thread-3  ]: On model.nhl_analytics.int_all_players: BEGIN
[0m13:43:30.967777 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: BEGIN
[0m13:43:30.967974 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:43:30.968170 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:43:30.968605 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m13:43:30.968811 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m13:43:30.969003 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m13:43:30.969222 [debug] [Thread-3  ]: On model.nhl_analytics.int_all_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */

  
  create view "nhl"."silver"."int_all_players__dbt_tmp" as (
    

with all_players as (
    select 
        player_id,
        season,
        player_name,
        team_code,
        'G' as position,
        null as games_played,
        null as points_per_game,
        null as shooting_percentage
    from "nhl"."silver"."stg_goalies"
    
    union all
    
    select 
        player_id,
        season,
        player_name,
        team_code,
        position,
        games_played,
        points_per_game,
        shooting_percentage
    from "nhl"."silver"."stg_skaters"
)

select *,
    case 
        when position = 'G' then 'Goalie'
        when position in ('C', 'L', 'R', 'LW', 'RW') then 'Forward'
        when position in ('D') then 'Defense'
        else 'Unknown'
    end as position_group,
    current_timestamp as loaded_at
from all_players
  );

[0m13:43:30.969450 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m13:43:30.969767 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

  
    
    

    create  table
      "nhl"."silver"."mart_team_standings__dbt_tmp"
  
    as (
      

select 
    season,
    team_name,
    team_code,
    games_played,
    goalsFor,
    goalsAgainst,
    goal_differential,
    xGoalsFor,
    xGoalsAgainst,
    row_number() over (
        order by goalsFor desc,
            goal_differential desc
    ) as standings_rank,
    loaded_at
from "nhl"."silver"."stg_teams"
order by standings_rank
    );
  
  
[0m13:43:30.970551 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m13:43:30.972567 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m13:43:30.972816 [debug] [Thread-3  ]: On model.nhl_analytics.int_all_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */
alter view "nhl"."silver"."int_all_players" rename to "int_all_players__dbt_backup"
[0m13:43:30.973201 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m13:43:30.975849 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m13:43:30.976084 [debug] [Thread-3  ]: On model.nhl_analytics.int_all_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */
alter view "nhl"."silver"."int_all_players__dbt_tmp" rename to "int_all_players"
[0m13:43:30.976459 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m13:43:30.977175 [debug] [Thread-3  ]: On model.nhl_analytics.int_all_players: COMMIT
[0m13:43:30.977403 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m13:43:30.977616 [debug] [Thread-3  ]: On model.nhl_analytics.int_all_players: COMMIT
[0m13:43:30.978019 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m13:43:30.978220 [debug] [Thread-4  ]: SQL status: OK in 0.008 seconds
[0m13:43:30.979820 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m13:43:30.982931 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m13:43:30.983157 [debug] [Thread-3  ]: On model.nhl_analytics.int_all_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */

      drop view if exists "nhl"."silver"."int_all_players__dbt_backup" cascade
    
[0m13:43:30.983376 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'silver'
      AND table_name = 'mart_team_standings'
  
[0m13:43:30.983761 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m13:43:30.984451 [debug] [Thread-3  ]: On model.nhl_analytics.int_all_players: Close
[0m13:43:30.984665 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m13:43:30.985009 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47478fd8-c39f-4840-9e3e-4d3db37d93df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c56dc0>]}
[0m13:43:30.985685 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m13:43:30.985958 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'silver'
      AND table_name = 'mart_team_standings'
  
[0m13:43:30.986270 [info ] [Thread-3  ]: 5 of 7 OK created sql view model silver.int_all_players ........................ [[32mOK[0m in 0.04s]
[0m13:43:30.986627 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.int_all_players
[0m13:43:30.986897 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m13:43:30.987185 [debug] [Thread-2  ]: Began running node model.nhl_analytics.mart_goalie_performance
[0m13:43:30.987404 [debug] [Thread-1  ]: Began running node model.nhl_analytics.mart_player_performance
[0m13:43:30.989303 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m13:43:30.989580 [info ] [Thread-2  ]: 6 of 7 START sql table model silver.mart_goalie_performance .................... [RUN]
[0m13:43:30.989888 [info ] [Thread-1  ]: 7 of 7 START sql table model silver.mart_player_performance .................... [RUN]
[0m13:43:30.990125 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */
alter table "nhl"."silver"."mart_team_standings" rename to "mart_team_standings__dbt_backup"
[0m13:43:30.990368 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.stg_skaters, now model.nhl_analytics.mart_goalie_performance)
[0m13:43:30.990599 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.stg_goalies, now model.nhl_analytics.mart_player_performance)
[0m13:43:30.990909 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.mart_goalie_performance
[0m13:43:30.991125 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.mart_player_performance
[0m13:43:30.991333 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m13:43:30.993286 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.mart_goalie_performance"
[0m13:43:30.995453 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.mart_player_performance"
[0m13:43:30.997271 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m13:43:30.997587 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */
alter table "nhl"."silver"."mart_team_standings__dbt_tmp" rename to "mart_team_standings"
[0m13:43:30.997937 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.mart_player_performance
[0m13:43:30.998170 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.mart_goalie_performance
[0m13:43:31.000304 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.mart_player_performance"
[0m13:43:31.000521 [debug] [Thread-4  ]: SQL status: OK in 0.003 seconds
[0m13:43:31.003237 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.mart_goalie_performance"
[0m13:43:31.006895 [info ] [Thread-4  ]: Exporting mart_team_standings to silver folder
[0m13:43:31.007234 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m13:43:31.007512 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m13:43:31.007732 [debug] [Thread-1  ]: On model.nhl_analytics.mart_player_performance: BEGIN
[0m13:43:31.007961 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

        COPY (
    SELECT *
    FROM "nhl"."silver"."mart_team_standings"
) TO '../data/silver/mart_team_standings.parquet' (FORMAT PARQUET);
      
[0m13:43:31.008183 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m13:43:31.008382 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:43:31.008663 [debug] [Thread-2  ]: On model.nhl_analytics.mart_goalie_performance: BEGIN
[0m13:43:31.008924 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:43:31.009167 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m13:43:31.009367 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m13:43:31.009567 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m13:43:31.009785 [debug] [Thread-1  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */

  
    
    

    create  table
      "nhl"."silver"."mart_player_performance__dbt_tmp"
  
    as (
      

select 
    player_id,
    player_name,
    team_code,
    position,
    position_group,
    games_played,
    points_per_game,
    shooting_percentage,
    case
        when points_per_game >= 1.0 then 'Elite'
        when points_per_game >= 0.7 then 'Very Good'
        when points_per_game >= 0.5 then 'Good'
        when points_per_game >= 0.3 then 'Average'
        else 'Below Average'
    end as offensive_rating,
    loaded_at
from "nhl"."silver"."int_all_players"
where position_group in ('Forward', 'Defense')
    and games_played >= 10
    );
  
  
[0m13:43:31.010006 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m13:43:31.010320 [debug] [Thread-2  ]: On model.nhl_analytics.mart_goalie_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */

  
    
    

    create  table
      "nhl"."silver"."mart_goalie_performance__dbt_tmp"
  
    as (
      

select 
    player_id,
    player_name,
    season,
    team_code,
    position,
    loaded_at
from "nhl"."silver"."int_all_players"
where position_group in ('Goalie')
    and games_played >= 10
    );
  
  
[0m13:43:31.011783 [debug] [Thread-4  ]: SQL status: OK in 0.003 seconds
[0m13:43:31.012495 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: COMMIT
[0m13:43:31.012714 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m13:43:31.012935 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: COMMIT
[0m13:43:31.013767 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m13:43:31.015530 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m13:43:31.015771 [debug] [Thread-2  ]: SQL status: OK in 0.005 seconds
[0m13:43:31.016003 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

      drop table if exists "nhl"."silver"."mart_team_standings__dbt_backup" cascade
    
[0m13:43:31.016602 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m13:43:31.016917 [debug] [Thread-2  ]: On model.nhl_analytics.mart_goalie_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'silver'
      AND table_name = 'mart_goalie_performance'
  
[0m13:43:31.017264 [debug] [Thread-1  ]: SQL status: OK in 0.007 seconds
[0m13:43:31.017475 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m13:43:31.018039 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m13:43:31.018251 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m13:43:31.018983 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: Close
[0m13:43:31.019209 [debug] [Thread-1  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'silver'
      AND table_name = 'mart_player_performance'
  
[0m13:43:31.019901 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m13:43:31.020251 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47478fd8-c39f-4840-9e3e-4d3db37d93df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d65f10>]}
[0m13:43:31.022750 [debug] [Thread-2  ]: On model.nhl_analytics.mart_goalie_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'silver'
      AND table_name = 'mart_goalie_performance'
  
[0m13:43:31.023359 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m13:43:31.023184 [info ] [Thread-4  ]: 4 of 7 OK created sql table model silver.mart_team_standings ................... [[32mOK[0m in 0.07s]
[0m13:43:31.024159 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m13:43:31.024453 [debug] [Thread-4  ]: Finished running node model.nhl_analytics.mart_team_standings
[0m13:43:31.024677 [debug] [Thread-1  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'silver'
      AND table_name = 'mart_player_performance'
  
[0m13:43:31.024892 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m13:43:31.027063 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m13:43:31.027292 [debug] [Thread-2  ]: On model.nhl_analytics.mart_goalie_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */
alter table "nhl"."silver"."mart_goalie_performance" rename to "mart_goalie_performance__dbt_backup"
[0m13:43:31.027498 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m13:43:31.029458 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m13:43:31.029692 [debug] [Thread-1  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */
alter table "nhl"."silver"."mart_player_performance" rename to "mart_player_performance__dbt_backup"
[0m13:43:31.029920 [debug] [Thread-2  ]: SQL status: OK in 0.002 seconds
[0m13:43:31.031752 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m13:43:31.031962 [debug] [Thread-2  ]: On model.nhl_analytics.mart_goalie_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */
alter table "nhl"."silver"."mart_goalie_performance__dbt_tmp" rename to "mart_goalie_performance"
[0m13:43:31.032167 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m13:43:31.033951 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m13:43:31.034165 [debug] [Thread-1  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */
alter table "nhl"."silver"."mart_player_performance__dbt_tmp" rename to "mart_player_performance"
[0m13:43:31.034369 [debug] [Thread-2  ]: SQL status: OK in 0.002 seconds
[0m13:43:31.035450 [info ] [Thread-2  ]: Exporting mart_goalie_performance to silver folder
[0m13:43:31.035768 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m13:43:31.035992 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m13:43:31.036200 [debug] [Thread-2  ]: On model.nhl_analytics.mart_goalie_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */

        COPY (
    SELECT *
    FROM "nhl"."silver"."mart_goalie_performance"
) TO '../data/silver/mart_goalie_performance.parquet' (FORMAT PARQUET);
      
[0m13:43:31.037235 [info ] [Thread-1  ]: Exporting mart_player_performance to silver folder
[0m13:43:31.037678 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m13:43:31.037927 [debug] [Thread-1  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */

        COPY (
    SELECT *
    FROM "nhl"."silver"."mart_player_performance"
) TO '../data/silver/mart_player_performance.parquet' (FORMAT PARQUET);
      
[0m13:43:31.038248 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m13:43:31.039022 [debug] [Thread-2  ]: On model.nhl_analytics.mart_goalie_performance: COMMIT
[0m13:43:31.039246 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m13:43:31.039453 [debug] [Thread-2  ]: On model.nhl_analytics.mart_goalie_performance: COMMIT
[0m13:43:31.039845 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m13:43:31.042122 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m13:43:31.042337 [debug] [Thread-1  ]: SQL status: OK in 0.004 seconds
[0m13:43:31.042549 [debug] [Thread-2  ]: On model.nhl_analytics.mart_goalie_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */

      drop table if exists "nhl"."silver"."mart_goalie_performance__dbt_backup" cascade
    
[0m13:43:31.043208 [debug] [Thread-1  ]: On model.nhl_analytics.mart_player_performance: COMMIT
[0m13:43:31.043472 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m13:43:31.043676 [debug] [Thread-1  ]: On model.nhl_analytics.mart_player_performance: COMMIT
[0m13:43:31.043878 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m13:43:31.044610 [debug] [Thread-2  ]: On model.nhl_analytics.mart_goalie_performance: Close
[0m13:43:31.044971 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47478fd8-c39f-4840-9e3e-4d3db37d93df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104899e50>]}
[0m13:43:31.045235 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m13:43:31.046798 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m13:43:31.047305 [debug] [Thread-1  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */

      drop table if exists "nhl"."silver"."mart_player_performance__dbt_backup" cascade
    
[0m13:43:31.047118 [info ] [Thread-2  ]: 6 of 7 OK created sql table model silver.mart_goalie_performance ............... [[32mOK[0m in 0.05s]
[0m13:43:31.047746 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.mart_goalie_performance
[0m13:43:31.048073 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m13:43:31.048713 [debug] [Thread-1  ]: On model.nhl_analytics.mart_player_performance: Close
[0m13:43:31.048992 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47478fd8-c39f-4840-9e3e-4d3db37d93df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d7ec10>]}
[0m13:43:31.049301 [info ] [Thread-1  ]: 7 of 7 OK created sql table model silver.mart_player_performance ............... [[32mOK[0m in 0.06s]
[0m13:43:31.049605 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.mart_player_performance
[0m13:43:31.050184 [debug] [MainThread]: Using duckdb connection "master"
[0m13:43:31.050363 [debug] [MainThread]: On master: BEGIN
[0m13:43:31.050514 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:43:31.050788 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:43:31.050954 [debug] [MainThread]: On master: COMMIT
[0m13:43:31.051130 [debug] [MainThread]: Using duckdb connection "master"
[0m13:43:31.051290 [debug] [MainThread]: On master: COMMIT
[0m13:43:31.051515 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:43:31.051707 [debug] [MainThread]: On master: Close
[0m13:43:31.051931 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:43:31.052162 [debug] [MainThread]: Connection 'model.nhl_analytics.mart_player_performance' was properly closed.
[0m13:43:31.052334 [debug] [MainThread]: Connection 'model.nhl_analytics.mart_goalie_performance' was properly closed.
[0m13:43:31.052496 [debug] [MainThread]: Connection 'model.nhl_analytics.int_all_players' was properly closed.
[0m13:43:31.052652 [debug] [MainThread]: Connection 'model.nhl_analytics.mart_team_standings' was properly closed.
[0m13:43:31.052875 [info ] [MainThread]: 
[0m13:43:31.053071 [info ] [MainThread]: Finished running 3 table models, 4 view models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m13:43:31.054065 [debug] [MainThread]: Command end result
[0m13:43:31.069021 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m13:43:31.069986 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m13:43:31.074061 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/run_results.json
[0m13:43:31.074253 [info ] [MainThread]: 
[0m13:43:31.074483 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:43:31.074671 [info ] [MainThread]: 
[0m13:43:31.074865 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m13:43:31.075816 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9071784, "process_in_blocks": "0", "process_kernel_time": 0.20216, "process_mem_max_rss": "156254208", "process_out_blocks": "0", "process_user_time": 1.442387}
[0m13:43:31.076026 [debug] [MainThread]: Command `python -m dbt.cli.main run` succeeded at 13:43:31.075987 after 0.91 seconds
[0m13:43:31.076225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f072b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105934f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076e4b20>]}
[0m13:43:31.076426 [debug] [MainThread]: Flushing usage events
[0m13:43:31.328316 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:55:20.299027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f34370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090be550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090be370>]}


============================== 13:55:20.303271 | 665c60fe-02fc-4710-a3dc-a0113f25f755 ==============================
[0m13:55:20.303271 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:55:20.303710 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select stg_goalies --profiles-dir .', 'use_experimental_parser': 'False', 'warn_error': 'None', 'no_print': 'None', 'profiles_dir': '.', 'printer_width': '80', 'cache_selected_only': 'False', 'introspect': 'True', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'partial_parse': 'True', 'debug': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'log_format': 'default', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'version_check': 'True'}
[0m13:55:20.478923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '665c60fe-02fc-4710-a3dc-a0113f25f755', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068c5700>]}
[0m13:55:20.512793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '665c60fe-02fc-4710-a3dc-a0113f25f755', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109185f70>]}
[0m13:55:20.514086 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m13:55:20.585731 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:55:20.682569 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:55:20.682834 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:55:20.718627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '665c60fe-02fc-4710-a3dc-a0113f25f755', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a91ff40>]}
[0m13:55:20.814035 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m13:55:20.815381 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m13:55:20.825653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '665c60fe-02fc-4710-a3dc-a0113f25f755', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8d3820>]}
[0m13:55:20.825964 [info ] [MainThread]: Found 7 models, 6 data tests, 4 sources, 445 macros
[0m13:55:20.826188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '665c60fe-02fc-4710-a3dc-a0113f25f755', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a933880>]}
[0m13:55:20.826875 [info ] [MainThread]: 
[0m13:55:20.827084 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:55:20.827264 [info ] [MainThread]: 
[0m13:55:20.827550 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:55:20.828031 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl'
[0m13:55:20.861354 [debug] [ThreadPool]: Using duckdb connection "list_nhl"
[0m13:55:20.861621 [debug] [ThreadPool]: On list_nhl: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m13:55:20.861792 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:20.905581 [debug] [ThreadPool]: SQL status: OK in 0.044 seconds
[0m13:55:20.906641 [debug] [ThreadPool]: On list_nhl: Close
[0m13:55:20.907067 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nhl, now create_nhl_silver)
[0m13:55:20.907348 [debug] [ThreadPool]: Creating schema "database: "nhl"
schema: "silver"
"
[0m13:55:20.911605 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:55:20.911806 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nhl'
        and type='sqlite'
    
  
[0m13:55:20.911982 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:20.912665 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:55:20.913652 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:55:20.913860 [debug] [ThreadPool]: On create_nhl_silver: BEGIN
[0m13:55:20.914178 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:55:20.914397 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:55:20.914570 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
    
        create schema if not exists "nhl"."silver"
    
[0m13:55:20.915002 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:55:20.915467 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m13:55:20.915632 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:55:20.915783 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m13:55:20.916040 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:55:20.916236 [debug] [ThreadPool]: On create_nhl_silver: Close
[0m13:55:20.919548 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nhl_silver, now list_nhl_silver)
[0m13:55:20.922947 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m13:55:20.923136 [debug] [ThreadPool]: On list_nhl_silver: BEGIN
[0m13:55:20.923293 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:20.923576 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:55:20.923745 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m13:55:20.923915 [debug] [ThreadPool]: On list_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl_silver"} */
select
      'nhl' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'silver'
    and lower(table_catalog) = 'nhl'
  
[0m13:55:20.933671 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m13:55:20.934563 [debug] [ThreadPool]: On list_nhl_silver: ROLLBACK
[0m13:55:20.935749 [debug] [ThreadPool]: Failed to rollback 'list_nhl_silver'
[0m13:55:20.935919 [debug] [ThreadPool]: On list_nhl_silver: Close
[0m13:55:20.936830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '665c60fe-02fc-4710-a3dc-a0113f25f755', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095c6cd0>]}
[0m13:55:20.937091 [debug] [MainThread]: Using duckdb connection "master"
[0m13:55:20.937253 [debug] [MainThread]: On master: BEGIN
[0m13:55:20.937403 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:55:20.937677 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:55:20.937847 [debug] [MainThread]: On master: COMMIT
[0m13:55:20.938005 [debug] [MainThread]: Using duckdb connection "master"
[0m13:55:20.938167 [debug] [MainThread]: On master: COMMIT
[0m13:55:20.938397 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:55:20.938571 [debug] [MainThread]: On master: Close
[0m13:55:20.939967 [debug] [Thread-1  ]: Began running node model.nhl_analytics.stg_goalies
[0m13:55:20.940260 [info ] [Thread-1  ]: 1 of 1 START sql view model silver.stg_goalies ................................. [RUN]
[0m13:55:20.940516 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_nhl_silver, now model.nhl_analytics.stg_goalies)
[0m13:55:20.940721 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.stg_goalies
[0m13:55:20.945865 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.stg_goalies"
[0m13:55:20.946264 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.stg_goalies
[0m13:55:20.964909 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.stg_goalies"
[0m13:55:20.965482 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:55:20.965730 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: BEGIN
[0m13:55:20.965938 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:55:20.966317 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m13:55:20.966503 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:55:20.966696 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    

select 
    playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position
from "nhl"."bronze"."goalies"
where playerId is not null
    and season is not null
  );

[0m13:55:20.967107 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m13:55:20.970762 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:55:20.970973 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */
alter view "nhl"."silver"."stg_goalies" rename to "stg_goalies__dbt_backup"
[0m13:55:20.971633 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m13:55:20.973451 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:55:20.973666 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */
alter view "nhl"."silver"."stg_goalies__dbt_tmp" rename to "stg_goalies"
[0m13:55:20.974000 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m13:55:20.980945 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: COMMIT
[0m13:55:20.981164 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:55:20.981355 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: COMMIT
[0m13:55:20.982301 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m13:55:20.985570 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:55:20.985790 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

      drop view if exists "nhl"."silver"."stg_goalies__dbt_backup" cascade
    
[0m13:55:20.986445 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m13:55:20.987784 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: Close
[0m13:55:20.988916 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '665c60fe-02fc-4710-a3dc-a0113f25f755', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068c8f10>]}
[0m13:55:20.989274 [info ] [Thread-1  ]: 1 of 1 OK created sql view model silver.stg_goalies ............................ [[32mOK[0m in 0.05s]
[0m13:55:20.989606 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.stg_goalies
[0m13:55:20.990207 [debug] [MainThread]: Using duckdb connection "master"
[0m13:55:20.990415 [debug] [MainThread]: On master: BEGIN
[0m13:55:20.990579 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:55:20.990864 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:55:20.991044 [debug] [MainThread]: On master: COMMIT
[0m13:55:20.991200 [debug] [MainThread]: Using duckdb connection "master"
[0m13:55:20.991351 [debug] [MainThread]: On master: COMMIT
[0m13:55:20.991583 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:55:20.991749 [debug] [MainThread]: On master: Close
[0m13:55:20.991949 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:55:20.992094 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_goalies' was properly closed.
[0m13:55:20.992250 [info ] [MainThread]: 
[0m13:55:20.992438 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m13:55:20.992802 [debug] [MainThread]: Command end result
[0m13:55:21.008523 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m13:55:21.009479 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m13:55:21.013225 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/run_results.json
[0m13:55:21.013421 [info ] [MainThread]: 
[0m13:55:21.013659 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:55:21.013840 [info ] [MainThread]: 
[0m13:55:21.014032 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:55:21.015281 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8160813, "process_in_blocks": "0", "process_kernel_time": 0.189035, "process_mem_max_rss": "143310848", "process_out_blocks": "0", "process_user_time": 1.310198}
[0m13:55:21.015491 [debug] [MainThread]: Command `python -m dbt.cli.main run` succeeded at 13:55:21.015449 after 0.82 seconds
[0m13:55:21.015691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f34370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107954640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095c67c0>]}
[0m13:55:21.015893 [debug] [MainThread]: Flushing usage events
[0m13:55:21.264356 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:56:55.033002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103afe310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c845b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c843d0>]}


============================== 13:56:55.035754 | f8dcae24-cd8e-4e14-be2d-152139f78514 ==============================
[0m13:56:55.035754 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:56:55.036098 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'log_cache_events': 'False', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'no_print': 'None', 'target_path': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'quiet': 'False', 'log_format': 'default', 'use_colors': 'True', 'version_check': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt run --profiles-dir .', 'profiles_dir': '.', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'cache_selected_only': 'False', 'empty': 'False'}
[0m13:56:55.210066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8dcae24-cd8e-4e14-be2d-152139f78514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10248c580>]}
[0m13:56:55.245259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8dcae24-cd8e-4e14-be2d-152139f78514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e3afd0>]}
[0m13:56:55.246991 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m13:56:55.325789 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:56:55.415069 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:56:55.415301 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:56:55.448558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8dcae24-cd8e-4e14-be2d-152139f78514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052b0130>]}
[0m13:56:55.534321 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m13:56:55.535645 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m13:56:55.546274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8dcae24-cd8e-4e14-be2d-152139f78514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105275b50>]}
[0m13:56:55.546579 [info ] [MainThread]: Found 7 models, 6 data tests, 4 sources, 445 macros
[0m13:56:55.546795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8dcae24-cd8e-4e14-be2d-152139f78514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105247160>]}
[0m13:56:55.547735 [info ] [MainThread]: 
[0m13:56:55.547949 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:56:55.548129 [info ] [MainThread]: 
[0m13:56:55.548408 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:56:55.551616 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl'
[0m13:56:55.583608 [debug] [ThreadPool]: Using duckdb connection "list_nhl"
[0m13:56:55.583839 [debug] [ThreadPool]: On list_nhl: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m13:56:55.584011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:55.624867 [debug] [ThreadPool]: SQL status: OK in 0.041 seconds
[0m13:56:55.625821 [debug] [ThreadPool]: On list_nhl: Close
[0m13:56:55.626230 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nhl, now create_nhl_silver)
[0m13:56:55.626496 [debug] [ThreadPool]: Creating schema "database: "nhl"
schema: "silver"
"
[0m13:56:55.630759 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:56:55.630968 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nhl'
        and type='sqlite'
    
  
[0m13:56:55.631138 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:55.631785 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:56:55.632632 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:56:55.632812 [debug] [ThreadPool]: On create_nhl_silver: BEGIN
[0m13:56:55.633079 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:56:55.633253 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:56:55.633417 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
    
        create schema if not exists "nhl"."silver"
    
[0m13:56:55.633704 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:56:55.634168 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m13:56:55.634334 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m13:56:55.634487 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m13:56:55.634727 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:56:55.634904 [debug] [ThreadPool]: On create_nhl_silver: Close
[0m13:56:55.635725 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nhl_silver, now list_nhl_silver)
[0m13:56:55.639228 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m13:56:55.639407 [debug] [ThreadPool]: On list_nhl_silver: BEGIN
[0m13:56:55.639561 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:55.639834 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:56:55.640004 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m13:56:55.640174 [debug] [ThreadPool]: On list_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl_silver"} */
select
      'nhl' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'silver'
    and lower(table_catalog) = 'nhl'
  
[0m13:56:55.649515 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m13:56:55.650273 [debug] [ThreadPool]: On list_nhl_silver: ROLLBACK
[0m13:56:55.651465 [debug] [ThreadPool]: Failed to rollback 'list_nhl_silver'
[0m13:56:55.651657 [debug] [ThreadPool]: On list_nhl_silver: Close
[0m13:56:55.652551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8dcae24-cd8e-4e14-be2d-152139f78514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103db1dc0>]}
[0m13:56:55.652807 [debug] [MainThread]: Using duckdb connection "master"
[0m13:56:55.652969 [debug] [MainThread]: On master: BEGIN
[0m13:56:55.653117 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:56:55.653390 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:56:55.653559 [debug] [MainThread]: On master: COMMIT
[0m13:56:55.653717 [debug] [MainThread]: Using duckdb connection "master"
[0m13:56:55.653871 [debug] [MainThread]: On master: COMMIT
[0m13:56:55.654097 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:56:55.654272 [debug] [MainThread]: On master: Close
[0m13:56:55.655638 [debug] [Thread-1  ]: Began running node model.nhl_analytics.stg_goalies
[0m13:56:55.655878 [debug] [Thread-2  ]: Began running node model.nhl_analytics.stg_skaters
[0m13:56:55.656351 [debug] [Thread-3  ]: Began running node model.nhl_analytics.stg_teams
[0m13:56:55.656172 [info ] [Thread-1  ]: 1 of 7 START sql view model silver.stg_goalies ................................. [RUN]
[0m13:56:55.656676 [info ] [Thread-2  ]: 2 of 7 START sql view model silver.stg_skaters ................................. [RUN]
[0m13:56:55.656987 [info ] [Thread-3  ]: 3 of 7 START sql view model silver.stg_teams ................................... [RUN]
[0m13:56:55.657260 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_nhl_silver, now model.nhl_analytics.stg_goalies)
[0m13:56:55.657534 [debug] [Thread-2  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_skaters'
[0m13:56:55.657792 [debug] [Thread-3  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_teams'
[0m13:56:55.658000 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.stg_goalies
[0m13:56:55.658198 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.stg_skaters
[0m13:56:55.658396 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.stg_teams
[0m13:56:55.663640 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.stg_goalies"
[0m13:56:55.666072 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.stg_skaters"
[0m13:56:55.667913 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.stg_teams"
[0m13:56:55.668405 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.stg_goalies
[0m13:56:55.668633 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.stg_teams
[0m13:56:55.668830 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.stg_skaters
[0m13:56:55.689456 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.stg_goalies"
[0m13:56:55.690717 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.stg_teams"
[0m13:56:55.692703 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.stg_skaters"
[0m13:56:55.693193 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:56:55.693407 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: BEGIN
[0m13:56:55.693652 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:56:55.693850 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:56:55.694065 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: BEGIN
[0m13:56:55.694285 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:56:55.694592 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:55.694807 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: BEGIN
[0m13:56:55.695005 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m13:56:55.695271 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:56:55.695486 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:56:55.695684 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m13:56:55.695955 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

  
  create view "nhl"."silver"."stg_teams__dbt_tmp" as (
    

select
    season,
    name as team_name,
    team as team_code,
    games_played,
    goalsFor,
    goalsAgainst,
    goalsFor - goalsAgainst as goal_differential,
    xGoalsFor,
    xGoalsAgainst,
    current_timestamp as loaded_at
from "nhl"."bronze"."teams"
where season is not null
    and name is not null
    and situation = 'all'
  );

[0m13:56:55.696170 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:56:55.696370 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m13:56:55.696639 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    

select 
    playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position
from "nhl"."bronze"."goalies"
where playerId is not null
    and season is not null
  );

[0m13:56:55.696859 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:56:55.697148 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    

select
    playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    games_played,
    icetime as ice_time,
    I_F_goals as goals,
    I_F_points as points,
    I_F_shotsOnGoal as shots_on_goal,
    I_F_primaryAssists as primary_assists,
    I_F_secondaryAssists as secondary_assists,
    case 
        when games_played > 0 then true 
        else false 
    end as is_active_player,
    case 
        when games_played > 0 then round(I_F_points * 1.0 / games_played, 2)
        else null 
    end as points_per_game,
    case 
        when I_F_shotsOnGoal > 0 then round(I_F_goals * 100.0 / I_F_shotsOnGoal, 2)
        else null 
    end as shooting_percentage,
    current_timestamp as loaded_at
from "nhl"."bronze"."skaters"
where playerId is not null
    and season is not null
  );

[0m13:56:55.697506 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m13:56:55.701214 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:56:55.701444 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */
alter view "nhl"."silver"."stg_goalies" rename to "stg_goalies__dbt_backup"
[0m13:56:55.701662 [debug] [Thread-3  ]: SQL status: OK in 0.005 seconds
[0m13:56:55.701892 [debug] [Thread-2  ]: SQL status: OK in 0.005 seconds
[0m13:56:55.703868 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:56:55.706045 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:56:55.706260 [debug] [Thread-1  ]: SQL status: OK in 0.004 seconds
[0m13:56:55.706464 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */
alter view "nhl"."silver"."stg_teams" rename to "stg_teams__dbt_backup"
[0m13:56:55.706673 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */
alter view "nhl"."silver"."stg_skaters" rename to "stg_skaters__dbt_backup"
[0m13:56:55.708439 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:56:55.708795 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */
alter view "nhl"."silver"."stg_goalies__dbt_tmp" rename to "stg_goalies"
[0m13:56:55.709045 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m13:56:55.709254 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m13:56:55.711048 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:56:55.712769 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:56:55.712975 [debug] [Thread-1  ]: SQL status: OK in 0.004 seconds
[0m13:56:55.713179 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */
alter view "nhl"."silver"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m13:56:55.713394 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */
alter view "nhl"."silver"."stg_skaters__dbt_tmp" rename to "stg_skaters"
[0m13:56:55.720218 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: COMMIT
[0m13:56:55.720531 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m13:56:55.720745 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:56:55.721426 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: COMMIT
[0m13:56:55.721640 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m13:56:55.721846 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: COMMIT
[0m13:56:55.722044 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:56:55.722726 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: COMMIT
[0m13:56:55.723000 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: COMMIT
[0m13:56:55.723223 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:56:55.723525 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: COMMIT
[0m13:56:55.723789 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m13:56:55.727033 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m13:56:55.727254 [debug] [Thread-1  ]: SQL status: OK in 0.004 seconds
[0m13:56:55.727460 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

      drop view if exists "nhl"."silver"."stg_teams__dbt_backup" cascade
    
[0m13:56:55.727672 [debug] [Thread-2  ]: SQL status: OK in 0.004 seconds
[0m13:56:55.729151 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m13:56:55.731481 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m13:56:55.731712 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

      drop view if exists "nhl"."silver"."stg_goalies__dbt_backup" cascade
    
[0m13:56:55.731921 [debug] [Thread-3  ]: SQL status: OK in 0.003 seconds
[0m13:56:55.732132 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

      drop view if exists "nhl"."silver"."stg_skaters__dbt_backup" cascade
    
[0m13:56:55.733499 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: Close
[0m13:56:55.734154 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m13:56:55.734833 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: Close
[0m13:56:55.735052 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m13:56:55.736161 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: Close
[0m13:56:55.736687 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8dcae24-cd8e-4e14-be2d-152139f78514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dbb730>]}
[0m13:56:55.736897 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8dcae24-cd8e-4e14-be2d-152139f78514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057cc1f0>]}
[0m13:56:55.737128 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8dcae24-cd8e-4e14-be2d-152139f78514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056856a0>]}
[0m13:56:55.737484 [info ] [Thread-3  ]: 3 of 7 OK created sql view model silver.stg_teams .............................. [[32mOK[0m in 0.08s]
[0m13:56:55.737744 [info ] [Thread-2  ]: 2 of 7 OK created sql view model silver.stg_skaters ............................ [[32mOK[0m in 0.08s]
[0m13:56:55.738430 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.stg_teams
[0m13:56:55.738165 [info ] [Thread-1  ]: 1 of 7 OK created sql view model silver.stg_goalies ............................ [[32mOK[0m in 0.08s]
[0m13:56:55.738775 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.stg_skaters
[0m13:56:55.739129 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.stg_goalies
[0m13:56:55.739372 [debug] [Thread-4  ]: Began running node model.nhl_analytics.mart_team_standings
[0m13:56:55.739755 [info ] [Thread-4  ]: 4 of 7 START sql table model silver.mart_team_standings ........................ [RUN]
[0m13:56:55.740054 [debug] [Thread-3  ]: Began running node model.nhl_analytics.int_all_players
[0m13:56:55.740325 [debug] [Thread-4  ]: Acquiring new duckdb connection 'model.nhl_analytics.mart_team_standings'
[0m13:56:55.740761 [debug] [Thread-4  ]: Began compiling node model.nhl_analytics.mart_team_standings
[0m13:56:55.740585 [info ] [Thread-3  ]: 5 of 7 START sql view model silver.int_all_players ............................. [RUN]
[0m13:56:55.742765 [debug] [Thread-4  ]: Writing injected SQL for node "model.nhl_analytics.mart_team_standings"
[0m13:56:55.743021 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.stg_teams, now model.nhl_analytics.int_all_players)
[0m13:56:55.743279 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.int_all_players
[0m13:56:55.745432 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.int_all_players"
[0m13:56:55.745750 [debug] [Thread-4  ]: Began executing node model.nhl_analytics.mart_team_standings
[0m13:56:55.758754 [debug] [Thread-4  ]: Writing runtime sql for node "model.nhl_analytics.mart_team_standings"
[0m13:56:55.759022 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.int_all_players
[0m13:56:55.761106 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.int_all_players"
[0m13:56:55.761469 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m13:56:55.761710 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m13:56:55.761912 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: BEGIN
[0m13:56:55.762115 [debug] [Thread-3  ]: On model.nhl_analytics.int_all_players: BEGIN
[0m13:56:55.762308 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:56:55.762502 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:56:55.762922 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m13:56:55.763149 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m13:56:55.763344 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m13:56:55.763561 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

  
    
    

    create  table
      "nhl"."silver"."mart_team_standings__dbt_tmp"
  
    as (
      

select 
    season,
    team_name,
    team_code,
    games_played,
    goalsFor,
    goalsAgainst,
    goal_differential,
    xGoalsFor,
    xGoalsAgainst,
    row_number() over (
        order by goalsFor desc,
            goal_differential desc
    ) as standings_rank,
    loaded_at
from "nhl"."silver"."stg_teams"
order by standings_rank
    );
  
  
[0m13:56:55.763791 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m13:56:55.764127 [debug] [Thread-3  ]: On model.nhl_analytics.int_all_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */

  
  create view "nhl"."silver"."int_all_players__dbt_tmp" as (
    

with all_players as (
    select 
        player_id,
        season,
        player_name,
        team_code,
        'G' as position,
        null as games_played,
        null as points_per_game,
        null as shooting_percentage
    from "nhl"."silver"."stg_goalies"
    
    union all
    
    select 
        player_id,
        season,
        player_name,
        team_code,
        position,
        games_played,
        points_per_game,
        shooting_percentage
    from "nhl"."silver"."stg_skaters"
)

select *,
    case 
        when position = 'G' then 'Goalie'
        when position in ('C', 'L', 'R', 'LW', 'RW') then 'Forward'
        when position in ('D') then 'Defense'
        else 'Unknown'
    end as position_group,
    current_timestamp as loaded_at
from all_players
  );

[0m13:56:55.765236 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m13:56:55.767266 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m13:56:55.767521 [debug] [Thread-3  ]: On model.nhl_analytics.int_all_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */
alter view "nhl"."silver"."int_all_players" rename to "int_all_players__dbt_backup"
[0m13:56:55.767916 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m13:56:55.769881 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m13:56:55.770119 [debug] [Thread-3  ]: On model.nhl_analytics.int_all_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */
alter view "nhl"."silver"."int_all_players__dbt_tmp" rename to "int_all_players"
[0m13:56:55.770490 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m13:56:55.771214 [debug] [Thread-3  ]: On model.nhl_analytics.int_all_players: COMMIT
[0m13:56:55.771429 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m13:56:55.771630 [debug] [Thread-3  ]: On model.nhl_analytics.int_all_players: COMMIT
[0m13:56:55.771867 [debug] [Thread-4  ]: SQL status: OK in 0.008 seconds
[0m13:56:55.775696 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m13:56:55.775911 [debug] [Thread-3  ]: SQL status: OK in 0.004 seconds
[0m13:56:55.776112 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'silver'
      AND table_name = 'mart_team_standings'
  
[0m13:56:55.777623 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m13:56:55.777895 [debug] [Thread-3  ]: On model.nhl_analytics.int_all_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */

      drop view if exists "nhl"."silver"."int_all_players__dbt_backup" cascade
    
[0m13:56:55.778147 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m13:56:55.778821 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m13:56:55.779021 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m13:56:55.779218 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'silver'
      AND table_name = 'mart_team_standings'
  
[0m13:56:55.779879 [debug] [Thread-3  ]: On model.nhl_analytics.int_all_players: Close
[0m13:56:55.780268 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8dcae24-cd8e-4e14-be2d-152139f78514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043c5b20>]}
[0m13:56:55.780882 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m13:56:55.780695 [info ] [Thread-3  ]: 5 of 7 OK created sql view model silver.int_all_players ........................ [[32mOK[0m in 0.04s]
[0m13:56:55.781273 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.int_all_players
[0m13:56:55.783138 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m13:56:55.783427 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */
alter table "nhl"."silver"."mart_team_standings" rename to "mart_team_standings__dbt_backup"
[0m13:56:55.783711 [debug] [Thread-1  ]: Began running node model.nhl_analytics.mart_goalie_performance
[0m13:56:55.783956 [debug] [Thread-2  ]: Began running node model.nhl_analytics.mart_player_performance
[0m13:56:55.784230 [info ] [Thread-1  ]: 6 of 7 START sql table model silver.mart_goalie_performance .................... [RUN]
[0m13:56:55.784464 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m13:56:55.784713 [info ] [Thread-2  ]: 7 of 7 START sql table model silver.mart_player_performance .................... [RUN]
[0m13:56:55.784985 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.stg_goalies, now model.nhl_analytics.mart_goalie_performance)
[0m13:56:55.786862 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m13:56:55.787103 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.stg_skaters, now model.nhl_analytics.mart_player_performance)
[0m13:56:55.787337 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.mart_goalie_performance
[0m13:56:55.787577 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */
alter table "nhl"."silver"."mart_team_standings__dbt_tmp" rename to "mart_team_standings"
[0m13:56:55.787817 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.mart_player_performance
[0m13:56:55.789666 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.mart_goalie_performance"
[0m13:56:55.791637 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.mart_player_performance"
[0m13:56:55.791889 [debug] [Thread-4  ]: SQL status: OK in 0.002 seconds
[0m13:56:55.795552 [info ] [Thread-4  ]: Exporting mart_team_standings to silver folder
[0m13:56:55.795911 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m13:56:55.796153 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

        COPY (
    SELECT *
    FROM "nhl"."silver"."mart_team_standings"
) TO '../data/silver/mart_team_standings.parquet' (FORMAT PARQUET);
      
[0m13:56:55.796373 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.mart_player_performance
[0m13:56:55.798795 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.mart_player_performance"
[0m13:56:55.799034 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.mart_goalie_performance
[0m13:56:55.802021 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.mart_goalie_performance"
[0m13:56:55.802354 [debug] [Thread-4  ]: SQL status: OK in 0.006 seconds
[0m13:56:55.802616 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m13:56:55.803337 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: COMMIT
[0m13:56:55.803578 [debug] [Thread-2  ]: On model.nhl_analytics.mart_player_performance: BEGIN
[0m13:56:55.803821 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m13:56:55.804016 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m13:56:55.804218 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:56:55.804425 [debug] [Thread-1  ]: On model.nhl_analytics.mart_goalie_performance: BEGIN
[0m13:56:55.804638 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: COMMIT
[0m13:56:55.804931 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:55.805232 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m13:56:55.805438 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m13:56:55.805663 [debug] [Thread-2  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */

  
    
    

    create  table
      "nhl"."silver"."mart_player_performance__dbt_tmp"
  
    as (
      

select 
    player_id,
    player_name,
    team_code,
    position,
    position_group,
    games_played,
    points_per_game,
    shooting_percentage,
    case
        when points_per_game >= 1.0 then 'Elite'
        when points_per_game >= 0.7 then 'Very Good'
        when points_per_game >= 0.5 then 'Good'
        when points_per_game >= 0.3 then 'Average'
        else 'Below Average'
    end as offensive_rating,
    loaded_at
from "nhl"."silver"."int_all_players"
where position_group in ('Forward', 'Defense')
    and games_played >= 10
    );
  
  
[0m13:56:55.805891 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m13:56:55.806092 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m13:56:55.807743 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m13:56:55.807966 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m13:56:55.808194 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

      drop table if exists "nhl"."silver"."mart_team_standings__dbt_backup" cascade
    
[0m13:56:55.808440 [debug] [Thread-1  ]: On model.nhl_analytics.mart_goalie_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */

  
    
    

    create  table
      "nhl"."silver"."mart_goalie_performance__dbt_tmp"
  
    as (
      

select 
    player_id,
    player_name,
    season,
    team_code,
    position,
    loaded_at
from "nhl"."silver"."int_all_players"
where position_group in ('Goalie')
    and games_played >= 10
    );
  
  
[0m13:56:55.808888 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m13:56:55.809619 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: Close
[0m13:56:55.809972 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8dcae24-cd8e-4e14-be2d-152139f78514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105763ca0>]}
[0m13:56:55.810347 [info ] [Thread-4  ]: 4 of 7 OK created sql table model silver.mart_team_standings ................... [[32mOK[0m in 0.07s]
[0m13:56:55.810671 [debug] [Thread-4  ]: Finished running node model.nhl_analytics.mart_team_standings
[0m13:56:55.811086 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m13:56:55.811680 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m13:56:55.811906 [debug] [Thread-1  ]: On model.nhl_analytics.mart_goalie_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'silver'
      AND table_name = 'mart_goalie_performance'
  
[0m13:56:55.812432 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m13:56:55.813142 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m13:56:55.813378 [debug] [Thread-1  ]: On model.nhl_analytics.mart_goalie_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'silver'
      AND table_name = 'mart_goalie_performance'
  
[0m13:56:55.813601 [debug] [Thread-2  ]: SQL status: OK in 0.007 seconds
[0m13:56:55.814316 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m13:56:55.814538 [debug] [Thread-2  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'silver'
      AND table_name = 'mart_player_performance'
  
[0m13:56:55.814746 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m13:56:55.817054 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m13:56:55.817385 [debug] [Thread-1  ]: On model.nhl_analytics.mart_goalie_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */
alter table "nhl"."silver"."mart_goalie_performance" rename to "mart_goalie_performance__dbt_backup"
[0m13:56:55.817599 [debug] [Thread-2  ]: SQL status: OK in 0.003 seconds
[0m13:56:55.818346 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m13:56:55.818566 [debug] [Thread-2  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'silver'
      AND table_name = 'mart_player_performance'
  
[0m13:56:55.818782 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m13:56:55.820712 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m13:56:55.820929 [debug] [Thread-1  ]: On model.nhl_analytics.mart_goalie_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */
alter table "nhl"."silver"."mart_goalie_performance__dbt_tmp" rename to "mart_goalie_performance"
[0m13:56:55.821132 [debug] [Thread-2  ]: SQL status: OK in 0.002 seconds
[0m13:56:55.823090 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m13:56:55.823316 [debug] [Thread-2  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */
alter table "nhl"."silver"."mart_player_performance" rename to "mart_player_performance__dbt_backup"
[0m13:56:55.823515 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m13:56:55.824546 [info ] [Thread-1  ]: Exporting mart_goalie_performance to silver folder
[0m13:56:55.824857 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m13:56:55.825056 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m13:56:55.825260 [debug] [Thread-1  ]: On model.nhl_analytics.mart_goalie_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */

        COPY (
    SELECT *
    FROM "nhl"."silver"."mart_goalie_performance"
) TO '../data/silver/mart_goalie_performance.parquet' (FORMAT PARQUET);
      
[0m13:56:55.826968 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m13:56:55.827240 [debug] [Thread-2  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */
alter table "nhl"."silver"."mart_player_performance__dbt_tmp" rename to "mart_player_performance"
[0m13:56:55.827621 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m13:56:55.828593 [info ] [Thread-2  ]: Exporting mart_player_performance to silver folder
[0m13:56:55.828831 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m13:56:55.829080 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m13:56:55.829723 [debug] [Thread-1  ]: On model.nhl_analytics.mart_goalie_performance: COMMIT
[0m13:56:55.829931 [debug] [Thread-2  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */

        COPY (
    SELECT *
    FROM "nhl"."silver"."mart_player_performance"
) TO '../data/silver/mart_player_performance.parquet' (FORMAT PARQUET);
      
[0m13:56:55.830219 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m13:56:55.830527 [debug] [Thread-1  ]: On model.nhl_analytics.mart_goalie_performance: COMMIT
[0m13:56:55.830917 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m13:56:55.833707 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m13:56:55.833948 [debug] [Thread-1  ]: On model.nhl_analytics.mart_goalie_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */

      drop table if exists "nhl"."silver"."mart_goalie_performance__dbt_backup" cascade
    
[0m13:56:55.834165 [debug] [Thread-2  ]: SQL status: OK in 0.004 seconds
[0m13:56:55.834911 [debug] [Thread-2  ]: On model.nhl_analytics.mart_player_performance: COMMIT
[0m13:56:55.835122 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m13:56:55.835335 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m13:56:55.835530 [debug] [Thread-2  ]: On model.nhl_analytics.mart_player_performance: COMMIT
[0m13:56:55.836216 [debug] [Thread-1  ]: On model.nhl_analytics.mart_goalie_performance: Close
[0m13:56:55.836620 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8dcae24-cd8e-4e14-be2d-152139f78514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105925b50>]}
[0m13:56:55.837013 [info ] [Thread-1  ]: 6 of 7 OK created sql table model silver.mart_goalie_performance ............... [[32mOK[0m in 0.05s]
[0m13:56:55.837338 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.mart_goalie_performance
[0m13:56:55.837600 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m13:56:55.839114 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m13:56:55.839335 [debug] [Thread-2  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */

      drop table if exists "nhl"."silver"."mart_player_performance__dbt_backup" cascade
    
[0m13:56:55.839758 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m13:56:55.840436 [debug] [Thread-2  ]: On model.nhl_analytics.mart_player_performance: Close
[0m13:56:55.840746 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8dcae24-cd8e-4e14-be2d-152139f78514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dbb730>]}
[0m13:56:55.841061 [info ] [Thread-2  ]: 7 of 7 OK created sql table model silver.mart_player_performance ............... [[32mOK[0m in 0.05s]
[0m13:56:55.841365 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.mart_player_performance
[0m13:56:55.842000 [debug] [MainThread]: Using duckdb connection "master"
[0m13:56:55.842173 [debug] [MainThread]: On master: BEGIN
[0m13:56:55.842325 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:56:55.842656 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:56:55.842853 [debug] [MainThread]: On master: COMMIT
[0m13:56:55.843021 [debug] [MainThread]: Using duckdb connection "master"
[0m13:56:55.843177 [debug] [MainThread]: On master: COMMIT
[0m13:56:55.843430 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:56:55.843607 [debug] [MainThread]: On master: Close
[0m13:56:55.843811 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:56:55.843977 [debug] [MainThread]: Connection 'model.nhl_analytics.mart_goalie_performance' was properly closed.
[0m13:56:55.844129 [debug] [MainThread]: Connection 'model.nhl_analytics.mart_player_performance' was properly closed.
[0m13:56:55.844266 [debug] [MainThread]: Connection 'model.nhl_analytics.int_all_players' was properly closed.
[0m13:56:55.844402 [debug] [MainThread]: Connection 'model.nhl_analytics.mart_team_standings' was properly closed.
[0m13:56:55.844608 [info ] [MainThread]: 
[0m13:56:55.844792 [info ] [MainThread]: Finished running 3 table models, 4 view models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m13:56:55.845516 [debug] [MainThread]: Command end result
[0m13:56:55.860464 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m13:56:55.861384 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m13:56:55.865422 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/run_results.json
[0m13:56:55.865627 [info ] [MainThread]: 
[0m13:56:55.865856 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:56:55.866041 [info ] [MainThread]: 
[0m13:56:55.866267 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m13:56:55.867588 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8763473, "process_in_blocks": "0", "process_kernel_time": 0.192505, "process_mem_max_rss": "154845184", "process_out_blocks": "0", "process_user_time": 1.440644}
[0m13:56:55.867820 [debug] [MainThread]: Command `python -m dbt.cli.main run` succeeded at 13:56:55.867775 after 0.88 seconds
[0m13:56:55.868036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103afe310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10248c580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105275b50>]}
[0m13:56:55.868252 [debug] [MainThread]: Flushing usage events
[0m13:56:56.136163 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:01:40.875656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112831340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143b8460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143b8280>]}


============================== 14:01:40.879144 | c41d13fd-e063-47ec-ab98-d0cac6ba4914 ==============================
[0m14:01:40.879144 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:01:40.879510 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'version_check': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'debug': 'False', 'target_path': 'None', 'profiles_dir': '.', 'partial_parse': 'True', 'warn_error': 'None', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir .', 'empty': 'False', 'static_parser': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'introspect': 'True'}
[0m14:01:41.065021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c41d13fd-e063-47ec-ab98-d0cac6ba4914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114480fd0>]}
[0m14:01:41.107478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c41d13fd-e063-47ec-ab98-d0cac6ba4914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113270fd0>]}
[0m14:01:41.108985 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m14:01:41.213942 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:01:41.312554 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:01:41.313026 [debug] [MainThread]: Partial parsing: updated file: nhl_analytics://models/staging/stg_goalies.sql
[0m14:01:41.313294 [debug] [MainThread]: Partial parsing: updated file: nhl_analytics://models/staging/stg_skaters.sql
[0m14:01:41.513406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c41d13fd-e063-47ec-ab98-d0cac6ba4914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11473f9a0>]}
[0m14:01:41.580434 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m14:01:41.582201 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m14:01:41.593372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c41d13fd-e063-47ec-ab98-d0cac6ba4914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115151820>]}
[0m14:01:41.593745 [info ] [MainThread]: Found 7 models, 6 data tests, 4 sources, 445 macros
[0m14:01:41.593974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c41d13fd-e063-47ec-ab98-d0cac6ba4914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115163f70>]}
[0m14:01:41.594932 [info ] [MainThread]: 
[0m14:01:41.595155 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:01:41.595339 [info ] [MainThread]: 
[0m14:01:41.595634 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:01:41.598994 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl'
[0m14:01:41.632930 [debug] [ThreadPool]: Using duckdb connection "list_nhl"
[0m14:01:41.633215 [debug] [ThreadPool]: On list_nhl: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m14:01:41.633405 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:01:41.641768 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m14:01:41.642010 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m14:01:41.642491 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:01:41.642695 [debug] [MainThread]: Connection 'list_nhl' was properly closed.
[0m14:01:41.642877 [info ] [MainThread]: 
[0m14:01:41.643087 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.05 seconds (0.05s).
[0m14:01:41.643391 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/../nhl.duckdb": Conflicting lock is held in /opt/homebrew/Cellar/duckdb/1.4.1/bin/duckdb (PID 58506) by user izaakford. See also https://duckdb.org/docs/stable/connect/concurrency
[0m14:01:41.644334 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.81647277, "process_in_blocks": "0", "process_kernel_time": 0.177576, "process_mem_max_rss": "134791168", "process_out_blocks": "0", "process_user_time": 1.328963}
[0m14:01:41.644573 [debug] [MainThread]: Command `python -m dbt.cli.main run` failed at 14:01:41.644526 after 0.82 seconds
[0m14:01:41.644786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112831340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115163f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1153bd070>]}
[0m14:01:41.645011 [debug] [MainThread]: Flushing usage events
[0m14:01:41.895950 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:03:01.406790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107db33a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f39490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f392b0>]}


============================== 14:03:01.409759 | 485e4a84-46d4-454f-bc02-9cb06d013058 ==============================
[0m14:03:01.409759 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:03:01.410113 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'log_format': 'default', 'empty': 'None', 'introspect': 'True', 'version_check': 'True', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'use_experimental_parser': 'False', 'static_parser': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '.', 'printer_width': '80', 'partial_parse': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'log_cache_events': 'False', 'invocation_command': 'dbt clean --profiles-dir .', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'debug': 'False', 'use_colors': 'True', 'quiet': 'False'}
[0m14:03:01.482803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '485e4a84-46d4-454f-bc02-9cb06d013058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10805bc70>]}
[0m14:03:01.494700 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.13044387, "process_in_blocks": "0", "process_kernel_time": 0.097219, "process_mem_max_rss": "99368960", "process_out_blocks": "0", "process_user_time": 0.7833}
[0m14:03:01.494956 [debug] [MainThread]: Command `python -m dbt.cli.main clean` succeeded at 14:03:01.494902 after 0.13 seconds
[0m14:03:01.495163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107db33a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090a2430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109011160>]}
[0m14:03:01.495370 [debug] [MainThread]: Flushing usage events
[0m14:03:01.749669 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:03:08.997402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105399340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106738460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106738280>]}


============================== 14:03:08.999678 | 5ce425ca-cf2e-4f68-9190-ed06accbfd62 ==============================
[0m14:03:08.999678 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:03:09.000014 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'target_path': 'None', 'printer_width': '80', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '.', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'write_json': 'True', 'empty': 'False', 'introspect': 'True', 'static_parser': 'True', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'log_format': 'default', 'log_cache_events': 'False', 'invocation_command': 'dbt run --profiles-dir .', 'partial_parse': 'True', 'warn_error': 'None'}
[0m14:03:09.159130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ce425ca-cf2e-4f68-9190-ed06accbfd62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067cc550>]}
[0m14:03:09.193053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ce425ca-cf2e-4f68-9190-ed06accbfd62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106776d90>]}
[0m14:03:09.194920 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m14:03:09.264935 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:03:09.265430 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:03:09.265671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5ce425ca-cf2e-4f68-9190-ed06accbfd62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10669ccd0>]}
[0m14:03:09.840178 [info ] [MainThread]: Exporting mart_goalie_performance to silver folder
[0m14:03:09.843868 [info ] [MainThread]: Exporting mart_player_performance to silver folder
[0m14:03:09.847617 [info ] [MainThread]: Exporting mart_team_standings to silver folder
[0m14:03:10.048779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ce425ca-cf2e-4f68-9190-ed06accbfd62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076a9130>]}
[0m14:03:10.136147 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m14:03:10.137605 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m14:03:10.145933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ce425ca-cf2e-4f68-9190-ed06accbfd62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d36610>]}
[0m14:03:10.146236 [info ] [MainThread]: Found 7 models, 6 data tests, 4 sources, 445 macros
[0m14:03:10.146451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ce425ca-cf2e-4f68-9190-ed06accbfd62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107669fd0>]}
[0m14:03:10.147374 [info ] [MainThread]: 
[0m14:03:10.147592 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:03:10.147770 [info ] [MainThread]: 
[0m14:03:10.148054 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:03:10.151389 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl'
[0m14:03:10.183668 [debug] [ThreadPool]: Using duckdb connection "list_nhl"
[0m14:03:10.183924 [debug] [ThreadPool]: On list_nhl: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m14:03:10.184113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:03:10.191409 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m14:03:10.191616 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m14:03:10.192022 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:03:10.192217 [debug] [MainThread]: Connection 'list_nhl' was properly closed.
[0m14:03:10.192388 [info ] [MainThread]: 
[0m14:03:10.192590 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.04 seconds (0.04s).
[0m14:03:10.192879 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/../nhl.duckdb": Conflicting lock is held in /opt/homebrew/Cellar/duckdb/1.4.1/bin/duckdb (PID 59999) by user izaakford. See also https://duckdb.org/docs/stable/connect/concurrency
[0m14:03:10.193706 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2366058, "process_in_blocks": "0", "process_kernel_time": 0.143732, "process_mem_max_rss": "137216000", "process_out_blocks": "0", "process_user_time": 1.786306}
[0m14:03:10.193922 [debug] [MainThread]: Command `python -m dbt.cli.main run` failed at 14:03:10.193879 after 1.24 seconds
[0m14:03:10.194121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105399340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10764fd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10752d5b0>]}
[0m14:03:10.194330 [debug] [MainThread]: Flushing usage events
[0m14:03:10.352084 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:03:55.575621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e21370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fa8490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fa82b0>]}


============================== 14:03:55.578621 | 4bb6cfc3-99b9-441b-ad92-cf2bc623bdbb ==============================
[0m14:03:55.578621 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:03:55.578977 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'invocation_command': 'dbt clean --profiles-dir .', 'cache_selected_only': 'False', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'no_print': 'None', 'partial_parse': 'True', 'empty': 'None', 'write_json': 'True', 'debug': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'static_parser': 'True', 'warn_error': 'None', 'target_path': 'None', 'version_check': 'True', 'profiles_dir': '.', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'indirect_selection': 'eager', 'quiet': 'False'}
[0m14:03:55.652020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4bb6cfc3-99b9-441b-ad92-cf2bc623bdbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078a06a0>]}
[0m14:03:55.661674 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.12876303, "process_in_blocks": "0", "process_kernel_time": 0.088924, "process_mem_max_rss": "99926016", "process_out_blocks": "0", "process_user_time": 0.796733}
[0m14:03:55.661927 [debug] [MainThread]: Command `python -m dbt.cli.main clean` succeeded at 14:03:55.661871 after 0.13 seconds
[0m14:03:55.662131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e21370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10904a160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078a06a0>]}
[0m14:03:55.662344 [debug] [MainThread]: Flushing usage events
[0m14:03:55.973257 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:04:00.915521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108131340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095b8460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095b8280>]}


============================== 14:04:00.917722 | b6de2998-815d-4dc3-ab54-d98b93b94c01 ==============================
[0m14:04:00.917722 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:04:00.918072 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'version_check': 'True', 'empty': 'False', 'quiet': 'False', 'printer_width': '80', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '.', 'debug': 'False', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'partial_parse': 'True', 'write_json': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir .', 'log_cache_events': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'use_colors': 'True'}
[0m14:04:01.073518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6de2998-815d-4dc3-ab54-d98b93b94c01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069b9a60>]}
[0m14:04:01.107133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6de2998-815d-4dc3-ab54-d98b93b94c01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c70fd0>]}
[0m14:04:01.108621 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m14:04:01.178205 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:04:01.178674 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:01.178918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b6de2998-815d-4dc3-ab54-d98b93b94c01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b79dc0>]}
[0m14:04:01.748293 [info ] [MainThread]: Exporting mart_goalie_performance to silver folder
[0m14:04:01.752138 [info ] [MainThread]: Exporting mart_player_performance to silver folder
[0m14:04:01.755961 [info ] [MainThread]: Exporting mart_team_standings to silver folder
[0m14:04:01.956282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6de2998-815d-4dc3-ab54-d98b93b94c01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a427130>]}
[0m14:04:02.042690 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m14:04:02.044046 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m14:04:02.054299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6de2998-815d-4dc3-ab54-d98b93b94c01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4ba8b0>]}
[0m14:04:02.054615 [info ] [MainThread]: Found 7 models, 6 data tests, 4 sources, 445 macros
[0m14:04:02.054837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6de2998-815d-4dc3-ab54-d98b93b94c01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2818e0>]}
[0m14:04:02.055744 [info ] [MainThread]: 
[0m14:04:02.055959 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:04:02.056135 [info ] [MainThread]: 
[0m14:04:02.056418 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:04:02.059574 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl'
[0m14:04:02.090744 [debug] [ThreadPool]: Using duckdb connection "list_nhl"
[0m14:04:02.090983 [debug] [ThreadPool]: On list_nhl: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m14:04:02.091160 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:02.123512 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m14:04:02.124304 [debug] [ThreadPool]: On list_nhl: Close
[0m14:04:02.124689 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nhl, now create_nhl_silver)
[0m14:04:02.124951 [debug] [ThreadPool]: Creating schema "database: "nhl"
schema: "silver"
"
[0m14:04:02.129106 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:04:02.129296 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nhl'
        and type='sqlite'
    
  
[0m14:04:02.129462 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:02.130051 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:04:02.130719 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:04:02.130884 [debug] [ThreadPool]: On create_nhl_silver: BEGIN
[0m14:04:02.131133 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:04:02.131303 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:04:02.131470 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
    
        create schema if not exists "nhl"."silver"
    
[0m14:04:02.131737 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:04:02.132182 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m14:04:02.132346 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:04:02.132495 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m14:04:02.132727 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:04:02.132897 [debug] [ThreadPool]: On create_nhl_silver: Close
[0m14:04:02.133718 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nhl_silver, now list_nhl_silver)
[0m14:04:02.137049 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m14:04:02.137234 [debug] [ThreadPool]: On list_nhl_silver: BEGIN
[0m14:04:02.137392 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:02.137679 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:04:02.137855 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m14:04:02.138029 [debug] [ThreadPool]: On list_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl_silver"} */
select
      'nhl' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'silver'
    and lower(table_catalog) = 'nhl'
  
[0m14:04:02.146716 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:04:02.147597 [debug] [ThreadPool]: On list_nhl_silver: ROLLBACK
[0m14:04:02.148731 [debug] [ThreadPool]: Failed to rollback 'list_nhl_silver'
[0m14:04:02.148920 [debug] [ThreadPool]: On list_nhl_silver: Close
[0m14:04:02.149728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6de2998-815d-4dc3-ab54-d98b93b94c01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0c9460>]}
[0m14:04:02.149997 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:02.150165 [debug] [MainThread]: On master: BEGIN
[0m14:04:02.150316 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:02.150586 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:04:02.150757 [debug] [MainThread]: On master: COMMIT
[0m14:04:02.150925 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:02.151077 [debug] [MainThread]: On master: COMMIT
[0m14:04:02.151307 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:04:02.151476 [debug] [MainThread]: On master: Close
[0m14:04:02.152882 [debug] [Thread-1  ]: Began running node model.nhl_analytics.stg_goalies
[0m14:04:02.153119 [debug] [Thread-2  ]: Began running node model.nhl_analytics.stg_skaters
[0m14:04:02.153579 [debug] [Thread-3  ]: Began running node model.nhl_analytics.stg_teams
[0m14:04:02.153410 [info ] [Thread-1  ]: 1 of 7 START sql view model silver.stg_goalies ................................. [RUN]
[0m14:04:02.153902 [info ] [Thread-2  ]: 2 of 7 START sql view model silver.stg_skaters ................................. [RUN]
[0m14:04:02.154186 [info ] [Thread-3  ]: 3 of 7 START sql view model silver.stg_teams ................................... [RUN]
[0m14:04:02.154469 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_nhl_silver, now model.nhl_analytics.stg_goalies)
[0m14:04:02.154747 [debug] [Thread-2  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_skaters'
[0m14:04:02.155000 [debug] [Thread-3  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_teams'
[0m14:04:02.155203 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.stg_goalies
[0m14:04:02.155407 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.stg_skaters
[0m14:04:02.155600 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.stg_teams
[0m14:04:02.159962 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.stg_goalies"
[0m14:04:02.161422 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.stg_skaters"
[0m14:04:02.163528 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.stg_teams"
[0m14:04:02.164150 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.stg_skaters
[0m14:04:02.170409 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.stg_goalies
[0m14:04:02.170628 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.stg_teams
[0m14:04:02.183999 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.stg_skaters"
[0m14:04:02.186006 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.stg_goalies"
[0m14:04:02.187964 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.stg_teams"
[0m14:04:02.188639 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m14:04:02.188879 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:04:02.189114 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m14:04:02.189318 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: BEGIN
[0m14:04:02.189522 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: BEGIN
[0m14:04:02.189718 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: BEGIN
[0m14:04:02.189920 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:04:02.190105 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:04:02.190300 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:04:02.190795 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m14:04:02.191022 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m14:04:02.191229 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:04:02.191437 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m14:04:02.191672 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m14:04:02.191909 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

  
  create view "nhl"."silver"."stg_teams__dbt_tmp" as (
    

select
    season,
    name as team_name,
    team as team_code,
    games_played,
    goalsFor,
    goalsAgainst,
    goalsFor - goalsAgainst as goal_differential,
    xGoalsFor,
    xGoalsAgainst,
    current_timestamp as loaded_at
from "nhl"."bronze"."teams"
where season is not null
    and name is not null
    and situation = 'all'
  );

[0m14:04:02.192146 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m14:04:02.192398 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position
from { { source('bronze', 'goalies') } }
where playerId is not null
    and season is not null
    and situation = 'all'
  );

[0m14:04:02.192753 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    games_played,
    icetime as ice_time,
    I_F_goals as goals,
    I_F_points as points,
    I_F_shotsOnGoal as shots_on_goal,
    I_F_primaryAssists as primary_assists,
    I_F_secondaryAssists as secondary_assists,
    case
        when games_played > 0 then true
        else false
    end as is_active_player,
    case
        when games_played > 0 then round(I_F_points * 1.0 / games_played, 2)
        else null
    end as points_per_game,
    case
        when I_F_shotsOnGoal > 0 then round(I_F_goals * 100.0 / I_F_shotsOnGoal, 2)
        else null
    end as shooting_percentage,
    current_timestamp as loaded_at
from { { source('bronze', 'skaters') } }
where playerId is not null
    and season is not null
    and situation = 'all'
  );

[0m14:04:02.194859 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position
from { { source('bronze', 'goalies') } }
where playerId is not null
    and season is not null
    and situation = 'all'
  );

[0m14:04:02.195276 [debug] [Thread-2  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    games_played,
    icetime as ice_time,
    I_F_goals as goals,
    I_F_points as points,
    I_F_shotsOnGoal as shots_on_goal,
    I_F_primaryAssists as primary_assists,
    I_F_secondaryAssists as secondary_assists,
    case
        when games_played > 0 then true
        else false
    end as is_active_player,
    case
        when games_played > 0 then round(I_F_points * 1.0 / games_played, 2)
        else null
    end as points_per_game,
    case
        when I_F_shotsOnGoal > 0 then round(I_F_goals * 100.0 / I_F_shotsOnGoal, 2)
        else null
    end as shooting_percentage,
    current_timestamp as loaded_at
from { { source('bronze', 'skaters') } }
where playerId is not null
    and season is not null
    and situation = 'all'
  );

[0m14:04:02.195516 [debug] [Thread-3  ]: SQL status: OK in 0.003 seconds
[0m14:04:02.195714 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m14:04:02.195920 [debug] [Thread-2  ]: DuckDB adapter: Rolling back transaction.
[0m14:04:02.199663 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:04:02.199950 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: ROLLBACK
[0m14:04:02.200219 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: ROLLBACK
[0m14:04:02.200433 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */
alter view "nhl"."silver"."stg_teams" rename to "stg_teams__dbt_backup"
[0m14:04:02.203692 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m14:04:02.205608 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:04:02.205847 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */
alter view "nhl"."silver"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m14:04:02.208630 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m14:04:02.216111 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: COMMIT
[0m14:04:02.216383 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:04:02.218419 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: COMMIT
[0m14:04:02.219784 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m14:04:02.223063 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:04:02.223687 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

      drop view if exists "nhl"."silver"."stg_teams__dbt_backup" cascade
    
[0m14:04:02.224539 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m14:04:02.225952 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: Close
[0m14:04:02.232134 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6de2998-815d-4dc3-ab54-d98b93b94c01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dc3280>]}
[0m14:04:02.234119 [info ] [Thread-3  ]: 3 of 7 OK created sql view model silver.stg_teams .............................. [[32mOK[0m in 0.07s]
[0m14:04:02.234503 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.stg_teams
[0m14:04:02.237207 [debug] [Thread-4  ]: Began running node model.nhl_analytics.mart_team_standings
[0m14:04:02.237527 [info ] [Thread-4  ]: 4 of 7 START sql table model silver.mart_team_standings ........................ [RUN]
[0m14:04:02.240357 [debug] [Thread-4  ]: Acquiring new duckdb connection 'model.nhl_analytics.mart_team_standings'
[0m14:04:02.240892 [debug] [Thread-4  ]: Began compiling node model.nhl_analytics.mart_team_standings
[0m14:04:02.243479 [debug] [Thread-4  ]: Writing injected SQL for node "model.nhl_analytics.mart_team_standings"
[0m14:04:02.246542 [debug] [Thread-4  ]: Began executing node model.nhl_analytics.mart_team_standings
[0m14:04:02.247045 [debug] [Thread-2  ]: Failed to rollback 'model.nhl_analytics.stg_skaters'
[0m14:04:02.247525 [debug] [Thread-1  ]: Failed to rollback 'model.nhl_analytics.stg_goalies'
[0m14:04:02.259588 [debug] [Thread-4  ]: Writing runtime sql for node "model.nhl_analytics.mart_team_standings"
[0m14:04:02.259813 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: Close
[0m14:04:02.260034 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: Close
[0m14:04:02.263230 [debug] [Thread-2  ]: Runtime Error in model stg_skaters (models/staging/stg_skaters.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m14:04:02.263538 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6de2998-815d-4dc3-ab54-d98b93b94c01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b3ff40>]}
[0m14:04:02.263787 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:04:02.264150 [error] [Thread-2  ]: 2 of 7 ERROR creating sql view model silver.stg_skaters ........................ [[31mERROR[0m in 0.11s]
[0m14:04:02.266870 [debug] [Thread-1  ]: Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m14:04:02.267081 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: BEGIN
[0m14:04:02.267384 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.stg_skaters
[0m14:04:02.267639 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6de2998-815d-4dc3-ab54-d98b93b94c01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097d5340>]}
[0m14:04:02.267853 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:04:02.268147 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_skaters' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_skaters (models/staging/stg_skaters.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^.
[0m14:04:02.268611 [error] [Thread-1  ]: 1 of 7 ERROR creating sql view model silver.stg_goalies ........................ [[31mERROR[0m in 0.11s]
[0m14:04:02.268915 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m14:04:02.269210 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.stg_goalies
[0m14:04:02.269422 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:04:02.269712 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_goalies' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^.
[0m14:04:02.269941 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

  
    
    

    create  table
      "nhl"."silver"."mart_team_standings__dbt_tmp"
  
    as (
      

select 
    season,
    team_name,
    team_code,
    games_played,
    goalsFor,
    goalsAgainst,
    goal_differential,
    xGoalsFor,
    xGoalsAgainst,
    row_number() over (
        order by goalsFor desc,
            goal_differential desc
    ) as standings_rank,
    loaded_at
from "nhl"."silver"."stg_teams"
order by standings_rank
    );
  
  
[0m14:04:02.270280 [debug] [Thread-3  ]: Began running node model.nhl_analytics.int_all_players
[0m14:04:02.270622 [info ] [Thread-3  ]: 5 of 7 SKIP relation silver.int_all_players .................................... [[33mSKIP[0m]
[0m14:04:02.270881 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.int_all_players
[0m14:04:02.271187 [debug] [Thread-1  ]: Began running node model.nhl_analytics.mart_goalie_performance
[0m14:04:02.271412 [debug] [Thread-2  ]: Began running node model.nhl_analytics.mart_player_performance
[0m14:04:02.271756 [info ] [Thread-1  ]: 6 of 7 SKIP relation silver.mart_goalie_performance ............................ [[33mSKIP[0m]
[0m14:04:02.272323 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.mart_goalie_performance
[0m14:04:02.272056 [info ] [Thread-2  ]: 7 of 7 SKIP relation silver.mart_player_performance ............................ [[33mSKIP[0m]
[0m14:04:02.272732 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.mart_player_performance
[0m14:04:02.278918 [debug] [Thread-4  ]: SQL status: OK in 0.008 seconds
[0m14:04:02.284132 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:04:02.284401 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'silver'
      AND table_name = 'mart_team_standings'
  
[0m14:04:02.284980 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m14:04:02.285694 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:04:02.285900 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'silver'
      AND table_name = 'mart_team_standings'
  
[0m14:04:02.286632 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m14:04:02.288676 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:04:02.288881 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */
alter table "nhl"."silver"."mart_team_standings" rename to "mart_team_standings__dbt_backup"
[0m14:04:02.289220 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m14:04:02.291043 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:04:02.291247 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */
alter table "nhl"."silver"."mart_team_standings__dbt_tmp" rename to "mart_team_standings"
[0m14:04:02.291583 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m14:04:02.294322 [info ] [Thread-4  ]: Exporting mart_team_standings to silver folder
[0m14:04:02.294651 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:04:02.294877 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

        COPY (
    SELECT *
    FROM "nhl"."silver"."mart_team_standings"
) TO '../data/silver/mart_team_standings.parquet' (FORMAT PARQUET);
      
[0m14:04:02.298505 [debug] [Thread-4  ]: SQL status: OK in 0.003 seconds
[0m14:04:02.299250 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: COMMIT
[0m14:04:02.299454 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:04:02.299640 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: COMMIT
[0m14:04:02.300274 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m14:04:02.301889 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:04:02.302109 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

      drop table if exists "nhl"."silver"."mart_team_standings__dbt_backup" cascade
    
[0m14:04:02.302577 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m14:04:02.303255 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: Close
[0m14:04:02.303571 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6de2998-815d-4dc3-ab54-d98b93b94c01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095878b0>]}
[0m14:04:02.303933 [info ] [Thread-4  ]: 4 of 7 OK created sql table model silver.mart_team_standings ................... [[32mOK[0m in 0.06s]
[0m14:04:02.304259 [debug] [Thread-4  ]: Finished running node model.nhl_analytics.mart_team_standings
[0m14:04:02.304889 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:02.305086 [debug] [MainThread]: On master: BEGIN
[0m14:04:02.305247 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:04:02.305536 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:04:02.305710 [debug] [MainThread]: On master: COMMIT
[0m14:04:02.305866 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:02.306016 [debug] [MainThread]: On master: COMMIT
[0m14:04:02.306255 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:04:02.306427 [debug] [MainThread]: On master: Close
[0m14:04:02.306634 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:04:02.306791 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_goalies' was properly closed.
[0m14:04:02.306933 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_skaters' was properly closed.
[0m14:04:02.307081 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_teams' was properly closed.
[0m14:04:02.307238 [debug] [MainThread]: Connection 'model.nhl_analytics.mart_team_standings' was properly closed.
[0m14:04:02.307465 [info ] [MainThread]: 
[0m14:04:02.307657 [info ] [MainThread]: Finished running 3 table models, 4 view models in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m14:04:02.308263 [debug] [MainThread]: Command end result
[0m14:04:02.324080 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m14:04:02.325066 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m14:04:02.328777 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/run_results.json
[0m14:04:02.328969 [info ] [MainThread]: 
[0m14:04:02.329197 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m14:04:02.329390 [info ] [MainThread]: 
[0m14:04:02.329611 [error] [MainThread]: [31mFailure in model stg_skaters (models/staging/stg_skaters.sql)[0m
[0m14:04:02.329865 [error] [MainThread]:   Runtime Error in model stg_skaters (models/staging/stg_skaters.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m14:04:02.330111 [info ] [MainThread]: 
[0m14:04:02.330344 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_skaters.sql
[0m14:04:02.330534 [info ] [MainThread]: 
[0m14:04:02.330749 [error] [MainThread]: [31mFailure in model stg_goalies (models/staging/stg_goalies.sql)[0m
[0m14:04:02.330959 [error] [MainThread]:   Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m14:04:02.331130 [info ] [MainThread]: 
[0m14:04:02.331330 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_goalies.sql
[0m14:04:02.331504 [info ] [MainThread]: 
[0m14:04:02.331697 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=3 NO-OP=0 TOTAL=7
[0m14:04:02.332640 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4573368, "process_in_blocks": "0", "process_kernel_time": 0.172116, "process_mem_max_rss": "153649152", "process_out_blocks": "0", "process_user_time": 2.026736}
[0m14:04:02.332857 [debug] [MainThread]: Command `python -m dbt.cli.main run` failed at 14:04:02.332815 after 1.46 seconds
[0m14:04:02.333061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108131340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10975c9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a3b9d0>]}
[0m14:04:02.333266 [debug] [MainThread]: Flushing usage events
[0m14:04:02.479306 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:08:25.428810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d273d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eae5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eae3d0>]}


============================== 14:08:25.432616 | 76ed3e74-e7b7-4ad3-bcd8-035dffc39a42 ==============================
[0m14:08:25.432616 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:08:25.432970 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '.', 'fail_fast': 'False', 'version_check': 'True', 'debug': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt run --models staging --profiles-dir .', 'introspect': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'no_print': 'None', 'printer_width': '80', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error': 'None'}
[0m14:08:25.433307 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m14:08:25.433583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '76ed3e74-e7b7-4ad3-bcd8-035dffc39a42', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eae5b0>]}
[0m14:08:25.631023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76ed3e74-e7b7-4ad3-bcd8-035dffc39a42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e573d0>]}
[0m14:08:25.665209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76ed3e74-e7b7-4ad3-bcd8-035dffc39a42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bd64c0>]}
[0m14:08:25.666496 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m14:08:25.734542 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:08:25.827163 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m14:08:25.827531 [debug] [MainThread]: Partial parsing: updated file: nhl_analytics://models/staging/stg_skaters.sql
[0m14:08:25.827765 [debug] [MainThread]: Partial parsing: updated file: nhl_analytics://models/staging/stg_teams.sql
[0m14:08:25.827987 [debug] [MainThread]: Partial parsing: updated file: nhl_analytics://models/staging/stg_goalies.sql
[0m14:08:26.019113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76ed3e74-e7b7-4ad3-bcd8-035dffc39a42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054e8970>]}
[0m14:08:26.081809 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m14:08:26.083093 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m14:08:26.093278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76ed3e74-e7b7-4ad3-bcd8-035dffc39a42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f81bb0>]}
[0m14:08:26.093571 [info ] [MainThread]: Found 7 models, 6 data tests, 4 sources, 445 macros
[0m14:08:26.093788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76ed3e74-e7b7-4ad3-bcd8-035dffc39a42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104676c40>]}
[0m14:08:26.094516 [info ] [MainThread]: 
[0m14:08:26.094723 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:08:26.094897 [info ] [MainThread]: 
[0m14:08:26.095173 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:08:26.098244 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl'
[0m14:08:26.129475 [debug] [ThreadPool]: Using duckdb connection "list_nhl"
[0m14:08:26.129762 [debug] [ThreadPool]: On list_nhl: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m14:08:26.130082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:08:26.172132 [debug] [ThreadPool]: SQL status: OK in 0.042 seconds
[0m14:08:26.173399 [debug] [ThreadPool]: On list_nhl: Close
[0m14:08:26.173811 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nhl, now create_nhl_silver)
[0m14:08:26.174077 [debug] [ThreadPool]: Creating schema "database: "nhl"
schema: "silver"
"
[0m14:08:26.178542 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:08:26.178742 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nhl'
        and type='sqlite'
    
  
[0m14:08:26.178909 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:08:26.179531 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:08:26.180433 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:08:26.180626 [debug] [ThreadPool]: On create_nhl_silver: BEGIN
[0m14:08:26.180888 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:08:26.181060 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:08:26.181233 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
    
        create schema if not exists "nhl"."silver"
    
[0m14:08:26.181675 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:08:26.182180 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m14:08:26.182368 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:08:26.182533 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m14:08:26.182789 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:08:26.182965 [debug] [ThreadPool]: On create_nhl_silver: Close
[0m14:08:26.183784 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nhl_silver, now list_nhl_silver)
[0m14:08:26.187236 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m14:08:26.187419 [debug] [ThreadPool]: On list_nhl_silver: BEGIN
[0m14:08:26.187575 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:08:26.187847 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:08:26.188015 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m14:08:26.188191 [debug] [ThreadPool]: On list_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl_silver"} */
select
      'nhl' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'silver'
    and lower(table_catalog) = 'nhl'
  
[0m14:08:26.198524 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m14:08:26.199423 [debug] [ThreadPool]: On list_nhl_silver: ROLLBACK
[0m14:08:26.200577 [debug] [ThreadPool]: Failed to rollback 'list_nhl_silver'
[0m14:08:26.200747 [debug] [ThreadPool]: On list_nhl_silver: Close
[0m14:08:26.201559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76ed3e74-e7b7-4ad3-bcd8-035dffc39a42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054e8970>]}
[0m14:08:26.201816 [debug] [MainThread]: Using duckdb connection "master"
[0m14:08:26.201981 [debug] [MainThread]: On master: BEGIN
[0m14:08:26.202127 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:08:26.202392 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:08:26.202561 [debug] [MainThread]: On master: COMMIT
[0m14:08:26.202733 [debug] [MainThread]: Using duckdb connection "master"
[0m14:08:26.202892 [debug] [MainThread]: On master: COMMIT
[0m14:08:26.203160 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:08:26.203363 [debug] [MainThread]: On master: Close
[0m14:08:26.204815 [debug] [Thread-1  ]: Began running node model.nhl_analytics.stg_goalies
[0m14:08:26.205039 [debug] [Thread-2  ]: Began running node model.nhl_analytics.stg_skaters
[0m14:08:26.205260 [debug] [Thread-3  ]: Began running node model.nhl_analytics.stg_teams
[0m14:08:26.205558 [info ] [Thread-1  ]: 1 of 3 START sql view model silver.stg_goalies ................................. [RUN]
[0m14:08:26.205884 [info ] [Thread-2  ]: 2 of 3 START sql view model silver.stg_skaters ................................. [RUN]
[0m14:08:26.206178 [info ] [Thread-3  ]: 3 of 3 START sql view model silver.stg_teams ................................... [RUN]
[0m14:08:26.206454 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_nhl_silver, now model.nhl_analytics.stg_goalies)
[0m14:08:26.206732 [debug] [Thread-2  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_skaters'
[0m14:08:26.206989 [debug] [Thread-3  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_teams'
[0m14:08:26.207194 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.stg_goalies
[0m14:08:26.207391 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.stg_skaters
[0m14:08:26.207582 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.stg_teams
[0m14:08:26.212044 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.stg_goalies"
[0m14:08:26.213479 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.stg_skaters"
[0m14:08:26.214820 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.stg_teams"
[0m14:08:26.215239 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.stg_goalies
[0m14:08:26.215472 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.stg_teams
[0m14:08:26.221391 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.stg_skaters
[0m14:08:26.237086 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.stg_teams"
[0m14:08:26.238006 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.stg_goalies"
[0m14:08:26.240034 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.stg_skaters"
[0m14:08:26.240600 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:08:26.240842 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m14:08:26.241058 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m14:08:26.241265 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: BEGIN
[0m14:08:26.241462 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: BEGIN
[0m14:08:26.241647 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: BEGIN
[0m14:08:26.241838 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:08:26.242022 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:08:26.242211 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:08:26.242674 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m14:08:26.242886 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m14:08:26.243103 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:08:26.243291 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m14:08:26.243495 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m14:08:26.243712 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

  
  create view "nhl"."silver"."stg_teams__dbt_tmp" as (
    { { config(materialized = 'view') } }
select season,
    name as team_name,
    team as team_code,
    sum(games_played) as games_played,
    sum(goalsFor) as goalsFor,
    sum(goalsAgainst) as goalsAgainst,
    sum(goalsFor) - sum(goalsAgainst) as goal_differential,
    sum(xGoalsFor) as xGoalsFor,
    sum(xGoalsAgainst) as xGoalsAgainst,
    current_timestamp as loaded_at
from { { source('bronze', 'teams') } }
where season is not null
    and name is not null
group by season,
    name,
    team
  );

[0m14:08:26.243926 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m14:08:26.244170 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    sum(games_played) as games_played,
    sum(icetime) as ice_time,
    sum(shifts) as shifts,
    sum(gameScore) as game_score,
    sum(I_F_goals) as goals,
    sum(I_F_points) as points,
    sum(I_F_shotsOnGoal) as shots_on_goal,
    sum(I_F_primaryAssists) as primary_assists,
    sum(I_F_secondaryAssists) as secondary_assists,
    sum(I_F_xOnGoal) as expected_on_goal,
    sum(I_F_xGoals) as expected_goals,
    sum(I_F_xRebounds) as expected_rebounds,
    sum(I_F_rebounds) as rebounds,
    sum(I_F_freeze) as freeze,
    sum(I_F_playStopped) as play_stopped,
    sum(I_F_playContinuedInZone) as play_continued_in_zone,
    sum(I_F_playContinuedOutsideZone) as play_continued_outside_zone,
    sum(I_F_lowDangerShots) as low_danger_shots,
    sum(I_F_mediumDangerShots) as medium_danger_shots,
    sum(I_F_highDangerShots) as high_danger_shots,
    sum(I_F_lowDangerxGoals) as low_danger_expected_goals,
    sum(I_F_mediumDangerxGoals) as medium_danger_expected_goals,
    sum(I_F_highDangerxGoals) as high_danger_expected_goals,
    sum(I_F_lowDangerGoals) as low_danger_goals,
    sum(I_F_mediumDangerGoals) as medium_danger_goals,
    sum(I_F_highDangerGoals) as high_danger_goals,
    case
        when sum(games_played) > 0 then true
        else false
    end as is_active_player,
    case
        when sum(games_played) > 0 then round(sum(I_F_points) * 1.0 / sum(games_played), 2)
        else null
    end as points_per_game,
    case
        when sum(I_F_shotsOnGoal) > 0 then round(sum(I_F_goals) * 100.0 / sum(I_F_shotsOnGoal), 2)
        else null
    end as shooting_percentage,
    current_timestamp as loaded_at
from { { source('bronze', 'skaters') } }
where playerId is not null
    and season is not null
group by playerId,
    season,
    name,
    team,
    position
  );

[0m14:08:26.247135 [debug] [Thread-3  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

  
  create view "nhl"."silver"."stg_teams__dbt_tmp" as (
    { { config(materialized = 'view') } }
select season,
    name as team_name,
    team as team_code,
    sum(games_played) as games_played,
    sum(goalsFor) as goalsFor,
    sum(goalsAgainst) as goalsAgainst,
    sum(goalsFor) - sum(goalsAgainst) as goal_differential,
    sum(xGoalsFor) as xGoalsFor,
    sum(xGoalsAgainst) as xGoalsAgainst,
    current_timestamp as loaded_at
from { { source('bronze', 'teams') } }
where season is not null
    and name is not null
group by season,
    name,
    team
  );

[0m14:08:26.247402 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    sum(games_played) as games_played,
    sum(icetime) as ice_time,
    sum(xGoals) as expected_goals,
    sum(goals) as goals,
    sum(unblocked_shot_attempts) as unblocked_shot_attempts,
    sum(xRebounds) as expected_rebounds,
    sum(rebounds) as rebounds,
    sum(xFreeze) as expected_freeze,
    sum(freeze) as freeze,
    sum(xOnGoal) as expected_on_goal,
    sum(ongoal) as on_goal,
    sum(xPlayStopped) as expected_play_stopped,
    sum(playStopped) as play_stopped,
    sum(xPlayContinuedInZone) as expected_play_continued_in_zone,
    sum(playContinuedInZone) as play_continued_in_zone,
    sum(xPlayContinuedOutsideZone) as expected_play_continued_outside_zone,
    sum(playContinuedOutsideZone) as play_continued_outside_zone,
    sum(flurryAdjustedxGoals) as flurry_adjusted_expected_goals,
    sum(lowDangerShots) as low_danger_shots,
    sum(mediumDangerShots) as medium_danger_shots,
    sum(highDangerShots) as high_danger_shots,
    sum(lowDangerxGoals) as low_danger_expected_goals,
    sum(mediumDangerxGoals) as medium_danger_expected_goals,
    sum(highDangerxGoals) as high_danger_expected_goals,
    sum(lowDangerGoals) as low_danger_goals,
    sum(mediumDangerGoals) as medium_danger_goals,
    sum(highDangerGoals) as high_danger_goals,
    sum(blocked_shot_attempts) as blocked_shot_attempts,
    sum(penalityMinutes) as penalty_minutes,
    sum(penalties) as penalties,
    current_timestamp as loaded_at
from { { source('bronze', 'goalies') } }
where playerId is not null
    and season is not null
group by playerId,
    season,
    name,
    team,
    position
  );

[0m14:08:26.247848 [debug] [Thread-2  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    sum(games_played) as games_played,
    sum(icetime) as ice_time,
    sum(shifts) as shifts,
    sum(gameScore) as game_score,
    sum(I_F_goals) as goals,
    sum(I_F_points) as points,
    sum(I_F_shotsOnGoal) as shots_on_goal,
    sum(I_F_primaryAssists) as primary_assists,
    sum(I_F_secondaryAssists) as secondary_assists,
    sum(I_F_xOnGoal) as expected_on_goal,
    sum(I_F_xGoals) as expected_goals,
    sum(I_F_xRebounds) as expected_rebounds,
    sum(I_F_rebounds) as rebounds,
    sum(I_F_freeze) as freeze,
    sum(I_F_playStopped) as play_stopped,
    sum(I_F_playContinuedInZone) as play_continued_in_zone,
    sum(I_F_playContinuedOutsideZone) as play_continued_outside_zone,
    sum(I_F_lowDangerShots) as low_danger_shots,
    sum(I_F_mediumDangerShots) as medium_danger_shots,
    sum(I_F_highDangerShots) as high_danger_shots,
    sum(I_F_lowDangerxGoals) as low_danger_expected_goals,
    sum(I_F_mediumDangerxGoals) as medium_danger_expected_goals,
    sum(I_F_highDangerxGoals) as high_danger_expected_goals,
    sum(I_F_lowDangerGoals) as low_danger_goals,
    sum(I_F_mediumDangerGoals) as medium_danger_goals,
    sum(I_F_highDangerGoals) as high_danger_goals,
    case
        when sum(games_played) > 0 then true
        else false
    end as is_active_player,
    case
        when sum(games_played) > 0 then round(sum(I_F_points) * 1.0 / sum(games_played), 2)
        else null
    end as points_per_game,
    case
        when sum(I_F_shotsOnGoal) > 0 then round(sum(I_F_goals) * 100.0 / sum(I_F_shotsOnGoal), 2)
        else null
    end as shooting_percentage,
    current_timestamp as loaded_at
from { { source('bronze', 'skaters') } }
where playerId is not null
    and season is not null
group by playerId,
    season,
    name,
    team,
    position
  );

[0m14:08:26.248107 [debug] [Thread-3  ]: DuckDB adapter: Rolling back transaction.
[0m14:08:26.248479 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    sum(games_played) as games_played,
    sum(icetime) as ice_time,
    sum(xGoals) as expected_goals,
    sum(goals) as goals,
    sum(unblocked_shot_attempts) as unblocked_shot_attempts,
    sum(xRebounds) as expected_rebounds,
    sum(rebounds) as rebounds,
    sum(xFreeze) as expected_freeze,
    sum(freeze) as freeze,
    sum(xOnGoal) as expected_on_goal,
    sum(ongoal) as on_goal,
    sum(xPlayStopped) as expected_play_stopped,
    sum(playStopped) as play_stopped,
    sum(xPlayContinuedInZone) as expected_play_continued_in_zone,
    sum(playContinuedInZone) as play_continued_in_zone,
    sum(xPlayContinuedOutsideZone) as expected_play_continued_outside_zone,
    sum(playContinuedOutsideZone) as play_continued_outside_zone,
    sum(flurryAdjustedxGoals) as flurry_adjusted_expected_goals,
    sum(lowDangerShots) as low_danger_shots,
    sum(mediumDangerShots) as medium_danger_shots,
    sum(highDangerShots) as high_danger_shots,
    sum(lowDangerxGoals) as low_danger_expected_goals,
    sum(mediumDangerxGoals) as medium_danger_expected_goals,
    sum(highDangerxGoals) as high_danger_expected_goals,
    sum(lowDangerGoals) as low_danger_goals,
    sum(mediumDangerGoals) as medium_danger_goals,
    sum(highDangerGoals) as high_danger_goals,
    sum(blocked_shot_attempts) as blocked_shot_attempts,
    sum(penalityMinutes) as penalty_minutes,
    sum(penalties) as penalties,
    current_timestamp as loaded_at
from { { source('bronze', 'goalies') } }
where playerId is not null
    and season is not null
group by playerId,
    season,
    name,
    team,
    position
  );

[0m14:08:26.248739 [debug] [Thread-2  ]: DuckDB adapter: Rolling back transaction.
[0m14:08:26.248992 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: ROLLBACK
[0m14:08:26.249191 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m14:08:26.249450 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: ROLLBACK
[0m14:08:26.249790 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: ROLLBACK
[0m14:08:26.286127 [debug] [Thread-1  ]: Failed to rollback 'model.nhl_analytics.stg_goalies'
[0m14:08:26.286594 [debug] [Thread-3  ]: Failed to rollback 'model.nhl_analytics.stg_teams'
[0m14:08:26.286809 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: Close
[0m14:08:26.287237 [debug] [Thread-2  ]: Failed to rollback 'model.nhl_analytics.stg_skaters'
[0m14:08:26.287443 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: Close
[0m14:08:26.287664 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: Close
[0m14:08:26.290728 [debug] [Thread-1  ]: Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m14:08:26.293730 [debug] [Thread-3  ]: Runtime Error in model stg_teams (models/staging/stg_teams.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m14:08:26.297434 [debug] [Thread-2  ]: Runtime Error in model stg_skaters (models/staging/stg_skaters.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m14:08:26.297986 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76ed3e74-e7b7-4ad3-bcd8-035dffc39a42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f6bbe0>]}
[0m14:08:26.298184 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76ed3e74-e7b7-4ad3-bcd8-035dffc39a42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e94ac0>]}
[0m14:08:26.298422 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76ed3e74-e7b7-4ad3-bcd8-035dffc39a42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b3af40>]}
[0m14:08:26.298727 [error] [Thread-1  ]: 1 of 3 ERROR creating sql view model silver.stg_goalies ........................ [[31mERROR[0m in 0.08s]
[0m14:08:26.299096 [error] [Thread-3  ]: 3 of 3 ERROR creating sql view model silver.stg_teams .......................... [[31mERROR[0m in 0.09s]
[0m14:08:26.299720 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.stg_goalies
[0m14:08:26.299462 [error] [Thread-2  ]: 2 of 3 ERROR creating sql view model silver.stg_skaters ........................ [[31mERROR[0m in 0.09s]
[0m14:08:26.300066 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.stg_teams
[0m14:08:26.300371 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_goalies' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^.
[0m14:08:26.300656 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.stg_skaters
[0m14:08:26.300962 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_teams' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_teams (models/staging/stg_teams.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^.
[0m14:08:26.301254 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_skaters' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_skaters (models/staging/stg_skaters.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^.
[0m14:08:26.301816 [debug] [MainThread]: Using duckdb connection "master"
[0m14:08:26.301997 [debug] [MainThread]: On master: BEGIN
[0m14:08:26.302146 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:08:26.302446 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:08:26.302617 [debug] [MainThread]: On master: COMMIT
[0m14:08:26.302781 [debug] [MainThread]: Using duckdb connection "master"
[0m14:08:26.302928 [debug] [MainThread]: On master: COMMIT
[0m14:08:26.303166 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:08:26.303337 [debug] [MainThread]: On master: Close
[0m14:08:26.303552 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:08:26.303698 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_goalies' was properly closed.
[0m14:08:26.303840 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_skaters' was properly closed.
[0m14:08:26.303976 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_teams' was properly closed.
[0m14:08:26.304159 [info ] [MainThread]: 
[0m14:08:26.304347 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m14:08:26.304922 [debug] [MainThread]: Command end result
[0m14:08:26.320247 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m14:08:26.321148 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m14:08:26.324840 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/run_results.json
[0m14:08:26.325030 [info ] [MainThread]: 
[0m14:08:26.325263 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m14:08:26.325454 [info ] [MainThread]: 
[0m14:08:26.325677 [error] [MainThread]: [31mFailure in model stg_goalies (models/staging/stg_goalies.sql)[0m
[0m14:08:26.325891 [error] [MainThread]:   Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m14:08:26.326063 [info ] [MainThread]: 
[0m14:08:26.326265 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_goalies.sql
[0m14:08:26.326441 [info ] [MainThread]: 
[0m14:08:26.326646 [error] [MainThread]: [31mFailure in model stg_teams (models/staging/stg_teams.sql)[0m
[0m14:08:26.326852 [error] [MainThread]:   Runtime Error in model stg_teams (models/staging/stg_teams.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m14:08:26.327021 [info ] [MainThread]: 
[0m14:08:26.327216 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_teams.sql
[0m14:08:26.327386 [info ] [MainThread]: 
[0m14:08:26.327588 [error] [MainThread]: [31mFailure in model stg_skaters (models/staging/stg_skaters.sql)[0m
[0m14:08:26.327792 [error] [MainThread]:   Runtime Error in model stg_skaters (models/staging/stg_skaters.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m14:08:26.327959 [info ] [MainThread]: 
[0m14:08:26.328157 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_skaters.sql
[0m14:08:26.328325 [info ] [MainThread]: 
[0m14:08:26.329724 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=3
[0m14:08:26.330524 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m14:08:26.333872 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.94939023, "process_in_blocks": "0", "process_kernel_time": 0.195368, "process_mem_max_rss": "146948096", "process_out_blocks": "0", "process_user_time": 1.476091}
[0m14:08:26.334112 [debug] [MainThread]: Command `python -m dbt.cli.main run` failed at 14:08:26.334067 after 0.95 seconds
[0m14:08:26.336969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d273d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f81bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ff8220>]}
[0m14:08:26.337344 [debug] [MainThread]: Flushing usage events
[0m14:08:26.629413 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:09:27.332642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ee13d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090695b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090693d0>]}


============================== 14:09:27.336089 | 46d92e81-bf34-4dca-a5ba-330fcba545eb ==============================
[0m14:09:27.336089 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:09:27.336449 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'warn_error': 'None', 'log_format': 'default', 'printer_width': '80', 'static_parser': 'True', 'introspect': 'True', 'debug': 'False', 'quiet': 'False', 'no_print': 'None', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'empty': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'target_path': 'None', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'invocation_command': 'dbt run --models staging --profiles-dir .'}
[0m14:09:27.336749 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m14:09:27.336976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '46d92e81-bf34-4dca-a5ba-330fcba545eb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090695b0>]}
[0m14:09:27.513907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46d92e81-bf34-4dca-a5ba-330fcba545eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090133d0>]}
[0m14:09:27.547802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46d92e81-bf34-4dca-a5ba-330fcba545eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d934c0>]}
[0m14:09:27.549362 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m14:09:27.620560 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:09:27.711577 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:09:27.711810 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:09:27.745909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46d92e81-bf34-4dca-a5ba-330fcba545eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109694fd0>]}
[0m14:09:27.833144 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m14:09:27.834421 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m14:09:27.844341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46d92e81-bf34-4dca-a5ba-330fcba545eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10953df40>]}
[0m14:09:27.844652 [info ] [MainThread]: Found 7 models, 6 data tests, 4 sources, 445 macros
[0m14:09:27.844879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46d92e81-bf34-4dca-a5ba-330fcba545eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109694cd0>]}
[0m14:09:27.845615 [info ] [MainThread]: 
[0m14:09:27.845834 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:09:27.846086 [info ] [MainThread]: 
[0m14:09:27.846405 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:09:27.849442 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl'
[0m14:09:27.881643 [debug] [ThreadPool]: Using duckdb connection "list_nhl"
[0m14:09:27.881894 [debug] [ThreadPool]: On list_nhl: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m14:09:27.882071 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:09:27.925195 [debug] [ThreadPool]: SQL status: OK in 0.043 seconds
[0m14:09:27.926202 [debug] [ThreadPool]: On list_nhl: Close
[0m14:09:27.926607 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nhl, now create_nhl_silver)
[0m14:09:27.926874 [debug] [ThreadPool]: Creating schema "database: "nhl"
schema: "silver"
"
[0m14:09:27.931234 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:09:27.931450 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nhl'
        and type='sqlite'
    
  
[0m14:09:27.931626 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:09:27.932283 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:09:27.933125 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:09:27.933295 [debug] [ThreadPool]: On create_nhl_silver: BEGIN
[0m14:09:27.933548 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:09:27.933723 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:09:27.933887 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
    
        create schema if not exists "nhl"."silver"
    
[0m14:09:27.934163 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:09:27.934603 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m14:09:27.934766 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:09:27.934920 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m14:09:27.935159 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:09:27.935331 [debug] [ThreadPool]: On create_nhl_silver: Close
[0m14:09:27.936150 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nhl_silver, now list_nhl_silver)
[0m14:09:27.939523 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m14:09:27.939711 [debug] [ThreadPool]: On list_nhl_silver: BEGIN
[0m14:09:27.939870 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:09:27.940155 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:09:27.940327 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m14:09:27.940505 [debug] [ThreadPool]: On list_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl_silver"} */
select
      'nhl' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'silver'
    and lower(table_catalog) = 'nhl'
  
[0m14:09:27.950100 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:09:27.950847 [debug] [ThreadPool]: On list_nhl_silver: ROLLBACK
[0m14:09:27.952037 [debug] [ThreadPool]: Failed to rollback 'list_nhl_silver'
[0m14:09:27.952229 [debug] [ThreadPool]: On list_nhl_silver: Close
[0m14:09:27.953201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46d92e81-bf34-4dca-a5ba-330fcba545eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10827e490>]}
[0m14:09:27.953468 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:27.953638 [debug] [MainThread]: On master: BEGIN
[0m14:09:27.953792 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:09:27.954063 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:09:27.954232 [debug] [MainThread]: On master: COMMIT
[0m14:09:27.954395 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:27.954543 [debug] [MainThread]: On master: COMMIT
[0m14:09:27.954774 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:09:27.954945 [debug] [MainThread]: On master: Close
[0m14:09:27.956291 [debug] [Thread-1  ]: Began running node model.nhl_analytics.stg_goalies
[0m14:09:27.956524 [debug] [Thread-2  ]: Began running node model.nhl_analytics.stg_skaters
[0m14:09:27.956982 [debug] [Thread-3  ]: Began running node model.nhl_analytics.stg_teams
[0m14:09:27.956808 [info ] [Thread-1  ]: 1 of 3 START sql view model silver.stg_goalies ................................. [RUN]
[0m14:09:27.957317 [info ] [Thread-2  ]: 2 of 3 START sql view model silver.stg_skaters ................................. [RUN]
[0m14:09:27.957606 [info ] [Thread-3  ]: 3 of 3 START sql view model silver.stg_teams ................................... [RUN]
[0m14:09:27.957873 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_nhl_silver, now model.nhl_analytics.stg_goalies)
[0m14:09:27.958145 [debug] [Thread-2  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_skaters'
[0m14:09:27.958401 [debug] [Thread-3  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_teams'
[0m14:09:27.958609 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.stg_goalies
[0m14:09:27.958809 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.stg_skaters
[0m14:09:27.959004 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.stg_teams
[0m14:09:27.963693 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.stg_goalies"
[0m14:09:27.965071 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.stg_skaters"
[0m14:09:27.966373 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.stg_teams"
[0m14:09:27.966787 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.stg_goalies
[0m14:09:27.967003 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.stg_skaters
[0m14:09:27.985657 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.stg_teams
[0m14:09:27.989739 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.stg_goalies"
[0m14:09:27.990421 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.stg_skaters"
[0m14:09:27.992451 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.stg_teams"
[0m14:09:27.992980 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m14:09:27.993205 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: BEGIN
[0m14:09:27.993441 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m14:09:27.993634 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:09:27.993860 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: BEGIN
[0m14:09:27.994069 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:09:27.994378 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:09:27.994588 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: BEGIN
[0m14:09:27.994803 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m14:09:27.995053 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:09:27.995257 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m14:09:27.995454 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m14:09:27.995755 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    sum(games_played) as games_played,
    sum(icetime) as ice_time,
    sum(shifts) as shifts,
    sum(gameScore) as game_score,
    sum(I_F_goals) as goals,
    sum(I_F_points) as points,
    sum(I_F_shotsOnGoal) as shots_on_goal,
    sum(I_F_primaryAssists) as primary_assists,
    sum(I_F_secondaryAssists) as secondary_assists,
    sum(I_F_xOnGoal) as expected_on_goal,
    sum(I_F_xGoals) as expected_goals,
    sum(I_F_xRebounds) as expected_rebounds,
    sum(I_F_rebounds) as rebounds,
    sum(I_F_freeze) as freeze,
    sum(I_F_playStopped) as play_stopped,
    sum(I_F_playContinuedInZone) as play_continued_in_zone,
    sum(I_F_playContinuedOutsideZone) as play_continued_outside_zone,
    sum(I_F_lowDangerShots) as low_danger_shots,
    sum(I_F_mediumDangerShots) as medium_danger_shots,
    sum(I_F_highDangerShots) as high_danger_shots,
    sum(I_F_lowDangerxGoals) as low_danger_expected_goals,
    sum(I_F_mediumDangerxGoals) as medium_danger_expected_goals,
    sum(I_F_highDangerxGoals) as high_danger_expected_goals,
    sum(I_F_lowDangerGoals) as low_danger_goals,
    sum(I_F_mediumDangerGoals) as medium_danger_goals,
    sum(I_F_highDangerGoals) as high_danger_goals,
    case
        when sum(games_played) > 0 then true
        else false
    end as is_active_player,
    case
        when sum(games_played) > 0 then round(sum(I_F_points) * 1.0 / sum(games_played), 2)
        else null
    end as points_per_game,
    case
        when sum(I_F_shotsOnGoal) > 0 then round(sum(I_F_goals) * 100.0 / sum(I_F_shotsOnGoal), 2)
        else null
    end as shooting_percentage,
    current_timestamp as loaded_at
from { { source('bronze', 'skaters') } }
where playerId is not null
    and season is not null
group by playerId,
    season,
    name,
    team,
    position
  );

[0m14:09:27.996077 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m14:09:27.996339 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m14:09:27.999299 [debug] [Thread-2  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    sum(games_played) as games_played,
    sum(icetime) as ice_time,
    sum(shifts) as shifts,
    sum(gameScore) as game_score,
    sum(I_F_goals) as goals,
    sum(I_F_points) as points,
    sum(I_F_shotsOnGoal) as shots_on_goal,
    sum(I_F_primaryAssists) as primary_assists,
    sum(I_F_secondaryAssists) as secondary_assists,
    sum(I_F_xOnGoal) as expected_on_goal,
    sum(I_F_xGoals) as expected_goals,
    sum(I_F_xRebounds) as expected_rebounds,
    sum(I_F_rebounds) as rebounds,
    sum(I_F_freeze) as freeze,
    sum(I_F_playStopped) as play_stopped,
    sum(I_F_playContinuedInZone) as play_continued_in_zone,
    sum(I_F_playContinuedOutsideZone) as play_continued_outside_zone,
    sum(I_F_lowDangerShots) as low_danger_shots,
    sum(I_F_mediumDangerShots) as medium_danger_shots,
    sum(I_F_highDangerShots) as high_danger_shots,
    sum(I_F_lowDangerxGoals) as low_danger_expected_goals,
    sum(I_F_mediumDangerxGoals) as medium_danger_expected_goals,
    sum(I_F_highDangerxGoals) as high_danger_expected_goals,
    sum(I_F_lowDangerGoals) as low_danger_goals,
    sum(I_F_mediumDangerGoals) as medium_danger_goals,
    sum(I_F_highDangerGoals) as high_danger_goals,
    case
        when sum(games_played) > 0 then true
        else false
    end as is_active_player,
    case
        when sum(games_played) > 0 then round(sum(I_F_points) * 1.0 / sum(games_played), 2)
        else null
    end as points_per_game,
    case
        when sum(I_F_shotsOnGoal) > 0 then round(sum(I_F_goals) * 100.0 / sum(I_F_shotsOnGoal), 2)
        else null
    end as shooting_percentage,
    current_timestamp as loaded_at
from { { source('bronze', 'skaters') } }
where playerId is not null
    and season is not null
group by playerId,
    season,
    name,
    team,
    position
  );

[0m14:09:27.999607 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    sum(games_played) as games_played,
    sum(icetime) as ice_time,
    sum(xGoals) as expected_goals,
    sum(goals) as goals,
    sum(unblocked_shot_attempts) as unblocked_shot_attempts,
    sum(xRebounds) as expected_rebounds,
    sum(rebounds) as rebounds,
    sum(xFreeze) as expected_freeze,
    sum(freeze) as freeze,
    sum(xOnGoal) as expected_on_goal,
    sum(ongoal) as on_goal,
    sum(xPlayStopped) as expected_play_stopped,
    sum(playStopped) as play_stopped,
    sum(xPlayContinuedInZone) as expected_play_continued_in_zone,
    sum(playContinuedInZone) as play_continued_in_zone,
    sum(xPlayContinuedOutsideZone) as expected_play_continued_outside_zone,
    sum(playContinuedOutsideZone) as play_continued_outside_zone,
    sum(flurryAdjustedxGoals) as flurry_adjusted_expected_goals,
    sum(lowDangerShots) as low_danger_shots,
    sum(mediumDangerShots) as medium_danger_shots,
    sum(highDangerShots) as high_danger_shots,
    sum(lowDangerxGoals) as low_danger_expected_goals,
    sum(mediumDangerxGoals) as medium_danger_expected_goals,
    sum(highDangerxGoals) as high_danger_expected_goals,
    sum(lowDangerGoals) as low_danger_goals,
    sum(mediumDangerGoals) as medium_danger_goals,
    sum(highDangerGoals) as high_danger_goals,
    sum(blocked_shot_attempts) as blocked_shot_attempts,
    sum(penalityMinutes) as penalty_minutes,
    sum(penalties) as penalties,
    current_timestamp as loaded_at
from { { source('bronze', 'goalies') } }
where playerId is not null
    and season is not null
group by playerId,
    season,
    name,
    team,
    position
  );

[0m14:09:27.999863 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:09:28.000072 [debug] [Thread-2  ]: DuckDB adapter: Rolling back transaction.
[0m14:09:28.000442 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    sum(games_played) as games_played,
    sum(icetime) as ice_time,
    sum(xGoals) as expected_goals,
    sum(goals) as goals,
    sum(unblocked_shot_attempts) as unblocked_shot_attempts,
    sum(xRebounds) as expected_rebounds,
    sum(rebounds) as rebounds,
    sum(xFreeze) as expected_freeze,
    sum(freeze) as freeze,
    sum(xOnGoal) as expected_on_goal,
    sum(ongoal) as on_goal,
    sum(xPlayStopped) as expected_play_stopped,
    sum(playStopped) as play_stopped,
    sum(xPlayContinuedInZone) as expected_play_continued_in_zone,
    sum(playContinuedInZone) as play_continued_in_zone,
    sum(xPlayContinuedOutsideZone) as expected_play_continued_outside_zone,
    sum(playContinuedOutsideZone) as play_continued_outside_zone,
    sum(flurryAdjustedxGoals) as flurry_adjusted_expected_goals,
    sum(lowDangerShots) as low_danger_shots,
    sum(mediumDangerShots) as medium_danger_shots,
    sum(highDangerShots) as high_danger_shots,
    sum(lowDangerxGoals) as low_danger_expected_goals,
    sum(mediumDangerxGoals) as medium_danger_expected_goals,
    sum(highDangerxGoals) as high_danger_expected_goals,
    sum(lowDangerGoals) as low_danger_goals,
    sum(mediumDangerGoals) as medium_danger_goals,
    sum(highDangerGoals) as high_danger_goals,
    sum(blocked_shot_attempts) as blocked_shot_attempts,
    sum(penalityMinutes) as penalty_minutes,
    sum(penalties) as penalties,
    current_timestamp as loaded_at
from { { source('bronze', 'goalies') } }
where playerId is not null
    and season is not null
group by playerId,
    season,
    name,
    team,
    position
  );

[0m14:09:28.000705 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

  
  create view "nhl"."silver"."stg_teams__dbt_tmp" as (
    { { config(materialized = 'view') } }
select season,
    name as team_name,
    team as team_code,
    sum(games_played) as games_played,
    sum(goalsFor) as goalsFor,
    sum(goalsAgainst) as goalsAgainst,
    sum(goalsFor) - sum(goalsAgainst) as goal_differential,
    sum(xGoalsFor) as xGoalsFor,
    sum(xGoalsAgainst) as xGoalsAgainst,
    current_timestamp as loaded_at
from { { source('bronze', 'teams') } }
where season is not null
    and name is not null
group by season,
    name,
    team
  );

[0m14:09:28.000995 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: ROLLBACK
[0m14:09:28.001209 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m14:09:28.001534 [debug] [Thread-3  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

  
  create view "nhl"."silver"."stg_teams__dbt_tmp" as (
    { { config(materialized = 'view') } }
select season,
    name as team_name,
    team as team_code,
    sum(games_played) as games_played,
    sum(goalsFor) as goalsFor,
    sum(goalsAgainst) as goalsAgainst,
    sum(goalsFor) - sum(goalsAgainst) as goal_differential,
    sum(xGoalsFor) as xGoalsFor,
    sum(xGoalsAgainst) as xGoalsAgainst,
    current_timestamp as loaded_at
from { { source('bronze', 'teams') } }
where season is not null
    and name is not null
group by season,
    name,
    team
  );

[0m14:09:28.001909 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: ROLLBACK
[0m14:09:28.003748 [debug] [Thread-3  ]: DuckDB adapter: Rolling back transaction.
[0m14:09:28.004090 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: ROLLBACK
[0m14:09:28.039046 [debug] [Thread-1  ]: Failed to rollback 'model.nhl_analytics.stg_goalies'
[0m14:09:28.039299 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: Close
[0m14:09:28.039775 [debug] [Thread-2  ]: Failed to rollback 'model.nhl_analytics.stg_skaters'
[0m14:09:28.040226 [debug] [Thread-3  ]: Failed to rollback 'model.nhl_analytics.stg_teams'
[0m14:09:28.040541 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: Close
[0m14:09:28.040791 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: Close
[0m14:09:28.043711 [debug] [Thread-1  ]: Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m14:09:28.047414 [debug] [Thread-2  ]: Runtime Error in model stg_skaters (models/staging/stg_skaters.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m14:09:28.050188 [debug] [Thread-3  ]: Runtime Error in model stg_teams (models/staging/stg_teams.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m14:09:28.050469 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46d92e81-bf34-4dca-a5ba-330fcba545eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a49d30>]}
[0m14:09:28.050668 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46d92e81-bf34-4dca-a5ba-330fcba545eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b52d30>]}
[0m14:09:28.050897 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46d92e81-bf34-4dca-a5ba-330fcba545eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bb18e0>]}
[0m14:09:28.051236 [error] [Thread-1  ]: 1 of 3 ERROR creating sql view model silver.stg_goalies ........................ [[31mERROR[0m in 0.09s]
[0m14:09:28.052187 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.stg_goalies
[0m14:09:28.051558 [error] [Thread-2  ]: 2 of 3 ERROR creating sql view model silver.stg_skaters ........................ [[31mERROR[0m in 0.09s]
[0m14:09:28.051903 [error] [Thread-3  ]: 3 of 3 ERROR creating sql view model silver.stg_teams .......................... [[31mERROR[0m in 0.09s]
[0m14:09:28.052646 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_goalies' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^.
[0m14:09:28.052942 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.stg_skaters
[0m14:09:28.053229 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.stg_teams
[0m14:09:28.053553 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_skaters' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_skaters (models/staging/stg_skaters.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^.
[0m14:09:28.053866 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_teams' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_teams (models/staging/stg_teams.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^.
[0m14:09:28.054425 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:28.054599 [debug] [MainThread]: On master: BEGIN
[0m14:09:28.054747 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:09:28.055054 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:09:28.055226 [debug] [MainThread]: On master: COMMIT
[0m14:09:28.055398 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:28.055546 [debug] [MainThread]: On master: COMMIT
[0m14:09:28.055782 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:09:28.055951 [debug] [MainThread]: On master: Close
[0m14:09:28.056157 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:09:28.056326 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_goalies' was properly closed.
[0m14:09:28.056533 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_skaters' was properly closed.
[0m14:09:28.056689 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_teams' was properly closed.
[0m14:09:28.056892 [info ] [MainThread]: 
[0m14:09:28.057083 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m14:09:28.057593 [debug] [MainThread]: Command end result
[0m14:09:28.072713 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m14:09:28.073651 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m14:09:28.077357 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/run_results.json
[0m14:09:28.077546 [info ] [MainThread]: 
[0m14:09:28.077778 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m14:09:28.077970 [info ] [MainThread]: 
[0m14:09:28.078196 [error] [MainThread]: [31mFailure in model stg_goalies (models/staging/stg_goalies.sql)[0m
[0m14:09:28.078413 [error] [MainThread]:   Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m14:09:28.078595 [info ] [MainThread]: 
[0m14:09:28.078798 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_goalies.sql
[0m14:09:28.078976 [info ] [MainThread]: 
[0m14:09:28.079182 [error] [MainThread]: [31mFailure in model stg_skaters (models/staging/stg_skaters.sql)[0m
[0m14:09:28.079484 [error] [MainThread]:   Runtime Error in model stg_skaters (models/staging/stg_skaters.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m14:09:28.079671 [info ] [MainThread]: 
[0m14:09:28.079880 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_skaters.sql
[0m14:09:28.080057 [info ] [MainThread]: 
[0m14:09:28.080266 [error] [MainThread]: [31mFailure in model stg_teams (models/staging/stg_teams.sql)[0m
[0m14:09:28.080474 [error] [MainThread]:   Runtime Error in model stg_teams (models/staging/stg_teams.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m14:09:28.080754 [info ] [MainThread]: 
[0m14:09:28.081000 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_teams.sql
[0m14:09:28.081189 [info ] [MainThread]: 
[0m14:09:28.081387 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=3
[0m14:09:28.081697 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m14:09:28.082638 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.79246944, "process_in_blocks": "0", "process_kernel_time": 0.186388, "process_mem_max_rss": "142688256", "process_out_blocks": "0", "process_user_time": 1.337806}
[0m14:09:28.082866 [debug] [MainThread]: Command `python -m dbt.cli.main run` failed at 14:09:28.082822 after 0.79 seconds
[0m14:09:28.083084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ee13d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081b4220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10933cbb0>]}
[0m14:09:28.083325 [debug] [MainThread]: Flushing usage events
[0m14:09:28.242215 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:09:42.440706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aa3310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070385b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070383d0>]}


============================== 14:09:42.443298 | 4d05e1d1-c099-4720-9563-bf678214b732 ==============================
[0m14:09:42.443298 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:09:42.443647 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'no_print': 'None', 'quiet': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'write_json': 'True', 'profiles_dir': '.', 'partial_parse': 'True', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'static_parser': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'target_path': 'None', 'printer_width': '80', 'fail_fast': 'False', 'debug': 'False', 'invocation_command': 'dbt run --profiles-dir .', 'log_cache_events': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:09:42.566444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d05e1d1-c099-4720-9563-bf678214b732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104430580>]}
[0m14:09:42.600383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d05e1d1-c099-4720-9563-bf678214b732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074eefd0>]}
[0m14:09:42.602399 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m14:09:42.670177 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:09:42.760697 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:09:42.760933 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:09:42.794607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d05e1d1-c099-4720-9563-bf678214b732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110163130>]}
[0m14:09:42.882397 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m14:09:42.883850 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m14:09:42.893505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d05e1d1-c099-4720-9563-bf678214b732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101631f0>]}
[0m14:09:42.893813 [info ] [MainThread]: Found 7 models, 6 data tests, 4 sources, 445 macros
[0m14:09:42.894039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d05e1d1-c099-4720-9563-bf678214b732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075f8760>]}
[0m14:09:42.894948 [info ] [MainThread]: 
[0m14:09:42.895164 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:09:42.895344 [info ] [MainThread]: 
[0m14:09:42.895635 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:09:42.898900 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl'
[0m14:09:42.927618 [debug] [ThreadPool]: Using duckdb connection "list_nhl"
[0m14:09:42.927862 [debug] [ThreadPool]: On list_nhl: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m14:09:42.928035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:09:42.961951 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m14:09:42.962861 [debug] [ThreadPool]: On list_nhl: Close
[0m14:09:42.963302 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nhl, now create_nhl_silver)
[0m14:09:42.963582 [debug] [ThreadPool]: Creating schema "database: "nhl"
schema: "silver"
"
[0m14:09:42.967775 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:09:42.967969 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nhl'
        and type='sqlite'
    
  
[0m14:09:42.968137 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:09:42.968582 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:09:42.969263 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:09:42.969432 [debug] [ThreadPool]: On create_nhl_silver: BEGIN
[0m14:09:42.969692 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:09:42.969861 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:09:42.970032 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
    
        create schema if not exists "nhl"."silver"
    
[0m14:09:42.970299 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:09:42.970757 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m14:09:42.970930 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:09:42.971089 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m14:09:42.971324 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:09:42.971491 [debug] [ThreadPool]: On create_nhl_silver: Close
[0m14:09:42.972312 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nhl_silver, now list_nhl_silver)
[0m14:09:42.975636 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m14:09:42.975823 [debug] [ThreadPool]: On list_nhl_silver: BEGIN
[0m14:09:42.975984 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:09:42.976280 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:09:42.976440 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m14:09:42.976605 [debug] [ThreadPool]: On list_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl_silver"} */
select
      'nhl' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'silver'
    and lower(table_catalog) = 'nhl'
  
[0m14:09:42.983371 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m14:09:42.984119 [debug] [ThreadPool]: On list_nhl_silver: ROLLBACK
[0m14:09:42.985317 [debug] [ThreadPool]: Failed to rollback 'list_nhl_silver'
[0m14:09:42.985495 [debug] [ThreadPool]: On list_nhl_silver: Close
[0m14:09:42.986303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d05e1d1-c099-4720-9563-bf678214b732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041ce0a0>]}
[0m14:09:42.986546 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:42.986709 [debug] [MainThread]: On master: BEGIN
[0m14:09:42.986859 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:09:42.987124 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:09:42.987279 [debug] [MainThread]: On master: COMMIT
[0m14:09:42.987432 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:42.987583 [debug] [MainThread]: On master: COMMIT
[0m14:09:42.987819 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:09:42.987977 [debug] [MainThread]: On master: Close
[0m14:09:42.989329 [debug] [Thread-1  ]: Began running node model.nhl_analytics.stg_goalies
[0m14:09:42.989567 [debug] [Thread-2  ]: Began running node model.nhl_analytics.stg_skaters
[0m14:09:42.990037 [debug] [Thread-3  ]: Began running node model.nhl_analytics.stg_teams
[0m14:09:42.989859 [info ] [Thread-1  ]: 1 of 7 START sql view model silver.stg_goalies ................................. [RUN]
[0m14:09:42.990374 [info ] [Thread-2  ]: 2 of 7 START sql view model silver.stg_skaters ................................. [RUN]
[0m14:09:42.990659 [info ] [Thread-3  ]: 3 of 7 START sql view model silver.stg_teams ................................... [RUN]
[0m14:09:42.990926 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_nhl_silver, now model.nhl_analytics.stg_goalies)
[0m14:09:42.991210 [debug] [Thread-2  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_skaters'
[0m14:09:42.991469 [debug] [Thread-3  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_teams'
[0m14:09:42.991672 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.stg_goalies
[0m14:09:42.991876 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.stg_skaters
[0m14:09:42.992072 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.stg_teams
[0m14:09:42.996625 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.stg_goalies"
[0m14:09:42.998037 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.stg_skaters"
[0m14:09:42.999430 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.stg_teams"
[0m14:09:43.000565 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.stg_goalies
[0m14:09:43.000825 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.stg_skaters
[0m14:09:43.001051 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.stg_teams
[0m14:09:43.023089 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.stg_goalies"
[0m14:09:43.023431 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.stg_skaters"
[0m14:09:43.025389 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.stg_teams"
[0m14:09:43.025905 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m14:09:43.026148 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:09:43.026362 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m14:09:43.026550 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: BEGIN
[0m14:09:43.026747 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: BEGIN
[0m14:09:43.026936 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: BEGIN
[0m14:09:43.027124 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:09:43.027310 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:09:43.027492 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:09:43.027978 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m14:09:43.028190 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m14:09:43.028393 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m14:09:43.028591 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m14:09:43.028795 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:09:43.029042 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    sum(games_played) as games_played,
    sum(icetime) as ice_time,
    sum(xGoals) as expected_goals,
    sum(goals) as goals,
    sum(unblocked_shot_attempts) as unblocked_shot_attempts,
    sum(xRebounds) as expected_rebounds,
    sum(rebounds) as rebounds,
    sum(xFreeze) as expected_freeze,
    sum(freeze) as freeze,
    sum(xOnGoal) as expected_on_goal,
    sum(ongoal) as on_goal,
    sum(xPlayStopped) as expected_play_stopped,
    sum(playStopped) as play_stopped,
    sum(xPlayContinuedInZone) as expected_play_continued_in_zone,
    sum(playContinuedInZone) as play_continued_in_zone,
    sum(xPlayContinuedOutsideZone) as expected_play_continued_outside_zone,
    sum(playContinuedOutsideZone) as play_continued_outside_zone,
    sum(flurryAdjustedxGoals) as flurry_adjusted_expected_goals,
    sum(lowDangerShots) as low_danger_shots,
    sum(mediumDangerShots) as medium_danger_shots,
    sum(highDangerShots) as high_danger_shots,
    sum(lowDangerxGoals) as low_danger_expected_goals,
    sum(mediumDangerxGoals) as medium_danger_expected_goals,
    sum(highDangerxGoals) as high_danger_expected_goals,
    sum(lowDangerGoals) as low_danger_goals,
    sum(mediumDangerGoals) as medium_danger_goals,
    sum(highDangerGoals) as high_danger_goals,
    sum(blocked_shot_attempts) as blocked_shot_attempts,
    sum(penalityMinutes) as penalty_minutes,
    sum(penalties) as penalties,
    current_timestamp as loaded_at
from { { source('bronze', 'goalies') } }
where playerId is not null
    and season is not null
group by playerId,
    season,
    name,
    team,
    position
  );

[0m14:09:43.029304 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m14:09:43.029534 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

  
  create view "nhl"."silver"."stg_teams__dbt_tmp" as (
    { { config(materialized = 'view') } }
select season,
    name as team_name,
    team as team_code,
    sum(games_played) as games_played,
    sum(goalsFor) as goalsFor,
    sum(goalsAgainst) as goalsAgainst,
    sum(goalsFor) - sum(goalsAgainst) as goal_differential,
    sum(xGoalsFor) as xGoalsFor,
    sum(xGoalsAgainst) as xGoalsAgainst,
    current_timestamp as loaded_at
from { { source('bronze', 'teams') } }
where season is not null
    and name is not null
group by season,
    name,
    team
  );

[0m14:09:43.030016 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    sum(games_played) as games_played,
    sum(icetime) as ice_time,
    sum(xGoals) as expected_goals,
    sum(goals) as goals,
    sum(unblocked_shot_attempts) as unblocked_shot_attempts,
    sum(xRebounds) as expected_rebounds,
    sum(rebounds) as rebounds,
    sum(xFreeze) as expected_freeze,
    sum(freeze) as freeze,
    sum(xOnGoal) as expected_on_goal,
    sum(ongoal) as on_goal,
    sum(xPlayStopped) as expected_play_stopped,
    sum(playStopped) as play_stopped,
    sum(xPlayContinuedInZone) as expected_play_continued_in_zone,
    sum(playContinuedInZone) as play_continued_in_zone,
    sum(xPlayContinuedOutsideZone) as expected_play_continued_outside_zone,
    sum(playContinuedOutsideZone) as play_continued_outside_zone,
    sum(flurryAdjustedxGoals) as flurry_adjusted_expected_goals,
    sum(lowDangerShots) as low_danger_shots,
    sum(mediumDangerShots) as medium_danger_shots,
    sum(highDangerShots) as high_danger_shots,
    sum(lowDangerxGoals) as low_danger_expected_goals,
    sum(mediumDangerxGoals) as medium_danger_expected_goals,
    sum(highDangerxGoals) as high_danger_expected_goals,
    sum(lowDangerGoals) as low_danger_goals,
    sum(mediumDangerGoals) as medium_danger_goals,
    sum(highDangerGoals) as high_danger_goals,
    sum(blocked_shot_attempts) as blocked_shot_attempts,
    sum(penalityMinutes) as penalty_minutes,
    sum(penalties) as penalties,
    current_timestamp as loaded_at
from { { source('bronze', 'goalies') } }
where playerId is not null
    and season is not null
group by playerId,
    season,
    name,
    team,
    position
  );

[0m14:09:43.030322 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    sum(games_played) as games_played,
    sum(icetime) as ice_time,
    sum(shifts) as shifts,
    sum(gameScore) as game_score,
    sum(I_F_goals) as goals,
    sum(I_F_points) as points,
    sum(I_F_shotsOnGoal) as shots_on_goal,
    sum(I_F_primaryAssists) as primary_assists,
    sum(I_F_secondaryAssists) as secondary_assists,
    sum(I_F_xOnGoal) as expected_on_goal,
    sum(I_F_xGoals) as expected_goals,
    sum(I_F_xRebounds) as expected_rebounds,
    sum(I_F_rebounds) as rebounds,
    sum(I_F_freeze) as freeze,
    sum(I_F_playStopped) as play_stopped,
    sum(I_F_playContinuedInZone) as play_continued_in_zone,
    sum(I_F_playContinuedOutsideZone) as play_continued_outside_zone,
    sum(I_F_lowDangerShots) as low_danger_shots,
    sum(I_F_mediumDangerShots) as medium_danger_shots,
    sum(I_F_highDangerShots) as high_danger_shots,
    sum(I_F_lowDangerxGoals) as low_danger_expected_goals,
    sum(I_F_mediumDangerxGoals) as medium_danger_expected_goals,
    sum(I_F_highDangerxGoals) as high_danger_expected_goals,
    sum(I_F_lowDangerGoals) as low_danger_goals,
    sum(I_F_mediumDangerGoals) as medium_danger_goals,
    sum(I_F_highDangerGoals) as high_danger_goals,
    case
        when sum(games_played) > 0 then true
        else false
    end as is_active_player,
    case
        when sum(games_played) > 0 then round(sum(I_F_points) * 1.0 / sum(games_played), 2)
        else null
    end as points_per_game,
    case
        when sum(I_F_shotsOnGoal) > 0 then round(sum(I_F_goals) * 100.0 / sum(I_F_shotsOnGoal), 2)
        else null
    end as shooting_percentage,
    current_timestamp as loaded_at
from { { source('bronze', 'skaters') } }
where playerId is not null
    and season is not null
group by playerId,
    season,
    name,
    team,
    position
  );

[0m14:09:43.030719 [debug] [Thread-3  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

  
  create view "nhl"."silver"."stg_teams__dbt_tmp" as (
    { { config(materialized = 'view') } }
select season,
    name as team_name,
    team as team_code,
    sum(games_played) as games_played,
    sum(goalsFor) as goalsFor,
    sum(goalsAgainst) as goalsAgainst,
    sum(goalsFor) - sum(goalsAgainst) as goal_differential,
    sum(xGoalsFor) as xGoalsFor,
    sum(xGoalsAgainst) as xGoalsAgainst,
    current_timestamp as loaded_at
from { { source('bronze', 'teams') } }
where season is not null
    and name is not null
group by season,
    name,
    team
  );

[0m14:09:43.030945 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m14:09:43.031312 [debug] [Thread-2  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    sum(games_played) as games_played,
    sum(icetime) as ice_time,
    sum(shifts) as shifts,
    sum(gameScore) as game_score,
    sum(I_F_goals) as goals,
    sum(I_F_points) as points,
    sum(I_F_shotsOnGoal) as shots_on_goal,
    sum(I_F_primaryAssists) as primary_assists,
    sum(I_F_secondaryAssists) as secondary_assists,
    sum(I_F_xOnGoal) as expected_on_goal,
    sum(I_F_xGoals) as expected_goals,
    sum(I_F_xRebounds) as expected_rebounds,
    sum(I_F_rebounds) as rebounds,
    sum(I_F_freeze) as freeze,
    sum(I_F_playStopped) as play_stopped,
    sum(I_F_playContinuedInZone) as play_continued_in_zone,
    sum(I_F_playContinuedOutsideZone) as play_continued_outside_zone,
    sum(I_F_lowDangerShots) as low_danger_shots,
    sum(I_F_mediumDangerShots) as medium_danger_shots,
    sum(I_F_highDangerShots) as high_danger_shots,
    sum(I_F_lowDangerxGoals) as low_danger_expected_goals,
    sum(I_F_mediumDangerxGoals) as medium_danger_expected_goals,
    sum(I_F_highDangerxGoals) as high_danger_expected_goals,
    sum(I_F_lowDangerGoals) as low_danger_goals,
    sum(I_F_mediumDangerGoals) as medium_danger_goals,
    sum(I_F_highDangerGoals) as high_danger_goals,
    case
        when sum(games_played) > 0 then true
        else false
    end as is_active_player,
    case
        when sum(games_played) > 0 then round(sum(I_F_points) * 1.0 / sum(games_played), 2)
        else null
    end as points_per_game,
    case
        when sum(I_F_shotsOnGoal) > 0 then round(sum(I_F_goals) * 100.0 / sum(I_F_shotsOnGoal), 2)
        else null
    end as shooting_percentage,
    current_timestamp as loaded_at
from { { source('bronze', 'skaters') } }
where playerId is not null
    and season is not null
group by playerId,
    season,
    name,
    team,
    position
  );

[0m14:09:43.031568 [debug] [Thread-3  ]: DuckDB adapter: Rolling back transaction.
[0m14:09:43.031829 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: ROLLBACK
[0m14:09:43.032043 [debug] [Thread-2  ]: DuckDB adapter: Rolling back transaction.
[0m14:09:43.032292 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: ROLLBACK
[0m14:09:43.032628 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: ROLLBACK
[0m14:09:43.069142 [debug] [Thread-1  ]: Failed to rollback 'model.nhl_analytics.stg_goalies'
[0m14:09:43.069390 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: Close
[0m14:09:43.069850 [debug] [Thread-3  ]: Failed to rollback 'model.nhl_analytics.stg_teams'
[0m14:09:43.070323 [debug] [Thread-2  ]: Failed to rollback 'model.nhl_analytics.stg_skaters'
[0m14:09:43.070627 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: Close
[0m14:09:43.070873 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: Close
[0m14:09:43.073889 [debug] [Thread-1  ]: Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m14:09:43.077479 [debug] [Thread-2  ]: Runtime Error in model stg_skaters (models/staging/stg_skaters.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m14:09:43.080310 [debug] [Thread-3  ]: Runtime Error in model stg_teams (models/staging/stg_teams.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m14:09:43.080550 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d05e1d1-c099-4720-9563-bf678214b732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107764c10>]}
[0m14:09:43.080812 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d05e1d1-c099-4720-9563-bf678214b732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11063bb20>]}
[0m14:09:43.080992 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d05e1d1-c099-4720-9563-bf678214b732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110564df0>]}
[0m14:09:43.081374 [error] [Thread-1  ]: 1 of 7 ERROR creating sql view model silver.stg_goalies ........................ [[31mERROR[0m in 0.08s]
[0m14:09:43.081743 [error] [Thread-3  ]: 3 of 7 ERROR creating sql view model silver.stg_teams .......................... [[31mERROR[0m in 0.09s]
[0m14:09:43.082353 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.stg_goalies
[0m14:09:43.082085 [error] [Thread-2  ]: 2 of 7 ERROR creating sql view model silver.stg_skaters ........................ [[31mERROR[0m in 0.09s]
[0m14:09:43.082696 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.stg_teams
[0m14:09:43.082990 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_goalies' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^.
[0m14:09:43.083270 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.stg_skaters
[0m14:09:43.083597 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_teams' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_teams (models/staging/stg_teams.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^.
[0m14:09:43.083918 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_skaters' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_skaters (models/staging/stg_skaters.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^.
[0m14:09:43.084206 [debug] [Thread-4  ]: Began running node model.nhl_analytics.mart_team_standings
[0m14:09:43.084456 [debug] [Thread-3  ]: Began running node model.nhl_analytics.int_all_players
[0m14:09:43.084676 [info ] [Thread-4  ]: 4 of 7 SKIP relation silver.mart_team_standings ................................ [[33mSKIP[0m]
[0m14:09:43.084929 [info ] [Thread-3  ]: 5 of 7 SKIP relation silver.int_all_players .................................... [[33mSKIP[0m]
[0m14:09:43.085174 [debug] [Thread-4  ]: Finished running node model.nhl_analytics.mart_team_standings
[0m14:09:43.085395 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.int_all_players
[0m14:09:43.085780 [debug] [Thread-1  ]: Began running node model.nhl_analytics.mart_goalie_performance
[0m14:09:43.086030 [debug] [Thread-2  ]: Began running node model.nhl_analytics.mart_player_performance
[0m14:09:43.086248 [info ] [Thread-1  ]: 6 of 7 SKIP relation silver.mart_goalie_performance ............................ [[33mSKIP[0m]
[0m14:09:43.086516 [info ] [Thread-2  ]: 7 of 7 SKIP relation silver.mart_player_performance ............................ [[33mSKIP[0m]
[0m14:09:43.086802 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.mart_goalie_performance
[0m14:09:43.087075 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.mart_player_performance
[0m14:09:43.087728 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:43.087913 [debug] [MainThread]: On master: BEGIN
[0m14:09:43.088082 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:09:43.088453 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:09:43.088628 [debug] [MainThread]: On master: COMMIT
[0m14:09:43.088790 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:43.088948 [debug] [MainThread]: On master: COMMIT
[0m14:09:43.089213 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:09:43.089398 [debug] [MainThread]: On master: Close
[0m14:09:43.089640 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:09:43.089812 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_goalies' was properly closed.
[0m14:09:43.089960 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_skaters' was properly closed.
[0m14:09:43.090108 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_teams' was properly closed.
[0m14:09:43.090333 [info ] [MainThread]: 
[0m14:09:43.090541 [info ] [MainThread]: Finished running 3 table models, 4 view models in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m14:09:43.091300 [debug] [MainThread]: Command end result
[0m14:09:43.106678 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m14:09:43.107637 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m14:09:43.111531 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/run_results.json
[0m14:09:43.111726 [info ] [MainThread]: 
[0m14:09:43.111959 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m14:09:43.112155 [info ] [MainThread]: 
[0m14:09:43.112384 [error] [MainThread]: [31mFailure in model stg_goalies (models/staging/stg_goalies.sql)[0m
[0m14:09:43.112623 [error] [MainThread]:   Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m14:09:43.112850 [info ] [MainThread]: 
[0m14:09:43.113109 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_goalies.sql
[0m14:09:43.113295 [info ] [MainThread]: 
[0m14:09:43.113538 [error] [MainThread]: [31mFailure in model stg_teams (models/staging/stg_teams.sql)[0m
[0m14:09:43.113786 [error] [MainThread]:   Runtime Error in model stg_teams (models/staging/stg_teams.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m14:09:43.113974 [info ] [MainThread]: 
[0m14:09:43.114185 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_teams.sql
[0m14:09:43.114373 [info ] [MainThread]: 
[0m14:09:43.114586 [error] [MainThread]: [31mFailure in model stg_skaters (models/staging/stg_skaters.sql)[0m
[0m14:09:43.114801 [error] [MainThread]:   Runtime Error in model stg_skaters (models/staging/stg_skaters.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m14:09:43.114976 [info ] [MainThread]: 
[0m14:09:43.115177 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_skaters.sql
[0m14:09:43.115351 [info ] [MainThread]: 
[0m14:09:43.115545 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=4 NO-OP=0 TOTAL=7
[0m14:09:43.116747 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.71909577, "process_in_blocks": "0", "process_kernel_time": 0.139803, "process_mem_max_rss": "144490496", "process_out_blocks": "0", "process_user_time": 1.325293}
[0m14:09:43.116993 [debug] [MainThread]: Command `python -m dbt.cli.main run` failed at 14:09:43.116945 after 0.72 seconds
[0m14:09:43.117264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aa3310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ff7580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048fb340>]}
[0m14:09:43.117518 [debug] [MainThread]: Flushing usage events
[0m14:09:43.262764 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:11:40.407470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d3d340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ec5460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ec5280>]}


============================== 14:11:40.410900 | 8d9aebc8-192c-47a6-9ecb-c69deccd1b59 ==============================
[0m14:11:40.410900 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:11:40.411286 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'quiet': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'cache_selected_only': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '.', 'introspect': 'True', 'use_colors': 'True', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'use_experimental_parser': 'False', 'write_json': 'True', 'partial_parse': 'True', 'version_check': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'invocation_command': 'dbt run --profiles-dir .'}
[0m14:11:40.584362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d9aebc8-192c-47a6-9ecb-c69deccd1b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f8cfd0>]}
[0m14:11:40.622140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d9aebc8-192c-47a6-9ecb-c69deccd1b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10467cfd0>]}
[0m14:11:40.623812 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m14:11:40.701826 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:11:40.801797 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:11:40.802122 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:11:40.839268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d9aebc8-192c-47a6-9ecb-c69deccd1b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054ef130>]}
[0m14:11:40.929953 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m14:11:40.931443 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m14:11:40.941610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d9aebc8-192c-47a6-9ecb-c69deccd1b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105501040>]}
[0m14:11:40.941923 [info ] [MainThread]: Found 7 models, 6 data tests, 4 sources, 445 macros
[0m14:11:40.942152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d9aebc8-192c-47a6-9ecb-c69deccd1b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053f7bb0>]}
[0m14:11:40.943057 [info ] [MainThread]: 
[0m14:11:40.943275 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:11:40.943459 [info ] [MainThread]: 
[0m14:11:40.943735 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:11:40.947018 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl'
[0m14:11:40.979794 [debug] [ThreadPool]: Using duckdb connection "list_nhl"
[0m14:11:40.980036 [debug] [ThreadPool]: On list_nhl: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m14:11:40.980209 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:41.016205 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m14:11:41.016961 [debug] [ThreadPool]: On list_nhl: Close
[0m14:11:41.017345 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nhl, now create_nhl_silver)
[0m14:11:41.017618 [debug] [ThreadPool]: Creating schema "database: "nhl"
schema: "silver"
"
[0m14:11:41.021715 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:11:41.021907 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nhl'
        and type='sqlite'
    
  
[0m14:11:41.022072 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:41.022638 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:11:41.023298 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:11:41.023477 [debug] [ThreadPool]: On create_nhl_silver: BEGIN
[0m14:11:41.023734 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:11:41.023902 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:11:41.024067 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
    
        create schema if not exists "nhl"."silver"
    
[0m14:11:41.024335 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:11:41.024769 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m14:11:41.024931 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:11:41.025080 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m14:11:41.025320 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:11:41.025490 [debug] [ThreadPool]: On create_nhl_silver: Close
[0m14:11:41.026288 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nhl_silver, now list_nhl_silver)
[0m14:11:41.029693 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m14:11:41.029883 [debug] [ThreadPool]: On list_nhl_silver: BEGIN
[0m14:11:41.030048 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:41.030429 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:11:41.030637 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m14:11:41.030825 [debug] [ThreadPool]: On list_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl_silver"} */
select
      'nhl' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'silver'
    and lower(table_catalog) = 'nhl'
  
[0m14:11:41.039695 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:11:41.040594 [debug] [ThreadPool]: On list_nhl_silver: ROLLBACK
[0m14:11:41.041751 [debug] [ThreadPool]: Failed to rollback 'list_nhl_silver'
[0m14:11:41.041942 [debug] [ThreadPool]: On list_nhl_silver: Close
[0m14:11:41.042754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d9aebc8-192c-47a6-9ecb-c69deccd1b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040a5460>]}
[0m14:11:41.043019 [debug] [MainThread]: Using duckdb connection "master"
[0m14:11:41.043180 [debug] [MainThread]: On master: BEGIN
[0m14:11:41.043331 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:11:41.043598 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:11:41.043767 [debug] [MainThread]: On master: COMMIT
[0m14:11:41.043928 [debug] [MainThread]: Using duckdb connection "master"
[0m14:11:41.044078 [debug] [MainThread]: On master: COMMIT
[0m14:11:41.044308 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:11:41.044477 [debug] [MainThread]: On master: Close
[0m14:11:41.045923 [debug] [Thread-1  ]: Began running node model.nhl_analytics.stg_goalies
[0m14:11:41.046193 [debug] [Thread-2  ]: Began running node model.nhl_analytics.stg_skaters
[0m14:11:41.046678 [debug] [Thread-3  ]: Began running node model.nhl_analytics.stg_teams
[0m14:11:41.046493 [info ] [Thread-1  ]: 1 of 7 START sql view model silver.stg_goalies ................................. [RUN]
[0m14:11:41.047011 [info ] [Thread-2  ]: 2 of 7 START sql view model silver.stg_skaters ................................. [RUN]
[0m14:11:41.047310 [info ] [Thread-3  ]: 3 of 7 START sql view model silver.stg_teams ................................... [RUN]
[0m14:11:41.047596 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_nhl_silver, now model.nhl_analytics.stg_goalies)
[0m14:11:41.047874 [debug] [Thread-2  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_skaters'
[0m14:11:41.048132 [debug] [Thread-3  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_teams'
[0m14:11:41.048336 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.stg_goalies
[0m14:11:41.048537 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.stg_skaters
[0m14:11:41.048731 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.stg_teams
[0m14:11:41.053351 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.stg_goalies"
[0m14:11:41.054805 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.stg_skaters"
[0m14:11:41.056138 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.stg_teams"
[0m14:11:41.056563 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.stg_skaters
[0m14:11:41.056810 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.stg_goalies
[0m14:11:41.057102 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.stg_teams
[0m14:11:41.079145 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.stg_skaters"
[0m14:11:41.079484 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.stg_goalies"
[0m14:11:41.081451 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.stg_teams"
[0m14:11:41.081941 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m14:11:41.082190 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m14:11:41.082388 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: BEGIN
[0m14:11:41.082605 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: BEGIN
[0m14:11:41.082822 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:11:41.083023 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:11:41.083210 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:11:41.083401 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: BEGIN
[0m14:11:41.083783 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:11:41.084040 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m14:11:41.084245 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m14:11:41.084444 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m14:11:41.084647 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m14:11:41.084884 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    sum(games_played) as games_played,
    sum(icetime) as ice_time,
    sum(xGoals) as expected_goals,
    sum(goals) as goals,
    sum(unblocked_shot_attempts) as unblocked_shot_attempts,
    sum(xRebounds) as expected_rebounds,
    sum(rebounds) as rebounds,
    sum(xFreeze) as expected_freeze,
    sum(freeze) as freeze,
    sum(xOnGoal) as expected_on_goal,
    sum(ongoal) as on_goal,
    sum(xPlayStopped) as expected_play_stopped,
    sum(playStopped) as play_stopped,
    sum(xPlayContinuedInZone) as expected_play_continued_in_zone,
    sum(playContinuedInZone) as play_continued_in_zone,
    sum(xPlayContinuedOutsideZone) as expected_play_continued_outside_zone,
    sum(playContinuedOutsideZone) as play_continued_outside_zone,
    sum(flurryAdjustedxGoals) as flurry_adjusted_expected_goals,
    sum(lowDangerShots) as low_danger_shots,
    sum(mediumDangerShots) as medium_danger_shots,
    sum(highDangerShots) as high_danger_shots,
    sum(lowDangerxGoals) as low_danger_expected_goals,
    sum(mediumDangerxGoals) as medium_danger_expected_goals,
    sum(highDangerxGoals) as high_danger_expected_goals,
    sum(lowDangerGoals) as low_danger_goals,
    sum(mediumDangerGoals) as medium_danger_goals,
    sum(highDangerGoals) as high_danger_goals,
    sum(blocked_shot_attempts) as blocked_shot_attempts,
    sum(penalityMinutes) as penalty_minutes,
    sum(penalties) as penalties,
    current_timestamp as loaded_at
from { { source('bronze', 'goalies') } }
where playerId is not null
    and season is not null
group by playerId,
    season,
    name,
    team,
    position
  );

[0m14:11:41.085137 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:11:41.085332 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m14:11:41.087679 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    sum(games_played) as games_played,
    sum(icetime) as ice_time,
    sum(xGoals) as expected_goals,
    sum(goals) as goals,
    sum(unblocked_shot_attempts) as unblocked_shot_attempts,
    sum(xRebounds) as expected_rebounds,
    sum(rebounds) as rebounds,
    sum(xFreeze) as expected_freeze,
    sum(freeze) as freeze,
    sum(xOnGoal) as expected_on_goal,
    sum(ongoal) as on_goal,
    sum(xPlayStopped) as expected_play_stopped,
    sum(playStopped) as play_stopped,
    sum(xPlayContinuedInZone) as expected_play_continued_in_zone,
    sum(playContinuedInZone) as play_continued_in_zone,
    sum(xPlayContinuedOutsideZone) as expected_play_continued_outside_zone,
    sum(playContinuedOutsideZone) as play_continued_outside_zone,
    sum(flurryAdjustedxGoals) as flurry_adjusted_expected_goals,
    sum(lowDangerShots) as low_danger_shots,
    sum(mediumDangerShots) as medium_danger_shots,
    sum(highDangerShots) as high_danger_shots,
    sum(lowDangerxGoals) as low_danger_expected_goals,
    sum(mediumDangerxGoals) as medium_danger_expected_goals,
    sum(highDangerxGoals) as high_danger_expected_goals,
    sum(lowDangerGoals) as low_danger_goals,
    sum(mediumDangerGoals) as medium_danger_goals,
    sum(highDangerGoals) as high_danger_goals,
    sum(blocked_shot_attempts) as blocked_shot_attempts,
    sum(penalityMinutes) as penalty_minutes,
    sum(penalties) as penalties,
    current_timestamp as loaded_at
from { { source('bronze', 'goalies') } }
where playerId is not null
    and season is not null
group by playerId,
    season,
    name,
    team,
    position
  );

[0m14:11:41.087941 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

  
  create view "nhl"."silver"."stg_teams__dbt_tmp" as (
    { { config(materialized = 'view') } }
select season,
    name as team_name,
    team as team_code,
    sum(games_played) as games_played,
    sum(goalsFor) as goalsFor,
    sum(goalsAgainst) as goalsAgainst,
    sum(goalsFor) - sum(goalsAgainst) as goal_differential,
    sum(xGoalsFor) as xGoalsFor,
    sum(xGoalsAgainst) as xGoalsAgainst,
    current_timestamp as loaded_at
from { { source('bronze', 'teams') } }
where season is not null
    and name is not null
group by season,
    name,
    team
  );

[0m14:11:41.088216 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    sum(games_played) as games_played,
    sum(icetime) as ice_time,
    sum(shifts) as shifts,
    sum(gameScore) as game_score,
    sum(I_F_goals) as goals,
    sum(I_F_points) as points,
    sum(I_F_shotsOnGoal) as shots_on_goal,
    sum(I_F_primaryAssists) as primary_assists,
    sum(I_F_secondaryAssists) as secondary_assists,
    sum(I_F_xOnGoal) as expected_on_goal,
    sum(I_F_xGoals) as expected_goals,
    sum(I_F_xRebounds) as expected_rebounds,
    sum(I_F_rebounds) as rebounds,
    sum(I_F_freeze) as freeze,
    sum(I_F_playStopped) as play_stopped,
    sum(I_F_playContinuedInZone) as play_continued_in_zone,
    sum(I_F_playContinuedOutsideZone) as play_continued_outside_zone,
    sum(I_F_lowDangerShots) as low_danger_shots,
    sum(I_F_mediumDangerShots) as medium_danger_shots,
    sum(I_F_highDangerShots) as high_danger_shots,
    sum(I_F_lowDangerxGoals) as low_danger_expected_goals,
    sum(I_F_mediumDangerxGoals) as medium_danger_expected_goals,
    sum(I_F_highDangerxGoals) as high_danger_expected_goals,
    sum(I_F_lowDangerGoals) as low_danger_goals,
    sum(I_F_mediumDangerGoals) as medium_danger_goals,
    sum(I_F_highDangerGoals) as high_danger_goals,
    case
        when sum(games_played) > 0 then true
        else false
    end as is_active_player,
    case
        when sum(games_played) > 0 then round(sum(I_F_points) * 1.0 / sum(games_played), 2)
        else null
    end as points_per_game,
    case
        when sum(I_F_shotsOnGoal) > 0 then round(sum(I_F_goals) * 100.0 / sum(I_F_shotsOnGoal), 2)
        else null
    end as shooting_percentage,
    current_timestamp as loaded_at
from { { source('bronze', 'skaters') } }
where playerId is not null
    and season is not null
group by playerId,
    season,
    name,
    team,
    position
  );

[0m14:11:41.088485 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m14:11:41.088818 [debug] [Thread-3  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

  
  create view "nhl"."silver"."stg_teams__dbt_tmp" as (
    { { config(materialized = 'view') } }
select season,
    name as team_name,
    team as team_code,
    sum(games_played) as games_played,
    sum(goalsFor) as goalsFor,
    sum(goalsAgainst) as goalsAgainst,
    sum(goalsFor) - sum(goalsAgainst) as goal_differential,
    sum(xGoalsFor) as xGoalsFor,
    sum(xGoalsAgainst) as xGoalsAgainst,
    current_timestamp as loaded_at
from { { source('bronze', 'teams') } }
where season is not null
    and name is not null
group by season,
    name,
    team
  );

[0m14:11:41.089207 [debug] [Thread-2  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    sum(games_played) as games_played,
    sum(icetime) as ice_time,
    sum(shifts) as shifts,
    sum(gameScore) as game_score,
    sum(I_F_goals) as goals,
    sum(I_F_points) as points,
    sum(I_F_shotsOnGoal) as shots_on_goal,
    sum(I_F_primaryAssists) as primary_assists,
    sum(I_F_secondaryAssists) as secondary_assists,
    sum(I_F_xOnGoal) as expected_on_goal,
    sum(I_F_xGoals) as expected_goals,
    sum(I_F_xRebounds) as expected_rebounds,
    sum(I_F_rebounds) as rebounds,
    sum(I_F_freeze) as freeze,
    sum(I_F_playStopped) as play_stopped,
    sum(I_F_playContinuedInZone) as play_continued_in_zone,
    sum(I_F_playContinuedOutsideZone) as play_continued_outside_zone,
    sum(I_F_lowDangerShots) as low_danger_shots,
    sum(I_F_mediumDangerShots) as medium_danger_shots,
    sum(I_F_highDangerShots) as high_danger_shots,
    sum(I_F_lowDangerxGoals) as low_danger_expected_goals,
    sum(I_F_mediumDangerxGoals) as medium_danger_expected_goals,
    sum(I_F_highDangerxGoals) as high_danger_expected_goals,
    sum(I_F_lowDangerGoals) as low_danger_goals,
    sum(I_F_mediumDangerGoals) as medium_danger_goals,
    sum(I_F_highDangerGoals) as high_danger_goals,
    case
        when sum(games_played) > 0 then true
        else false
    end as is_active_player,
    case
        when sum(games_played) > 0 then round(sum(I_F_points) * 1.0 / sum(games_played), 2)
        else null
    end as points_per_game,
    case
        when sum(I_F_shotsOnGoal) > 0 then round(sum(I_F_goals) * 100.0 / sum(I_F_shotsOnGoal), 2)
        else null
    end as shooting_percentage,
    current_timestamp as loaded_at
from { { source('bronze', 'skaters') } }
where playerId is not null
    and season is not null
group by playerId,
    season,
    name,
    team,
    position
  );

[0m14:11:41.089517 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: ROLLBACK
[0m14:11:41.089725 [debug] [Thread-3  ]: DuckDB adapter: Rolling back transaction.
[0m14:11:41.089927 [debug] [Thread-2  ]: DuckDB adapter: Rolling back transaction.
[0m14:11:41.090263 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: ROLLBACK
[0m14:11:41.092086 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: ROLLBACK
[0m14:11:41.126178 [debug] [Thread-3  ]: Failed to rollback 'model.nhl_analytics.stg_teams'
[0m14:11:41.126648 [debug] [Thread-2  ]: Failed to rollback 'model.nhl_analytics.stg_skaters'
[0m14:11:41.126866 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: Close
[0m14:11:41.127311 [debug] [Thread-1  ]: Failed to rollback 'model.nhl_analytics.stg_goalies'
[0m14:11:41.127517 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: Close
[0m14:11:41.127839 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: Close
[0m14:11:41.130920 [debug] [Thread-3  ]: Runtime Error in model stg_teams (models/staging/stg_teams.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m14:11:41.134094 [debug] [Thread-2  ]: Runtime Error in model stg_skaters (models/staging/stg_skaters.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m14:11:41.137178 [debug] [Thread-1  ]: Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m14:11:41.137670 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d9aebc8-192c-47a6-9ecb-c69deccd1b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059c1af0>]}
[0m14:11:41.137870 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d9aebc8-192c-47a6-9ecb-c69deccd1b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a0e0a0>]}
[0m14:11:41.138110 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d9aebc8-192c-47a6-9ecb-c69deccd1b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104627910>]}
[0m14:11:41.138419 [error] [Thread-3  ]: 3 of 7 ERROR creating sql view model silver.stg_teams .......................... [[31mERROR[0m in 0.08s]
[0m14:11:41.138788 [error] [Thread-2  ]: 2 of 7 ERROR creating sql view model silver.stg_skaters ........................ [[31mERROR[0m in 0.09s]
[0m14:11:41.139408 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.stg_teams
[0m14:11:41.139143 [error] [Thread-1  ]: 1 of 7 ERROR creating sql view model silver.stg_goalies ........................ [[31mERROR[0m in 0.09s]
[0m14:11:41.139757 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.stg_skaters
[0m14:11:41.140041 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_teams' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_teams (models/staging/stg_teams.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^.
[0m14:11:41.140332 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.stg_goalies
[0m14:11:41.140650 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_skaters' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_skaters (models/staging/stg_skaters.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^.
[0m14:11:41.140917 [debug] [Thread-4  ]: Began running node model.nhl_analytics.mart_team_standings
[0m14:11:41.141223 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_goalies' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^.
[0m14:11:41.141461 [info ] [Thread-4  ]: 4 of 7 SKIP relation silver.mart_team_standings ................................ [[33mSKIP[0m]
[0m14:11:41.141773 [debug] [Thread-4  ]: Finished running node model.nhl_analytics.mart_team_standings
[0m14:11:41.141983 [debug] [Thread-2  ]: Began running node model.nhl_analytics.int_all_players
[0m14:11:41.142240 [info ] [Thread-2  ]: 5 of 7 SKIP relation silver.int_all_players .................................... [[33mSKIP[0m]
[0m14:11:41.142471 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.int_all_players
[0m14:11:41.142808 [debug] [Thread-3  ]: Began running node model.nhl_analytics.mart_goalie_performance
[0m14:11:41.143060 [debug] [Thread-1  ]: Began running node model.nhl_analytics.mart_player_performance
[0m14:11:41.143278 [info ] [Thread-3  ]: 6 of 7 SKIP relation silver.mart_goalie_performance ............................ [[33mSKIP[0m]
[0m14:11:41.143602 [info ] [Thread-1  ]: 7 of 7 SKIP relation silver.mart_player_performance ............................ [[33mSKIP[0m]
[0m14:11:41.143867 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.mart_goalie_performance
[0m14:11:41.144098 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.mart_player_performance
[0m14:11:41.144716 [debug] [MainThread]: Using duckdb connection "master"
[0m14:11:41.144987 [debug] [MainThread]: On master: BEGIN
[0m14:11:41.145175 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:11:41.145514 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:11:41.145693 [debug] [MainThread]: On master: COMMIT
[0m14:11:41.145905 [debug] [MainThread]: Using duckdb connection "master"
[0m14:11:41.146079 [debug] [MainThread]: On master: COMMIT
[0m14:11:41.146359 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:11:41.146535 [debug] [MainThread]: On master: Close
[0m14:11:41.146757 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:11:41.146916 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_goalies' was properly closed.
[0m14:11:41.147067 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_skaters' was properly closed.
[0m14:11:41.147218 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_teams' was properly closed.
[0m14:11:41.147507 [info ] [MainThread]: 
[0m14:11:41.147850 [info ] [MainThread]: Finished running 3 table models, 4 view models in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m14:11:41.148570 [debug] [MainThread]: Command end result
[0m14:11:41.164534 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m14:11:41.165602 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m14:11:41.169534 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/run_results.json
[0m14:11:41.169725 [info ] [MainThread]: 
[0m14:11:41.169945 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m14:11:41.170138 [info ] [MainThread]: 
[0m14:11:41.170358 [error] [MainThread]: [31mFailure in model stg_teams (models/staging/stg_teams.sql)[0m
[0m14:11:41.170574 [error] [MainThread]:   Runtime Error in model stg_teams (models/staging/stg_teams.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m14:11:41.170746 [info ] [MainThread]: 
[0m14:11:41.170947 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_teams.sql
[0m14:11:41.171121 [info ] [MainThread]: 
[0m14:11:41.171327 [error] [MainThread]: [31mFailure in model stg_skaters (models/staging/stg_skaters.sql)[0m
[0m14:11:41.171533 [error] [MainThread]:   Runtime Error in model stg_skaters (models/staging/stg_skaters.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m14:11:41.171701 [info ] [MainThread]: 
[0m14:11:41.171898 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_skaters.sql
[0m14:11:41.172069 [info ] [MainThread]: 
[0m14:11:41.172270 [error] [MainThread]: [31mFailure in model stg_goalies (models/staging/stg_goalies.sql)[0m
[0m14:11:41.172473 [error] [MainThread]:   Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m14:11:41.172641 [info ] [MainThread]: 
[0m14:11:41.172844 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_goalies.sql
[0m14:11:41.173013 [info ] [MainThread]: 
[0m14:11:41.173210 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=4 NO-OP=0 TOTAL=7
[0m14:11:41.174534 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8162114, "process_in_blocks": "0", "process_kernel_time": 0.201398, "process_mem_max_rss": "143802368", "process_out_blocks": "0", "process_user_time": 1.414728}
[0m14:11:41.174797 [debug] [MainThread]: Command `python -m dbt.cli.main run` failed at 14:11:41.174746 after 0.82 seconds
[0m14:11:41.175045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d3d340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f8cfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105004130>]}
[0m14:11:41.175268 [debug] [MainThread]: Flushing usage events
[0m14:11:41.402541 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:13:21.113595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f72310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050f85b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050f83d0>]}


============================== 14:13:21.116442 | bfa2c510-536e-4d69-9d12-c03e4956e5b9 ==============================
[0m14:13:21.116442 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:13:21.116787 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'empty': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'warn_error': 'None', 'printer_width': '80', 'static_parser': 'True', 'log_format': 'default', 'quiet': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --profiles-dir .', 'introspect': 'True', 'debug': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'cache_selected_only': 'False'}
[0m14:13:21.290964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bfa2c510-536e-4d69-9d12-c03e4956e5b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102900580>]}
[0m14:13:21.324791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bfa2c510-536e-4d69-9d12-c03e4956e5b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052aefd0>]}
[0m14:13:21.326348 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m14:13:21.395001 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:13:21.486681 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:13:21.486926 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:13:21.520570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bfa2c510-536e-4d69-9d12-c03e4956e5b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105723130>]}
[0m14:13:21.606256 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m14:13:21.607611 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m14:13:21.617491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bfa2c510-536e-4d69-9d12-c03e4956e5b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057231f0>]}
[0m14:13:21.617804 [info ] [MainThread]: Found 7 models, 6 data tests, 4 sources, 445 macros
[0m14:13:21.618023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfa2c510-536e-4d69-9d12-c03e4956e5b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053b8760>]}
[0m14:13:21.618913 [info ] [MainThread]: 
[0m14:13:21.619133 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:13:21.619319 [info ] [MainThread]: 
[0m14:13:21.619604 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:13:21.622761 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl'
[0m14:13:21.654606 [debug] [ThreadPool]: Using duckdb connection "list_nhl"
[0m14:13:21.654850 [debug] [ThreadPool]: On list_nhl: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m14:13:21.655023 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:13:21.699153 [debug] [ThreadPool]: SQL status: OK in 0.044 seconds
[0m14:13:21.700267 [debug] [ThreadPool]: On list_nhl: Close
[0m14:13:21.700663 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nhl, now create_nhl_silver)
[0m14:13:21.700924 [debug] [ThreadPool]: Creating schema "database: "nhl"
schema: "silver"
"
[0m14:13:21.705112 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:13:21.705301 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nhl'
        and type='sqlite'
    
  
[0m14:13:21.705469 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:13:21.706038 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:13:21.706848 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:13:21.707051 [debug] [ThreadPool]: On create_nhl_silver: BEGIN
[0m14:13:21.707328 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:13:21.707503 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:13:21.707670 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
    
        create schema if not exists "nhl"."silver"
    
[0m14:13:21.707944 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:13:21.708390 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m14:13:21.708555 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:13:21.708731 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m14:13:21.708975 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:13:21.709147 [debug] [ThreadPool]: On create_nhl_silver: Close
[0m14:13:21.710019 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nhl_silver, now list_nhl_silver)
[0m14:13:21.713779 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m14:13:21.714000 [debug] [ThreadPool]: On list_nhl_silver: BEGIN
[0m14:13:21.714170 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:13:21.714470 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:13:21.714641 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m14:13:21.714809 [debug] [ThreadPool]: On list_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl_silver"} */
select
      'nhl' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'silver'
    and lower(table_catalog) = 'nhl'
  
[0m14:13:21.724794 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m14:13:21.725722 [debug] [ThreadPool]: On list_nhl_silver: ROLLBACK
[0m14:13:21.726901 [debug] [ThreadPool]: Failed to rollback 'list_nhl_silver'
[0m14:13:21.727080 [debug] [ThreadPool]: On list_nhl_silver: Close
[0m14:13:21.727986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfa2c510-536e-4d69-9d12-c03e4956e5b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10269e0a0>]}
[0m14:13:21.728257 [debug] [MainThread]: Using duckdb connection "master"
[0m14:13:21.728424 [debug] [MainThread]: On master: BEGIN
[0m14:13:21.728572 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:13:21.728841 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:13:21.729012 [debug] [MainThread]: On master: COMMIT
[0m14:13:21.729186 [debug] [MainThread]: Using duckdb connection "master"
[0m14:13:21.729343 [debug] [MainThread]: On master: COMMIT
[0m14:13:21.729576 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:13:21.729746 [debug] [MainThread]: On master: Close
[0m14:13:21.731130 [debug] [Thread-1  ]: Began running node model.nhl_analytics.stg_goalies
[0m14:13:21.731366 [debug] [Thread-2  ]: Began running node model.nhl_analytics.stg_skaters
[0m14:13:21.731832 [debug] [Thread-3  ]: Began running node model.nhl_analytics.stg_teams
[0m14:13:21.731661 [info ] [Thread-1  ]: 1 of 7 START sql view model silver.stg_goalies ................................. [RUN]
[0m14:13:21.732185 [info ] [Thread-2  ]: 2 of 7 START sql view model silver.stg_skaters ................................. [RUN]
[0m14:13:21.732495 [info ] [Thread-3  ]: 3 of 7 START sql view model silver.stg_teams ................................... [RUN]
[0m14:13:21.732775 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_nhl_silver, now model.nhl_analytics.stg_goalies)
[0m14:13:21.733057 [debug] [Thread-2  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_skaters'
[0m14:13:21.733312 [debug] [Thread-3  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_teams'
[0m14:13:21.733515 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.stg_goalies
[0m14:13:21.733714 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.stg_skaters
[0m14:13:21.733912 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.stg_teams
[0m14:13:21.738436 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.stg_goalies"
[0m14:13:21.739886 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.stg_skaters"
[0m14:13:21.741235 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.stg_teams"
[0m14:13:21.741656 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.stg_goalies
[0m14:13:21.741873 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.stg_skaters
[0m14:13:21.748410 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.stg_teams
[0m14:13:21.764181 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.stg_skaters"
[0m14:13:21.764458 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.stg_goalies"
[0m14:13:21.766434 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.stg_teams"
[0m14:13:21.766959 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m14:13:21.767217 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:13:21.767449 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m14:13:21.767645 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: BEGIN
[0m14:13:21.767857 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: BEGIN
[0m14:13:21.768083 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: BEGIN
[0m14:13:21.768285 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:13:21.768481 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:13:21.768672 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:13:21.769142 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m14:13:21.769347 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m14:13:21.769552 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:13:21.769750 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m14:13:21.769939 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m14:13:21.770159 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

  
  create view "nhl"."silver"."stg_teams__dbt_tmp" as (
    { { config(materialized = 'view') } }
select season,
    name as team_name,
    team as team_code,
    sum(games_played) as games_played,
    sum(goalsFor) as goalsFor,
    sum(goalsAgainst) as goalsAgainst,
    sum(goalsFor) - sum(goalsAgainst) as goal_differential,
    sum(xGoalsFor) as xGoalsFor,
    sum(xGoalsAgainst) as xGoalsAgainst,
    current_timestamp as loaded_at
from { { source('bronze', 'teams') } }
where season is not null
    and name is not null
group by season,
    name,
    team
  );

[0m14:13:21.770370 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m14:13:21.770616 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    sum(games_played) as games_played,
    sum(icetime) as ice_time,
    sum(shifts) as shifts,
    sum(gameScore) as game_score,
    sum(I_F_goals) as goals,
    sum(I_F_points) as points,
    sum(I_F_shotsOnGoal) as shots_on_goal,
    sum(I_F_primaryAssists) as primary_assists,
    sum(I_F_secondaryAssists) as secondary_assists,
    sum(I_F_xOnGoal) as expected_on_goal,
    sum(I_F_xGoals) as expected_goals,
    sum(I_F_xRebounds) as expected_rebounds,
    sum(I_F_rebounds) as rebounds,
    sum(I_F_freeze) as freeze,
    sum(I_F_playStopped) as play_stopped,
    sum(I_F_playContinuedInZone) as play_continued_in_zone,
    sum(I_F_playContinuedOutsideZone) as play_continued_outside_zone,
    sum(I_F_lowDangerShots) as low_danger_shots,
    sum(I_F_mediumDangerShots) as medium_danger_shots,
    sum(I_F_highDangerShots) as high_danger_shots,
    sum(I_F_lowDangerxGoals) as low_danger_expected_goals,
    sum(I_F_mediumDangerxGoals) as medium_danger_expected_goals,
    sum(I_F_highDangerxGoals) as high_danger_expected_goals,
    sum(I_F_lowDangerGoals) as low_danger_goals,
    sum(I_F_mediumDangerGoals) as medium_danger_goals,
    sum(I_F_highDangerGoals) as high_danger_goals,
    case
        when sum(games_played) > 0 then true
        else false
    end as is_active_player,
    case
        when sum(games_played) > 0 then round(sum(I_F_points) * 1.0 / sum(games_played), 2)
        else null
    end as points_per_game,
    case
        when sum(I_F_shotsOnGoal) > 0 then round(sum(I_F_goals) * 100.0 / sum(I_F_shotsOnGoal), 2)
        else null
    end as shooting_percentage,
    current_timestamp as loaded_at
from { { source('bronze', 'skaters') } }
where playerId is not null
    and season is not null
group by playerId,
    season,
    name,
    team,
    position
  );

[0m14:13:21.773215 [debug] [Thread-3  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

  
  create view "nhl"."silver"."stg_teams__dbt_tmp" as (
    { { config(materialized = 'view') } }
select season,
    name as team_name,
    team as team_code,
    sum(games_played) as games_played,
    sum(goalsFor) as goalsFor,
    sum(goalsAgainst) as goalsAgainst,
    sum(goalsFor) - sum(goalsAgainst) as goal_differential,
    sum(xGoalsFor) as xGoalsFor,
    sum(xGoalsAgainst) as xGoalsAgainst,
    current_timestamp as loaded_at
from { { source('bronze', 'teams') } }
where season is not null
    and name is not null
group by season,
    name,
    team
  );

[0m14:13:21.773482 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    sum(games_played) as games_played,
    sum(icetime) as ice_time,
    sum(xGoals) as expected_goals,
    sum(goals) as goals,
    sum(unblocked_shot_attempts) as unblocked_shot_attempts,
    sum(xRebounds) as expected_rebounds,
    sum(rebounds) as rebounds,
    sum(xFreeze) as expected_freeze,
    sum(freeze) as freeze,
    sum(xOnGoal) as expected_on_goal,
    sum(ongoal) as on_goal,
    sum(xPlayStopped) as expected_play_stopped,
    sum(playStopped) as play_stopped,
    sum(xPlayContinuedInZone) as expected_play_continued_in_zone,
    sum(playContinuedInZone) as play_continued_in_zone,
    sum(xPlayContinuedOutsideZone) as expected_play_continued_outside_zone,
    sum(playContinuedOutsideZone) as play_continued_outside_zone,
    sum(flurryAdjustedxGoals) as flurry_adjusted_expected_goals,
    sum(lowDangerShots) as low_danger_shots,
    sum(mediumDangerShots) as medium_danger_shots,
    sum(highDangerShots) as high_danger_shots,
    sum(lowDangerxGoals) as low_danger_expected_goals,
    sum(mediumDangerxGoals) as medium_danger_expected_goals,
    sum(highDangerxGoals) as high_danger_expected_goals,
    sum(lowDangerGoals) as low_danger_goals,
    sum(mediumDangerGoals) as medium_danger_goals,
    sum(highDangerGoals) as high_danger_goals,
    sum(blocked_shot_attempts) as blocked_shot_attempts,
    sum(penalityMinutes) as penalty_minutes,
    sum(penalties) as penalties,
    current_timestamp as loaded_at
from { { source('bronze', 'goalies') } }
where playerId is not null
    and season is not null
group by playerId,
    season,
    name,
    team,
    position
  );

[0m14:13:21.773910 [debug] [Thread-2  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    sum(games_played) as games_played,
    sum(icetime) as ice_time,
    sum(shifts) as shifts,
    sum(gameScore) as game_score,
    sum(I_F_goals) as goals,
    sum(I_F_points) as points,
    sum(I_F_shotsOnGoal) as shots_on_goal,
    sum(I_F_primaryAssists) as primary_assists,
    sum(I_F_secondaryAssists) as secondary_assists,
    sum(I_F_xOnGoal) as expected_on_goal,
    sum(I_F_xGoals) as expected_goals,
    sum(I_F_xRebounds) as expected_rebounds,
    sum(I_F_rebounds) as rebounds,
    sum(I_F_freeze) as freeze,
    sum(I_F_playStopped) as play_stopped,
    sum(I_F_playContinuedInZone) as play_continued_in_zone,
    sum(I_F_playContinuedOutsideZone) as play_continued_outside_zone,
    sum(I_F_lowDangerShots) as low_danger_shots,
    sum(I_F_mediumDangerShots) as medium_danger_shots,
    sum(I_F_highDangerShots) as high_danger_shots,
    sum(I_F_lowDangerxGoals) as low_danger_expected_goals,
    sum(I_F_mediumDangerxGoals) as medium_danger_expected_goals,
    sum(I_F_highDangerxGoals) as high_danger_expected_goals,
    sum(I_F_lowDangerGoals) as low_danger_goals,
    sum(I_F_mediumDangerGoals) as medium_danger_goals,
    sum(I_F_highDangerGoals) as high_danger_goals,
    case
        when sum(games_played) > 0 then true
        else false
    end as is_active_player,
    case
        when sum(games_played) > 0 then round(sum(I_F_points) * 1.0 / sum(games_played), 2)
        else null
    end as points_per_game,
    case
        when sum(I_F_shotsOnGoal) > 0 then round(sum(I_F_goals) * 100.0 / sum(I_F_shotsOnGoal), 2)
        else null
    end as shooting_percentage,
    current_timestamp as loaded_at
from { { source('bronze', 'skaters') } }
where playerId is not null
    and season is not null
group by playerId,
    season,
    name,
    team,
    position
  );

[0m14:13:21.774163 [debug] [Thread-3  ]: DuckDB adapter: Rolling back transaction.
[0m14:13:21.774536 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    { { config(materialized = 'view') } }
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    sum(games_played) as games_played,
    sum(icetime) as ice_time,
    sum(xGoals) as expected_goals,
    sum(goals) as goals,
    sum(unblocked_shot_attempts) as unblocked_shot_attempts,
    sum(xRebounds) as expected_rebounds,
    sum(rebounds) as rebounds,
    sum(xFreeze) as expected_freeze,
    sum(freeze) as freeze,
    sum(xOnGoal) as expected_on_goal,
    sum(ongoal) as on_goal,
    sum(xPlayStopped) as expected_play_stopped,
    sum(playStopped) as play_stopped,
    sum(xPlayContinuedInZone) as expected_play_continued_in_zone,
    sum(playContinuedInZone) as play_continued_in_zone,
    sum(xPlayContinuedOutsideZone) as expected_play_continued_outside_zone,
    sum(playContinuedOutsideZone) as play_continued_outside_zone,
    sum(flurryAdjustedxGoals) as flurry_adjusted_expected_goals,
    sum(lowDangerShots) as low_danger_shots,
    sum(mediumDangerShots) as medium_danger_shots,
    sum(highDangerShots) as high_danger_shots,
    sum(lowDangerxGoals) as low_danger_expected_goals,
    sum(mediumDangerxGoals) as medium_danger_expected_goals,
    sum(highDangerxGoals) as high_danger_expected_goals,
    sum(lowDangerGoals) as low_danger_goals,
    sum(mediumDangerGoals) as medium_danger_goals,
    sum(highDangerGoals) as high_danger_goals,
    sum(blocked_shot_attempts) as blocked_shot_attempts,
    sum(penalityMinutes) as penalty_minutes,
    sum(penalties) as penalties,
    current_timestamp as loaded_at
from { { source('bronze', 'goalies') } }
where playerId is not null
    and season is not null
group by playerId,
    season,
    name,
    team,
    position
  );

[0m14:13:21.774789 [debug] [Thread-2  ]: DuckDB adapter: Rolling back transaction.
[0m14:13:21.775048 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: ROLLBACK
[0m14:13:21.775251 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m14:13:21.775506 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: ROLLBACK
[0m14:13:21.775844 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: ROLLBACK
[0m14:13:21.813342 [debug] [Thread-3  ]: Failed to rollback 'model.nhl_analytics.stg_teams'
[0m14:13:21.813821 [debug] [Thread-1  ]: Failed to rollback 'model.nhl_analytics.stg_goalies'
[0m14:13:21.814042 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: Close
[0m14:13:21.814477 [debug] [Thread-2  ]: Failed to rollback 'model.nhl_analytics.stg_skaters'
[0m14:13:21.814678 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: Close
[0m14:13:21.814996 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: Close
[0m14:13:21.818056 [debug] [Thread-3  ]: Runtime Error in model stg_teams (models/staging/stg_teams.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m14:13:21.821355 [debug] [Thread-1  ]: Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m14:13:21.824931 [debug] [Thread-2  ]: Runtime Error in model stg_skaters (models/staging/stg_skaters.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m14:13:21.825423 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfa2c510-536e-4d69-9d12-c03e4956e5b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105772f70>]}
[0m14:13:21.825626 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfa2c510-536e-4d69-9d12-c03e4956e5b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c42070>]}
[0m14:13:21.825902 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfa2c510-536e-4d69-9d12-c03e4956e5b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c6bdc0>]}
[0m14:13:21.826214 [error] [Thread-3  ]: 3 of 7 ERROR creating sql view model silver.stg_teams .......................... [[31mERROR[0m in 0.09s]
[0m14:13:21.826596 [error] [Thread-1  ]: 1 of 7 ERROR creating sql view model silver.stg_goalies ........................ [[31mERROR[0m in 0.09s]
[0m14:13:21.826944 [error] [Thread-2  ]: 2 of 7 ERROR creating sql view model silver.stg_skaters ........................ [[31mERROR[0m in 0.09s]
[0m14:13:21.827269 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.stg_teams
[0m14:13:21.827564 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.stg_goalies
[0m14:13:21.827860 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.stg_skaters
[0m14:13:21.828174 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_teams' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_teams (models/staging/stg_teams.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^.
[0m14:13:21.828525 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_goalies' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^.
[0m14:13:21.828833 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_skaters' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_skaters (models/staging/stg_skaters.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^.
[0m14:13:21.829056 [debug] [Thread-4  ]: Began running node model.nhl_analytics.mart_team_standings
[0m14:13:21.829348 [debug] [Thread-1  ]: Began running node model.nhl_analytics.int_all_players
[0m14:13:21.829569 [info ] [Thread-4  ]: 4 of 7 SKIP relation silver.mart_team_standings ................................ [[33mSKIP[0m]
[0m14:13:21.829813 [info ] [Thread-1  ]: 5 of 7 SKIP relation silver.int_all_players .................................... [[33mSKIP[0m]
[0m14:13:21.830051 [debug] [Thread-4  ]: Finished running node model.nhl_analytics.mart_team_standings
[0m14:13:21.830270 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.int_all_players
[0m14:13:21.830655 [debug] [Thread-3  ]: Began running node model.nhl_analytics.mart_goalie_performance
[0m14:13:21.830906 [debug] [Thread-2  ]: Began running node model.nhl_analytics.mart_player_performance
[0m14:13:21.831126 [info ] [Thread-3  ]: 6 of 7 SKIP relation silver.mart_goalie_performance ............................ [[33mSKIP[0m]
[0m14:13:21.831459 [info ] [Thread-2  ]: 7 of 7 SKIP relation silver.mart_player_performance ............................ [[33mSKIP[0m]
[0m14:13:21.831729 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.mart_goalie_performance
[0m14:13:21.831952 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.mart_player_performance
[0m14:13:21.832552 [debug] [MainThread]: Using duckdb connection "master"
[0m14:13:21.832731 [debug] [MainThread]: On master: BEGIN
[0m14:13:21.832911 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:13:21.833272 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:13:21.833441 [debug] [MainThread]: On master: COMMIT
[0m14:13:21.833604 [debug] [MainThread]: Using duckdb connection "master"
[0m14:13:21.833759 [debug] [MainThread]: On master: COMMIT
[0m14:13:21.834009 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:13:21.834177 [debug] [MainThread]: On master: Close
[0m14:13:21.834387 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:13:21.834541 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_goalies' was properly closed.
[0m14:13:21.834686 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_skaters' was properly closed.
[0m14:13:21.834832 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_teams' was properly closed.
[0m14:13:21.835054 [info ] [MainThread]: 
[0m14:13:21.835353 [info ] [MainThread]: Finished running 3 table models, 4 view models in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m14:13:21.836007 [debug] [MainThread]: Command end result
[0m14:13:21.851123 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m14:13:21.852054 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m14:13:21.855821 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/run_results.json
[0m14:13:21.856011 [info ] [MainThread]: 
[0m14:13:21.856251 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m14:13:21.856441 [info ] [MainThread]: 
[0m14:13:21.856676 [error] [MainThread]: [31mFailure in model stg_teams (models/staging/stg_teams.sql)[0m
[0m14:13:21.856891 [error] [MainThread]:   Runtime Error in model stg_teams (models/staging/stg_teams.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m14:13:21.857094 [info ] [MainThread]: 
[0m14:13:21.857295 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_teams.sql
[0m14:13:21.857472 [info ] [MainThread]: 
[0m14:13:21.857677 [error] [MainThread]: [31mFailure in model stg_goalies (models/staging/stg_goalies.sql)[0m
[0m14:13:21.857888 [error] [MainThread]:   Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m14:13:21.858059 [info ] [MainThread]: 
[0m14:13:21.858256 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_goalies.sql
[0m14:13:21.858425 [info ] [MainThread]: 
[0m14:13:21.858628 [error] [MainThread]: [31mFailure in model stg_skaters (models/staging/stg_skaters.sql)[0m
[0m14:13:21.858832 [error] [MainThread]:   Runtime Error in model stg_skaters (models/staging/stg_skaters.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'view') } }
              ^
[0m14:13:21.858997 [info ] [MainThread]: 
[0m14:13:21.859193 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_skaters.sql
[0m14:13:21.859367 [info ] [MainThread]: 
[0m14:13:21.859555 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=4 NO-OP=0 TOTAL=7
[0m14:13:21.860483 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7879539, "process_in_blocks": "0", "process_kernel_time": 0.191177, "process_mem_max_rss": "142573568", "process_out_blocks": "0", "process_user_time": 1.338016}
[0m14:13:21.860713 [debug] [MainThread]: Command `python -m dbt.cli.main run` failed at 14:13:21.860668 after 0.79 seconds
[0m14:13:21.860938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f72310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105723520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105184340>]}
[0m14:13:21.861216 [debug] [MainThread]: Flushing usage events
[0m14:13:22.168915 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:16:48.642122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033a3340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104529430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104529250>]}


============================== 14:16:48.644786 | 8dadcee6-fb66-4b31-a541-c550b8775c54 ==============================
[0m14:16:48.644786 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:16:48.645133 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'profiles_dir': '.', 'target_path': 'None', 'quiet': 'False', 'partial_parse': 'True', 'introspect': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'empty': 'None', 'use_experimental_parser': 'False', 'invocation_command': 'dbt clean --profiles-dir .', 'printer_width': '80', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None'}
[0m14:16:48.711526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8dadcee6-fb66-4b31-a541-c550b8775c54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104505d90>]}
[0m14:16:48.722731 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.12115296, "process_in_blocks": "0", "process_kernel_time": 0.09454, "process_mem_max_rss": "99811328", "process_out_blocks": "0", "process_user_time": 0.787431}
[0m14:16:48.722982 [debug] [MainThread]: Command `python -m dbt.cli.main clean` succeeded at 14:16:48.722933 after 0.12 seconds
[0m14:16:48.723181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033a3340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104616bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045d5460>]}
[0m14:16:48.723381 [debug] [MainThread]: Flushing usage events
[0m14:16:48.958972 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:16:56.046362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10390d370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a94550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a94370>]}


============================== 14:16:56.049522 | 93b66cc7-bb2a-41c0-afe2-5a92a79bbde0 ==============================
[0m14:16:56.049522 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:16:56.050052 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --profiles-dir .', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'no_print': 'None', 'debug': 'False', 'profiles_dir': '.', 'write_json': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'warn_error': 'None', 'use_colors': 'True', 'target_path': 'None', 'fail_fast': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'introspect': 'True', 'partial_parse': 'True'}
[0m14:16:56.231444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93b66cc7-bb2a-41c0-afe2-5a92a79bbde0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b27310>]}
[0m14:16:56.265631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93b66cc7-bb2a-41c0-afe2-5a92a79bbde0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c5b7c0>]}
[0m14:16:56.267295 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m14:16:56.335327 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:16:56.335802 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:16:56.336046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '93b66cc7-bb2a-41c0-afe2-5a92a79bbde0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d05100>]}
[0m14:16:56.912901 [info ] [MainThread]: Exporting mart_goalie_performance to silver folder
[0m14:16:56.917073 [info ] [MainThread]: Exporting mart_player_performance to silver folder
[0m14:16:56.920909 [info ] [MainThread]: Exporting mart_team_standings to silver folder
[0m14:16:57.124502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93b66cc7-bb2a-41c0-afe2-5a92a79bbde0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105403130>]}
[0m14:16:57.211495 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m14:16:57.213497 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m14:16:57.223358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93b66cc7-bb2a-41c0-afe2-5a92a79bbde0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c09d0>]}
[0m14:16:57.223676 [info ] [MainThread]: Found 7 models, 6 data tests, 4 sources, 445 macros
[0m14:16:57.223902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93b66cc7-bb2a-41c0-afe2-5a92a79bbde0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10539e580>]}
[0m14:16:57.224829 [info ] [MainThread]: 
[0m14:16:57.225045 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:16:57.225223 [info ] [MainThread]: 
[0m14:16:57.225510 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:16:57.228688 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl'
[0m14:16:57.259759 [debug] [ThreadPool]: Using duckdb connection "list_nhl"
[0m14:16:57.260001 [debug] [ThreadPool]: On list_nhl: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m14:16:57.260171 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:16:57.303304 [debug] [ThreadPool]: SQL status: OK in 0.043 seconds
[0m14:16:57.304421 [debug] [ThreadPool]: On list_nhl: Close
[0m14:16:57.304826 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nhl, now create_nhl_silver)
[0m14:16:57.305120 [debug] [ThreadPool]: Creating schema "database: "nhl"
schema: "silver"
"
[0m14:16:57.309377 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:16:57.309570 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nhl'
        and type='sqlite'
    
  
[0m14:16:57.309737 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:16:57.310330 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:16:57.311182 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:16:57.311358 [debug] [ThreadPool]: On create_nhl_silver: BEGIN
[0m14:16:57.311612 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:16:57.311791 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:16:57.311959 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
    
        create schema if not exists "nhl"."silver"
    
[0m14:16:57.312376 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:16:57.312812 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m14:16:57.312979 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:16:57.313131 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m14:16:57.313367 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:16:57.313539 [debug] [ThreadPool]: On create_nhl_silver: Close
[0m14:16:57.314328 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nhl_silver, now list_nhl_silver)
[0m14:16:57.317661 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m14:16:57.317844 [debug] [ThreadPool]: On list_nhl_silver: BEGIN
[0m14:16:57.318002 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:16:57.318281 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:16:57.318455 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m14:16:57.318629 [debug] [ThreadPool]: On list_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl_silver"} */
select
      'nhl' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'silver'
    and lower(table_catalog) = 'nhl'
  
[0m14:16:57.329121 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m14:16:57.330036 [debug] [ThreadPool]: On list_nhl_silver: ROLLBACK
[0m14:16:57.331194 [debug] [ThreadPool]: Failed to rollback 'list_nhl_silver'
[0m14:16:57.331384 [debug] [ThreadPool]: On list_nhl_silver: Close
[0m14:16:57.332373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93b66cc7-bb2a-41c0-afe2-5a92a79bbde0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105293b80>]}
[0m14:16:57.332637 [debug] [MainThread]: Using duckdb connection "master"
[0m14:16:57.332801 [debug] [MainThread]: On master: BEGIN
[0m14:16:57.332951 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:16:57.333224 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:16:57.333396 [debug] [MainThread]: On master: COMMIT
[0m14:16:57.333555 [debug] [MainThread]: Using duckdb connection "master"
[0m14:16:57.333707 [debug] [MainThread]: On master: COMMIT
[0m14:16:57.333937 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:16:57.334107 [debug] [MainThread]: On master: Close
[0m14:16:57.335520 [debug] [Thread-1  ]: Began running node model.nhl_analytics.stg_goalies
[0m14:16:57.335755 [debug] [Thread-2  ]: Began running node model.nhl_analytics.stg_skaters
[0m14:16:57.336219 [debug] [Thread-3  ]: Began running node model.nhl_analytics.stg_teams
[0m14:16:57.336043 [info ] [Thread-1  ]: 1 of 7 START sql view model silver.stg_goalies ................................. [RUN]
[0m14:16:57.336555 [info ] [Thread-2  ]: 2 of 7 START sql view model silver.stg_skaters ................................. [RUN]
[0m14:16:57.336843 [info ] [Thread-3  ]: 3 of 7 START sql view model silver.stg_teams ................................... [RUN]
[0m14:16:57.337120 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_nhl_silver, now model.nhl_analytics.stg_goalies)
[0m14:16:57.337390 [debug] [Thread-2  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_skaters'
[0m14:16:57.337647 [debug] [Thread-3  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_teams'
[0m14:16:57.337849 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.stg_goalies
[0m14:16:57.338051 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.stg_skaters
[0m14:16:57.338244 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.stg_teams
[0m14:16:57.343336 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.stg_goalies"
[0m14:16:57.345365 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.stg_skaters"
[0m14:16:57.347522 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.stg_teams"
[0m14:16:57.348201 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.stg_goalies
[0m14:16:57.348450 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.stg_teams
[0m14:16:57.348687 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.stg_skaters
[0m14:16:57.370757 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.stg_goalies"
[0m14:16:57.371391 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.stg_teams"
[0m14:16:57.373473 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.stg_skaters"
[0m14:16:57.374208 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:16:57.374461 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m14:16:57.374695 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m14:16:57.374894 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: BEGIN
[0m14:16:57.375100 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: BEGIN
[0m14:16:57.375293 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: BEGIN
[0m14:16:57.375484 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:16:57.375674 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:16:57.375856 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:16:57.376348 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m14:16:57.376572 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m14:16:57.376789 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:16:57.376977 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m14:16:57.377177 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m14:16:57.377396 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

  
  create view "nhl"."silver"."stg_teams__dbt_tmp" as (
    
select season,
    name as team_name,
    team as team_code,
    sum(games_played) as games_played,
    sum(goalsFor) as goalsFor,
    sum(goalsAgainst) as goalsAgainst,
    sum(goalsFor) - sum(goalsAgainst) as goal_differential,
    sum(xGoalsFor) as xGoalsFor,
    sum(xGoalsAgainst) as xGoalsAgainst,
    current_timestamp as loaded_at
from { { source('bronze', 'teams') } }
where season is not null
    and name is not null
group by season,
    name,
    team
  );

[0m14:16:57.377610 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m14:16:57.377863 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    

select 
    playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    sum(games_played) as games_played,
    sum(icetime) as ice_time,
    sum(xGoals) as expected_goals,
    sum(goals) as goals,
    sum(unblocked_shot_attempts) as unblocked_shot_attempts,
    sum(xRebounds) as expected_rebounds,
    sum(rebounds) as rebounds,
    sum(xFreeze) as expected_freeze,
    sum(freeze) as freeze,
    sum(xOnGoal) as expected_on_goal,
    sum(ongoal) as on_goal,
    sum(xPlayStopped) as expected_play_stopped,
    sum(playStopped) as play_stopped,
    sum(xPlayContinuedInZone) as expected_play_continued_in_zone,
    sum(playContinuedInZone) as play_continued_in_zone,
    sum(xPlayContinuedOutsideZone) as expected_play_continued_outside_zone,
    sum(playContinuedOutsideZone) as play_continued_outside_zone,
    sum(flurryAdjustedxGoals) as flurry_adjusted_expected_goals,
    sum(lowDangerShots) as low_danger_shots,
    sum(mediumDangerShots) as medium_danger_shots,
    sum(highDangerShots) as high_danger_shots,
    sum(lowDangerxGoals) as low_danger_expected_goals,
    sum(mediumDangerxGoals) as medium_danger_expected_goals,
    sum(highDangerxGoals) as high_danger_expected_goals,
    sum(lowDangerGoals) as low_danger_goals,
    sum(mediumDangerGoals) as medium_danger_goals,
    sum(highDangerGoals) as high_danger_goals,
    sum(blocked_shot_attempts) as blocked_shot_attempts,
    sum(penalityMinutes) as penalty_minutes,
    sum(penalties) as penalties,
    current_timestamp as loaded_at
from "nhl"."bronze"."goalies"
where playerId is not null
    and season is not null
group by playerId, season, name, team, position
  );

[0m14:16:57.380594 [debug] [Thread-3  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

  
  create view "nhl"."silver"."stg_teams__dbt_tmp" as (
    
select season,
    name as team_name,
    team as team_code,
    sum(games_played) as games_played,
    sum(goalsFor) as goalsFor,
    sum(goalsAgainst) as goalsAgainst,
    sum(goalsFor) - sum(goalsAgainst) as goal_differential,
    sum(xGoalsFor) as xGoalsFor,
    sum(xGoalsAgainst) as xGoalsAgainst,
    current_timestamp as loaded_at
from { { source('bronze', 'teams') } }
where season is not null
    and name is not null
group by season,
    name,
    team
  );

[0m14:16:57.380875 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    sum(games_played) as games_played,
    sum(icetime) as ice_time,
    sum(shifts) as shifts,
    sum(gameScore) as game_score,
    sum(I_F_goals) as goals,
    sum(I_F_points) as points,
    sum(I_F_shotsOnGoal) as shots_on_goal,
    sum(I_F_primaryAssists) as primary_assists,
    sum(I_F_secondaryAssists) as secondary_assists,
    sum(I_F_xOnGoal) as expected_on_goal,
    sum(I_F_xGoals) as expected_goals,
    sum(I_F_xRebounds) as expected_rebounds,
    sum(I_F_rebounds) as rebounds,
    sum(I_F_freeze) as freeze,
    sum(I_F_playStopped) as play_stopped,
    sum(I_F_playContinuedInZone) as play_continued_in_zone,
    sum(I_F_playContinuedOutsideZone) as play_continued_outside_zone,
    sum(I_F_lowDangerShots) as low_danger_shots,
    sum(I_F_mediumDangerShots) as medium_danger_shots,
    sum(I_F_highDangerShots) as high_danger_shots,
    sum(I_F_lowDangerxGoals) as low_danger_expected_goals,
    sum(I_F_mediumDangerxGoals) as medium_danger_expected_goals,
    sum(I_F_highDangerxGoals) as high_danger_expected_goals,
    sum(I_F_lowDangerGoals) as low_danger_goals,
    sum(I_F_mediumDangerGoals) as medium_danger_goals,
    sum(I_F_highDangerGoals) as high_danger_goals,
    case
        when sum(games_played) > 0 then true
        else false
    end as is_active_player,
    case
        when sum(games_played) > 0 then round(sum(I_F_points) * 1.0 / sum(games_played), 2)
        else null
    end as points_per_game,
    case
        when sum(I_F_shotsOnGoal) > 0 then round(sum(I_F_goals) * 100.0 / sum(I_F_shotsOnGoal), 2)
        else null
    end as shooting_percentage,
    current_timestamp as loaded_at
from { { source('bronze', 'skaters') } }
where playerId is not null
    and season is not null
group by playerId,
    season,
    name,
    team,
    position
  );

[0m14:16:57.381326 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    

select 
    playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    sum(games_played) as games_played,
    sum(icetime) as ice_time,
    sum(xGoals) as expected_goals,
    sum(goals) as goals,
    sum(unblocked_shot_attempts) as unblocked_shot_attempts,
    sum(xRebounds) as expected_rebounds,
    sum(rebounds) as rebounds,
    sum(xFreeze) as expected_freeze,
    sum(freeze) as freeze,
    sum(xOnGoal) as expected_on_goal,
    sum(ongoal) as on_goal,
    sum(xPlayStopped) as expected_play_stopped,
    sum(playStopped) as play_stopped,
    sum(xPlayContinuedInZone) as expected_play_continued_in_zone,
    sum(playContinuedInZone) as play_continued_in_zone,
    sum(xPlayContinuedOutsideZone) as expected_play_continued_outside_zone,
    sum(playContinuedOutsideZone) as play_continued_outside_zone,
    sum(flurryAdjustedxGoals) as flurry_adjusted_expected_goals,
    sum(lowDangerShots) as low_danger_shots,
    sum(mediumDangerShots) as medium_danger_shots,
    sum(highDangerShots) as high_danger_shots,
    sum(lowDangerxGoals) as low_danger_expected_goals,
    sum(mediumDangerxGoals) as medium_danger_expected_goals,
    sum(highDangerxGoals) as high_danger_expected_goals,
    sum(lowDangerGoals) as low_danger_goals,
    sum(mediumDangerGoals) as medium_danger_goals,
    sum(highDangerGoals) as high_danger_goals,
    sum(blocked_shot_attempts) as blocked_shot_attempts,
    sum(penalityMinutes) as penalty_minutes,
    sum(penalties) as penalties,
    current_timestamp as loaded_at
from "nhl"."bronze"."goalies"
where playerId is not null
    and season is not null
group by playerId, season, name, team, position
  );

[0m14:16:57.381581 [debug] [Thread-3  ]: DuckDB adapter: Rolling back transaction.
[0m14:16:57.382014 [debug] [Thread-2  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    sum(games_played) as games_played,
    sum(icetime) as ice_time,
    sum(shifts) as shifts,
    sum(gameScore) as game_score,
    sum(I_F_goals) as goals,
    sum(I_F_points) as points,
    sum(I_F_shotsOnGoal) as shots_on_goal,
    sum(I_F_primaryAssists) as primary_assists,
    sum(I_F_secondaryAssists) as secondary_assists,
    sum(I_F_xOnGoal) as expected_on_goal,
    sum(I_F_xGoals) as expected_goals,
    sum(I_F_xRebounds) as expected_rebounds,
    sum(I_F_rebounds) as rebounds,
    sum(I_F_freeze) as freeze,
    sum(I_F_playStopped) as play_stopped,
    sum(I_F_playContinuedInZone) as play_continued_in_zone,
    sum(I_F_playContinuedOutsideZone) as play_continued_outside_zone,
    sum(I_F_lowDangerShots) as low_danger_shots,
    sum(I_F_mediumDangerShots) as medium_danger_shots,
    sum(I_F_highDangerShots) as high_danger_shots,
    sum(I_F_lowDangerxGoals) as low_danger_expected_goals,
    sum(I_F_mediumDangerxGoals) as medium_danger_expected_goals,
    sum(I_F_highDangerxGoals) as high_danger_expected_goals,
    sum(I_F_lowDangerGoals) as low_danger_goals,
    sum(I_F_mediumDangerGoals) as medium_danger_goals,
    sum(I_F_highDangerGoals) as high_danger_goals,
    case
        when sum(games_played) > 0 then true
        else false
    end as is_active_player,
    case
        when sum(games_played) > 0 then round(sum(I_F_points) * 1.0 / sum(games_played), 2)
        else null
    end as points_per_game,
    case
        when sum(I_F_shotsOnGoal) > 0 then round(sum(I_F_goals) * 100.0 / sum(I_F_shotsOnGoal), 2)
        else null
    end as shooting_percentage,
    current_timestamp as loaded_at
from { { source('bronze', 'skaters') } }
where playerId is not null
    and season is not null
group by playerId,
    season,
    name,
    team,
    position
  );

[0m14:16:57.382273 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m14:16:57.382533 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: ROLLBACK
[0m14:16:57.382733 [debug] [Thread-2  ]: DuckDB adapter: Rolling back transaction.
[0m14:16:57.382980 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: ROLLBACK
[0m14:16:57.383370 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: ROLLBACK
[0m14:16:57.419903 [debug] [Thread-1  ]: Failed to rollback 'model.nhl_analytics.stg_goalies'
[0m14:16:57.420133 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: Close
[0m14:16:57.420593 [debug] [Thread-2  ]: Failed to rollback 'model.nhl_analytics.stg_skaters'
[0m14:16:57.421157 [debug] [Thread-3  ]: Failed to rollback 'model.nhl_analytics.stg_teams'
[0m14:16:57.421354 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: Close
[0m14:16:57.421602 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: Close
[0m14:16:57.424552 [debug] [Thread-1  ]: Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 21:     sum(freeze) as freeze,
                         ^
[0m14:16:57.428053 [debug] [Thread-2  ]: Runtime Error in model stg_skaters (models/staging/stg_skaters.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 50: from { { source('bronze', 'skaters') } }
                ^
[0m14:16:57.430737 [debug] [Thread-3  ]: Runtime Error in model stg_teams (models/staging/stg_teams.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 16: from { { source('bronze', 'teams') } }
                ^
[0m14:16:57.431113 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93b66cc7-bb2a-41c0-afe2-5a92a79bbde0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f795b0>]}
[0m14:16:57.431320 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93b66cc7-bb2a-41c0-afe2-5a92a79bbde0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f79190>]}
[0m14:16:57.431502 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93b66cc7-bb2a-41c0-afe2-5a92a79bbde0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f79af0>]}
[0m14:16:57.431866 [error] [Thread-1  ]: 1 of 7 ERROR creating sql view model silver.stg_goalies ........................ [[31mERROR[0m in 0.09s]
[0m14:16:57.432241 [error] [Thread-2  ]: 2 of 7 ERROR creating sql view model silver.stg_skaters ........................ [[31mERROR[0m in 0.09s]
[0m14:16:57.432593 [error] [Thread-3  ]: 3 of 7 ERROR creating sql view model silver.stg_teams .......................... [[31mERROR[0m in 0.09s]
[0m14:16:57.432914 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.stg_goalies
[0m14:16:57.433206 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.stg_skaters
[0m14:16:57.433491 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.stg_teams
[0m14:16:57.433801 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_goalies' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 21:     sum(freeze) as freeze,
                         ^.
[0m14:16:57.434140 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_skaters' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_skaters (models/staging/stg_skaters.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 50: from { { source('bronze', 'skaters') } }
                ^.
[0m14:16:57.434416 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_teams' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_teams (models/staging/stg_teams.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 16: from { { source('bronze', 'teams') } }
                ^.
[0m14:16:57.434701 [debug] [Thread-4  ]: Began running node model.nhl_analytics.int_all_players
[0m14:16:57.434937 [debug] [Thread-1  ]: Began running node model.nhl_analytics.mart_team_standings
[0m14:16:57.435162 [info ] [Thread-4  ]: 4 of 7 SKIP relation silver.int_all_players .................................... [[33mSKIP[0m]
[0m14:16:57.435413 [info ] [Thread-1  ]: 5 of 7 SKIP relation silver.mart_team_standings ................................ [[33mSKIP[0m]
[0m14:16:57.435651 [debug] [Thread-4  ]: Finished running node model.nhl_analytics.int_all_players
[0m14:16:57.435869 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.mart_team_standings
[0m14:16:57.436171 [debug] [Thread-1  ]: Began running node model.nhl_analytics.mart_goalie_performance
[0m14:16:57.436395 [debug] [Thread-3  ]: Began running node model.nhl_analytics.mart_player_performance
[0m14:16:57.436619 [info ] [Thread-1  ]: 6 of 7 SKIP relation silver.mart_goalie_performance ............................ [[33mSKIP[0m]
[0m14:16:57.436867 [info ] [Thread-3  ]: 7 of 7 SKIP relation silver.mart_player_performance ............................ [[33mSKIP[0m]
[0m14:16:57.437123 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.mart_goalie_performance
[0m14:16:57.437344 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.mart_player_performance
[0m14:16:57.437942 [debug] [MainThread]: Using duckdb connection "master"
[0m14:16:57.438118 [debug] [MainThread]: On master: BEGIN
[0m14:16:57.438281 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:16:57.438676 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:16:57.438867 [debug] [MainThread]: On master: COMMIT
[0m14:16:57.439048 [debug] [MainThread]: Using duckdb connection "master"
[0m14:16:57.439220 [debug] [MainThread]: On master: COMMIT
[0m14:16:57.439477 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:16:57.439655 [debug] [MainThread]: On master: Close
[0m14:16:57.439970 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:16:57.440131 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_goalies' was properly closed.
[0m14:16:57.440278 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_skaters' was properly closed.
[0m14:16:57.440427 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_teams' was properly closed.
[0m14:16:57.440634 [info ] [MainThread]: 
[0m14:16:57.440828 [info ] [MainThread]: Finished running 3 table models, 4 view models in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m14:16:57.441556 [debug] [MainThread]: Command end result
[0m14:16:57.456854 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m14:16:57.457805 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m14:16:57.461540 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/run_results.json
[0m14:16:57.461730 [info ] [MainThread]: 
[0m14:16:57.461954 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m14:16:57.462190 [info ] [MainThread]: 
[0m14:16:57.462425 [error] [MainThread]: [31mFailure in model stg_goalies (models/staging/stg_goalies.sql)[0m
[0m14:16:57.462645 [error] [MainThread]:   Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 21:     sum(freeze) as freeze,
                         ^
[0m14:16:57.462825 [info ] [MainThread]: 
[0m14:16:57.463033 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_goalies.sql
[0m14:16:57.463210 [info ] [MainThread]: 
[0m14:16:57.463417 [error] [MainThread]: [31mFailure in model stg_skaters (models/staging/stg_skaters.sql)[0m
[0m14:16:57.463628 [error] [MainThread]:   Runtime Error in model stg_skaters (models/staging/stg_skaters.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 50: from { { source('bronze', 'skaters') } }
                ^
[0m14:16:57.463799 [info ] [MainThread]: 
[0m14:16:57.463994 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_skaters.sql
[0m14:16:57.464285 [info ] [MainThread]: 
[0m14:16:57.464521 [error] [MainThread]: [31mFailure in model stg_teams (models/staging/stg_teams.sql)[0m
[0m14:16:57.464730 [error] [MainThread]:   Runtime Error in model stg_teams (models/staging/stg_teams.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 16: from { { source('bronze', 'teams') } }
                ^
[0m14:16:57.464901 [info ] [MainThread]: 
[0m14:16:57.465097 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_teams.sql
[0m14:16:57.465267 [info ] [MainThread]: 
[0m14:16:57.465459 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=4 NO-OP=0 TOTAL=7
[0m14:16:57.466467 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4684073, "process_in_blocks": "0", "process_kernel_time": 0.197767, "process_mem_max_rss": "150781952", "process_out_blocks": "0", "process_user_time": 2.048956}
[0m14:16:57.466703 [debug] [MainThread]: Command `python -m dbt.cli.main run` failed at 14:16:57.466658 after 1.47 seconds
[0m14:16:57.466978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10390d370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ea5df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c08b0>]}
[0m14:16:57.467217 [debug] [MainThread]: Flushing usage events
[0m14:16:57.652753 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:17:35.753477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059723a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106df9460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106df9280>]}


============================== 14:17:35.756368 | 1a6a058c-2d50-41ec-97c5-e938ff77f122 ==============================
[0m14:17:35.756368 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:17:35.756712 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '.', 'write_json': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'printer_width': '80', 'version_check': 'True', 'partial_parse': 'True', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'fail_fast': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'quiet': 'False', 'invocation_command': 'dbt run --profiles-dir .', 'indirect_selection': 'eager', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m14:17:35.936434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a6a058c-2d50-41ec-97c5-e938ff77f122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104059640>]}
[0m14:17:35.970421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a6a058c-2d50-41ec-97c5-e938ff77f122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e9bc10>]}
[0m14:17:35.972076 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m14:17:36.041886 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:17:36.132040 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:17:36.132409 [debug] [MainThread]: Partial parsing: updated file: nhl_analytics://models/staging/stg_skaters.sql
[0m14:17:36.132644 [debug] [MainThread]: Partial parsing: updated file: nhl_analytics://models/staging/stg_teams.sql
[0m14:17:36.313656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a6a058c-2d50-41ec-97c5-e938ff77f122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110804640>]}
[0m14:17:36.374543 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m14:17:36.376507 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m14:17:36.386342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a6a058c-2d50-41ec-97c5-e938ff77f122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ebffd0>]}
[0m14:17:36.386624 [info ] [MainThread]: Found 7 models, 6 data tests, 4 sources, 445 macros
[0m14:17:36.386845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a6a058c-2d50-41ec-97c5-e938ff77f122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110893d00>]}
[0m14:17:36.387750 [info ] [MainThread]: 
[0m14:17:36.387963 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:17:36.388142 [info ] [MainThread]: 
[0m14:17:36.388411 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:17:36.391488 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl'
[0m14:17:36.422504 [debug] [ThreadPool]: Using duckdb connection "list_nhl"
[0m14:17:36.422735 [debug] [ThreadPool]: On list_nhl: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m14:17:36.422908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:36.463088 [debug] [ThreadPool]: SQL status: OK in 0.040 seconds
[0m14:17:36.464155 [debug] [ThreadPool]: On list_nhl: Close
[0m14:17:36.464540 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nhl, now create_nhl_silver)
[0m14:17:36.464806 [debug] [ThreadPool]: Creating schema "database: "nhl"
schema: "silver"
"
[0m14:17:36.469202 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:17:36.469431 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nhl'
        and type='sqlite'
    
  
[0m14:17:36.469613 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:17:36.470253 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:17:36.471087 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:17:36.471281 [debug] [ThreadPool]: On create_nhl_silver: BEGIN
[0m14:17:36.471556 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:17:36.471736 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:17:36.471905 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
    
        create schema if not exists "nhl"."silver"
    
[0m14:17:36.472181 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:17:36.472630 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m14:17:36.472797 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:17:36.472951 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m14:17:36.473196 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:17:36.473368 [debug] [ThreadPool]: On create_nhl_silver: Close
[0m14:17:36.474171 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nhl_silver, now list_nhl_silver)
[0m14:17:36.477524 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m14:17:36.477708 [debug] [ThreadPool]: On list_nhl_silver: BEGIN
[0m14:17:36.477864 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:17:36.478139 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:17:36.478308 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m14:17:36.478480 [debug] [ThreadPool]: On list_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl_silver"} */
select
      'nhl' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'silver'
    and lower(table_catalog) = 'nhl'
  
[0m14:17:36.487700 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:17:36.488442 [debug] [ThreadPool]: On list_nhl_silver: ROLLBACK
[0m14:17:36.489614 [debug] [ThreadPool]: Failed to rollback 'list_nhl_silver'
[0m14:17:36.489790 [debug] [ThreadPool]: On list_nhl_silver: Close
[0m14:17:36.490701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a6a058c-2d50-41ec-97c5-e938ff77f122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e34b50>]}
[0m14:17:36.490984 [debug] [MainThread]: Using duckdb connection "master"
[0m14:17:36.491149 [debug] [MainThread]: On master: BEGIN
[0m14:17:36.491300 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:17:36.491567 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:17:36.491742 [debug] [MainThread]: On master: COMMIT
[0m14:17:36.491905 [debug] [MainThread]: Using duckdb connection "master"
[0m14:17:36.492054 [debug] [MainThread]: On master: COMMIT
[0m14:17:36.492286 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:17:36.492456 [debug] [MainThread]: On master: Close
[0m14:17:36.493786 [debug] [Thread-1  ]: Began running node model.nhl_analytics.stg_goalies
[0m14:17:36.494027 [debug] [Thread-2  ]: Began running node model.nhl_analytics.stg_skaters
[0m14:17:36.494503 [debug] [Thread-3  ]: Began running node model.nhl_analytics.stg_teams
[0m14:17:36.494327 [info ] [Thread-1  ]: 1 of 7 START sql view model silver.stg_goalies ................................. [RUN]
[0m14:17:36.494869 [info ] [Thread-2  ]: 2 of 7 START sql view model silver.stg_skaters ................................. [RUN]
[0m14:17:36.495159 [info ] [Thread-3  ]: 3 of 7 START sql view model silver.stg_teams ................................... [RUN]
[0m14:17:36.495430 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_nhl_silver, now model.nhl_analytics.stg_goalies)
[0m14:17:36.495710 [debug] [Thread-2  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_skaters'
[0m14:17:36.495967 [debug] [Thread-3  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_teams'
[0m14:17:36.496171 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.stg_goalies
[0m14:17:36.496372 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.stg_skaters
[0m14:17:36.496566 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.stg_teams
[0m14:17:36.501886 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.stg_goalies"
[0m14:17:36.504284 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.stg_skaters"
[0m14:17:36.506210 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.stg_teams"
[0m14:17:36.506728 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.stg_goalies
[0m14:17:36.506992 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.stg_skaters
[0m14:17:36.513896 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.stg_teams
[0m14:17:36.525690 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.stg_goalies"
[0m14:17:36.527691 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.stg_skaters"
[0m14:17:36.529751 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.stg_teams"
[0m14:17:36.530240 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m14:17:36.530485 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m14:17:36.530720 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: BEGIN
[0m14:17:36.530948 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: BEGIN
[0m14:17:36.531168 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:17:36.531372 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:17:36.531560 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:17:36.531752 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: BEGIN
[0m14:17:36.532129 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:17:36.532428 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m14:17:36.532632 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m14:17:36.532817 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m14:17:36.533002 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m14:17:36.533192 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m14:17:36.533430 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    sum(games_played) as games_played,
    sum(icetime) as ice_time,
    sum(shifts) as shifts,
    sum(gameScore) as game_score,
    sum(I_F_goals) as goals,
    sum(I_F_points) as points,
    sum(I_F_shotsOnGoal) as shots_on_goal,
    sum(I_F_primaryAssists) as primary_assists,
    sum(I_F_secondaryAssists) as secondary_assists,
    sum(I_F_xOnGoal) as expected_on_goal,
    sum(I_F_xGoals) as expected_goals,
    sum(I_F_xRebounds) as expected_rebounds,
    sum(I_F_rebounds) as rebounds,
    sum(I_F_freeze) as freeze,
    sum(I_F_playStopped) as play_stopped,
    sum(I_F_playContinuedInZone) as play_continued_in_zone,
    sum(I_F_playContinuedOutsideZone) as play_continued_outside_zone,
    sum(I_F_lowDangerShots) as low_danger_shots,
    sum(I_F_mediumDangerShots) as medium_danger_shots,
    sum(I_F_highDangerShots) as high_danger_shots,
    sum(I_F_lowDangerxGoals) as low_danger_expected_goals,
    sum(I_F_mediumDangerxGoals) as medium_danger_expected_goals,
    sum(I_F_highDangerxGoals) as high_danger_expected_goals,
    sum(I_F_lowDangerGoals) as low_danger_goals,
    sum(I_F_mediumDangerGoals) as medium_danger_goals,
    sum(I_F_highDangerGoals) as high_danger_goals,
    case
        when sum(games_played) > 0 then true
        else false
    end as is_active_player,
    case
        when sum(games_played) > 0 then round(sum(I_F_points) * 1.0 / sum(games_played), 2)
        else null
    end as points_per_game,
    case
        when sum(I_F_shotsOnGoal) > 0 then round(sum(I_F_goals) * 100.0 / sum(I_F_shotsOnGoal), 2)
        else null
    end as shooting_percentage,
    current_timestamp as loaded_at
from "nhl"."bronze"."skaters"
where playerId is not null
    and season is not null
group by playerId,
    season,
    name,
    team,
    position
  );

[0m14:17:36.533677 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:17:36.533904 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    

select 
    playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    sum(games_played) as games_played,
    sum(icetime) as ice_time,
    sum(xGoals) as expected_goals,
    sum(goals) as goals,
    sum(unblocked_shot_attempts) as unblocked_shot_attempts,
    sum(xRebounds) as expected_rebounds,
    sum(rebounds) as rebounds,
    sum(xFreeze) as expected_freeze,
    sum(freeze) as freeze,
    sum(xOnGoal) as expected_on_goal,
    sum(ongoal) as on_goal,
    sum(xPlayStopped) as expected_play_stopped,
    sum(playStopped) as play_stopped,
    sum(xPlayContinuedInZone) as expected_play_continued_in_zone,
    sum(playContinuedInZone) as play_continued_in_zone,
    sum(xPlayContinuedOutsideZone) as expected_play_continued_outside_zone,
    sum(playContinuedOutsideZone) as play_continued_outside_zone,
    sum(flurryAdjustedxGoals) as flurry_adjusted_expected_goals,
    sum(lowDangerShots) as low_danger_shots,
    sum(mediumDangerShots) as medium_danger_shots,
    sum(highDangerShots) as high_danger_shots,
    sum(lowDangerxGoals) as low_danger_expected_goals,
    sum(mediumDangerxGoals) as medium_danger_expected_goals,
    sum(highDangerxGoals) as high_danger_expected_goals,
    sum(lowDangerGoals) as low_danger_goals,
    sum(mediumDangerGoals) as medium_danger_goals,
    sum(highDangerGoals) as high_danger_goals,
    sum(blocked_shot_attempts) as blocked_shot_attempts,
    sum(penalityMinutes) as penalty_minutes,
    sum(penalties) as penalties,
    current_timestamp as loaded_at
from "nhl"."bronze"."goalies"
where playerId is not null
    and season is not null
group by playerId, season, name, team, position
  );

[0m14:17:36.534360 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

  
  create view "nhl"."silver"."stg_teams__dbt_tmp" as (
    
select season,
    name as team_name,
    team as team_code,
    sum(games_played) as games_played,
    sum(goalsFor) as goalsFor,
    sum(goalsAgainst) as goalsAgainst,
    sum(goalsFor) - sum(goalsAgainst) as goal_differential,
    sum(xGoalsFor) as xGoalsFor,
    sum(xGoalsAgainst) as xGoalsAgainst,
    current_timestamp as loaded_at
from "nhl"."bronze"."teams"
where season is not null
    and name is not null
group by season,
    name,
    team
  );

[0m14:17:36.536634 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    

select 
    playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    sum(games_played) as games_played,
    sum(icetime) as ice_time,
    sum(xGoals) as expected_goals,
    sum(goals) as goals,
    sum(unblocked_shot_attempts) as unblocked_shot_attempts,
    sum(xRebounds) as expected_rebounds,
    sum(rebounds) as rebounds,
    sum(xFreeze) as expected_freeze,
    sum(freeze) as freeze,
    sum(xOnGoal) as expected_on_goal,
    sum(ongoal) as on_goal,
    sum(xPlayStopped) as expected_play_stopped,
    sum(playStopped) as play_stopped,
    sum(xPlayContinuedInZone) as expected_play_continued_in_zone,
    sum(playContinuedInZone) as play_continued_in_zone,
    sum(xPlayContinuedOutsideZone) as expected_play_continued_outside_zone,
    sum(playContinuedOutsideZone) as play_continued_outside_zone,
    sum(flurryAdjustedxGoals) as flurry_adjusted_expected_goals,
    sum(lowDangerShots) as low_danger_shots,
    sum(mediumDangerShots) as medium_danger_shots,
    sum(highDangerShots) as high_danger_shots,
    sum(lowDangerxGoals) as low_danger_expected_goals,
    sum(mediumDangerxGoals) as medium_danger_expected_goals,
    sum(highDangerxGoals) as high_danger_expected_goals,
    sum(lowDangerGoals) as low_danger_goals,
    sum(mediumDangerGoals) as medium_danger_goals,
    sum(highDangerGoals) as high_danger_goals,
    sum(blocked_shot_attempts) as blocked_shot_attempts,
    sum(penalityMinutes) as penalty_minutes,
    sum(penalties) as penalties,
    current_timestamp as loaded_at
from "nhl"."bronze"."goalies"
where playerId is not null
    and season is not null
group by playerId, season, name, team, position
  );

[0m14:17:36.536966 [debug] [Thread-2  ]: SQL status: OK in 0.003 seconds
[0m14:17:36.537191 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m14:17:36.540808 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m14:17:36.541029 [debug] [Thread-3  ]: SQL status: OK in 0.004 seconds
[0m14:17:36.541341 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: ROLLBACK
[0m14:17:36.541562 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */
alter view "nhl"."silver"."stg_skaters" rename to "stg_skaters__dbt_backup"
[0m14:17:36.543435 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:17:36.545418 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */
alter view "nhl"."silver"."stg_teams" rename to "stg_teams__dbt_backup"
[0m14:17:36.545681 [debug] [Thread-2  ]: SQL status: OK in 0.002 seconds
[0m14:17:36.547564 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m14:17:36.547804 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */
alter view "nhl"."silver"."stg_skaters__dbt_tmp" rename to "stg_skaters"
[0m14:17:36.548009 [debug] [Thread-3  ]: SQL status: OK in 0.002 seconds
[0m14:17:36.551541 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:17:36.551830 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */
alter view "nhl"."silver"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m14:17:36.552044 [debug] [Thread-2  ]: SQL status: OK in 0.003 seconds
[0m14:17:36.559667 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: COMMIT
[0m14:17:36.559903 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m14:17:36.560114 [debug] [Thread-3  ]: SQL status: OK in 0.008 seconds
[0m14:17:36.560828 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: COMMIT
[0m14:17:36.561512 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: COMMIT
[0m14:17:36.561786 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:17:36.562025 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: COMMIT
[0m14:17:36.562271 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m14:17:36.565666 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m14:17:36.565912 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

      drop view if exists "nhl"."silver"."stg_skaters__dbt_backup" cascade
    
[0m14:17:36.566120 [debug] [Thread-3  ]: SQL status: OK in 0.004 seconds
[0m14:17:36.568351 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:17:36.568582 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

      drop view if exists "nhl"."silver"."stg_teams__dbt_backup" cascade
    
[0m14:17:36.568795 [debug] [Thread-2  ]: SQL status: OK in 0.002 seconds
[0m14:17:36.570248 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: Close
[0m14:17:36.572568 [debug] [Thread-3  ]: SQL status: OK in 0.004 seconds
[0m14:17:36.573258 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: Close
[0m14:17:36.576309 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a6a058c-2d50-41ec-97c5-e938ff77f122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e34b50>]}
[0m14:17:36.576526 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a6a058c-2d50-41ec-97c5-e938ff77f122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111237d60>]}
[0m14:17:36.578120 [info ] [Thread-2  ]: 2 of 7 OK created sql view model silver.stg_skaters ............................ [[32mOK[0m in 0.07s]
[0m14:17:36.578761 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.stg_skaters
[0m14:17:36.578497 [info ] [Thread-3  ]: 3 of 7 OK created sql view model silver.stg_teams .............................. [[32mOK[0m in 0.08s]
[0m14:17:36.580362 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.stg_teams
[0m14:17:36.580670 [debug] [Thread-4  ]: Began running node model.nhl_analytics.mart_team_standings
[0m14:17:36.580945 [info ] [Thread-4  ]: 4 of 7 START sql table model silver.mart_team_standings ........................ [RUN]
[0m14:17:36.581477 [debug] [Thread-4  ]: Acquiring new duckdb connection 'model.nhl_analytics.mart_team_standings'
[0m14:17:36.581683 [debug] [Thread-4  ]: Began compiling node model.nhl_analytics.mart_team_standings
[0m14:17:36.583596 [debug] [Thread-4  ]: Writing injected SQL for node "model.nhl_analytics.mart_team_standings"
[0m14:17:36.585516 [debug] [Thread-1  ]: Failed to rollback 'model.nhl_analytics.stg_goalies'
[0m14:17:36.585741 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: Close
[0m14:17:36.585956 [debug] [Thread-4  ]: Began executing node model.nhl_analytics.mart_team_standings
[0m14:17:36.598525 [debug] [Thread-4  ]: Writing runtime sql for node "model.nhl_analytics.mart_team_standings"
[0m14:17:36.601480 [debug] [Thread-1  ]: Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 21:     sum(freeze) as freeze,
                         ^
[0m14:17:36.601778 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a6a058c-2d50-41ec-97c5-e938ff77f122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108ef280>]}
[0m14:17:36.602138 [error] [Thread-1  ]: 1 of 7 ERROR creating sql view model silver.stg_goalies ........................ [[31mERROR[0m in 0.11s]
[0m14:17:36.602493 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.stg_goalies
[0m14:17:36.602775 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_goalies' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 21:     sum(freeze) as freeze,
                         ^.
[0m14:17:36.603015 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:17:36.603351 [debug] [Thread-3  ]: Began running node model.nhl_analytics.int_all_players
[0m14:17:36.603549 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: BEGIN
[0m14:17:36.603771 [info ] [Thread-3  ]: 5 of 7 SKIP relation silver.int_all_players .................................... [[33mSKIP[0m]
[0m14:17:36.604021 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:17:36.604228 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.int_all_players
[0m14:17:36.604632 [debug] [Thread-1  ]: Began running node model.nhl_analytics.mart_goalie_performance
[0m14:17:36.604841 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m14:17:36.605060 [debug] [Thread-2  ]: Began running node model.nhl_analytics.mart_player_performance
[0m14:17:36.605279 [info ] [Thread-1  ]: 6 of 7 SKIP relation silver.mart_goalie_performance ............................ [[33mSKIP[0m]
[0m14:17:36.605515 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:17:36.605755 [info ] [Thread-2  ]: 7 of 7 SKIP relation silver.mart_player_performance ............................ [[33mSKIP[0m]
[0m14:17:36.606003 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.mart_goalie_performance
[0m14:17:36.606229 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

  
    
    

    create  table
      "nhl"."silver"."mart_team_standings__dbt_tmp"
  
    as (
      

select 
    season,
    team_name,
    team_code,
    games_played,
    goalsFor,
    goalsAgainst,
    goal_differential,
    xGoalsFor,
    xGoalsAgainst,
    row_number() over (
        order by goalsFor desc,
            goal_differential desc
    ) as standings_rank,
    loaded_at
from "nhl"."silver"."stg_teams"
order by standings_rank
    );
  
  
[0m14:17:36.606460 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.mart_player_performance
[0m14:17:36.615055 [debug] [Thread-4  ]: SQL status: OK in 0.008 seconds
[0m14:17:36.618345 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:17:36.618563 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'silver'
      AND table_name = 'mart_team_standings'
  
[0m14:17:36.619023 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m14:17:36.619712 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:17:36.619916 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'silver'
      AND table_name = 'mart_team_standings'
  
[0m14:17:36.620354 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m14:17:36.622316 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:17:36.622519 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */
alter table "nhl"."silver"."mart_team_standings" rename to "mart_team_standings__dbt_backup"
[0m14:17:36.622843 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m14:17:36.625318 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:17:36.625520 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */
alter table "nhl"."silver"."mart_team_standings__dbt_tmp" rename to "mart_team_standings"
[0m14:17:36.625839 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m14:17:36.629632 [info ] [Thread-4  ]: Exporting mart_team_standings to silver folder
[0m14:17:36.629972 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:17:36.630189 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

        COPY (
    SELECT *
    FROM "nhl"."silver"."mart_team_standings"
) TO '../data/silver/mart_team_standings.parquet' (FORMAT PARQUET);
      
[0m14:17:36.635168 [debug] [Thread-4  ]: SQL status: OK in 0.005 seconds
[0m14:17:36.636011 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: COMMIT
[0m14:17:36.636274 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:17:36.636483 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: COMMIT
[0m14:17:36.636986 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m14:17:36.638516 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:17:36.638719 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

      drop table if exists "nhl"."silver"."mart_team_standings__dbt_backup" cascade
    
[0m14:17:36.639144 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m14:17:36.639830 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: Close
[0m14:17:36.640149 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a6a058c-2d50-41ec-97c5-e938ff77f122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e34b50>]}
[0m14:17:36.640498 [info ] [Thread-4  ]: 4 of 7 OK created sql table model silver.mart_team_standings ................... [[32mOK[0m in 0.06s]
[0m14:17:36.640813 [debug] [Thread-4  ]: Finished running node model.nhl_analytics.mart_team_standings
[0m14:17:36.641407 [debug] [MainThread]: Using duckdb connection "master"
[0m14:17:36.641594 [debug] [MainThread]: On master: BEGIN
[0m14:17:36.641747 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:17:36.642014 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:17:36.642185 [debug] [MainThread]: On master: COMMIT
[0m14:17:36.642354 [debug] [MainThread]: Using duckdb connection "master"
[0m14:17:36.642517 [debug] [MainThread]: On master: COMMIT
[0m14:17:36.642762 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:17:36.642932 [debug] [MainThread]: On master: Close
[0m14:17:36.643137 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:17:36.643285 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_goalies' was properly closed.
[0m14:17:36.643426 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_skaters' was properly closed.
[0m14:17:36.643566 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_teams' was properly closed.
[0m14:17:36.643704 [debug] [MainThread]: Connection 'model.nhl_analytics.mart_team_standings' was properly closed.
[0m14:17:36.643921 [info ] [MainThread]: 
[0m14:17:36.644112 [info ] [MainThread]: Finished running 3 table models, 4 view models in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m14:17:36.644716 [debug] [MainThread]: Command end result
[0m14:17:36.660027 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m14:17:36.660972 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m14:17:36.665287 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/run_results.json
[0m14:17:36.665494 [info ] [MainThread]: 
[0m14:17:36.665719 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:17:36.665909 [info ] [MainThread]: 
[0m14:17:36.666130 [error] [MainThread]: [31mFailure in model stg_goalies (models/staging/stg_goalies.sql)[0m
[0m14:17:36.666346 [error] [MainThread]:   Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 21:     sum(freeze) as freeze,
                         ^
[0m14:17:36.666518 [info ] [MainThread]: 
[0m14:17:36.666721 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_goalies.sql
[0m14:17:36.666898 [info ] [MainThread]: 
[0m14:17:36.667090 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=3 NO-OP=0 TOTAL=7
[0m14:17:36.668043 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9562902, "process_in_blocks": "0", "process_kernel_time": 0.183668, "process_mem_max_rss": "162775040", "process_out_blocks": "0", "process_user_time": 1.504581}
[0m14:17:36.668258 [debug] [MainThread]: Command `python -m dbt.cli.main run` failed at 14:17:36.668217 after 0.96 seconds
[0m14:17:36.668463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059723a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110846d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110846b20>]}
[0m14:17:36.668672 [debug] [MainThread]: Flushing usage events
[0m14:17:36.826774 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:17:48.068256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dc9310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a785b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a783d0>]}


============================== 14:17:48.070497 | bb6d45ab-aeae-45ba-a150-f3729031560d ==============================
[0m14:17:48.070497 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:17:48.070845 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': '.', 'target_path': 'None', 'write_json': 'True', 'use_colors': 'True', 'static_parser': 'True', 'quiet': 'False', 'warn_error': 'None', 'invocation_command': 'dbt run --profiles-dir .', 'use_experimental_parser': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'log_format': 'default', 'printer_width': '80', 'introspect': 'True', 'empty': 'False', 'version_check': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'debug': 'False', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m14:17:48.188621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb6d45ab-aeae-45ba-a150-f3729031560d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10443d580>]}
[0m14:17:48.222132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb6d45ab-aeae-45ba-a150-f3729031560d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11802efd0>]}
[0m14:17:48.223106 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m14:17:48.287943 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:17:48.371301 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:17:48.371543 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:17:48.406087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb6d45ab-aeae-45ba-a150-f3729031560d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1185a3130>]}
[0m14:17:48.491662 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m14:17:48.492705 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m14:17:48.499295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb6d45ab-aeae-45ba-a150-f3729031560d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118572f10>]}
[0m14:17:48.499591 [info ] [MainThread]: Found 7 models, 6 data tests, 4 sources, 445 macros
[0m14:17:48.499828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb6d45ab-aeae-45ba-a150-f3729031560d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1185cfee0>]}
[0m14:17:48.500695 [info ] [MainThread]: 
[0m14:17:48.500912 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:17:48.501098 [info ] [MainThread]: 
[0m14:17:48.501394 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:17:48.504574 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl'
[0m14:17:48.530333 [debug] [ThreadPool]: Using duckdb connection "list_nhl"
[0m14:17:48.530567 [debug] [ThreadPool]: On list_nhl: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m14:17:48.530740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:48.553283 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m14:17:48.553987 [debug] [ThreadPool]: On list_nhl: Close
[0m14:17:48.554401 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nhl, now create_nhl_silver)
[0m14:17:48.554676 [debug] [ThreadPool]: Creating schema "database: "nhl"
schema: "silver"
"
[0m14:17:48.558796 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:17:48.558992 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nhl'
        and type='sqlite'
    
  
[0m14:17:48.559163 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:17:48.559636 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:17:48.560271 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:17:48.560441 [debug] [ThreadPool]: On create_nhl_silver: BEGIN
[0m14:17:48.560697 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:17:48.560852 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:17:48.561009 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
    
        create schema if not exists "nhl"."silver"
    
[0m14:17:48.561274 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:17:48.561689 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m14:17:48.561858 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:17:48.562073 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m14:17:48.562317 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:17:48.562473 [debug] [ThreadPool]: On create_nhl_silver: Close
[0m14:17:48.563258 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nhl_silver, now list_nhl_silver)
[0m14:17:48.566497 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m14:17:48.566716 [debug] [ThreadPool]: On list_nhl_silver: BEGIN
[0m14:17:48.566889 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:17:48.567170 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:17:48.567330 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m14:17:48.567496 [debug] [ThreadPool]: On list_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl_silver"} */
select
      'nhl' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'silver'
    and lower(table_catalog) = 'nhl'
  
[0m14:17:48.574275 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m14:17:48.575107 [debug] [ThreadPool]: On list_nhl_silver: ROLLBACK
[0m14:17:48.576037 [debug] [ThreadPool]: Failed to rollback 'list_nhl_silver'
[0m14:17:48.576213 [debug] [ThreadPool]: On list_nhl_silver: Close
[0m14:17:48.577015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb6d45ab-aeae-45ba-a150-f3729031560d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10607ddc0>]}
[0m14:17:48.577274 [debug] [MainThread]: Using duckdb connection "master"
[0m14:17:48.577444 [debug] [MainThread]: On master: BEGIN
[0m14:17:48.577598 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:17:48.577877 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:17:48.578037 [debug] [MainThread]: On master: COMMIT
[0m14:17:48.578189 [debug] [MainThread]: Using duckdb connection "master"
[0m14:17:48.578340 [debug] [MainThread]: On master: COMMIT
[0m14:17:48.578569 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:17:48.578752 [debug] [MainThread]: On master: Close
[0m14:17:48.579867 [debug] [Thread-1  ]: Began running node model.nhl_analytics.stg_goalies
[0m14:17:48.580118 [debug] [Thread-2  ]: Began running node model.nhl_analytics.stg_skaters
[0m14:17:48.580334 [debug] [Thread-3  ]: Began running node model.nhl_analytics.stg_teams
[0m14:17:48.580610 [info ] [Thread-1  ]: 1 of 7 START sql view model silver.stg_goalies ................................. [RUN]
[0m14:17:48.580938 [info ] [Thread-2  ]: 2 of 7 START sql view model silver.stg_skaters ................................. [RUN]
[0m14:17:48.581234 [info ] [Thread-3  ]: 3 of 7 START sql view model silver.stg_teams ................................... [RUN]
[0m14:17:48.581496 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_nhl_silver, now model.nhl_analytics.stg_goalies)
[0m14:17:48.581760 [debug] [Thread-2  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_skaters'
[0m14:17:48.582008 [debug] [Thread-3  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_teams'
[0m14:17:48.582215 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.stg_goalies
[0m14:17:48.582407 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.stg_skaters
[0m14:17:48.582601 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.stg_teams
[0m14:17:48.587773 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.stg_goalies"
[0m14:17:48.590129 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.stg_skaters"
[0m14:17:48.591956 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.stg_teams"
[0m14:17:48.592449 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.stg_skaters
[0m14:17:48.592708 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.stg_teams
[0m14:17:48.592940 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.stg_goalies
[0m14:17:48.613731 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.stg_skaters"
[0m14:17:48.615099 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.stg_teams"
[0m14:17:48.617091 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.stg_goalies"
[0m14:17:48.617591 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:17:48.617842 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m14:17:48.618068 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m14:17:48.618272 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: BEGIN
[0m14:17:48.618471 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: BEGIN
[0m14:17:48.618667 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: BEGIN
[0m14:17:48.618859 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:17:48.619048 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:17:48.619231 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:17:48.619728 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m14:17:48.619954 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m14:17:48.620161 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m14:17:48.620370 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m14:17:48.620564 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:17:48.620816 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    

select 
    playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    sum(games_played) as games_played,
    sum(icetime) as ice_time,
    sum(xGoals) as expected_goals,
    sum(goals) as goals,
    sum(unblocked_shot_attempts) as unblocked_shot_attempts,
    sum(xRebounds) as expected_rebounds,
    sum(rebounds) as rebounds,
    sum(xFreeze) as expected_freeze,
    sum(freeze) as freeze,
    sum(xOnGoal) as expected_on_goal,
    sum(ongoal) as on_goal,
    sum(xPlayStopped) as expected_play_stopped,
    sum(playStopped) as play_stopped,
    sum(xPlayContinuedInZone) as expected_play_continued_in_zone,
    sum(playContinuedInZone) as play_continued_in_zone,
    sum(xPlayContinuedOutsideZone) as expected_play_continued_outside_zone,
    sum(playContinuedOutsideZone) as play_continued_outside_zone,
    sum(flurryAdjustedxGoals) as flurry_adjusted_expected_goals,
    sum(lowDangerShots) as low_danger_shots,
    sum(mediumDangerShots) as medium_danger_shots,
    sum(highDangerShots) as high_danger_shots,
    sum(lowDangerxGoals) as low_danger_expected_goals,
    sum(mediumDangerxGoals) as medium_danger_expected_goals,
    sum(highDangerxGoals) as high_danger_expected_goals,
    sum(lowDangerGoals) as low_danger_goals,
    sum(mediumDangerGoals) as medium_danger_goals,
    sum(highDangerGoals) as high_danger_goals,
    sum(blocked_shot_attempts) as blocked_shot_attempts,
    sum(penalityMinutes) as penalty_minutes,
    sum(penalties) as penalties,
    current_timestamp as loaded_at
from "nhl"."bronze"."goalies"
where playerId is not null
    and season is not null
group by playerId, season, name, team, position
  );

[0m14:17:48.621065 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m14:17:48.621275 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

  
  create view "nhl"."silver"."stg_teams__dbt_tmp" as (
    
select season,
    name as team_name,
    team as team_code,
    sum(games_played) as games_played,
    sum(goalsFor) as goalsFor,
    sum(goalsAgainst) as goalsAgainst,
    sum(goalsFor) - sum(goalsAgainst) as goal_differential,
    sum(xGoalsFor) as xGoalsFor,
    sum(xGoalsAgainst) as xGoalsAgainst,
    current_timestamp as loaded_at
from "nhl"."bronze"."teams"
where season is not null
    and name is not null
group by season,
    name,
    team
  );

[0m14:17:48.621739 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    

select 
    playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    sum(games_played) as games_played,
    sum(icetime) as ice_time,
    sum(xGoals) as expected_goals,
    sum(goals) as goals,
    sum(unblocked_shot_attempts) as unblocked_shot_attempts,
    sum(xRebounds) as expected_rebounds,
    sum(rebounds) as rebounds,
    sum(xFreeze) as expected_freeze,
    sum(freeze) as freeze,
    sum(xOnGoal) as expected_on_goal,
    sum(ongoal) as on_goal,
    sum(xPlayStopped) as expected_play_stopped,
    sum(playStopped) as play_stopped,
    sum(xPlayContinuedInZone) as expected_play_continued_in_zone,
    sum(playContinuedInZone) as play_continued_in_zone,
    sum(xPlayContinuedOutsideZone) as expected_play_continued_outside_zone,
    sum(playContinuedOutsideZone) as play_continued_outside_zone,
    sum(flurryAdjustedxGoals) as flurry_adjusted_expected_goals,
    sum(lowDangerShots) as low_danger_shots,
    sum(mediumDangerShots) as medium_danger_shots,
    sum(highDangerShots) as high_danger_shots,
    sum(lowDangerxGoals) as low_danger_expected_goals,
    sum(mediumDangerxGoals) as medium_danger_expected_goals,
    sum(highDangerxGoals) as high_danger_expected_goals,
    sum(lowDangerGoals) as low_danger_goals,
    sum(mediumDangerGoals) as medium_danger_goals,
    sum(highDangerGoals) as high_danger_goals,
    sum(blocked_shot_attempts) as blocked_shot_attempts,
    sum(penalityMinutes) as penalty_minutes,
    sum(penalties) as penalties,
    current_timestamp as loaded_at
from "nhl"."bronze"."goalies"
where playerId is not null
    and season is not null
group by playerId, season, name, team, position
  );

[0m14:17:48.622047 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    sum(games_played) as games_played,
    sum(icetime) as ice_time,
    sum(shifts) as shifts,
    sum(gameScore) as game_score,
    sum(I_F_goals) as goals,
    sum(I_F_points) as points,
    sum(I_F_shotsOnGoal) as shots_on_goal,
    sum(I_F_primaryAssists) as primary_assists,
    sum(I_F_secondaryAssists) as secondary_assists,
    sum(I_F_xOnGoal) as expected_on_goal,
    sum(I_F_xGoals) as expected_goals,
    sum(I_F_xRebounds) as expected_rebounds,
    sum(I_F_rebounds) as rebounds,
    sum(I_F_freeze) as freeze,
    sum(I_F_playStopped) as play_stopped,
    sum(I_F_playContinuedInZone) as play_continued_in_zone,
    sum(I_F_playContinuedOutsideZone) as play_continued_outside_zone,
    sum(I_F_lowDangerShots) as low_danger_shots,
    sum(I_F_mediumDangerShots) as medium_danger_shots,
    sum(I_F_highDangerShots) as high_danger_shots,
    sum(I_F_lowDangerxGoals) as low_danger_expected_goals,
    sum(I_F_mediumDangerxGoals) as medium_danger_expected_goals,
    sum(I_F_highDangerxGoals) as high_danger_expected_goals,
    sum(I_F_lowDangerGoals) as low_danger_goals,
    sum(I_F_mediumDangerGoals) as medium_danger_goals,
    sum(I_F_highDangerGoals) as high_danger_goals,
    case
        when sum(games_played) > 0 then true
        else false
    end as is_active_player,
    case
        when sum(games_played) > 0 then round(sum(I_F_points) * 1.0 / sum(games_played), 2)
        else null
    end as points_per_game,
    case
        when sum(I_F_shotsOnGoal) > 0 then round(sum(I_F_goals) * 100.0 / sum(I_F_shotsOnGoal), 2)
        else null
    end as shooting_percentage,
    current_timestamp as loaded_at
from "nhl"."bronze"."skaters"
where playerId is not null
    and season is not null
group by playerId,
    season,
    name,
    team,
    position
  );

[0m14:17:48.622398 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m14:17:48.622807 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: ROLLBACK
[0m14:17:48.623077 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m14:17:48.626742 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:17:48.626983 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */
alter view "nhl"."silver"."stg_teams" rename to "stg_teams__dbt_backup"
[0m14:17:48.628849 [debug] [Thread-2  ]: SQL status: OK in 0.006 seconds
[0m14:17:48.630732 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m14:17:48.630943 [debug] [Thread-3  ]: SQL status: OK in 0.002 seconds
[0m14:17:48.632389 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */
alter view "nhl"."silver"."stg_skaters" rename to "stg_skaters__dbt_backup"
[0m14:17:48.634477 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:17:48.634933 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */
alter view "nhl"."silver"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m14:17:48.635973 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m14:17:48.637850 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m14:17:48.638088 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */
alter view "nhl"."silver"."stg_skaters__dbt_tmp" rename to "stg_skaters"
[0m14:17:48.638864 [debug] [Thread-3  ]: SQL status: OK in 0.003 seconds
[0m14:17:48.645153 [debug] [Thread-2  ]: SQL status: OK in 0.006 seconds
[0m14:17:48.645756 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: COMMIT
[0m14:17:48.646430 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: COMMIT
[0m14:17:48.647102 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:17:48.647349 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m14:17:48.650867 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: COMMIT
[0m14:17:48.651083 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: COMMIT
[0m14:17:48.652597 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m14:17:48.655971 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:17:48.656204 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

      drop view if exists "nhl"."silver"."stg_teams__dbt_backup" cascade
    
[0m14:17:48.656464 [debug] [Thread-2  ]: SQL status: OK in 0.004 seconds
[0m14:17:48.658010 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m14:17:48.659406 [debug] [Thread-3  ]: SQL status: OK in 0.003 seconds
[0m14:17:48.659608 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

      drop view if exists "nhl"."silver"."stg_skaters__dbt_backup" cascade
    
[0m14:17:48.661223 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: Close
[0m14:17:48.662083 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m14:17:48.663968 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: Close
[0m14:17:48.664775 [debug] [Thread-1  ]: Failed to rollback 'model.nhl_analytics.stg_goalies'
[0m14:17:48.665023 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: Close
[0m14:17:48.665350 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb6d45ab-aeae-45ba-a150-f3729031560d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106087730>]}
[0m14:17:48.665563 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb6d45ab-aeae-45ba-a150-f3729031560d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118951dc0>]}
[0m14:17:48.665917 [info ] [Thread-3  ]: 3 of 7 OK created sql view model silver.stg_teams .............................. [[32mOK[0m in 0.08s]
[0m14:17:48.666322 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.stg_teams
[0m14:17:48.666620 [info ] [Thread-2  ]: 2 of 7 OK created sql view model silver.stg_skaters ............................ [[32mOK[0m in 0.08s]
[0m14:17:48.667015 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.stg_skaters
[0m14:17:48.667288 [debug] [Thread-4  ]: Began running node model.nhl_analytics.mart_team_standings
[0m14:17:48.667590 [info ] [Thread-4  ]: 4 of 7 START sql table model silver.mart_team_standings ........................ [RUN]
[0m14:17:48.667884 [debug] [Thread-4  ]: Acquiring new duckdb connection 'model.nhl_analytics.mart_team_standings'
[0m14:17:48.670549 [debug] [Thread-1  ]: Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 21:     sum(freeze) as freeze,
                         ^
[0m14:17:48.670755 [debug] [Thread-4  ]: Began compiling node model.nhl_analytics.mart_team_standings
[0m14:17:48.670999 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb6d45ab-aeae-45ba-a150-f3729031560d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118ac24f0>]}
[0m14:17:48.673111 [debug] [Thread-4  ]: Writing injected SQL for node "model.nhl_analytics.mart_team_standings"
[0m14:17:48.673487 [error] [Thread-1  ]: 1 of 7 ERROR creating sql view model silver.stg_goalies ........................ [[31mERROR[0m in 0.09s]
[0m14:17:48.673932 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.stg_goalies
[0m14:17:48.674283 [debug] [Thread-7  ]: Marking all children of 'model.nhl_analytics.stg_goalies' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 21:     sum(freeze) as freeze,
                         ^.
[0m14:17:48.674641 [debug] [Thread-2  ]: Began running node model.nhl_analytics.int_all_players
[0m14:17:48.674867 [debug] [Thread-4  ]: Began executing node model.nhl_analytics.mart_team_standings
[0m14:17:48.675090 [info ] [Thread-2  ]: 5 of 7 SKIP relation silver.int_all_players .................................... [[33mSKIP[0m]
[0m14:17:48.686743 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.int_all_players
[0m14:17:48.687760 [debug] [Thread-4  ]: Writing runtime sql for node "model.nhl_analytics.mart_team_standings"
[0m14:17:48.688148 [debug] [Thread-1  ]: Began running node model.nhl_analytics.mart_goalie_performance
[0m14:17:48.688376 [debug] [Thread-3  ]: Began running node model.nhl_analytics.mart_player_performance
[0m14:17:48.688630 [info ] [Thread-1  ]: 6 of 7 SKIP relation silver.mart_goalie_performance ............................ [[33mSKIP[0m]
[0m14:17:48.688924 [info ] [Thread-3  ]: 7 of 7 SKIP relation silver.mart_player_performance ............................ [[33mSKIP[0m]
[0m14:17:48.689200 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:17:48.689430 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.mart_goalie_performance
[0m14:17:48.689651 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.mart_player_performance
[0m14:17:48.689854 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: BEGIN
[0m14:17:48.690132 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:17:48.690521 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m14:17:48.690722 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:17:48.690918 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

  
    
    

    create  table
      "nhl"."silver"."mart_team_standings__dbt_tmp"
  
    as (
      

select 
    season,
    team_name,
    team_code,
    games_played,
    goalsFor,
    goalsAgainst,
    goal_differential,
    xGoalsFor,
    xGoalsAgainst,
    row_number() over (
        order by goalsFor desc,
            goal_differential desc
    ) as standings_rank,
    loaded_at
from "nhl"."silver"."stg_teams"
order by standings_rank
    );
  
  
[0m14:17:48.693185 [debug] [Thread-4  ]: SQL status: OK in 0.002 seconds
[0m14:17:48.696535 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:17:48.696771 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'silver'
      AND table_name = 'mart_team_standings'
  
[0m14:17:48.697276 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m14:17:48.698226 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:17:48.698456 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'silver'
      AND table_name = 'mart_team_standings'
  
[0m14:17:48.698935 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m14:17:48.701540 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:17:48.701746 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */
alter table "nhl"."silver"."mart_team_standings" rename to "mart_team_standings__dbt_backup"
[0m14:17:48.702087 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m14:17:48.703806 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:17:48.704031 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */
alter table "nhl"."silver"."mart_team_standings__dbt_tmp" rename to "mart_team_standings"
[0m14:17:48.704363 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m14:17:48.708015 [info ] [Thread-4  ]: Exporting mart_team_standings to silver folder
[0m14:17:48.708373 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:17:48.708575 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

        COPY (
    SELECT *
    FROM "nhl"."silver"."mart_team_standings"
) TO '../data/silver/mart_team_standings.parquet' (FORMAT PARQUET);
      
[0m14:17:48.709695 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m14:17:48.710434 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: COMMIT
[0m14:17:48.710644 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:17:48.710837 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: COMMIT
[0m14:17:48.711299 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m14:17:48.713069 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:17:48.713341 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

      drop table if exists "nhl"."silver"."mart_team_standings__dbt_backup" cascade
    
[0m14:17:48.713811 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m14:17:48.714861 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: Close
[0m14:17:48.715208 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb6d45ab-aeae-45ba-a150-f3729031560d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1188e6400>]}
[0m14:17:48.715554 [info ] [Thread-4  ]: 4 of 7 OK created sql table model silver.mart_team_standings ................... [[32mOK[0m in 0.05s]
[0m14:17:48.715874 [debug] [Thread-4  ]: Finished running node model.nhl_analytics.mart_team_standings
[0m14:17:48.716495 [debug] [MainThread]: Using duckdb connection "master"
[0m14:17:48.716673 [debug] [MainThread]: On master: BEGIN
[0m14:17:48.716824 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:17:48.717120 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:17:48.717291 [debug] [MainThread]: On master: COMMIT
[0m14:17:48.717450 [debug] [MainThread]: Using duckdb connection "master"
[0m14:17:48.717599 [debug] [MainThread]: On master: COMMIT
[0m14:17:48.717833 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:17:48.718003 [debug] [MainThread]: On master: Close
[0m14:17:48.718205 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:17:48.718357 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_goalies' was properly closed.
[0m14:17:48.718499 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_skaters' was properly closed.
[0m14:17:48.718640 [debug] [MainThread]: Connection 'model.nhl_analytics.stg_teams' was properly closed.
[0m14:17:48.718776 [debug] [MainThread]: Connection 'model.nhl_analytics.mart_team_standings' was properly closed.
[0m14:17:48.718981 [info ] [MainThread]: 
[0m14:17:48.719168 [info ] [MainThread]: Finished running 3 table models, 4 view models in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m14:17:48.719767 [debug] [MainThread]: Command end result
[0m14:17:48.735070 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m14:17:48.735994 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m14:17:48.739805 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/run_results.json
[0m14:17:48.739998 [info ] [MainThread]: 
[0m14:17:48.740215 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:17:48.740405 [info ] [MainThread]: 
[0m14:17:48.740631 [error] [MainThread]: [31mFailure in model stg_goalies (models/staging/stg_goalies.sql)[0m
[0m14:17:48.740847 [error] [MainThread]:   Runtime Error in model stg_goalies (models/staging/stg_goalies.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 21:     sum(freeze) as freeze,
                         ^
[0m14:17:48.741021 [info ] [MainThread]: 
[0m14:17:48.741227 [info ] [MainThread]:   compiled code at target/compiled/nhl_analytics/models/staging/stg_goalies.sql
[0m14:17:48.741407 [info ] [MainThread]: 
[0m14:17:48.741600 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=3 NO-OP=0 TOTAL=7
[0m14:17:48.742468 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7139648, "process_in_blocks": "0", "process_kernel_time": 0.125038, "process_mem_max_rss": "157876224", "process_out_blocks": "0", "process_user_time": 1.364211}
[0m14:17:48.742688 [debug] [MainThread]: Command `python -m dbt.cli.main run` failed at 14:17:48.742647 after 0.71 seconds
[0m14:17:48.742893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dc9310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a0f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f0ae80>]}
[0m14:17:48.743098 [debug] [MainThread]: Flushing usage events
[0m14:17:48.887131 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:20:05.390847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f69340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070f0460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070f0280>]}


============================== 14:20:05.393672 | b555368f-7fbe-4655-af49-85da3c923795 ==============================
[0m14:20:05.393672 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:20:05.394031 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'invocation_command': 'dbt run --profiles-dir .', 'use_colors': 'True', 'target_path': 'None', 'warn_error': 'None', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'cache_selected_only': 'False', 'partial_parse': 'True', 'version_check': 'True', 'introspect': 'True', 'no_print': 'None', 'static_parser': 'True', 'write_json': 'True', 'fail_fast': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'empty': 'False'}
[0m14:20:05.574305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b555368f-7fbe-4655-af49-85da3c923795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071b8fd0>]}
[0m14:20:05.607996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b555368f-7fbe-4655-af49-85da3c923795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068a8fd0>]}
[0m14:20:05.609587 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m14:20:05.683875 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:20:05.781483 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:20:05.781884 [debug] [MainThread]: Partial parsing: updated file: nhl_analytics://models/staging/stg_goalies.sql
[0m14:20:05.965372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b555368f-7fbe-4655-af49-85da3c923795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073b6190>]}
[0m14:20:06.026713 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m14:20:06.027923 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m14:20:06.038036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b555368f-7fbe-4655-af49-85da3c923795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10707c280>]}
[0m14:20:06.038327 [info ] [MainThread]: Found 7 models, 6 data tests, 4 sources, 445 macros
[0m14:20:06.038549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b555368f-7fbe-4655-af49-85da3c923795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077e8460>]}
[0m14:20:06.039448 [info ] [MainThread]: 
[0m14:20:06.039667 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:20:06.039847 [info ] [MainThread]: 
[0m14:20:06.040128 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:20:06.043281 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl'
[0m14:20:06.074358 [debug] [ThreadPool]: Using duckdb connection "list_nhl"
[0m14:20:06.074601 [debug] [ThreadPool]: On list_nhl: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m14:20:06.074776 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:20:06.121025 [debug] [ThreadPool]: SQL status: OK in 0.046 seconds
[0m14:20:06.122226 [debug] [ThreadPool]: On list_nhl: Close
[0m14:20:06.122632 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nhl, now create_nhl_silver)
[0m14:20:06.122927 [debug] [ThreadPool]: Creating schema "database: "nhl"
schema: "silver"
"
[0m14:20:06.127116 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:20:06.127310 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nhl'
        and type='sqlite'
    
  
[0m14:20:06.127478 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:20:06.128093 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:20:06.128925 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:20:06.129095 [debug] [ThreadPool]: On create_nhl_silver: BEGIN
[0m14:20:06.129354 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:20:06.129524 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:20:06.129689 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
    
        create schema if not exists "nhl"."silver"
    
[0m14:20:06.130125 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:20:06.130634 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m14:20:06.130819 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:20:06.130985 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m14:20:06.131270 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:20:06.131452 [debug] [ThreadPool]: On create_nhl_silver: Close
[0m14:20:06.132253 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nhl_silver, now list_nhl_silver)
[0m14:20:06.135894 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m14:20:06.136078 [debug] [ThreadPool]: On list_nhl_silver: BEGIN
[0m14:20:06.136235 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:20:06.136506 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:20:06.136679 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m14:20:06.136849 [debug] [ThreadPool]: On list_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl_silver"} */
select
      'nhl' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'silver'
    and lower(table_catalog) = 'nhl'
  
[0m14:20:06.147052 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m14:20:06.147974 [debug] [ThreadPool]: On list_nhl_silver: ROLLBACK
[0m14:20:06.149153 [debug] [ThreadPool]: Failed to rollback 'list_nhl_silver'
[0m14:20:06.149349 [debug] [ThreadPool]: On list_nhl_silver: Close
[0m14:20:06.150284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b555368f-7fbe-4655-af49-85da3c923795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049df550>]}
[0m14:20:06.150556 [debug] [MainThread]: Using duckdb connection "master"
[0m14:20:06.150728 [debug] [MainThread]: On master: BEGIN
[0m14:20:06.150884 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:20:06.151149 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:20:06.151321 [debug] [MainThread]: On master: COMMIT
[0m14:20:06.151483 [debug] [MainThread]: Using duckdb connection "master"
[0m14:20:06.151632 [debug] [MainThread]: On master: COMMIT
[0m14:20:06.151867 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:20:06.152035 [debug] [MainThread]: On master: Close
[0m14:20:06.153362 [debug] [Thread-1  ]: Began running node model.nhl_analytics.stg_goalies
[0m14:20:06.153606 [debug] [Thread-2  ]: Began running node model.nhl_analytics.stg_skaters
[0m14:20:06.154073 [debug] [Thread-3  ]: Began running node model.nhl_analytics.stg_teams
[0m14:20:06.153897 [info ] [Thread-1  ]: 1 of 7 START sql view model silver.stg_goalies ................................. [RUN]
[0m14:20:06.154406 [info ] [Thread-2  ]: 2 of 7 START sql view model silver.stg_skaters ................................. [RUN]
[0m14:20:06.154714 [info ] [Thread-3  ]: 3 of 7 START sql view model silver.stg_teams ................................... [RUN]
[0m14:20:06.155009 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_nhl_silver, now model.nhl_analytics.stg_goalies)
[0m14:20:06.155291 [debug] [Thread-2  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_skaters'
[0m14:20:06.155554 [debug] [Thread-3  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_teams'
[0m14:20:06.155760 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.stg_goalies
[0m14:20:06.155966 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.stg_skaters
[0m14:20:06.156160 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.stg_teams
[0m14:20:06.161391 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.stg_goalies"
[0m14:20:06.163524 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.stg_skaters"
[0m14:20:06.165859 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.stg_teams"
[0m14:20:06.166360 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.stg_goalies
[0m14:20:06.173230 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.stg_teams
[0m14:20:06.178785 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.stg_skaters
[0m14:20:06.184784 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.stg_goalies"
[0m14:20:06.187352 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.stg_teams"
[0m14:20:06.189342 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.stg_skaters"
[0m14:20:06.189815 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:20:06.190063 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m14:20:06.190290 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: BEGIN
[0m14:20:06.190514 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: BEGIN
[0m14:20:06.190737 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m14:20:06.190947 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:20:06.191155 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:20:06.191361 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: BEGIN
[0m14:20:06.191731 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:20:06.191941 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m14:20:06.192210 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m14:20:06.192417 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:20:06.192629 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m14:20:06.192824 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m14:20:06.193035 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

  
  create view "nhl"."silver"."stg_teams__dbt_tmp" as (
    
select season,
    name as team_name,
    team as team_code,
    sum(games_played) as games_played,
    sum(goalsFor) as goalsFor,
    sum(goalsAgainst) as goalsAgainst,
    sum(goalsFor) - sum(goalsAgainst) as goal_differential,
    sum(xGoalsFor) as xGoalsFor,
    sum(xGoalsAgainst) as xGoalsAgainst,
    current_timestamp as loaded_at
from "nhl"."bronze"."teams"
where season is not null
    and name is not null
group by season,
    name,
    team
  );

[0m14:20:06.193296 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    

select 
    playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    sum(games_played) as games_played,
    sum(icetime) as ice_time,
    sum(xGoals) as expected_goals,
    sum(goals) as goals,
    sum(unblocked_shot_attempts) as unblocked_shot_attempts,
    sum(xRebounds) as expected_rebounds,
    sum(rebounds) as rebounds,
    sum(xFreeze) as expected_freeze,
    sum("freeze") as freeze,
    sum(xOnGoal) as expected_on_goal,
    sum(ongoal) as on_goal,
    sum(xPlayStopped) as expected_play_stopped,
    sum(playStopped) as play_stopped,
    sum(xPlayContinuedInZone) as expected_play_continued_in_zone,
    sum(playContinuedInZone) as play_continued_in_zone,
    sum(xPlayContinuedOutsideZone) as expected_play_continued_outside_zone,
    sum(playContinuedOutsideZone) as play_continued_outside_zone,
    sum(flurryAdjustedxGoals) as flurry_adjusted_expected_goals,
    sum(lowDangerShots) as low_danger_shots,
    sum(mediumDangerShots) as medium_danger_shots,
    sum(highDangerShots) as high_danger_shots,
    sum(lowDangerxGoals) as low_danger_expected_goals,
    sum(mediumDangerxGoals) as medium_danger_expected_goals,
    sum(highDangerxGoals) as high_danger_expected_goals,
    sum(lowDangerGoals) as low_danger_goals,
    sum(mediumDangerGoals) as medium_danger_goals,
    sum(highDangerGoals) as high_danger_goals,
    sum(blocked_shot_attempts) as blocked_shot_attempts,
    sum(penalityMinutes) as penalty_minutes,
    sum(penalties) as penalties,
    current_timestamp as loaded_at
from "nhl"."bronze"."goalies"
where playerId is not null
    and season is not null
group by playerId, season, name, team, position
  );

[0m14:20:06.193545 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m14:20:06.194023 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    sum(games_played) as games_played,
    sum(icetime) as ice_time,
    sum(shifts) as shifts,
    sum(gameScore) as game_score,
    sum(I_F_goals) as goals,
    sum(I_F_points) as points,
    sum(I_F_shotsOnGoal) as shots_on_goal,
    sum(I_F_primaryAssists) as primary_assists,
    sum(I_F_secondaryAssists) as secondary_assists,
    sum(I_F_xOnGoal) as expected_on_goal,
    sum(I_F_xGoals) as expected_goals,
    sum(I_F_xRebounds) as expected_rebounds,
    sum(I_F_rebounds) as rebounds,
    sum(I_F_freeze) as freeze,
    sum(I_F_playStopped) as play_stopped,
    sum(I_F_playContinuedInZone) as play_continued_in_zone,
    sum(I_F_playContinuedOutsideZone) as play_continued_outside_zone,
    sum(I_F_lowDangerShots) as low_danger_shots,
    sum(I_F_mediumDangerShots) as medium_danger_shots,
    sum(I_F_highDangerShots) as high_danger_shots,
    sum(I_F_lowDangerxGoals) as low_danger_expected_goals,
    sum(I_F_mediumDangerxGoals) as medium_danger_expected_goals,
    sum(I_F_highDangerxGoals) as high_danger_expected_goals,
    sum(I_F_lowDangerGoals) as low_danger_goals,
    sum(I_F_mediumDangerGoals) as medium_danger_goals,
    sum(I_F_highDangerGoals) as high_danger_goals,
    case
        when sum(games_played) > 0 then true
        else false
    end as is_active_player,
    case
        when sum(games_played) > 0 then round(sum(I_F_points) * 1.0 / sum(games_played), 2)
        else null
    end as points_per_game,
    case
        when sum(I_F_shotsOnGoal) > 0 then round(sum(I_F_goals) * 100.0 / sum(I_F_shotsOnGoal), 2)
        else null
    end as shooting_percentage,
    current_timestamp as loaded_at
from "nhl"."bronze"."skaters"
where playerId is not null
    and season is not null
group by playerId,
    season,
    name,
    team,
    position
  );

[0m14:20:06.195128 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m14:20:06.198767 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:20:06.198995 [debug] [Thread-1  ]: SQL status: OK in 0.005 seconds
[0m14:20:06.199204 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */
alter view "nhl"."silver"."stg_teams" rename to "stg_teams__dbt_backup"
[0m14:20:06.199397 [debug] [Thread-2  ]: SQL status: OK in 0.005 seconds
[0m14:20:06.201261 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m14:20:06.203362 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m14:20:06.203593 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */
alter view "nhl"."silver"."stg_goalies" rename to "stg_goalies__dbt_backup"
[0m14:20:06.203805 [debug] [Thread-3  ]: SQL status: OK in 0.002 seconds
[0m14:20:06.204011 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */
alter view "nhl"."silver"."stg_skaters" rename to "stg_skaters__dbt_backup"
[0m14:20:06.205845 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:20:06.206123 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m14:20:06.206339 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */
alter view "nhl"."silver"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m14:20:06.208541 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m14:20:06.208757 [debug] [Thread-2  ]: SQL status: OK in 0.003 seconds
[0m14:20:06.209014 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */
alter view "nhl"."silver"."stg_goalies__dbt_tmp" rename to "stg_goalies"
[0m14:20:06.210760 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m14:20:06.210966 [debug] [Thread-3  ]: SQL status: OK in 0.002 seconds
[0m14:20:06.211211 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */
alter view "nhl"."silver"."stg_skaters__dbt_tmp" rename to "stg_skaters"
[0m14:20:06.217704 [debug] [Thread-1  ]: SQL status: OK in 0.007 seconds
[0m14:20:06.218254 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: COMMIT
[0m14:20:06.218982 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: COMMIT
[0m14:20:06.219208 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:20:06.219432 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m14:20:06.219626 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m14:20:06.219813 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: COMMIT
[0m14:20:06.219999 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: COMMIT
[0m14:20:06.220615 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: COMMIT
[0m14:20:06.220947 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m14:20:06.221181 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: COMMIT
[0m14:20:06.221602 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m14:20:06.224934 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:20:06.225167 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

      drop view if exists "nhl"."silver"."stg_teams__dbt_backup" cascade
    
[0m14:20:06.225378 [debug] [Thread-1  ]: SQL status: OK in 0.005 seconds
[0m14:20:06.225583 [debug] [Thread-2  ]: SQL status: OK in 0.004 seconds
[0m14:20:06.227379 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m14:20:06.228938 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m14:20:06.229143 [debug] [Thread-3  ]: SQL status: OK in 0.003 seconds
[0m14:20:06.229344 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

      drop view if exists "nhl"."silver"."stg_goalies__dbt_backup" cascade
    
[0m14:20:06.229551 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

      drop view if exists "nhl"."silver"."stg_skaters__dbt_backup" cascade
    
[0m14:20:06.230858 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: Close
[0m14:20:06.231596 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m14:20:06.231918 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m14:20:06.232556 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: Close
[0m14:20:06.233438 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: Close
[0m14:20:06.233981 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b555368f-7fbe-4655-af49-85da3c923795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049df550>]}
[0m14:20:06.234175 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b555368f-7fbe-4655-af49-85da3c923795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c863d0>]}
[0m14:20:06.234412 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b555368f-7fbe-4655-af49-85da3c923795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073a7dc0>]}
[0m14:20:06.234706 [info ] [Thread-3  ]: 3 of 7 OK created sql view model silver.stg_teams .............................. [[32mOK[0m in 0.08s]
[0m14:20:06.235069 [info ] [Thread-1  ]: 1 of 7 OK created sql view model silver.stg_goalies ............................ [[32mOK[0m in 0.08s]
[0m14:20:06.235424 [info ] [Thread-2  ]: 2 of 7 OK created sql view model silver.stg_skaters ............................ [[32mOK[0m in 0.08s]
[0m14:20:06.235743 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.stg_teams
[0m14:20:06.236026 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.stg_goalies
[0m14:20:06.236302 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.stg_skaters
[0m14:20:06.236636 [debug] [Thread-4  ]: Began running node model.nhl_analytics.mart_team_standings
[0m14:20:06.236997 [info ] [Thread-4  ]: 4 of 7 START sql table model silver.mart_team_standings ........................ [RUN]
[0m14:20:06.237253 [debug] [Thread-1  ]: Began running node model.nhl_analytics.int_all_players
[0m14:20:06.237520 [debug] [Thread-4  ]: Acquiring new duckdb connection 'model.nhl_analytics.mart_team_standings'
[0m14:20:06.237793 [info ] [Thread-1  ]: 5 of 7 START sql view model silver.int_all_players ............................. [RUN]
[0m14:20:06.238030 [debug] [Thread-4  ]: Began compiling node model.nhl_analytics.mart_team_standings
[0m14:20:06.238259 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.stg_goalies, now model.nhl_analytics.int_all_players)
[0m14:20:06.240173 [debug] [Thread-4  ]: Writing injected SQL for node "model.nhl_analytics.mart_team_standings"
[0m14:20:06.240397 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.int_all_players
[0m14:20:06.243464 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.int_all_players"
[0m14:20:06.243881 [debug] [Thread-4  ]: Began executing node model.nhl_analytics.mart_team_standings
[0m14:20:06.256160 [debug] [Thread-4  ]: Writing runtime sql for node "model.nhl_analytics.mart_team_standings"
[0m14:20:06.256440 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.int_all_players
[0m14:20:06.258460 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.int_all_players"
[0m14:20:06.258798 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:20:06.259037 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: BEGIN
[0m14:20:06.259253 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:20:06.259564 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m14:20:06.259780 [debug] [Thread-1  ]: On model.nhl_analytics.int_all_players: BEGIN
[0m14:20:06.259987 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m14:20:06.260166 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:20:06.260361 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:20:06.260639 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

  
    
    

    create  table
      "nhl"."silver"."mart_team_standings__dbt_tmp"
  
    as (
      

select 
    season,
    team_name,
    team_code,
    games_played,
    goalsFor,
    goalsAgainst,
    goal_differential,
    xGoalsFor,
    xGoalsAgainst,
    row_number() over (
        order by goalsFor desc,
            goal_differential desc
    ) as standings_rank,
    loaded_at
from "nhl"."silver"."stg_teams"
order by standings_rank
    );
  
  
[0m14:20:06.260919 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m14:20:06.261111 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m14:20:06.261325 [debug] [Thread-1  ]: On model.nhl_analytics.int_all_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */

  
  create view "nhl"."silver"."int_all_players__dbt_tmp" as (
    

with all_players as (
    select 
        player_id,
        season,
        player_name,
        team_code,
        'G' as position,
        null as games_played,
        null as points_per_game,
        null as shooting_percentage
    from "nhl"."silver"."stg_goalies"
    
    union all
    
    select 
        player_id,
        season,
        player_name,
        team_code,
        position,
        games_played,
        points_per_game,
        shooting_percentage
    from "nhl"."silver"."stg_skaters"
)

select *,
    case 
        when position = 'G' then 'Goalie'
        when position in ('C', 'L', 'R', 'LW', 'RW') then 'Forward'
        when position in ('D') then 'Defense'
        else 'Unknown'
    end as position_group,
    current_timestamp as loaded_at
from all_players
  );

[0m14:20:06.262945 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m14:20:06.265036 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m14:20:06.265271 [debug] [Thread-1  ]: On model.nhl_analytics.int_all_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */
alter view "nhl"."silver"."int_all_players" rename to "int_all_players__dbt_backup"
[0m14:20:06.265634 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m14:20:06.267509 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m14:20:06.267739 [debug] [Thread-1  ]: On model.nhl_analytics.int_all_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */
alter view "nhl"."silver"."int_all_players__dbt_tmp" rename to "int_all_players"
[0m14:20:06.268274 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m14:20:06.269401 [debug] [Thread-1  ]: On model.nhl_analytics.int_all_players: COMMIT
[0m14:20:06.269639 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m14:20:06.269862 [debug] [Thread-1  ]: On model.nhl_analytics.int_all_players: COMMIT
[0m14:20:06.270331 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m14:20:06.271982 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m14:20:06.272206 [debug] [Thread-1  ]: On model.nhl_analytics.int_all_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */

      drop view if exists "nhl"."silver"."int_all_players__dbt_backup" cascade
    
[0m14:20:06.272607 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m14:20:06.272814 [debug] [Thread-4  ]: SQL status: OK in 0.012 seconds
[0m14:20:06.273490 [debug] [Thread-1  ]: On model.nhl_analytics.int_all_players: Close
[0m14:20:06.276622 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:20:06.276888 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'silver'
      AND table_name = 'mart_team_standings'
  
[0m14:20:06.277221 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b555368f-7fbe-4655-af49-85da3c923795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c46c70>]}
[0m14:20:06.277657 [info ] [Thread-1  ]: 5 of 7 OK created sql view model silver.int_all_players ........................ [[32mOK[0m in 0.04s]
[0m14:20:06.277901 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m14:20:06.278184 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.int_all_players
[0m14:20:06.278891 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:20:06.279221 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'silver'
      AND table_name = 'mart_team_standings'
  
[0m14:20:06.279504 [debug] [Thread-2  ]: Began running node model.nhl_analytics.mart_goalie_performance
[0m14:20:06.279714 [debug] [Thread-3  ]: Began running node model.nhl_analytics.mart_player_performance
[0m14:20:06.280181 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m14:20:06.279989 [info ] [Thread-2  ]: 6 of 7 START sql table model silver.mart_goalie_performance .................... [RUN]
[0m14:20:06.280508 [info ] [Thread-3  ]: 7 of 7 START sql table model silver.mart_player_performance .................... [RUN]
[0m14:20:06.283141 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:20:06.283418 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.stg_skaters, now model.nhl_analytics.mart_goalie_performance)
[0m14:20:06.283670 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.stg_teams, now model.nhl_analytics.mart_player_performance)
[0m14:20:06.283900 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */
alter table "nhl"."silver"."mart_team_standings" rename to "mart_team_standings__dbt_backup"
[0m14:20:06.284132 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.mart_goalie_performance
[0m14:20:06.284343 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.mart_player_performance
[0m14:20:06.286257 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.mart_goalie_performance"
[0m14:20:06.288159 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.mart_player_performance"
[0m14:20:06.288379 [debug] [Thread-4  ]: SQL status: OK in 0.004 seconds
[0m14:20:06.290252 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:20:06.290478 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */
alter table "nhl"."silver"."mart_team_standings__dbt_tmp" rename to "mart_team_standings"
[0m14:20:06.290778 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.mart_player_performance
[0m14:20:06.290990 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.mart_goalie_performance
[0m14:20:06.293030 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.mart_player_performance"
[0m14:20:06.293231 [debug] [Thread-4  ]: SQL status: OK in 0.003 seconds
[0m14:20:06.295220 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.mart_goalie_performance"
[0m14:20:06.299011 [info ] [Thread-4  ]: Exporting mart_team_standings to silver folder
[0m14:20:06.299423 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:20:06.299668 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m14:20:06.299896 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

        COPY (
    SELECT *
    FROM "nhl"."silver"."mart_team_standings"
) TO '../data/silver/mart_team_standings.parquet' (FORMAT PARQUET);
      
[0m14:20:06.300246 [debug] [Thread-3  ]: On model.nhl_analytics.mart_player_performance: BEGIN
[0m14:20:06.300473 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m14:20:06.300774 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m14:20:06.300987 [debug] [Thread-2  ]: On model.nhl_analytics.mart_goalie_performance: BEGIN
[0m14:20:06.301276 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m14:20:06.301559 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m14:20:06.301778 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m14:20:06.302001 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m14:20:06.302245 [debug] [Thread-3  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */

  
    
    

    create  table
      "nhl"."silver"."mart_player_performance__dbt_tmp"
  
    as (
      

select 
    player_id,
    player_name,
    team_code,
    position,
    position_group,
    games_played,
    points_per_game,
    shooting_percentage,
    case
        when points_per_game >= 1.0 then 'Elite'
        when points_per_game >= 0.7 then 'Very Good'
        when points_per_game >= 0.5 then 'Good'
        when points_per_game >= 0.3 then 'Average'
        else 'Below Average'
    end as offensive_rating,
    loaded_at
from "nhl"."silver"."int_all_players"
where position_group in ('Forward', 'Defense')
    and games_played >= 10
    );
  
  
[0m14:20:06.302487 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m14:20:06.302808 [debug] [Thread-2  ]: On model.nhl_analytics.mart_goalie_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */

  
    
    

    create  table
      "nhl"."silver"."mart_goalie_performance__dbt_tmp"
  
    as (
      

select 
    player_id,
    player_name,
    season,
    team_code,
    position,
    loaded_at
from "nhl"."silver"."int_all_players"
where position_group in ('Goalie')
    and games_played >= 10
    );
  
  
[0m14:20:06.304237 [debug] [Thread-4  ]: SQL status: OK in 0.004 seconds
[0m14:20:06.304963 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: COMMIT
[0m14:20:06.305187 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:20:06.305396 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: COMMIT
[0m14:20:06.305934 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m14:20:06.307699 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:20:06.307959 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

      drop table if exists "nhl"."silver"."mart_team_standings__dbt_backup" cascade
    
[0m14:20:06.308390 [debug] [Thread-2  ]: SQL status: OK in 0.005 seconds
[0m14:20:06.308616 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m14:20:06.309477 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m14:20:06.310693 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: Close
[0m14:20:06.311012 [debug] [Thread-2  ]: On model.nhl_analytics.mart_goalie_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'silver'
      AND table_name = 'mart_goalie_performance'
  
[0m14:20:06.311589 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b555368f-7fbe-4655-af49-85da3c923795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d7d160>]}
[0m14:20:06.312268 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m14:20:06.312075 [info ] [Thread-4  ]: 4 of 7 OK created sql table model silver.mart_team_standings ................... [[32mOK[0m in 0.07s]
[0m14:20:06.312557 [debug] [Thread-3  ]: SQL status: OK in 0.010 seconds
[0m14:20:06.313272 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m14:20:06.313560 [debug] [Thread-4  ]: Finished running node model.nhl_analytics.mart_team_standings
[0m14:20:06.314104 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m14:20:06.314338 [debug] [Thread-2  ]: On model.nhl_analytics.mart_goalie_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'silver'
      AND table_name = 'mart_goalie_performance'
  
[0m14:20:06.314636 [debug] [Thread-3  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'silver'
      AND table_name = 'mart_player_performance'
  
[0m14:20:06.315143 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m14:20:06.315369 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m14:20:06.316024 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m14:20:06.319054 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m14:20:06.319284 [debug] [Thread-3  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'silver'
      AND table_name = 'mart_player_performance'
  
[0m14:20:06.319524 [debug] [Thread-2  ]: On model.nhl_analytics.mart_goalie_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */
alter table "nhl"."silver"."mart_goalie_performance" rename to "mart_goalie_performance__dbt_backup"
[0m14:20:06.319984 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m14:20:06.321787 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m14:20:06.322000 [debug] [Thread-3  ]: SQL status: OK in 0.002 seconds
[0m14:20:06.322210 [debug] [Thread-2  ]: On model.nhl_analytics.mart_goalie_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */
alter table "nhl"."silver"."mart_goalie_performance__dbt_tmp" rename to "mart_goalie_performance"
[0m14:20:06.324186 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m14:20:06.324404 [debug] [Thread-3  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */
alter table "nhl"."silver"."mart_player_performance" rename to "mart_player_performance__dbt_backup"
[0m14:20:06.324634 [debug] [Thread-2  ]: SQL status: OK in 0.002 seconds
[0m14:20:06.325701 [info ] [Thread-2  ]: Exporting mart_goalie_performance to silver folder
[0m14:20:06.326031 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m14:20:06.326233 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m14:20:06.326430 [debug] [Thread-2  ]: On model.nhl_analytics.mart_goalie_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */

        COPY (
    SELECT *
    FROM "nhl"."silver"."mart_goalie_performance"
) TO '../data/silver/mart_goalie_performance.parquet' (FORMAT PARQUET);
      
[0m14:20:06.328204 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m14:20:06.328485 [debug] [Thread-3  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */
alter table "nhl"."silver"."mart_player_performance__dbt_tmp" rename to "mart_player_performance"
[0m14:20:06.328863 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m14:20:06.329805 [info ] [Thread-3  ]: Exporting mart_player_performance to silver folder
[0m14:20:06.330063 [debug] [Thread-2  ]: SQL status: OK in 0.002 seconds
[0m14:20:06.330314 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m14:20:06.330940 [debug] [Thread-2  ]: On model.nhl_analytics.mart_goalie_performance: COMMIT
[0m14:20:06.331221 [debug] [Thread-3  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */

        COPY (
    SELECT *
    FROM "nhl"."silver"."mart_player_performance"
) TO '../data/silver/mart_player_performance.parquet' (FORMAT PARQUET);
      
[0m14:20:06.331451 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m14:20:06.331711 [debug] [Thread-2  ]: On model.nhl_analytics.mart_goalie_performance: COMMIT
[0m14:20:06.332446 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m14:20:06.334147 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m14:20:06.334359 [debug] [Thread-2  ]: On model.nhl_analytics.mart_goalie_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */

      drop table if exists "nhl"."silver"."mart_goalie_performance__dbt_backup" cascade
    
[0m14:20:06.334560 [debug] [Thread-3  ]: SQL status: OK in 0.003 seconds
[0m14:20:06.335282 [debug] [Thread-3  ]: On model.nhl_analytics.mart_player_performance: COMMIT
[0m14:20:06.335489 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m14:20:06.335696 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m14:20:06.335886 [debug] [Thread-3  ]: On model.nhl_analytics.mart_player_performance: COMMIT
[0m14:20:06.336556 [debug] [Thread-2  ]: On model.nhl_analytics.mart_goalie_performance: Close
[0m14:20:06.336954 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b555368f-7fbe-4655-af49-85da3c923795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ef6e80>]}
[0m14:20:06.337351 [info ] [Thread-2  ]: 6 of 7 OK created sql table model silver.mart_goalie_performance ............... [[32mOK[0m in 0.05s]
[0m14:20:06.337601 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m14:20:06.337910 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.mart_goalie_performance
[0m14:20:06.339469 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m14:20:06.339755 [debug] [Thread-3  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */

      drop table if exists "nhl"."silver"."mart_player_performance__dbt_backup" cascade
    
[0m14:20:06.340189 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m14:20:06.340853 [debug] [Thread-3  ]: On model.nhl_analytics.mart_player_performance: Close
[0m14:20:06.341146 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b555368f-7fbe-4655-af49-85da3c923795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ebbee0>]}
[0m14:20:06.341465 [info ] [Thread-3  ]: 7 of 7 OK created sql table model silver.mart_player_performance ............... [[32mOK[0m in 0.06s]
[0m14:20:06.341776 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.mart_player_performance
[0m14:20:06.342399 [debug] [MainThread]: Using duckdb connection "master"
[0m14:20:06.342578 [debug] [MainThread]: On master: BEGIN
[0m14:20:06.342731 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:20:06.343024 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:20:06.343216 [debug] [MainThread]: On master: COMMIT
[0m14:20:06.343393 [debug] [MainThread]: Using duckdb connection "master"
[0m14:20:06.343558 [debug] [MainThread]: On master: COMMIT
[0m14:20:06.343824 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:20:06.344022 [debug] [MainThread]: On master: Close
[0m14:20:06.344241 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:20:06.344398 [debug] [MainThread]: Connection 'model.nhl_analytics.int_all_players' was properly closed.
[0m14:20:06.344543 [debug] [MainThread]: Connection 'model.nhl_analytics.mart_goalie_performance' was properly closed.
[0m14:20:06.344686 [debug] [MainThread]: Connection 'model.nhl_analytics.mart_player_performance' was properly closed.
[0m14:20:06.344826 [debug] [MainThread]: Connection 'model.nhl_analytics.mart_team_standings' was properly closed.
[0m14:20:06.345034 [info ] [MainThread]: 
[0m14:20:06.345226 [info ] [MainThread]: Finished running 3 table models, 4 view models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m14:20:06.345970 [debug] [MainThread]: Command end result
[0m14:20:06.362104 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m14:20:06.363109 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m14:20:06.367615 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/run_results.json
[0m14:20:06.367833 [info ] [MainThread]: 
[0m14:20:06.368066 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:20:06.368252 [info ] [MainThread]: 
[0m14:20:06.368448 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m14:20:06.369435 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0214132, "process_in_blocks": "0", "process_kernel_time": 0.223259, "process_mem_max_rss": "179126272", "process_out_blocks": "0", "process_user_time": 1.601686}
[0m14:20:06.369654 [debug] [MainThread]: Command `python -m dbt.cli.main run` succeeded at 14:20:06.369610 after 1.02 seconds
[0m14:20:06.369862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f69340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068a8fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107788a60>]}
[0m14:20:06.370072 [debug] [MainThread]: Flushing usage events
[0m14:20:06.621275 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:24:41.755231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107764340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088ed460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088ed280>]}


============================== 14:24:41.757980 | 67a3eaae-03b6-4f99-bb21-47e943b2803d ==============================
[0m14:24:41.757980 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:24:41.758329 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'invocation_command': 'dbt run --profiles-dir .', 'target_path': 'None', 'empty': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'no_print': 'None', 'debug': 'False', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'fail_fast': 'False', 'write_json': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'profiles_dir': '.', 'static_parser': 'True', 'printer_width': '80', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager'}
[0m14:24:41.913510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67a3eaae-03b6-4f99-bb21-47e943b2803d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089b3fd0>]}
[0m14:24:41.947012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67a3eaae-03b6-4f99-bb21-47e943b2803d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080a4fd0>]}
[0m14:24:41.948603 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m14:24:42.017548 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:24:42.107544 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:24:42.107901 [debug] [MainThread]: Partial parsing: updated file: nhl_analytics://models/staging/stg_goalies.sql
[0m14:24:42.287828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67a3eaae-03b6-4f99-bb21-47e943b2803d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ab1f40>]}
[0m14:24:42.349166 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m14:24:42.350340 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m14:24:42.360178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67a3eaae-03b6-4f99-bb21-47e943b2803d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fcd040>]}
[0m14:24:42.360472 [info ] [MainThread]: Found 7 models, 6 data tests, 4 sources, 445 macros
[0m14:24:42.360698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67a3eaae-03b6-4f99-bb21-47e943b2803d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090495e0>]}
[0m14:24:42.361609 [info ] [MainThread]: 
[0m14:24:42.361818 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:24:42.361995 [info ] [MainThread]: 
[0m14:24:42.362263 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:24:42.365355 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl'
[0m14:24:42.396157 [debug] [ThreadPool]: Using duckdb connection "list_nhl"
[0m14:24:42.396398 [debug] [ThreadPool]: On list_nhl: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m14:24:42.396570 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:24:42.403107 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m14:24:42.403334 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m14:24:42.403748 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:24:42.403939 [debug] [MainThread]: Connection 'list_nhl' was properly closed.
[0m14:24:42.404112 [info ] [MainThread]: 
[0m14:24:42.404314 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.04 seconds (0.04s).
[0m14:24:42.404604 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/../nhl.duckdb": Conflicting lock is held in /opt/homebrew/Cellar/duckdb/1.4.1/bin/duckdb (PID 66286) by user izaakford. See also https://duckdb.org/docs/stable/connect/concurrency
[0m14:24:42.405503 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.69260865, "process_in_blocks": "0", "process_kernel_time": 0.149728, "process_mem_max_rss": "133005312", "process_out_blocks": "0", "process_user_time": 1.253107}
[0m14:24:42.405719 [debug] [MainThread]: Command `python -m dbt.cli.main run` failed at 14:24:42.405676 after 0.69 seconds
[0m14:24:42.405912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107764340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10901c8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090807f0>]}
[0m14:24:42.406119 [debug] [MainThread]: Flushing usage events
[0m14:24:42.619723 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:25:02.274484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039f92e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b804c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b802e0>]}


============================== 14:25:02.277278 | 46da2be8-6f08-49ac-8d4a-68b40f6adae4 ==============================
[0m14:25:02.277278 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:25:02.277619 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'static_parser': 'True', 'use_colors': 'True', 'fail_fast': 'False', 'printer_width': '80', 'partial_parse': 'True', 'empty': 'False', 'debug': 'False', 'invocation_command': 'dbt run --profiles-dir .', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'quiet': 'False', 'no_print': 'None', 'warn_error': 'None', 'target_path': 'None', 'profiles_dir': '.', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True'}
[0m14:25:02.456433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46da2be8-6f08-49ac-8d4a-68b40f6adae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023885b0>]}
[0m14:25:02.489866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46da2be8-6f08-49ac-8d4a-68b40f6adae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b21a00>]}
[0m14:25:02.491466 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m14:25:02.561407 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:25:02.650098 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:25:02.650330 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:25:02.683897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46da2be8-6f08-49ac-8d4a-68b40f6adae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051ac130>]}
[0m14:25:02.769477 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m14:25:02.770674 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m14:25:02.780154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46da2be8-6f08-49ac-8d4a-68b40f6adae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051ac400>]}
[0m14:25:02.780462 [info ] [MainThread]: Found 7 models, 6 data tests, 4 sources, 445 macros
[0m14:25:02.780684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46da2be8-6f08-49ac-8d4a-68b40f6adae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051d8640>]}
[0m14:25:02.781584 [info ] [MainThread]: 
[0m14:25:02.781799 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:25:02.781978 [info ] [MainThread]: 
[0m14:25:02.782284 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:25:02.785460 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl'
[0m14:25:02.818567 [debug] [ThreadPool]: Using duckdb connection "list_nhl"
[0m14:25:02.818808 [debug] [ThreadPool]: On list_nhl: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m14:25:02.818982 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:02.826697 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m14:25:02.826920 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m14:25:02.827331 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:25:02.827513 [debug] [MainThread]: Connection 'list_nhl' was properly closed.
[0m14:25:02.827684 [info ] [MainThread]: 
[0m14:25:02.827882 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.05 seconds (0.05s).
[0m14:25:02.828169 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/../nhl.duckdb": Conflicting lock is held in /opt/homebrew/Cellar/duckdb/1.4.1/bin/duckdb (PID 66286) by user izaakford. See also https://duckdb.org/docs/stable/connect/concurrency
[0m14:25:02.829061 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.5955996, "process_in_blocks": "0", "process_kernel_time": 0.136246, "process_mem_max_rss": "129384448", "process_out_blocks": "0", "process_user_time": 1.130818}
[0m14:25:02.829279 [debug] [MainThread]: Command `python -m dbt.cli.main run` failed at 14:25:02.829231 after 0.60 seconds
[0m14:25:02.829471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039f92e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105196ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c51d60>]}
[0m14:25:02.829677 [debug] [MainThread]: Flushing usage events
[0m14:25:02.986355 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:25:15.455508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053232b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064a9490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064a92b0>]}


============================== 14:25:15.458146 | d57e0929-ed23-46ce-a941-bcf5c8831570 ==============================
[0m14:25:15.458146 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:25:15.458484 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'invocation_command': 'dbt run --profiles-dir .', 'cache_selected_only': 'False', 'write_json': 'True', 'debug': 'False', 'profiles_dir': '.', 'introspect': 'True', 'target_path': 'None', 'use_colors': 'True', 'partial_parse': 'True', 'quiet': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'printer_width': '80', 'log_format': 'default', 'version_check': 'True', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs'}
[0m14:25:15.582876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd57e0929-ed23-46ce-a941-bcf5c8831570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cb1b20>]}
[0m14:25:15.617118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd57e0929-ed23-46ce-a941-bcf5c8831570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064484f0>]}
[0m14:25:15.618132 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m14:25:15.682218 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:25:15.768381 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:25:15.768694 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:25:15.808668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd57e0929-ed23-46ce-a941-bcf5c8831570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ad4130>]}
[0m14:25:15.900707 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m14:25:15.901779 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m14:25:15.908622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd57e0929-ed23-46ce-a941-bcf5c8831570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106730a60>]}
[0m14:25:15.908933 [info ] [MainThread]: Found 7 models, 6 data tests, 4 sources, 445 macros
[0m14:25:15.909158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd57e0929-ed23-46ce-a941-bcf5c8831570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066ec130>]}
[0m14:25:15.910040 [info ] [MainThread]: 
[0m14:25:15.910249 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:25:15.910427 [info ] [MainThread]: 
[0m14:25:15.910708 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:25:15.913868 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl'
[0m14:25:15.943061 [debug] [ThreadPool]: Using duckdb connection "list_nhl"
[0m14:25:15.943302 [debug] [ThreadPool]: On list_nhl: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m14:25:15.943479 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:15.978950 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m14:25:15.980004 [debug] [ThreadPool]: On list_nhl: Close
[0m14:25:15.980400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nhl, now create_nhl_silver)
[0m14:25:15.980665 [debug] [ThreadPool]: Creating schema "database: "nhl"
schema: "silver"
"
[0m14:25:15.985089 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:25:15.985305 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nhl'
        and type='sqlite'
    
  
[0m14:25:15.985478 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:25:15.986162 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:25:15.987001 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:25:15.987176 [debug] [ThreadPool]: On create_nhl_silver: BEGIN
[0m14:25:15.987440 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:25:15.987611 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:25:15.987782 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
    
        create schema if not exists "nhl"."silver"
    
[0m14:25:15.988072 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:25:15.988520 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m14:25:15.988684 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:25:15.988835 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m14:25:15.989073 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:25:15.989243 [debug] [ThreadPool]: On create_nhl_silver: Close
[0m14:25:15.990054 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nhl_silver, now list_nhl_silver)
[0m14:25:15.993451 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m14:25:15.993647 [debug] [ThreadPool]: On list_nhl_silver: BEGIN
[0m14:25:15.993800 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:25:15.994065 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:25:15.994231 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m14:25:15.994408 [debug] [ThreadPool]: On list_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl_silver"} */
select
      'nhl' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'silver'
    and lower(table_catalog) = 'nhl'
  
[0m14:25:16.003826 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:25:16.004569 [debug] [ThreadPool]: On list_nhl_silver: ROLLBACK
[0m14:25:16.005762 [debug] [ThreadPool]: Failed to rollback 'list_nhl_silver'
[0m14:25:16.005934 [debug] [ThreadPool]: On list_nhl_silver: Close
[0m14:25:16.006772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd57e0929-ed23-46ce-a941-bcf5c8831570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c10880>]}
[0m14:25:16.007027 [debug] [MainThread]: Using duckdb connection "master"
[0m14:25:16.007196 [debug] [MainThread]: On master: BEGIN
[0m14:25:16.007353 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:25:16.007626 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:25:16.007797 [debug] [MainThread]: On master: COMMIT
[0m14:25:16.007963 [debug] [MainThread]: Using duckdb connection "master"
[0m14:25:16.008117 [debug] [MainThread]: On master: COMMIT
[0m14:25:16.008348 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:25:16.008515 [debug] [MainThread]: On master: Close
[0m14:25:16.009833 [debug] [Thread-1  ]: Began running node model.nhl_analytics.stg_goalies
[0m14:25:16.010069 [debug] [Thread-2  ]: Began running node model.nhl_analytics.stg_skaters
[0m14:25:16.010296 [debug] [Thread-3  ]: Began running node model.nhl_analytics.stg_teams
[0m14:25:16.010572 [info ] [Thread-1  ]: 1 of 7 START sql view model silver.stg_goalies ................................. [RUN]
[0m14:25:16.010904 [info ] [Thread-2  ]: 2 of 7 START sql view model silver.stg_skaters ................................. [RUN]
[0m14:25:16.011201 [info ] [Thread-3  ]: 3 of 7 START sql view model silver.stg_teams ................................... [RUN]
[0m14:25:16.011460 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_nhl_silver, now model.nhl_analytics.stg_goalies)
[0m14:25:16.011739 [debug] [Thread-2  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_skaters'
[0m14:25:16.012005 [debug] [Thread-3  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_teams'
[0m14:25:16.012208 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.stg_goalies
[0m14:25:16.012407 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.stg_skaters
[0m14:25:16.012602 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.stg_teams
[0m14:25:16.017899 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.stg_goalies"
[0m14:25:16.020131 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.stg_skaters"
[0m14:25:16.022229 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.stg_teams"
[0m14:25:16.022727 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.stg_goalies
[0m14:25:16.022976 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.stg_skaters
[0m14:25:16.041723 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.stg_goalies"
[0m14:25:16.043766 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.stg_skaters"
[0m14:25:16.044025 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.stg_teams
[0m14:25:16.046140 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.stg_teams"
[0m14:25:16.046511 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m14:25:16.046744 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m14:25:16.046964 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: BEGIN
[0m14:25:16.047190 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:25:16.047377 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: BEGIN
[0m14:25:16.047598 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:25:16.047808 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: BEGIN
[0m14:25:16.047994 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:25:16.048329 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:25:16.048655 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m14:25:16.048946 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m14:25:16.049147 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m14:25:16.049386 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    sum(games_played) as games_played,
    sum(icetime) as ice_time,
    sum(shifts) as shifts,
    sum(gameScore) as game_score,
    sum(I_F_goals) as goals,
    sum(I_F_points) as points,
    sum(I_F_shotsOnGoal) as shots_on_goal,
    sum(I_F_primaryAssists) as primary_assists,
    sum(I_F_secondaryAssists) as secondary_assists,
    sum(I_F_xOnGoal) as expected_on_goal,
    sum(I_F_xGoals) as expected_goals,
    sum(I_F_xRebounds) as expected_rebounds,
    sum(I_F_rebounds) as rebounds,
    sum(I_F_freeze) as freeze,
    sum(I_F_playStopped) as play_stopped,
    sum(I_F_playContinuedInZone) as play_continued_in_zone,
    sum(I_F_playContinuedOutsideZone) as play_continued_outside_zone,
    sum(I_F_lowDangerShots) as low_danger_shots,
    sum(I_F_mediumDangerShots) as medium_danger_shots,
    sum(I_F_highDangerShots) as high_danger_shots,
    sum(I_F_lowDangerxGoals) as low_danger_expected_goals,
    sum(I_F_mediumDangerxGoals) as medium_danger_expected_goals,
    sum(I_F_highDangerxGoals) as high_danger_expected_goals,
    sum(I_F_lowDangerGoals) as low_danger_goals,
    sum(I_F_mediumDangerGoals) as medium_danger_goals,
    sum(I_F_highDangerGoals) as high_danger_goals,
    case
        when sum(games_played) > 0 then true
        else false
    end as is_active_player,
    case
        when sum(games_played) > 0 then round(sum(I_F_points) * 1.0 / sum(games_played), 2)
        else null
    end as points_per_game,
    case
        when sum(I_F_shotsOnGoal) > 0 then round(sum(I_F_goals) * 100.0 / sum(I_F_shotsOnGoal), 2)
        else null
    end as shooting_percentage,
    current_timestamp as loaded_at
from "nhl"."bronze"."skaters"
where playerId is not null
    and season is not null
group by playerId,
    season,
    name,
    team,
    position
  );

[0m14:25:16.049623 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m14:25:16.049812 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m14:25:16.050215 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:25:16.050479 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    

select 
    playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    max(games_played) as games_played,
    sum(icetime) as ice_time,
    sum(xGoals) as expected_goals,
    sum(goals) as goals,
    sum(unblocked_shot_attempts) as unblocked_shot_attempts,
    sum(xRebounds) as expected_rebounds,
    sum(rebounds) as rebounds,
    sum(xFreeze) as expected_freeze,
    sum("freeze") as freeze,
    sum(xOnGoal) as expected_on_goal,
    sum(ongoal) as on_goal,
    sum(xPlayStopped) as expected_play_stopped,
    sum(playStopped) as play_stopped,
    sum(xPlayContinuedInZone) as expected_play_continued_in_zone,
    sum(playContinuedInZone) as play_continued_in_zone,
    sum(xPlayContinuedOutsideZone) as expected_play_continued_outside_zone,
    sum(playContinuedOutsideZone) as play_continued_outside_zone,
    sum(flurryAdjustedxGoals) as flurry_adjusted_expected_goals,
    sum(lowDangerShots) as low_danger_shots,
    sum(mediumDangerShots) as medium_danger_shots,
    sum(highDangerShots) as high_danger_shots,
    sum(lowDangerxGoals) as low_danger_expected_goals,
    sum(mediumDangerxGoals) as medium_danger_expected_goals,
    sum(highDangerxGoals) as high_danger_expected_goals,
    sum(lowDangerGoals) as low_danger_goals,
    sum(mediumDangerGoals) as medium_danger_goals,
    sum(highDangerGoals) as high_danger_goals,
    sum(blocked_shot_attempts) as blocked_shot_attempts,
    sum(penalityMinutes) as penalty_minutes,
    sum(penalties) as penalties,
    current_timestamp as loaded_at
from "nhl"."bronze"."goalies"
where playerId is not null
    and season is not null
group by playerId, season, name, team, position
  );

[0m14:25:16.050758 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

  
  create view "nhl"."silver"."stg_teams__dbt_tmp" as (
    
select season,
    name as team_name,
    team as team_code,
    sum(games_played) as games_played,
    sum(goalsFor) as goalsFor,
    sum(goalsAgainst) as goalsAgainst,
    sum(goalsFor) - sum(goalsAgainst) as goal_differential,
    sum(xGoalsFor) as xGoalsFor,
    sum(xGoalsAgainst) as xGoalsAgainst,
    current_timestamp as loaded_at
from "nhl"."bronze"."teams"
where season is not null
    and name is not null
group by season,
    name,
    team
  );

[0m14:25:16.051262 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m14:25:16.054916 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m14:25:16.055154 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */
alter view "nhl"."silver"."stg_skaters" rename to "stg_skaters__dbt_backup"
[0m14:25:16.055382 [debug] [Thread-3  ]: SQL status: OK in 0.004 seconds
[0m14:25:16.055588 [debug] [Thread-1  ]: SQL status: OK in 0.005 seconds
[0m14:25:16.057543 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:25:16.059700 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m14:25:16.059905 [debug] [Thread-2  ]: SQL status: OK in 0.004 seconds
[0m14:25:16.060119 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */
alter view "nhl"."silver"."stg_teams" rename to "stg_teams__dbt_backup"
[0m14:25:16.060332 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */
alter view "nhl"."silver"."stg_goalies" rename to "stg_goalies__dbt_backup"
[0m14:25:16.062106 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m14:25:16.062464 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */
alter view "nhl"."silver"."stg_skaters__dbt_tmp" rename to "stg_skaters"
[0m14:25:16.062734 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m14:25:16.062949 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m14:25:16.064685 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:25:16.064917 [debug] [Thread-2  ]: SQL status: OK in 0.002 seconds
[0m14:25:16.066738 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m14:25:16.066956 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */
alter view "nhl"."silver"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m14:25:16.073540 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */
alter view "nhl"."silver"."stg_goalies__dbt_tmp" rename to "stg_goalies"
[0m14:25:16.073827 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: COMMIT
[0m14:25:16.074172 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m14:25:16.074399 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: COMMIT
[0m14:25:16.074594 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m14:25:16.074784 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m14:25:16.075537 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: COMMIT
[0m14:25:16.076198 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: COMMIT
[0m14:25:16.076414 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:25:16.076600 [debug] [Thread-2  ]: SQL status: OK in 0.002 seconds
[0m14:25:16.076798 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m14:25:16.076989 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: COMMIT
[0m14:25:16.080199 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m14:25:16.080444 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: COMMIT
[0m14:25:16.080706 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

      drop view if exists "nhl"."silver"."stg_skaters__dbt_backup" cascade
    
[0m14:25:16.080941 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m14:25:16.082810 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:25:16.083025 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m14:25:16.083233 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

      drop view if exists "nhl"."silver"."stg_teams__dbt_backup" cascade
    
[0m14:25:16.083431 [debug] [Thread-2  ]: SQL status: OK in 0.002 seconds
[0m14:25:16.085385 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m14:25:16.086822 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: Close
[0m14:25:16.087060 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

      drop view if exists "nhl"."silver"."stg_goalies__dbt_backup" cascade
    
[0m14:25:16.087283 [debug] [Thread-3  ]: SQL status: OK in 0.002 seconds
[0m14:25:16.088511 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: Close
[0m14:25:16.088958 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m14:25:16.089764 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: Close
[0m14:25:16.090243 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd57e0929-ed23-46ce-a941-bcf5c8831570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cb5e50>]}
[0m14:25:16.090441 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd57e0929-ed23-46ce-a941-bcf5c8831570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f95be0>]}
[0m14:25:16.090673 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd57e0929-ed23-46ce-a941-bcf5c8831570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ae03d0>]}
[0m14:25:16.090969 [info ] [Thread-2  ]: 2 of 7 OK created sql view model silver.stg_skaters ............................ [[32mOK[0m in 0.08s]
[0m14:25:16.091321 [info ] [Thread-3  ]: 3 of 7 OK created sql view model silver.stg_teams .............................. [[32mOK[0m in 0.08s]
[0m14:25:16.091946 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.stg_skaters
[0m14:25:16.091688 [info ] [Thread-1  ]: 1 of 7 OK created sql view model silver.stg_goalies ............................ [[32mOK[0m in 0.08s]
[0m14:25:16.092280 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.stg_teams
[0m14:25:16.092613 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.stg_goalies
[0m14:25:16.092922 [debug] [Thread-1  ]: Began running node model.nhl_analytics.mart_team_standings
[0m14:25:16.093410 [debug] [Thread-2  ]: Began running node model.nhl_analytics.int_all_players
[0m14:25:16.093240 [info ] [Thread-1  ]: 4 of 7 START sql table model silver.mart_team_standings ........................ [RUN]
[0m14:25:16.093728 [info ] [Thread-2  ]: 5 of 7 START sql view model silver.int_all_players ............................. [RUN]
[0m14:25:16.093981 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.stg_goalies, now model.nhl_analytics.mart_team_standings)
[0m14:25:16.094214 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.stg_skaters, now model.nhl_analytics.int_all_players)
[0m14:25:16.094432 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.mart_team_standings
[0m14:25:16.094630 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.int_all_players
[0m14:25:16.096554 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.mart_team_standings"
[0m14:25:16.098687 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.int_all_players"
[0m14:25:16.099090 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.mart_team_standings
[0m14:25:16.111471 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.int_all_players
[0m14:25:16.111755 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.mart_team_standings"
[0m14:25:16.113780 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.int_all_players"
[0m14:25:16.114176 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:25:16.114403 [debug] [Thread-1  ]: On model.nhl_analytics.mart_team_standings: BEGIN
[0m14:25:16.114644 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m14:25:16.114851 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:25:16.115053 [debug] [Thread-2  ]: On model.nhl_analytics.int_all_players: BEGIN
[0m14:25:16.115357 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m14:25:16.115635 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m14:25:16.115837 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:25:16.116045 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m14:25:16.116257 [debug] [Thread-1  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

  
    
    

    create  table
      "nhl"."silver"."mart_team_standings__dbt_tmp"
  
    as (
      

select 
    season,
    team_name,
    team_code,
    games_played,
    goalsFor,
    goalsAgainst,
    goal_differential,
    xGoalsFor,
    xGoalsAgainst,
    row_number() over (
        order by goalsFor desc,
            goal_differential desc
    ) as standings_rank,
    loaded_at
from "nhl"."silver"."stg_teams"
order by standings_rank
    );
  
  
[0m14:25:16.116480 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m14:25:16.116782 [debug] [Thread-2  ]: On model.nhl_analytics.int_all_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */

  
  create view "nhl"."silver"."int_all_players__dbt_tmp" as (
    

with all_players as (
    select 
        player_id,
        season,
        player_name,
        team_code,
        'G' as position,
        null as games_played,
        null as points_per_game,
        null as shooting_percentage
    from "nhl"."silver"."stg_goalies"
    
    union all
    
    select 
        player_id,
        season,
        player_name,
        team_code,
        position,
        games_played,
        points_per_game,
        shooting_percentage
    from "nhl"."silver"."stg_skaters"
)

select *,
    case 
        when position = 'G' then 'Goalie'
        when position in ('C', 'L', 'R', 'LW', 'RW') then 'Forward'
        when position in ('D') then 'Defense'
        else 'Unknown'
    end as position_group,
    current_timestamp as loaded_at
from all_players
  );

[0m14:25:16.118517 [debug] [Thread-2  ]: SQL status: OK in 0.002 seconds
[0m14:25:16.120585 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m14:25:16.120821 [debug] [Thread-2  ]: On model.nhl_analytics.int_all_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */
alter view "nhl"."silver"."int_all_players" rename to "int_all_players__dbt_backup"
[0m14:25:16.121209 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m14:25:16.123530 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m14:25:16.123781 [debug] [Thread-2  ]: On model.nhl_analytics.int_all_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */
alter view "nhl"."silver"."int_all_players__dbt_tmp" rename to "int_all_players"
[0m14:25:16.124153 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m14:25:16.124880 [debug] [Thread-2  ]: On model.nhl_analytics.int_all_players: COMMIT
[0m14:25:16.125094 [debug] [Thread-1  ]: SQL status: OK in 0.008 seconds
[0m14:25:16.125298 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m14:25:16.129132 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:25:16.129361 [debug] [Thread-2  ]: On model.nhl_analytics.int_all_players: COMMIT
[0m14:25:16.129578 [debug] [Thread-1  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'silver'
      AND table_name = 'mart_team_standings'
  
[0m14:25:16.130028 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m14:25:16.131504 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m14:25:16.131704 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m14:25:16.131902 [debug] [Thread-2  ]: On model.nhl_analytics.int_all_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */

      drop view if exists "nhl"."silver"."int_all_players__dbt_backup" cascade
    
[0m14:25:16.132616 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:25:16.132879 [debug] [Thread-1  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'silver'
      AND table_name = 'mart_team_standings'
  
[0m14:25:16.133159 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m14:25:16.133835 [debug] [Thread-2  ]: On model.nhl_analytics.int_all_players: Close
[0m14:25:16.134037 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m14:25:16.134358 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd57e0929-ed23-46ce-a941-bcf5c8831570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10711d2b0>]}
[0m14:25:16.136273 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:25:16.136554 [debug] [Thread-1  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */
alter table "nhl"."silver"."mart_team_standings" rename to "mart_team_standings__dbt_backup"
[0m14:25:16.136863 [info ] [Thread-2  ]: 5 of 7 OK created sql view model silver.int_all_players ........................ [[32mOK[0m in 0.04s]
[0m14:25:16.137228 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.int_all_players
[0m14:25:16.137460 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m14:25:16.139218 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:25:16.139473 [debug] [Thread-1  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */
alter table "nhl"."silver"."mart_team_standings__dbt_tmp" rename to "mart_team_standings"
[0m14:25:16.139766 [debug] [Thread-4  ]: Began running node model.nhl_analytics.mart_goalie_performance
[0m14:25:16.140018 [debug] [Thread-3  ]: Began running node model.nhl_analytics.mart_player_performance
[0m14:25:16.140284 [info ] [Thread-4  ]: 6 of 7 START sql table model silver.mart_goalie_performance .................... [RUN]
[0m14:25:16.140745 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m14:25:16.140573 [info ] [Thread-3  ]: 7 of 7 START sql table model silver.mart_player_performance .................... [RUN]
[0m14:25:16.141055 [debug] [Thread-4  ]: Acquiring new duckdb connection 'model.nhl_analytics.mart_goalie_performance'
[0m14:25:16.144803 [info ] [Thread-1  ]: Exporting mart_team_standings to silver folder
[0m14:25:16.145080 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.stg_teams, now model.nhl_analytics.mart_player_performance)
[0m14:25:16.145308 [debug] [Thread-4  ]: Began compiling node model.nhl_analytics.mart_goalie_performance
[0m14:25:16.145613 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:25:16.145837 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.mart_player_performance
[0m14:25:16.147745 [debug] [Thread-4  ]: Writing injected SQL for node "model.nhl_analytics.mart_goalie_performance"
[0m14:25:16.147993 [debug] [Thread-1  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

        COPY (
    SELECT *
    FROM "nhl"."silver"."mart_team_standings"
) TO '../data/silver/mart_team_standings.parquet' (FORMAT PARQUET);
      
[0m14:25:16.149975 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.mart_player_performance"
[0m14:25:16.150485 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.mart_player_performance
[0m14:25:16.150746 [debug] [Thread-4  ]: Began executing node model.nhl_analytics.mart_goalie_performance
[0m14:25:16.153492 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.mart_player_performance"
[0m14:25:16.156253 [debug] [Thread-4  ]: Writing runtime sql for node "model.nhl_analytics.mart_goalie_performance"
[0m14:25:16.156475 [debug] [Thread-1  ]: SQL status: OK in 0.006 seconds
[0m14:25:16.157276 [debug] [Thread-1  ]: On model.nhl_analytics.mart_team_standings: COMMIT
[0m14:25:16.157509 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:25:16.157777 [debug] [Thread-1  ]: On model.nhl_analytics.mart_team_standings: COMMIT
[0m14:25:16.158017 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m14:25:16.158270 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m14:25:16.158520 [debug] [Thread-3  ]: On model.nhl_analytics.mart_player_performance: BEGIN
[0m14:25:16.158730 [debug] [Thread-4  ]: On model.nhl_analytics.mart_goalie_performance: BEGIN
[0m14:25:16.158934 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m14:25:16.159129 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m14:25:16.159321 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:25:16.160961 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:25:16.161242 [debug] [Thread-3  ]: SQL status: OK in 0.002 seconds
[0m14:25:16.161464 [debug] [Thread-1  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

      drop table if exists "nhl"."silver"."mart_team_standings__dbt_backup" cascade
    
[0m14:25:16.161681 [debug] [Thread-4  ]: SQL status: OK in 0.002 seconds
[0m14:25:16.161877 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m14:25:16.162137 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m14:25:16.162373 [debug] [Thread-3  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */

  
    
    

    create  table
      "nhl"."silver"."mart_player_performance__dbt_tmp"
  
    as (
      

select 
    player_id,
    player_name,
    team_code,
    position,
    position_group,
    games_played,
    points_per_game,
    shooting_percentage,
    case
        when points_per_game >= 1.0 then 'Elite'
        when points_per_game >= 0.7 then 'Very Good'
        when points_per_game >= 0.5 then 'Good'
        when points_per_game >= 0.3 then 'Average'
        else 'Below Average'
    end as offensive_rating,
    loaded_at
from "nhl"."silver"."int_all_players"
where position_group in ('Forward', 'Defense')
    and games_played >= 10
    );
  
  
[0m14:25:16.162612 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m14:25:16.162811 [debug] [Thread-4  ]: On model.nhl_analytics.mart_goalie_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */

  
    
    

    create  table
      "nhl"."silver"."mart_goalie_performance__dbt_tmp"
  
    as (
      

select 
    player_id,
    player_name,
    season,
    team_code,
    position,
    loaded_at
from "nhl"."silver"."int_all_players"
where position_group in ('Goalie')
    and games_played >= 10
    );
  
  
[0m14:25:16.163705 [debug] [Thread-1  ]: On model.nhl_analytics.mart_team_standings: Close
[0m14:25:16.164126 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd57e0929-ed23-46ce-a941-bcf5c8831570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106594e50>]}
[0m14:25:16.164497 [info ] [Thread-1  ]: 4 of 7 OK created sql table model silver.mart_team_standings ................... [[32mOK[0m in 0.07s]
[0m14:25:16.164823 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.mart_team_standings
[0m14:25:16.168361 [debug] [Thread-4  ]: SQL status: OK in 0.004 seconds
[0m14:25:16.170130 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m14:25:16.170533 [debug] [Thread-4  ]: On model.nhl_analytics.mart_goalie_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'silver'
      AND table_name = 'mart_goalie_performance'
  
[0m14:25:16.171318 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m14:25:16.171548 [debug] [Thread-3  ]: SQL status: OK in 0.008 seconds
[0m14:25:16.172280 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m14:25:16.172823 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m14:25:16.173044 [debug] [Thread-4  ]: On model.nhl_analytics.mart_goalie_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'silver'
      AND table_name = 'mart_goalie_performance'
  
[0m14:25:16.173271 [debug] [Thread-3  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'silver'
      AND table_name = 'mart_player_performance'
  
[0m14:25:16.173767 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m14:25:16.173996 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m14:25:16.176067 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m14:25:16.176813 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m14:25:16.177039 [debug] [Thread-4  ]: On model.nhl_analytics.mart_goalie_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */
alter table "nhl"."silver"."mart_goalie_performance" rename to "mart_goalie_performance__dbt_backup"
[0m14:25:16.177275 [debug] [Thread-3  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'silver'
      AND table_name = 'mart_player_performance'
  
[0m14:25:16.177660 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m14:25:16.179424 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m14:25:16.179632 [debug] [Thread-3  ]: SQL status: OK in 0.002 seconds
[0m14:25:16.179831 [debug] [Thread-4  ]: On model.nhl_analytics.mart_goalie_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */
alter table "nhl"."silver"."mart_goalie_performance__dbt_tmp" rename to "mart_goalie_performance"
[0m14:25:16.181762 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m14:25:16.182023 [debug] [Thread-3  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */
alter table "nhl"."silver"."mart_player_performance" rename to "mart_player_performance__dbt_backup"
[0m14:25:16.182282 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m14:25:16.183573 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m14:25:16.183385 [info ] [Thread-4  ]: Exporting mart_goalie_performance to silver folder
[0m14:25:16.185730 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m14:25:16.186109 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m14:25:16.186364 [debug] [Thread-3  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */
alter table "nhl"."silver"."mart_player_performance__dbt_tmp" rename to "mart_player_performance"
[0m14:25:16.186582 [debug] [Thread-4  ]: On model.nhl_analytics.mart_goalie_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */

        COPY (
    SELECT *
    FROM "nhl"."silver"."mart_goalie_performance"
) TO '../data/silver/mart_goalie_performance.parquet' (FORMAT PARQUET);
      
[0m14:25:16.187002 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m14:25:16.188044 [info ] [Thread-3  ]: Exporting mart_player_performance to silver folder
[0m14:25:16.188385 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m14:25:16.188615 [debug] [Thread-4  ]: SQL status: OK in 0.002 seconds
[0m14:25:16.188835 [debug] [Thread-3  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */

        COPY (
    SELECT *
    FROM "nhl"."silver"."mart_player_performance"
) TO '../data/silver/mart_player_performance.parquet' (FORMAT PARQUET);
      
[0m14:25:16.189528 [debug] [Thread-4  ]: On model.nhl_analytics.mart_goalie_performance: COMMIT
[0m14:25:16.189815 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m14:25:16.190025 [debug] [Thread-4  ]: On model.nhl_analytics.mart_goalie_performance: COMMIT
[0m14:25:16.190409 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m14:25:16.192719 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m14:25:16.192951 [debug] [Thread-4  ]: On model.nhl_analytics.mart_goalie_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */

      drop table if exists "nhl"."silver"."mart_goalie_performance__dbt_backup" cascade
    
[0m14:25:16.193210 [debug] [Thread-3  ]: SQL status: OK in 0.003 seconds
[0m14:25:16.193877 [debug] [Thread-3  ]: On model.nhl_analytics.mart_player_performance: COMMIT
[0m14:25:16.194084 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m14:25:16.194281 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m14:25:16.195019 [debug] [Thread-4  ]: On model.nhl_analytics.mart_goalie_performance: Close
[0m14:25:16.195230 [debug] [Thread-3  ]: On model.nhl_analytics.mart_player_performance: COMMIT
[0m14:25:16.195594 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd57e0929-ed23-46ce-a941-bcf5c8831570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107158850>]}
[0m14:25:16.196002 [info ] [Thread-4  ]: 6 of 7 OK created sql table model silver.mart_goalie_performance ............... [[32mOK[0m in 0.05s]
[0m14:25:16.196361 [debug] [Thread-4  ]: Finished running node model.nhl_analytics.mart_goalie_performance
[0m14:25:16.196662 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m14:25:16.198183 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m14:25:16.198385 [debug] [Thread-3  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */

      drop table if exists "nhl"."silver"."mart_player_performance__dbt_backup" cascade
    
[0m14:25:16.198798 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m14:25:16.199569 [debug] [Thread-3  ]: On model.nhl_analytics.mart_player_performance: Close
[0m14:25:16.199913 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd57e0929-ed23-46ce-a941-bcf5c8831570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107182c70>]}
[0m14:25:16.200301 [info ] [Thread-3  ]: 7 of 7 OK created sql table model silver.mart_player_performance ............... [[32mOK[0m in 0.05s]
[0m14:25:16.200628 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.mart_player_performance
[0m14:25:16.201299 [debug] [MainThread]: Using duckdb connection "master"
[0m14:25:16.201487 [debug] [MainThread]: On master: BEGIN
[0m14:25:16.201648 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:25:16.202005 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:25:16.202243 [debug] [MainThread]: On master: COMMIT
[0m14:25:16.202614 [debug] [MainThread]: Using duckdb connection "master"
[0m14:25:16.202784 [debug] [MainThread]: On master: COMMIT
[0m14:25:16.203079 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:25:16.203293 [debug] [MainThread]: On master: Close
[0m14:25:16.203515 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:25:16.203667 [debug] [MainThread]: Connection 'model.nhl_analytics.mart_team_standings' was properly closed.
[0m14:25:16.203808 [debug] [MainThread]: Connection 'model.nhl_analytics.int_all_players' was properly closed.
[0m14:25:16.203946 [debug] [MainThread]: Connection 'model.nhl_analytics.mart_player_performance' was properly closed.
[0m14:25:16.204083 [debug] [MainThread]: Connection 'model.nhl_analytics.mart_goalie_performance' was properly closed.
[0m14:25:16.204293 [info ] [MainThread]: 
[0m14:25:16.204483 [info ] [MainThread]: Finished running 3 table models, 4 view models in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m14:25:16.205228 [debug] [MainThread]: Command end result
[0m14:25:16.220596 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m14:25:16.221564 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m14:25:16.225438 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/run_results.json
[0m14:25:16.225645 [info ] [MainThread]: 
[0m14:25:16.225881 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:25:16.226069 [info ] [MainThread]: 
[0m14:25:16.226265 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m14:25:16.227198 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8121146, "process_in_blocks": "0", "process_kernel_time": 0.173413, "process_mem_max_rss": "176947200", "process_out_blocks": "0", "process_user_time": 1.465074}
[0m14:25:16.227433 [debug] [MainThread]: Command `python -m dbt.cli.main run` succeeded at 14:25:16.227390 after 0.81 seconds
[0m14:25:16.227649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053232b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055f4130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cb1b20>]}
[0m14:25:16.227863 [debug] [MainThread]: Flushing usage events
[0m14:25:16.415665 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:28:29.335435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071c1370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108349550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108349370>]}


============================== 14:28:29.338316 | 1e41dec0-75db-48ea-938e-77289ec52f52 ==============================
[0m14:28:29.338316 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:28:29.338668 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --profiles-dir .', 'log_path': '/Users/izaakford/Desktop/demo_sports_data_project/project/dbt/logs', 'warn_error': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'version_check': 'True', 'empty': 'False', 'target_path': 'None', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'quiet': 'False', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'static_parser': 'True'}
[0m14:28:29.512763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e41dec0-75db-48ea-938e-77289ec52f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b50700>]}
[0m14:28:29.546873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e41dec0-75db-48ea-938e-77289ec52f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10850f7c0>]}
[0m14:28:29.548506 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m14:28:29.618648 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:28:29.710482 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:28:29.710889 [debug] [MainThread]: Partial parsing: updated file: nhl_analytics://models/staging/stg_goalies.sql
[0m14:28:29.898813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e41dec0-75db-48ea-938e-77289ec52f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108439c40>]}
[0m14:28:30.018465 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m14:28:30.019869 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m14:28:30.029734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e41dec0-75db-48ea-938e-77289ec52f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108421730>]}
[0m14:28:30.030039 [info ] [MainThread]: Found 7 models, 6 data tests, 4 sources, 445 macros
[0m14:28:30.030259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e41dec0-75db-48ea-938e-77289ec52f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085abe20>]}
[0m14:28:30.031184 [info ] [MainThread]: 
[0m14:28:30.031402 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:28:30.031585 [info ] [MainThread]: 
[0m14:28:30.031875 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:28:30.035178 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nhl'
[0m14:28:30.067049 [debug] [ThreadPool]: Using duckdb connection "list_nhl"
[0m14:28:30.067338 [debug] [ThreadPool]: On list_nhl: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nhl"'
    
  
  
[0m14:28:30.067519 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:30.099726 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m14:28:30.100875 [debug] [ThreadPool]: On list_nhl: Close
[0m14:28:30.101298 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nhl, now create_nhl_silver)
[0m14:28:30.101576 [debug] [ThreadPool]: Creating schema "database: "nhl"
schema: "silver"
"
[0m14:28:30.105727 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:28:30.105922 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nhl'
        and type='sqlite'
    
  
[0m14:28:30.106091 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:28:30.106691 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:28:30.107477 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:28:30.107652 [debug] [ThreadPool]: On create_nhl_silver: BEGIN
[0m14:28:30.107909 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:28:30.108077 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:28:30.108245 [debug] [ThreadPool]: On create_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "create_nhl_silver"} */

    
    
        create schema if not exists "nhl"."silver"
    
[0m14:28:30.108512 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:28:30.108949 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m14:28:30.109112 [debug] [ThreadPool]: Using duckdb connection "create_nhl_silver"
[0m14:28:30.109262 [debug] [ThreadPool]: On create_nhl_silver: COMMIT
[0m14:28:30.109492 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:28:30.109665 [debug] [ThreadPool]: On create_nhl_silver: Close
[0m14:28:30.110484 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nhl_silver, now list_nhl_silver)
[0m14:28:30.114184 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m14:28:30.114376 [debug] [ThreadPool]: On list_nhl_silver: BEGIN
[0m14:28:30.114536 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:28:30.114822 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:28:30.114995 [debug] [ThreadPool]: Using duckdb connection "list_nhl_silver"
[0m14:28:30.115173 [debug] [ThreadPool]: On list_nhl_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "connection_name": "list_nhl_silver"} */
select
      'nhl' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'silver'
    and lower(table_catalog) = 'nhl'
  
[0m14:28:30.125191 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m14:28:30.126093 [debug] [ThreadPool]: On list_nhl_silver: ROLLBACK
[0m14:28:30.127244 [debug] [ThreadPool]: Failed to rollback 'list_nhl_silver'
[0m14:28:30.127440 [debug] [ThreadPool]: On list_nhl_silver: Close
[0m14:28:30.128380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e41dec0-75db-48ea-938e-77289ec52f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108385b20>]}
[0m14:28:30.128652 [debug] [MainThread]: Using duckdb connection "master"
[0m14:28:30.128817 [debug] [MainThread]: On master: BEGIN
[0m14:28:30.128968 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:28:30.129237 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:28:30.129407 [debug] [MainThread]: On master: COMMIT
[0m14:28:30.129576 [debug] [MainThread]: Using duckdb connection "master"
[0m14:28:30.129728 [debug] [MainThread]: On master: COMMIT
[0m14:28:30.129960 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:28:30.130131 [debug] [MainThread]: On master: Close
[0m14:28:30.131489 [debug] [Thread-1  ]: Began running node model.nhl_analytics.stg_goalies
[0m14:28:30.131723 [debug] [Thread-2  ]: Began running node model.nhl_analytics.stg_skaters
[0m14:28:30.132200 [debug] [Thread-3  ]: Began running node model.nhl_analytics.stg_teams
[0m14:28:30.132017 [info ] [Thread-1  ]: 1 of 7 START sql view model silver.stg_goalies ................................. [RUN]
[0m14:28:30.132478 [info ] [Thread-2  ]: 2 of 7 START sql view model silver.stg_skaters ................................. [RUN]
[0m14:28:30.132859 [info ] [Thread-3  ]: 3 of 7 START sql view model silver.stg_teams ................................... [RUN]
[0m14:28:30.133146 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_nhl_silver, now model.nhl_analytics.stg_goalies)
[0m14:28:30.133426 [debug] [Thread-2  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_skaters'
[0m14:28:30.133682 [debug] [Thread-3  ]: Acquiring new duckdb connection 'model.nhl_analytics.stg_teams'
[0m14:28:30.133894 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.stg_goalies
[0m14:28:30.134098 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.stg_skaters
[0m14:28:30.134295 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.stg_teams
[0m14:28:30.139646 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.stg_goalies"
[0m14:28:30.141639 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.stg_skaters"
[0m14:28:30.143500 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.stg_teams"
[0m14:28:30.143939 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.stg_goalies
[0m14:28:30.144183 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.stg_skaters
[0m14:28:30.149696 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.stg_teams
[0m14:28:30.166739 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.stg_goalies"
[0m14:28:30.167498 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.stg_skaters"
[0m14:28:30.169537 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.stg_teams"
[0m14:28:30.170101 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m14:28:30.170352 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:28:30.170590 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m14:28:30.170790 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: BEGIN
[0m14:28:30.171000 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: BEGIN
[0m14:28:30.171190 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: BEGIN
[0m14:28:30.171377 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:28:30.171561 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:28:30.171743 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:28:30.172222 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m14:28:30.172453 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m14:28:30.172668 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:28:30.172868 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m14:28:30.173075 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m14:28:30.173292 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

  
  create view "nhl"."silver"."stg_teams__dbt_tmp" as (
    
select season,
    name as team_name,
    team as team_code,
    sum(games_played) as games_played,
    sum(goalsFor) as goalsFor,
    sum(goalsAgainst) as goalsAgainst,
    sum(goalsFor) - sum(goalsAgainst) as goal_differential,
    sum(xGoalsFor) as xGoalsFor,
    sum(xGoalsAgainst) as xGoalsAgainst,
    current_timestamp as loaded_at
from "nhl"."bronze"."teams"
where season is not null
    and name is not null
group by season,
    name,
    team
  );

[0m14:28:30.173506 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m14:28:30.173751 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

  
  create view "nhl"."silver"."stg_goalies__dbt_tmp" as (
    

select 
    playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    max(games_played) as games_played,
    max(icetime) as ice_time,
    sum(xGoals) as expected_goals,
    sum(goals) as goals,
    sum(unblocked_shot_attempts) as unblocked_shot_attempts,
    sum(xRebounds) as expected_rebounds,
    sum(rebounds) as rebounds,
    sum(xFreeze) as expected_freeze,
    sum("freeze") as freeze,
    sum(xOnGoal) as expected_on_goal,
    sum(ongoal) as on_goal,
    sum(xPlayStopped) as expected_play_stopped,
    sum(playStopped) as play_stopped,
    sum(xPlayContinuedInZone) as expected_play_continued_in_zone,
    sum(playContinuedInZone) as play_continued_in_zone,
    sum(xPlayContinuedOutsideZone) as expected_play_continued_outside_zone,
    sum(playContinuedOutsideZone) as play_continued_outside_zone,
    sum(flurryAdjustedxGoals) as flurry_adjusted_expected_goals,
    sum(lowDangerShots) as low_danger_shots,
    sum(mediumDangerShots) as medium_danger_shots,
    sum(highDangerShots) as high_danger_shots,
    sum(lowDangerxGoals) as low_danger_expected_goals,
    sum(mediumDangerxGoals) as medium_danger_expected_goals,
    sum(highDangerxGoals) as high_danger_expected_goals,
    sum(lowDangerGoals) as low_danger_goals,
    sum(mediumDangerGoals) as medium_danger_goals,
    sum(highDangerGoals) as high_danger_goals,
    sum(blocked_shot_attempts) as blocked_shot_attempts,
    max(penalityMinutes) as penalty_minutes,
    max(penalties) as penalties,
    current_timestamp as loaded_at
from "nhl"."bronze"."goalies"
where playerId is not null
    and season is not null
group by playerId, season, name, team, position
  );

[0m14:28:30.174153 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

  
  create view "nhl"."silver"."stg_skaters__dbt_tmp" as (
    
select playerId as player_id,
    season,
    name as player_name,
    team as team_code,
    position,
    sum(games_played) as games_played,
    sum(icetime) as ice_time,
    sum(shifts) as shifts,
    sum(gameScore) as game_score,
    sum(I_F_goals) as goals,
    sum(I_F_points) as points,
    sum(I_F_shotsOnGoal) as shots_on_goal,
    sum(I_F_primaryAssists) as primary_assists,
    sum(I_F_secondaryAssists) as secondary_assists,
    sum(I_F_xOnGoal) as expected_on_goal,
    sum(I_F_xGoals) as expected_goals,
    sum(I_F_xRebounds) as expected_rebounds,
    sum(I_F_rebounds) as rebounds,
    sum(I_F_freeze) as freeze,
    sum(I_F_playStopped) as play_stopped,
    sum(I_F_playContinuedInZone) as play_continued_in_zone,
    sum(I_F_playContinuedOutsideZone) as play_continued_outside_zone,
    sum(I_F_lowDangerShots) as low_danger_shots,
    sum(I_F_mediumDangerShots) as medium_danger_shots,
    sum(I_F_highDangerShots) as high_danger_shots,
    sum(I_F_lowDangerxGoals) as low_danger_expected_goals,
    sum(I_F_mediumDangerxGoals) as medium_danger_expected_goals,
    sum(I_F_highDangerxGoals) as high_danger_expected_goals,
    sum(I_F_lowDangerGoals) as low_danger_goals,
    sum(I_F_mediumDangerGoals) as medium_danger_goals,
    sum(I_F_highDangerGoals) as high_danger_goals,
    case
        when sum(games_played) > 0 then true
        else false
    end as is_active_player,
    case
        when sum(games_played) > 0 then round(sum(I_F_points) * 1.0 / sum(games_played), 2)
        else null
    end as points_per_game,
    case
        when sum(I_F_shotsOnGoal) > 0 then round(sum(I_F_goals) * 100.0 / sum(I_F_shotsOnGoal), 2)
        else null
    end as shooting_percentage,
    current_timestamp as loaded_at
from "nhl"."bronze"."skaters"
where playerId is not null
    and season is not null
group by playerId,
    season,
    name,
    team,
    position
  );

[0m14:28:30.175326 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m14:28:30.179285 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:28:30.179522 [debug] [Thread-1  ]: SQL status: OK in 0.005 seconds
[0m14:28:30.179747 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */
alter view "nhl"."silver"."stg_teams" rename to "stg_teams__dbt_backup"
[0m14:28:30.179953 [debug] [Thread-2  ]: SQL status: OK in 0.005 seconds
[0m14:28:30.181747 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m14:28:30.183884 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m14:28:30.184121 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */
alter view "nhl"."silver"."stg_goalies" rename to "stg_goalies__dbt_backup"
[0m14:28:30.184335 [debug] [Thread-3  ]: SQL status: OK in 0.002 seconds
[0m14:28:30.184535 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */
alter view "nhl"."silver"."stg_skaters" rename to "stg_skaters__dbt_backup"
[0m14:28:30.186341 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:28:30.186602 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m14:28:30.186820 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */
alter view "nhl"."silver"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m14:28:30.187035 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m14:28:30.189254 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m14:28:30.191050 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m14:28:30.191271 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */
alter view "nhl"."silver"."stg_goalies__dbt_tmp" rename to "stg_goalies"
[0m14:28:30.191485 [debug] [Thread-3  ]: SQL status: OK in 0.002 seconds
[0m14:28:30.191680 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */
alter view "nhl"."silver"."stg_skaters__dbt_tmp" rename to "stg_skaters"
[0m14:28:30.198450 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: COMMIT
[0m14:28:30.198707 [debug] [Thread-1  ]: SQL status: OK in 0.007 seconds
[0m14:28:30.199029 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:28:30.199796 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: COMMIT
[0m14:28:30.200023 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m14:28:30.200222 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: COMMIT
[0m14:28:30.200430 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m14:28:30.201058 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: COMMIT
[0m14:28:30.201338 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: COMMIT
[0m14:28:30.201573 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m14:28:30.201869 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: COMMIT
[0m14:28:30.202173 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m14:28:30.202422 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m14:28:30.205708 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.stg_teams"
[0m14:28:30.205930 [debug] [Thread-2  ]: SQL status: OK in 0.004 seconds
[0m14:28:30.207404 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.stg_goalies"
[0m14:28:30.207625 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_teams"} */

      drop view if exists "nhl"."silver"."stg_teams__dbt_backup" cascade
    
[0m14:28:30.209183 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.stg_skaters"
[0m14:28:30.209406 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_goalies"} */

      drop view if exists "nhl"."silver"."stg_goalies__dbt_backup" cascade
    
[0m14:28:30.209703 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.stg_skaters"} */

      drop view if exists "nhl"."silver"."stg_skaters__dbt_backup" cascade
    
[0m14:28:30.209998 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m14:28:30.211350 [debug] [Thread-3  ]: On model.nhl_analytics.stg_teams: Close
[0m14:28:30.211573 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m14:28:30.211784 [debug] [Thread-2  ]: SQL status: OK in 0.002 seconds
[0m14:28:30.212830 [debug] [Thread-1  ]: On model.nhl_analytics.stg_goalies: Close
[0m14:28:30.213849 [debug] [Thread-2  ]: On model.nhl_analytics.stg_skaters: Close
[0m14:28:30.214496 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e41dec0-75db-48ea-938e-77289ec52f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108385b20>]}
[0m14:28:30.214696 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e41dec0-75db-48ea-938e-77289ec52f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ee03a0>]}
[0m14:28:30.214936 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e41dec0-75db-48ea-938e-77289ec52f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108af8130>]}
[0m14:28:30.215242 [info ] [Thread-3  ]: 3 of 7 OK created sql view model silver.stg_teams .............................. [[32mOK[0m in 0.08s]
[0m14:28:30.215593 [info ] [Thread-1  ]: 1 of 7 OK created sql view model silver.stg_goalies ............................ [[32mOK[0m in 0.08s]
[0m14:28:30.215945 [info ] [Thread-2  ]: 2 of 7 OK created sql view model silver.stg_skaters ............................ [[32mOK[0m in 0.08s]
[0m14:28:30.216272 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.stg_teams
[0m14:28:30.216571 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.stg_goalies
[0m14:28:30.216859 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.stg_skaters
[0m14:28:30.217234 [debug] [Thread-4  ]: Began running node model.nhl_analytics.mart_team_standings
[0m14:28:30.217587 [info ] [Thread-4  ]: 4 of 7 START sql table model silver.mart_team_standings ........................ [RUN]
[0m14:28:30.217921 [debug] [Thread-4  ]: Acquiring new duckdb connection 'model.nhl_analytics.mart_team_standings'
[0m14:28:30.218155 [debug] [Thread-1  ]: Began running node model.nhl_analytics.int_all_players
[0m14:28:30.218361 [debug] [Thread-4  ]: Began compiling node model.nhl_analytics.mart_team_standings
[0m14:28:30.218632 [info ] [Thread-1  ]: 5 of 7 START sql view model silver.int_all_players ............................. [RUN]
[0m14:28:30.220545 [debug] [Thread-4  ]: Writing injected SQL for node "model.nhl_analytics.mart_team_standings"
[0m14:28:30.220784 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.stg_goalies, now model.nhl_analytics.int_all_players)
[0m14:28:30.221040 [debug] [Thread-1  ]: Began compiling node model.nhl_analytics.int_all_players
[0m14:28:30.223767 [debug] [Thread-1  ]: Writing injected SQL for node "model.nhl_analytics.int_all_players"
[0m14:28:30.224060 [debug] [Thread-4  ]: Began executing node model.nhl_analytics.mart_team_standings
[0m14:28:30.236790 [debug] [Thread-4  ]: Writing runtime sql for node "model.nhl_analytics.mart_team_standings"
[0m14:28:30.237188 [debug] [Thread-1  ]: Began executing node model.nhl_analytics.int_all_players
[0m14:28:30.239379 [debug] [Thread-1  ]: Writing runtime sql for node "model.nhl_analytics.int_all_players"
[0m14:28:30.239729 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:28:30.239976 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: BEGIN
[0m14:28:30.240181 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:28:30.240402 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m14:28:30.240715 [debug] [Thread-1  ]: On model.nhl_analytics.int_all_players: BEGIN
[0m14:28:30.240916 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:28:30.241122 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m14:28:30.241384 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:28:30.241602 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

  
    
    

    create  table
      "nhl"."silver"."mart_team_standings__dbt_tmp"
  
    as (
      

select 
    season,
    team_name,
    team_code,
    games_played,
    goalsFor,
    goalsAgainst,
    goal_differential,
    xGoalsFor,
    xGoalsAgainst,
    row_number() over (
        order by goalsFor desc,
            goal_differential desc
    ) as standings_rank,
    loaded_at
from "nhl"."silver"."stg_teams"
order by standings_rank
    );
  
  
[0m14:28:30.241816 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m14:28:30.242078 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m14:28:30.242296 [debug] [Thread-1  ]: On model.nhl_analytics.int_all_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */

  
  create view "nhl"."silver"."int_all_players__dbt_tmp" as (
    

with all_players as (
    select 
        player_id,
        season,
        player_name,
        team_code,
        'G' as position,
        null as games_played,
        null as points_per_game,
        null as shooting_percentage
    from "nhl"."silver"."stg_goalies"
    
    union all
    
    select 
        player_id,
        season,
        player_name,
        team_code,
        position,
        games_played,
        points_per_game,
        shooting_percentage
    from "nhl"."silver"."stg_skaters"
)

select *,
    case 
        when position = 'G' then 'Goalie'
        when position in ('C', 'L', 'R', 'LW', 'RW') then 'Forward'
        when position in ('D') then 'Defense'
        else 'Unknown'
    end as position_group,
    current_timestamp as loaded_at
from all_players
  );

[0m14:28:30.243910 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m14:28:30.246051 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m14:28:30.246292 [debug] [Thread-1  ]: On model.nhl_analytics.int_all_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */
alter view "nhl"."silver"."int_all_players" rename to "int_all_players__dbt_backup"
[0m14:28:30.246685 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m14:28:30.248979 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m14:28:30.249375 [debug] [Thread-1  ]: On model.nhl_analytics.int_all_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */
alter view "nhl"."silver"."int_all_players__dbt_tmp" rename to "int_all_players"
[0m14:28:30.249812 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m14:28:30.250754 [debug] [Thread-1  ]: On model.nhl_analytics.int_all_players: COMMIT
[0m14:28:30.250996 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m14:28:30.251208 [debug] [Thread-1  ]: On model.nhl_analytics.int_all_players: COMMIT
[0m14:28:30.251665 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m14:28:30.253340 [debug] [Thread-1  ]: Using duckdb connection "model.nhl_analytics.int_all_players"
[0m14:28:30.253559 [debug] [Thread-1  ]: On model.nhl_analytics.int_all_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.int_all_players"} */

      drop view if exists "nhl"."silver"."int_all_players__dbt_backup" cascade
    
[0m14:28:30.253782 [debug] [Thread-4  ]: SQL status: OK in 0.012 seconds
[0m14:28:30.257050 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:28:30.257294 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'silver'
      AND table_name = 'mart_team_standings'
  
[0m14:28:30.257512 [debug] [Thread-1  ]: SQL status: OK in 0.004 seconds
[0m14:28:30.258266 [debug] [Thread-1  ]: On model.nhl_analytics.int_all_players: Close
[0m14:28:30.258494 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m14:28:30.258810 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e41dec0-75db-48ea-938e-77289ec52f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10927d790>]}
[0m14:28:30.259504 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:28:30.259785 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'silver'
      AND table_name = 'mart_team_standings'
  
[0m14:28:30.260100 [info ] [Thread-1  ]: 5 of 7 OK created sql view model silver.int_all_players ........................ [[32mOK[0m in 0.04s]
[0m14:28:30.260475 [debug] [Thread-1  ]: Finished running node model.nhl_analytics.int_all_players
[0m14:28:30.260711 [debug] [Thread-4  ]: SQL status: OK in 0.000 seconds
[0m14:28:30.262662 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:28:30.262888 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */
alter table "nhl"."silver"."mart_team_standings" rename to "mart_team_standings__dbt_backup"
[0m14:28:30.263741 [debug] [Thread-2  ]: Began running node model.nhl_analytics.mart_goalie_performance
[0m14:28:30.263991 [debug] [Thread-3  ]: Began running node model.nhl_analytics.mart_player_performance
[0m14:28:30.264273 [info ] [Thread-2  ]: 6 of 7 START sql table model silver.mart_goalie_performance .................... [RUN]
[0m14:28:30.264516 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m14:28:30.264804 [info ] [Thread-3  ]: 7 of 7 START sql table model silver.mart_player_performance .................... [RUN]
[0m14:28:30.265093 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.stg_skaters, now model.nhl_analytics.mart_goalie_performance)
[0m14:28:30.266946 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:28:30.267198 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.nhl_analytics.stg_teams, now model.nhl_analytics.mart_player_performance)
[0m14:28:30.267434 [debug] [Thread-2  ]: Began compiling node model.nhl_analytics.mart_goalie_performance
[0m14:28:30.267658 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */
alter table "nhl"."silver"."mart_team_standings__dbt_tmp" rename to "mart_team_standings"
[0m14:28:30.267873 [debug] [Thread-3  ]: Began compiling node model.nhl_analytics.mart_player_performance
[0m14:28:30.269973 [debug] [Thread-2  ]: Writing injected SQL for node "model.nhl_analytics.mart_goalie_performance"
[0m14:28:30.272067 [debug] [Thread-3  ]: Writing injected SQL for node "model.nhl_analytics.mart_player_performance"
[0m14:28:30.272350 [debug] [Thread-4  ]: SQL status: OK in 0.002 seconds
[0m14:28:30.276049 [info ] [Thread-4  ]: Exporting mart_team_standings to silver folder
[0m14:28:30.276460 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:28:30.276703 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

        COPY (
    SELECT *
    FROM "nhl"."silver"."mart_team_standings"
) TO '../data/silver/mart_team_standings.parquet' (FORMAT PARQUET);
      
[0m14:28:30.276961 [debug] [Thread-2  ]: Began executing node model.nhl_analytics.mart_goalie_performance
[0m14:28:30.279300 [debug] [Thread-2  ]: Writing runtime sql for node "model.nhl_analytics.mart_goalie_performance"
[0m14:28:30.279538 [debug] [Thread-3  ]: Began executing node model.nhl_analytics.mart_player_performance
[0m14:28:30.281657 [debug] [Thread-3  ]: Writing runtime sql for node "model.nhl_analytics.mart_player_performance"
[0m14:28:30.281927 [debug] [Thread-4  ]: SQL status: OK in 0.005 seconds
[0m14:28:30.282703 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: COMMIT
[0m14:28:30.282950 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:28:30.283162 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: COMMIT
[0m14:28:30.283396 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m14:28:30.283657 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m14:28:30.283880 [debug] [Thread-3  ]: On model.nhl_analytics.mart_player_performance: BEGIN
[0m14:28:30.284102 [debug] [Thread-2  ]: On model.nhl_analytics.mart_goalie_performance: BEGIN
[0m14:28:30.284332 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m14:28:30.284558 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m14:28:30.284751 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m14:28:30.286620 [debug] [Thread-4  ]: Using duckdb connection "model.nhl_analytics.mart_team_standings"
[0m14:28:30.286907 [debug] [Thread-3  ]: SQL status: OK in 0.003 seconds
[0m14:28:30.287132 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_team_standings"} */

      drop table if exists "nhl"."silver"."mart_team_standings__dbt_backup" cascade
    
[0m14:28:30.287352 [debug] [Thread-2  ]: SQL status: OK in 0.003 seconds
[0m14:28:30.287538 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m14:28:30.287790 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m14:28:30.288022 [debug] [Thread-3  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */

  
    
    

    create  table
      "nhl"."silver"."mart_player_performance__dbt_tmp"
  
    as (
      

select 
    player_id,
    player_name,
    team_code,
    position,
    position_group,
    games_played,
    points_per_game,
    shooting_percentage,
    case
        when points_per_game >= 1.0 then 'Elite'
        when points_per_game >= 0.7 then 'Very Good'
        when points_per_game >= 0.5 then 'Good'
        when points_per_game >= 0.3 then 'Average'
        else 'Below Average'
    end as offensive_rating,
    loaded_at
from "nhl"."silver"."int_all_players"
where position_group in ('Forward', 'Defense')
    and games_played >= 10
    );
  
  
[0m14:28:30.288252 [debug] [Thread-4  ]: SQL status: OK in 0.001 seconds
[0m14:28:30.288462 [debug] [Thread-2  ]: On model.nhl_analytics.mart_goalie_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */

  
    
    

    create  table
      "nhl"."silver"."mart_goalie_performance__dbt_tmp"
  
    as (
      

select 
    player_id,
    player_name,
    season,
    team_code,
    position,
    loaded_at
from "nhl"."silver"."int_all_players"
where position_group in ('Goalie')
    and games_played >= 10
    );
  
  
[0m14:28:30.289302 [debug] [Thread-4  ]: On model.nhl_analytics.mart_team_standings: Close
[0m14:28:30.289735 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e41dec0-75db-48ea-938e-77289ec52f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109207d90>]}
[0m14:28:30.290134 [info ] [Thread-4  ]: 4 of 7 OK created sql table model silver.mart_team_standings ................... [[32mOK[0m in 0.07s]
[0m14:28:30.290470 [debug] [Thread-4  ]: Finished running node model.nhl_analytics.mart_team_standings
[0m14:28:30.293589 [debug] [Thread-2  ]: SQL status: OK in 0.004 seconds
[0m14:28:30.294329 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m14:28:30.294722 [debug] [Thread-2  ]: On model.nhl_analytics.mart_goalie_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'silver'
      AND table_name = 'mart_goalie_performance'
  
[0m14:28:30.295457 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m14:28:30.296608 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m14:28:30.296973 [debug] [Thread-2  ]: On model.nhl_analytics.mart_goalie_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'silver'
      AND table_name = 'mart_goalie_performance'
  
[0m14:28:30.297576 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m14:28:30.300361 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m14:28:30.300595 [debug] [Thread-3  ]: SQL status: OK in 0.012 seconds
[0m14:28:30.300824 [debug] [Thread-2  ]: On model.nhl_analytics.mart_goalie_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */
alter table "nhl"."silver"."mart_goalie_performance" rename to "mart_goalie_performance__dbt_backup"
[0m14:28:30.301413 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m14:28:30.301696 [debug] [Thread-3  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'silver'
      AND table_name = 'mart_player_performance'
  
[0m14:28:30.301965 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m14:28:30.304004 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m14:28:30.304227 [debug] [Thread-3  ]: SQL status: OK in 0.002 seconds
[0m14:28:30.304452 [debug] [Thread-2  ]: On model.nhl_analytics.mart_goalie_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */
alter table "nhl"."silver"."mart_goalie_performance__dbt_tmp" rename to "mart_goalie_performance"
[0m14:28:30.305195 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m14:28:30.305470 [debug] [Thread-3  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'silver'
      AND table_name = 'mart_player_performance'
  
[0m14:28:30.305733 [debug] [Thread-2  ]: SQL status: OK in 0.000 seconds
[0m14:28:30.306887 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m14:28:30.306706 [info ] [Thread-2  ]: Exporting mart_goalie_performance to silver folder
[0m14:28:30.308848 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m14:28:30.309118 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m14:28:30.309337 [debug] [Thread-3  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */
alter table "nhl"."silver"."mart_player_performance" rename to "mart_player_performance__dbt_backup"
[0m14:28:30.309554 [debug] [Thread-2  ]: On model.nhl_analytics.mart_goalie_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */

        COPY (
    SELECT *
    FROM "nhl"."silver"."mart_goalie_performance"
) TO '../data/silver/mart_goalie_performance.parquet' (FORMAT PARQUET);
      
[0m14:28:30.309911 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m14:28:30.311717 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m14:28:30.311930 [debug] [Thread-3  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */
alter table "nhl"."silver"."mart_player_performance__dbt_tmp" rename to "mart_player_performance"
[0m14:28:30.312137 [debug] [Thread-2  ]: SQL status: OK in 0.002 seconds
[0m14:28:30.312838 [debug] [Thread-2  ]: On model.nhl_analytics.mart_goalie_performance: COMMIT
[0m14:28:30.313048 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m14:28:30.313285 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m14:28:30.313490 [debug] [Thread-2  ]: On model.nhl_analytics.mart_goalie_performance: COMMIT
[0m14:28:30.314424 [info ] [Thread-3  ]: Exporting mart_player_performance to silver folder
[0m14:28:30.314788 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m14:28:30.315005 [debug] [Thread-3  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */

        COPY (
    SELECT *
    FROM "nhl"."silver"."mart_player_performance"
) TO '../data/silver/mart_player_performance.parquet' (FORMAT PARQUET);
      
[0m14:28:30.315214 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m14:28:30.316966 [debug] [Thread-2  ]: Using duckdb connection "model.nhl_analytics.mart_goalie_performance"
[0m14:28:30.317194 [debug] [Thread-2  ]: On model.nhl_analytics.mart_goalie_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_goalie_performance"} */

      drop table if exists "nhl"."silver"."mart_goalie_performance__dbt_backup" cascade
    
[0m14:28:30.317410 [debug] [Thread-3  ]: SQL status: OK in 0.002 seconds
[0m14:28:30.318135 [debug] [Thread-3  ]: On model.nhl_analytics.mart_player_performance: COMMIT
[0m14:28:30.318356 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m14:28:30.318563 [debug] [Thread-2  ]: SQL status: OK in 0.001 seconds
[0m14:28:30.318957 [debug] [Thread-3  ]: On model.nhl_analytics.mart_player_performance: COMMIT
[0m14:28:30.319777 [debug] [Thread-2  ]: On model.nhl_analytics.mart_goalie_performance: Close
[0m14:28:30.320217 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e41dec0-75db-48ea-938e-77289ec52f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094637c0>]}
[0m14:28:30.320620 [info ] [Thread-2  ]: 6 of 7 OK created sql table model silver.mart_goalie_performance ............... [[32mOK[0m in 0.06s]
[0m14:28:30.320875 [debug] [Thread-3  ]: SQL status: OK in 0.001 seconds
[0m14:28:30.321173 [debug] [Thread-2  ]: Finished running node model.nhl_analytics.mart_goalie_performance
[0m14:28:30.322853 [debug] [Thread-3  ]: Using duckdb connection "model.nhl_analytics.mart_player_performance"
[0m14:28:30.323148 [debug] [Thread-3  ]: On model.nhl_analytics.mart_player_performance: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "nhl_analytics", "target_name": "dev", "node_id": "model.nhl_analytics.mart_player_performance"} */

      drop table if exists "nhl"."silver"."mart_player_performance__dbt_backup" cascade
    
[0m14:28:30.323596 [debug] [Thread-3  ]: SQL status: OK in 0.000 seconds
[0m14:28:30.324256 [debug] [Thread-3  ]: On model.nhl_analytics.mart_player_performance: Close
[0m14:28:30.324554 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e41dec0-75db-48ea-938e-77289ec52f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094490a0>]}
[0m14:28:30.324882 [info ] [Thread-3  ]: 7 of 7 OK created sql table model silver.mart_player_performance ............... [[32mOK[0m in 0.06s]
[0m14:28:30.325195 [debug] [Thread-3  ]: Finished running node model.nhl_analytics.mart_player_performance
[0m14:28:30.325793 [debug] [MainThread]: Using duckdb connection "master"
[0m14:28:30.325977 [debug] [MainThread]: On master: BEGIN
[0m14:28:30.326134 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:28:30.326415 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:28:30.326585 [debug] [MainThread]: On master: COMMIT
[0m14:28:30.326744 [debug] [MainThread]: Using duckdb connection "master"
[0m14:28:30.326913 [debug] [MainThread]: On master: COMMIT
[0m14:28:30.327165 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:28:30.327352 [debug] [MainThread]: On master: Close
[0m14:28:30.327564 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:28:30.327712 [debug] [MainThread]: Connection 'model.nhl_analytics.int_all_players' was properly closed.
[0m14:28:30.327853 [debug] [MainThread]: Connection 'model.nhl_analytics.mart_goalie_performance' was properly closed.
[0m14:28:30.327993 [debug] [MainThread]: Connection 'model.nhl_analytics.mart_player_performance' was properly closed.
[0m14:28:30.328130 [debug] [MainThread]: Connection 'model.nhl_analytics.mart_team_standings' was properly closed.
[0m14:28:30.328334 [info ] [MainThread]: 
[0m14:28:30.328521 [info ] [MainThread]: Finished running 3 table models, 4 view models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m14:28:30.329267 [debug] [MainThread]: Command end result
[0m14:28:30.345390 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/manifest.json
[0m14:28:30.346429 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/semantic_manifest.json
[0m14:28:30.350556 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/izaakford/Desktop/demo_sports_data_project/project/dbt/target/run_results.json
[0m14:28:30.350752 [info ] [MainThread]: 
[0m14:28:30.350975 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:28:30.351160 [info ] [MainThread]: 
[0m14:28:30.351356 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m14:28:30.352289 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0616591, "process_in_blocks": "0", "process_kernel_time": 0.20675, "process_mem_max_rss": "178667520", "process_out_blocks": "0", "process_user_time": 1.657776}
[0m14:28:30.352506 [debug] [MainThread]: Command `python -m dbt.cli.main run` succeeded at 14:28:30.352464 after 1.06 seconds
[0m14:28:30.352711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071c1370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10850f7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108421730>]}
[0m14:28:30.352916 [debug] [MainThread]: Flushing usage events
[0m14:28:30.583767 [debug] [MainThread]: An error was encountered while trying to flush usage events
